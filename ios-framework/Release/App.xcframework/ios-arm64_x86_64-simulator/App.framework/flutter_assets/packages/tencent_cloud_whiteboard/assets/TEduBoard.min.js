!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.TEduBoard=e():t.TEduBoard=e()}(window,(function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(i,o,function(e){return t[e]}.bind(null,o));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=349)}([function(t,e,r){var i=r(3),o=r(20),n=r(14),a=r(15),s=r(21),l=function(t,e,r){var c,h,u,d,p=t&l.F,f=t&l.G,g=t&l.S,m=t&l.P,y=t&l.B,v=f?i:g?i[e]||(i[e]={}):(i[e]||{}).prototype,_=f?o:o[e]||(o[e]={}),E=_.prototype||(_.prototype={});for(c in f&&(r=e),r)u=((h=!p&&v&&void 0!==v[c])?v:r)[c],d=y&&h?s(u,i):m&&"function"==typeof u?s(Function.call,u):u,v&&a(v,c,u,t&l.U),_[c]!=u&&n(_,c,d),m&&E[c]!=u&&(E[c]=u)};i.core=o,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},,function(t,e,r){var i=r(5);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,r){var i=r(23),o=Math.min;t.exports=function(t){return t>0?o(i(t),9007199254740991):0}},function(t,e,r){var i=r(52)("wks"),o=r(37),n=r(3).Symbol,a="function"==typeof n;(t.exports=function(t){return i[t]||(i[t]=a&&n[t]||(a?n:o)("Symbol."+t))}).store=i},function(t,e,r){t.exports=!r(4)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,r){var i=r(2),o=r(103),n=r(25),a=Object.defineProperty;e.f=r(8)?Object.defineProperty:function(t,e,r){if(i(t),e=n(e,!0),i(r),o)try{return a(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},function(t,e,r){var i=r(26);t.exports=function(t){return Object(i(t))}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,r){var i;
/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/!function(r){"use strict";var o=Math.cosh||function(t){return Math.abs(t)<1e-9?1-t:.5*(Math.exp(t)+Math.exp(-t))},n=Math.sinh||function(t){return Math.abs(t)<1e-9?t:.5*(Math.exp(t)-Math.exp(-t))},a=function(){throw SyntaxError("Invalid Param")};function s(t,e){var r=Math.abs(t),i=Math.abs(e);return 0===t?Math.log(i):0===e?Math.log(r):r<3e3&&i<3e3?.5*Math.log(t*t+e*e):(t/=2,e/=2,.5*Math.log(t*t+e*e)+Math.LN2)}function l(t,e){if(!(this instanceof l))return new l(t,e);var r=function(t,e){var r={re:0,im:0};if(null==t)r.re=r.im=0;else if(void 0!==e)r.re=t,r.im=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)r.re=t.re,r.im=t.im;else if("abs"in t&&"arg"in t){if(!Number.isFinite(t.abs)&&Number.isFinite(t.arg))return l.INFINITY;r.re=t.abs*Math.cos(t.arg),r.im=t.abs*Math.sin(t.arg)}else if("r"in t&&"phi"in t){if(!Number.isFinite(t.r)&&Number.isFinite(t.phi))return l.INFINITY;r.re=t.r*Math.cos(t.phi),r.im=t.r*Math.sin(t.phi)}else 2===t.length?(r.re=t[0],r.im=t[1]):a();break;case"string":r.im=r.re=0;var i=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),o=1,n=0;null===i&&a();for(var s=0;s<i.length;s++){var c=i[s];" "===c||"\t"===c||"\n"===c||("+"===c?o++:"-"===c?n++:"i"===c||"I"===c?(o+n===0&&a()," "===i[s+1]||isNaN(i[s+1])?r.im+=parseFloat((n%2?"-":"")+"1"):(r.im+=parseFloat((n%2?"-":"")+i[s+1]),s++),o=n=0):((o+n===0||isNaN(c))&&a(),"i"===i[s+1]||"I"===i[s+1]?(r.im+=parseFloat((n%2?"-":"")+c),s++):r.re+=parseFloat((n%2?"-":"")+c),o=n=0))}o+n>0&&a();break;case"number":r.im=0,r.re=t;break;default:a()}return isNaN(r.re)||isNaN(r.im),r}(t,e);this.re=r.re,this.im=r.im}l.prototype={re:0,im:0,sign:function(){var t=this.abs();return new l(this.re/t,this.im/t)},add:function(t,e){var r=new l(t,e);return this.isInfinite()&&r.isInfinite()?l.NAN:this.isInfinite()||r.isInfinite()?l.INFINITY:new l(this.re+r.re,this.im+r.im)},sub:function(t,e){var r=new l(t,e);return this.isInfinite()&&r.isInfinite()?l.NAN:this.isInfinite()||r.isInfinite()?l.INFINITY:new l(this.re-r.re,this.im-r.im)},mul:function(t,e){var r=new l(t,e);return this.isInfinite()&&r.isZero()||this.isZero()&&r.isInfinite()?l.NAN:this.isInfinite()||r.isInfinite()?l.INFINITY:0===r.im&&0===this.im?new l(this.re*r.re,0):new l(this.re*r.re-this.im*r.im,this.re*r.im+this.im*r.re)},div:function(t,e){var r=new l(t,e);if(this.isZero()&&r.isZero()||this.isInfinite()&&r.isInfinite())return l.NAN;if(this.isInfinite()||r.isZero())return l.INFINITY;if(this.isZero()||r.isInfinite())return l.ZERO;t=this.re,e=this.im;var i,o,n=r.re,a=r.im;return 0===a?new l(t/n,e/n):Math.abs(n)<Math.abs(a)?new l((t*(o=n/a)+e)/(i=n*o+a),(e*o-t)/i):new l((t+e*(o=a/n))/(i=a*o+n),(e-t*o)/i)},pow:function(t,e){var r=new l(t,e);if(t=this.re,e=this.im,r.isZero())return l.ONE;if(0===r.im){if(0===e&&t>0)return new l(Math.pow(t,r.re),0);if(0===t)switch((r.re%4+4)%4){case 0:return new l(Math.pow(e,r.re),0);case 1:return new l(0,Math.pow(e,r.re));case 2:return new l(-Math.pow(e,r.re),0);case 3:return new l(0,-Math.pow(e,r.re))}}if(0===t&&0===e&&r.re>0&&r.im>=0)return l.ZERO;var i=Math.atan2(e,t),o=s(t,e);return t=Math.exp(r.re*o-r.im*i),e=r.im*o+r.re*i,new l(t*Math.cos(e),t*Math.sin(e))},sqrt:function(){var t,e,r=this.re,i=this.im,o=this.abs();if(r>=0){if(0===i)return new l(Math.sqrt(r),0);t=.5*Math.sqrt(2*(o+r))}else t=Math.abs(i)/Math.sqrt(2*(o-r));return e=r<=0?.5*Math.sqrt(2*(o-r)):Math.abs(i)/Math.sqrt(2*(o+r)),new l(t,i<0?-e:e)},exp:function(){var t=Math.exp(this.re);return this.im,new l(t*Math.cos(this.im),t*Math.sin(this.im))},expm1:function(){var t=this.re,e=this.im;return new l(Math.expm1(t)*Math.cos(e)+function(t){var e=Math.PI/4;if(-e>t||t>e)return Math.cos(t)-1;var r=t*t;return r*(r*(r*(r*(r*(r*(r*(r/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(e),Math.exp(t)*Math.sin(e))},log:function(){var t=this.re,e=this.im;return new l(s(t,e),Math.atan2(e,t))},abs:function(){return t=this.re,e=this.im,r=Math.abs(t),i=Math.abs(e),r<3e3&&i<3e3?Math.sqrt(r*r+i*i):(r<i?(r=i,i=t/e):i=e/t,r*Math.sqrt(1+i*i));var t,e,r,i},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var t=this.re,e=this.im;return new l(Math.sin(t)*o(e),Math.cos(t)*n(e))},cos:function(){var t=this.re,e=this.im;return new l(Math.cos(t)*o(e),-Math.sin(t)*n(e))},tan:function(){var t=2*this.re,e=2*this.im,r=Math.cos(t)+o(e);return new l(Math.sin(t)/r,n(e)/r)},cot:function(){var t=2*this.re,e=2*this.im,r=Math.cos(t)-o(e);return new l(-Math.sin(t)/r,n(e)/r)},sec:function(){var t=this.re,e=this.im,r=.5*o(2*e)+.5*Math.cos(2*t);return new l(Math.cos(t)*o(e)/r,Math.sin(t)*n(e)/r)},csc:function(){var t=this.re,e=this.im,r=.5*o(2*e)-.5*Math.cos(2*t);return new l(Math.sin(t)*o(e)/r,-Math.cos(t)*n(e)/r)},asin:function(){var t=this.re,e=this.im,r=new l(e*e-t*t+1,-2*t*e).sqrt(),i=new l(r.re-e,r.im+t).log();return new l(i.im,-i.re)},acos:function(){var t=this.re,e=this.im,r=new l(e*e-t*t+1,-2*t*e).sqrt(),i=new l(r.re-e,r.im+t).log();return new l(Math.PI/2-i.im,i.re)},atan:function(){var t=this.re,e=this.im;if(0===t){if(1===e)return new l(0,1/0);if(-1===e)return new l(0,-1/0)}var r=t*t+(1-e)*(1-e),i=new l((1-e*e-t*t)/r,-2*t/r).log();return new l(-.5*i.im,.5*i.re)},acot:function(){var t=this.re,e=this.im;if(0===e)return new l(Math.atan2(1,t),0);var r=t*t+e*e;return 0!==r?new l(t/r,-e/r).atan():new l(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new l(0,1/0);var r=t*t+e*e;return 0!==r?new l(t/r,-e/r).acos():new l(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new l(Math.PI/2,1/0);var r=t*t+e*e;return 0!==r?new l(t/r,-e/r).asin():new l(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){var t=this.re,e=this.im;return new l(n(t)*Math.cos(e),o(t)*Math.sin(e))},cosh:function(){var t=this.re,e=this.im;return new l(o(t)*Math.cos(e),n(t)*Math.sin(e))},tanh:function(){var t=2*this.re,e=2*this.im,r=o(t)+Math.cos(e);return new l(n(t)/r,Math.sin(e)/r)},coth:function(){var t=2*this.re,e=2*this.im,r=o(t)-Math.cos(e);return new l(n(t)/r,-Math.sin(e)/r)},csch:function(){var t=this.re,e=this.im,r=Math.cos(2*e)-o(2*t);return new l(-2*n(t)*Math.cos(e)/r,2*o(t)*Math.sin(e)/r)},sech:function(){var t=this.re,e=this.im,r=Math.cos(2*e)+o(2*t);return new l(2*o(t)*Math.cos(e)/r,-2*n(t)*Math.sin(e)/r)},asinh:function(){var t=this.im;this.im=-this.re,this.re=t;var e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){var t=this.acos();if(t.im<=0){var e=t.re;t.re=-t.im,t.im=e}else e=t.im,t.im=-t.re,t.re=e;return t},atanh:function(){var t=this.re,e=this.im,r=t>1&&0===e,i=1-t,o=1+t,n=i*i+e*e,a=0!==n?new l((o*i-e*e)/n,(e*i+o*e)/n):new l(-1!==t?t/0:0,0!==e?e/0:0),c=a.re;return a.re=s(a.re,a.im)/2,a.im=Math.atan2(a.im,c)/2,r&&(a.im=-a.im),a},acoth:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new l(0,Math.PI/2);var r=t*t+e*e;return 0!==r?new l(t/r,-e/r).atanh():new l(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var t=this.re,e=this.im;if(0===e)return new l(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);var r=t*t+e*e;return 0!==r?new l(t/r,-e/r).asinh():new l(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){var t=this.re,e=this.im;if(this.isZero())return l.INFINITY;var r=t*t+e*e;return 0!==r?new l(t/r,-e/r).acosh():new l(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this.isZero())return l.INFINITY;if(this.isInfinite())return l.ZERO;var t=this.re,e=this.im,r=t*t+e*e;return new l(t/r,-e/r)},conjugate:function(){return new l(this.re,-this.im)},neg:function(){return new l(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new l(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new l(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new l(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,e){var r=new l(t,e);return Math.abs(r.re-this.re)<=l.EPSILON&&Math.abs(r.im-this.im)<=l.EPSILON},clone:function(){return new l(this.re,this.im)},toString:function(){var t=this.re,e=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(t)<l.EPSILON&&(t=0),Math.abs(e)<l.EPSILON&&(e=0),0===e?r+t:(0!==t?(r+=t,r+=" ",e<0?(e=-e,r+="-"):r+="+",r+=" "):e<0&&(e=-e,r+="-"),1!==e&&(r+=e),r+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},l.ZERO=new l(0,0),l.ONE=new l(1,0),l.I=new l(0,1),l.PI=new l(Math.PI,0),l.E=new l(Math.E,0),l.INFINITY=new l(1/0,1/0),l.NAN=new l(NaN,NaN),l.EPSILON=1e-15,void 0===(i=function(){return l}.apply(e,[]))||(t.exports=i)}()},function(t,e,r){var i=r(0),o=r(4),n=r(26),a=/"/g,s=function(t,e,r,i){var o=String(n(t)),s="<"+e;return""!==r&&(s+=" "+r+'="'+String(i).replace(a,"&quot;")+'"'),s+">"+o+"</"+e+">"};t.exports=function(t,e){var r={};r[t]=e(s),i(i.P+i.F*o((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",r)}},function(t,e,r){var i=r(9),o=r(36);t.exports=r(8)?function(t,e,r){return i.f(t,e,o(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e,r){var i=r(3),o=r(14),n=r(16),a=r(37)("src"),s=r(184),l=(""+s).split("toString");r(20).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,r,s){var c="function"==typeof r;c&&(n(r,"name")||o(r,"name",e)),t[e]!==r&&(c&&(n(r,a)||o(r,a,t[e]?""+t[e]:l.join(String(e)))),t===i?t[e]=r:s?t[e]?t[e]=r:o(t,e,r):(delete t[e],o(t,e,r)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var i=r(53),o=r(26);t.exports=function(t){return i(o(t))}},function(t,e,r){var i=r(54),o=r(36),n=r(17),a=r(25),s=r(16),l=r(103),c=Object.getOwnPropertyDescriptor;e.f=r(8)?c:function(t,e){if(t=n(t),e=a(e,!0),l)try{return c(t,e)}catch(t){}if(s(t,e))return o(!i.f.call(t,e),t[e])}},function(t,e,r){var i=r(16),o=r(10),n=r(74)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),i(t,n)?t[n]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e){var r=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=r)},function(t,e,r){var i=r(11);t.exports=function(t,e,r){if(i(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,i){return t.call(e,r,i)};case 3:return function(r,i,o){return t.call(e,r,i,o)}}return function(){return t.apply(e,arguments)}}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e){var r=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:r)(t)}},function(t,e,r){"use strict";var i=r(4);t.exports=function(t,e){return!!t&&i((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},function(t,e,r){var i=r(5);t.exports=function(t,e){if(!i(t))return t;var r,o;if(e&&"function"==typeof(r=t.toString)&&!i(o=r.call(t)))return o;if("function"==typeof(r=t.valueOf)&&!i(o=r.call(t)))return o;if(!e&&"function"==typeof(r=t.toString)&&!i(o=r.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,r){var i=r(0),o=r(20),n=r(4);t.exports=function(t,e){var r=(o.Object||{})[t]||Object[t],a={};a[t]=e(r),i(i.S+i.F*n((function(){r(1)})),"Object",a)}},function(t,e,r){var i=r(21),o=r(53),n=r(10),a=r(6),s=r(77);t.exports=function(t,e){var r=1==t,l=2==t,c=3==t,h=4==t,u=6==t,d=5==t||u,p=e||s;return function(e,s,f){for(var g,m,y=n(e),v=o(y),_=i(s,f,3),E=a(v.length),T=0,b=r?p(e,E):l?p(e,0):void 0;E>T;T++)if((d||T in v)&&(m=_(g=v[T],T,y),t))if(r)b[T]=m;else if(m)switch(t){case 3:return!0;case 5:return g;case 6:return T;case 2:b.push(g)}else if(h)return!1;return u?-1:c||h?h:b}}},function(t,e,r){"use strict";if(r(8)){var i=r(31),o=r(3),n=r(4),a=r(0),s=r(67),l=r(98),c=r(21),h=r(42),u=r(36),d=r(14),p=r(44),f=r(23),g=r(6),m=r(167),y=r(39),v=r(25),_=r(16),E=r(50),T=r(5),b=r(10),S=r(89),x=r(38),w=r(19),O=r(40).f,I=r(91),A=r(37),D=r(7),C=r(28),P=r(57),L=r(65),M=r(157),R=r(56),N=r(62),B=r(41),k=r(92),F=r(156),U=r(9),H=r(18),G=U.f,q=H.f,W=o.RangeError,Y=o.TypeError,z=o.Uint8Array,j=Array.prototype,V=l.ArrayBuffer,X=l.DataView,J=C(0),K=C(2),Z=C(3),Q=C(4),$=C(5),tt=C(6),et=P(!0),rt=P(!1),it=M.values,ot=M.keys,nt=M.entries,at=j.lastIndexOf,st=j.reduce,lt=j.reduceRight,ct=j.join,ht=j.sort,ut=j.slice,dt=j.toString,pt=j.toLocaleString,ft=D("iterator"),gt=D("toStringTag"),mt=A("typed_constructor"),yt=A("def_constructor"),vt=s.CONSTR,_t=s.TYPED,Et=s.VIEW,Tt=C(1,(function(t,e){return Ot(L(t,t[yt]),e)})),bt=n((function(){return 1===new z(new Uint16Array([1]).buffer)[0]})),St=!!z&&!!z.prototype.set&&n((function(){new z(1).set({})})),xt=function(t,e){var r=f(t);if(r<0||r%e)throw W("Wrong offset!");return r},wt=function(t){if(T(t)&&_t in t)return t;throw Y(t+" is not a typed array!")},Ot=function(t,e){if(!T(t)||!(mt in t))throw Y("It is not a typed array constructor!");return new t(e)},It=function(t,e){return At(L(t,t[yt]),e)},At=function(t,e){for(var r=0,i=e.length,o=Ot(t,i);i>r;)o[r]=e[r++];return o},Dt=function(t,e,r){G(t,e,{get:function(){return this._d[r]}})},Ct=function(t){var e,r,i,o,n,a,s=b(t),l=arguments.length,h=l>1?arguments[1]:void 0,u=void 0!==h,d=I(s);if(null!=d&&!S(d)){for(a=d.call(s),i=[],e=0;!(n=a.next()).done;e++)i.push(n.value);s=i}for(u&&l>2&&(h=c(h,arguments[2],2)),e=0,r=g(s.length),o=Ot(this,r);r>e;e++)o[e]=u?h(s[e],e):s[e];return o},Pt=function(){for(var t=0,e=arguments.length,r=Ot(this,e);e>t;)r[t]=arguments[t++];return r},Lt=!!z&&n((function(){pt.call(new z(1))})),Mt=function(){return pt.apply(Lt?ut.call(wt(this)):wt(this),arguments)},Rt={copyWithin:function(t,e){return F.call(wt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return Q(wt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return k.apply(wt(this),arguments)},filter:function(t){return It(this,K(wt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return $(wt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(wt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){J(wt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return rt(wt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(wt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(wt(this),arguments)},lastIndexOf:function(t){return at.apply(wt(this),arguments)},map:function(t){return Tt(wt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(wt(this),arguments)},reduceRight:function(t){return lt.apply(wt(this),arguments)},reverse:function(){for(var t,e=wt(this).length,r=Math.floor(e/2),i=0;i<r;)t=this[i],this[i++]=this[--e],this[e]=t;return this},some:function(t){return Z(wt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ht.call(wt(this),t)},subarray:function(t,e){var r=wt(this),i=r.length,o=y(t,i);return new(L(r,r[yt]))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,g((void 0===e?i:y(e,i))-o))}},Nt=function(t,e){return It(this,ut.call(wt(this),t,e))},Bt=function(t){wt(this);var e=xt(arguments[1],1),r=this.length,i=b(t),o=g(i.length),n=0;if(o+e>r)throw W("Wrong length!");for(;n<o;)this[e+n]=i[n++]},kt={entries:function(){return nt.call(wt(this))},keys:function(){return ot.call(wt(this))},values:function(){return it.call(wt(this))}},Ft=function(t,e){return T(t)&&t[_t]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Ut=function(t,e){return Ft(t,e=v(e,!0))?u(2,t[e]):q(t,e)},Ht=function(t,e,r){return!(Ft(t,e=v(e,!0))&&T(r)&&_(r,"value"))||_(r,"get")||_(r,"set")||r.configurable||_(r,"writable")&&!r.writable||_(r,"enumerable")&&!r.enumerable?G(t,e,r):(t[e]=r.value,t)};vt||(H.f=Ut,U.f=Ht),a(a.S+a.F*!vt,"Object",{getOwnPropertyDescriptor:Ut,defineProperty:Ht}),n((function(){dt.call({})}))&&(dt=pt=function(){return ct.call(this)});var Gt=p({},Rt);p(Gt,kt),d(Gt,ft,kt.values),p(Gt,{slice:Nt,set:Bt,constructor:function(){},toString:dt,toLocaleString:Mt}),Dt(Gt,"buffer","b"),Dt(Gt,"byteOffset","o"),Dt(Gt,"byteLength","l"),Dt(Gt,"length","e"),G(Gt,gt,{get:function(){return this[_t]}}),t.exports=function(t,e,r,l){var c=t+((l=!!l)?"Clamped":"")+"Array",u="get"+t,p="set"+t,f=o[c],y=f||{},v=f&&w(f),_=!f||!s.ABV,b={},S=f&&f.prototype,I=function(t,r){G(t,r,{get:function(){return function(t,r){var i=t._d;return i.v[u](r*e+i.o,bt)}(this,r)},set:function(t){return function(t,r,i){var o=t._d;l&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),o.v[p](r*e+o.o,i,bt)}(this,r,t)},enumerable:!0})};_?(f=r((function(t,r,i,o){h(t,f,c,"_d");var n,a,s,l,u=0,p=0;if(T(r)){if(!(r instanceof V||"ArrayBuffer"==(l=E(r))||"SharedArrayBuffer"==l))return _t in r?At(f,r):Ct.call(f,r);n=r,p=xt(i,e);var y=r.byteLength;if(void 0===o){if(y%e)throw W("Wrong length!");if((a=y-p)<0)throw W("Wrong length!")}else if((a=g(o)*e)+p>y)throw W("Wrong length!");s=a/e}else s=m(r),n=new V(a=s*e);for(d(t,"_d",{b:n,o:p,l:a,e:s,v:new X(n)});u<s;)I(t,u++)})),S=f.prototype=x(Gt),d(S,"constructor",f)):n((function(){f(1)}))&&n((function(){new f(-1)}))&&N((function(t){new f,new f(null),new f(1.5),new f(t)}),!0)||(f=r((function(t,r,i,o){var n;return h(t,f,c),T(r)?r instanceof V||"ArrayBuffer"==(n=E(r))||"SharedArrayBuffer"==n?void 0!==o?new y(r,xt(i,e),o):void 0!==i?new y(r,xt(i,e)):new y(r):_t in r?At(f,r):Ct.call(f,r):new y(m(r))})),J(v!==Function.prototype?O(y).concat(O(v)):O(y),(function(t){t in f||d(f,t,y[t])})),f.prototype=S,i||(S.constructor=f));var A=S[ft],D=!!A&&("values"==A.name||null==A.name),C=kt.values;d(f,mt,!0),d(S,_t,c),d(S,Et,!0),d(S,yt,f),(l?new f(1)[gt]==c:gt in S)||G(S,gt,{get:function(){return c}}),b[c]=f,a(a.G+a.W+a.F*(f!=y),b),a(a.S,c,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*n((function(){y.of.call(f,1)})),c,{from:Ct,of:Pt}),"BYTES_PER_ELEMENT"in S||d(S,"BYTES_PER_ELEMENT",e),a(a.P,c,Rt),B(c),a(a.P+a.F*St,c,{set:Bt}),a(a.P+a.F*!D,c,kt),i||S.toString==dt||(S.toString=dt),a(a.P+a.F*n((function(){new f(1).slice()})),c,{slice:Nt}),a(a.P+a.F*(n((function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()}))||!n((function(){S.toLocaleString.call([1,2])}))),c,{toLocaleString:Mt}),R[c]=D?A:C,i||D||d(S,ft,C)}}else t.exports=function(){}},function(t,e,r){var i=r(162),o=r(0),n=r(52)("metadata"),a=n.store||(n.store=new(r(165))),s=function(t,e,r){var o=a.get(t);if(!o){if(!r)return;a.set(t,o=new i)}var n=o.get(e);if(!n){if(!r)return;o.set(e,n=new i)}return n};t.exports={store:a,map:s,has:function(t,e,r){var i=s(e,r,!1);return void 0!==i&&i.has(t)},get:function(t,e,r){var i=s(e,r,!1);return void 0===i?void 0:i.get(t)},set:function(t,e,r,i){s(r,i,!0).set(t,e)},keys:function(t,e){var r=s(t,e,!1),i=[];return r&&r.forEach((function(t,e){i.push(e)})),i},key:function(t){return void 0===t||"symbol"==typeof t?t:String(t)},exp:function(t){o(o.S,"Reflect",t)}}},function(t,e){t.exports=!1},function(t,e,r){var i=r(37)("meta"),o=r(5),n=r(16),a=r(9).f,s=0,l=Object.isExtensible||function(){return!0},c=!r(4)((function(){return l(Object.preventExtensions({}))})),h=function(t){a(t,i,{value:{i:"O"+ ++s,w:{}}})},u=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!n(t,i)){if(!l(t))return"F";if(!e)return"E";h(t)}return t[i].i},getWeak:function(t,e){if(!n(t,i)){if(!l(t))return!0;if(!e)return!1;h(t)}return t[i].w},onFreeze:function(t){return c&&u.NEED&&l(t)&&!n(t,i)&&h(t),t}}},function(t,e,r){var i=r(7)("unscopables"),o=Array.prototype;null==o[i]&&r(14)(o,i,{}),t.exports=function(t){o[i][t]=!0}},function(t,e,r){var i=r(343)();t.exports=i;try{regeneratorRuntime=i}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},function(t,e,r){var i=r(345),o=r(346),n=r(347),a=r(348);t.exports=function(t){return i(t)||o(t)||n(t)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var r=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+i).toString(36))}},function(t,e,r){var i=r(2),o=r(104),n=r(75),a=r(74)("IE_PROTO"),s=function(){},l=function(){var t,e=r(73)("iframe"),i=n.length;for(e.style.display="none",r(76).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;i--;)delete l.prototype[n[i]];return l()};t.exports=Object.create||function(t,e){var r;return null!==t?(s.prototype=i(t),r=new s,s.prototype=null,r[a]=t):r=l(),void 0===e?r:o(r,e)}},function(t,e,r){var i=r(23),o=Math.max,n=Math.min;t.exports=function(t,e){return(t=i(t))<0?o(t+e,0):n(t,e)}},function(t,e,r){var i=r(105),o=r(75).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,o)}},function(t,e,r){"use strict";var i=r(3),o=r(9),n=r(8),a=r(7)("species");t.exports=function(t){var e=i[t];n&&e&&!e[a]&&o.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,r,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,e,r){var i=r(21),o=r(155),n=r(89),a=r(2),s=r(6),l=r(91),c={},h={};(e=t.exports=function(t,e,r,u,d){var p,f,g,m,y=d?function(){return t}:l(t),v=i(r,u,e?2:1),_=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(n(y)){for(p=s(t.length);p>_;_++)if((m=e?v(a(f=t[_])[0],f[1]):v(t[_]))===c||m===h)return m}else for(g=y.call(t);!(f=g.next()).done;)if((m=o(g,v,f.value,e))===c||m===h)return m}).BREAK=c,e.RETURN=h},function(t,e,r){var i=r(15);t.exports=function(t,e,r){for(var o in e)i(t,o,e[o],r);return t}},function(t,e,r){var i=r(5);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,r){var i;
/**
 * @license Fraction.js v4.2.0 05/03/2022
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
/**
 * @license Fraction.js v4.2.0 05/03/2022
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/!function(r){"use strict";var o={s:1,n:0,d:1};function n(t,e){if(isNaN(t=parseInt(t,10)))throw h.InvalidParameter;return t*e}function a(t,e){if(0===e)throw h.DivisionByZero;var r=Object.create(h.prototype);r.s=t<0?-1:1;var i=c(t=t<0?-t:t,e);return r.n=t/i,r.d=e/i,r}function s(t){for(var e={},r=t,i=2,o=4;o<=r;){for(;r%i==0;)r/=i,e[i]=(e[i]||0)+1;o+=1+2*i++}return r!==t?r>1&&(e[r]=(e[r]||0)+1):e[t]=(e[t]||0)+1,e}var l=function(t,e){var r,i=0,a=1,s=1,l=0,c=0,u=0,d=1,p=1,f=0,g=1,m=1,y=1,v=1e7;if(null==t);else if(void 0!==e){if(s=(i=t)*(a=e),i%1!=0||a%1!=0)throw h.NonIntegerParameter}else switch(typeof t){case"object":if("d"in t&&"n"in t)i=t.n,a=t.d,"s"in t&&(i*=t.s);else{if(!(0 in t))throw h.InvalidParameter;i=t[0],1 in t&&(a=t[1])}s=i*a;break;case"number":if(t<0&&(s=t,t=-t),t%1==0)i=t;else if(t>0){for(t>=1&&(t/=p=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)));g<=v&&y<=v;){if(t===(r=(f+m)/(g+y))){g+y<=v?(i=f+m,a=g+y):y>g?(i=m,a=y):(i=f,a=g);break}t>r?(f+=m,g+=y):(m+=f,y+=g),g>v?(i=m,a=y):(i=f,a=g)}i*=p}else(isNaN(t)||isNaN(e))&&(a=i=NaN);break;case"string":if(null===(g=t.match(/\d+|./g)))throw h.InvalidParameter;if("-"===g[f]?(s=-1,f++):"+"===g[f]&&f++,g.length===f+1?c=n(g[f++],s):"."===g[f+1]||"."===g[f]?("."!==g[f]&&(l=n(g[f++],s)),(1+ ++f===g.length||"("===g[f+1]&&")"===g[f+3]||"'"===g[f+1]&&"'"===g[f+3])&&(c=n(g[f],s),d=Math.pow(10,g[f].length),f++),("("===g[f]&&")"===g[f+2]||"'"===g[f]&&"'"===g[f+2])&&(u=n(g[f+1],s),p=Math.pow(10,g[f+1].length)-1,f+=3)):"/"===g[f+1]||":"===g[f+1]?(c=n(g[f],s),d=n(g[f+2],1),f+=3):"/"===g[f+3]&&" "===g[f+1]&&(l=n(g[f],s),c=n(g[f+2],s),d=n(g[f+4],1),f+=5),g.length<=f){s=i=u+(a=d*p)*l+p*c;break}default:throw h.InvalidParameter}if(0===a)throw h.DivisionByZero;o.s=s<0?-1:1,o.n=Math.abs(i),o.d=Math.abs(a)};function c(t,e){if(!t)return e;if(!e)return t;for(;;){if(!(t%=e))return e;if(!(e%=t))return t}}function h(t,e){if(l(t,e),!(this instanceof h))return a(o.s*o.n,o.d);t=c(o.d,o.n),this.s=o.s,this.n=o.n/t,this.d=o.d/t}h.DivisionByZero=new Error("Division by Zero"),h.InvalidParameter=new Error("Invalid argument"),h.NonIntegerParameter=new Error("Parameters must be integer"),h.prototype={s:1,n:0,d:1,abs:function(){return a(this.n,this.d)},neg:function(){return a(-this.s*this.n,this.d)},add:function(t,e){return l(t,e),a(this.s*this.n*o.d+o.s*this.d*o.n,this.d*o.d)},sub:function(t,e){return l(t,e),a(this.s*this.n*o.d-o.s*this.d*o.n,this.d*o.d)},mul:function(t,e){return l(t,e),a(this.s*o.s*this.n*o.n,this.d*o.d)},div:function(t,e){return l(t,e),a(this.s*o.s*this.n*o.d,this.d*o.n)},clone:function(){return a(this.s*this.n,this.d)},mod:function(t,e){if(isNaN(this.n)||isNaN(this.d))return new h(NaN);if(void 0===t)return a(this.s*this.n%this.d,1);if(l(t,e),0===o.n&&0===this.d)throw h.DivisionByZero;return a(this.s*(o.d*this.n)%(o.n*this.d),o.d*this.d)},gcd:function(t,e){return l(t,e),a(c(o.n,this.n)*c(o.d,this.d),o.d*this.d)},lcm:function(t,e){return l(t,e),0===o.n&&0===this.n?a(0,1):a(o.n*this.n,c(o.n,this.n)*c(o.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new h(NaN):a(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new h(NaN):a(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new h(NaN):a(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return a(this.s*this.d,this.n)},pow:function(t,e){if(l(t,e),1===o.d)return o.s<0?a(Math.pow(this.s*this.d,o.n),Math.pow(this.n,o.n)):a(Math.pow(this.s*this.n,o.n),Math.pow(this.d,o.n));if(this.s<0)return null;var r=s(this.n),i=s(this.d),n=1,c=1;for(var h in r)if("1"!==h){if("0"===h){n=0;break}if(r[h]*=o.n,r[h]%o.d!=0)return null;r[h]/=o.d,n*=Math.pow(h,r[h])}for(var h in i)if("1"!==h){if(i[h]*=o.n,i[h]%o.d!=0)return null;i[h]/=o.d,c*=Math.pow(h,i[h])}return o.s<0?a(c,n):a(n,c)},equals:function(t,e){return l(t,e),this.s*this.n*o.d==o.s*o.n*this.d},compare:function(t,e){l(t,e);var r=this.s*this.n*o.d-o.s*o.n*this.d;return(0<r)-(r<0)},simplify:function(t){if(isNaN(this.n)||isNaN(this.d))return this;t=t||.001;for(var e=this.abs(),r=e.toContinued(),i=1;i<r.length;i++){for(var o=a(r[i-1],1),n=i-2;n>=0;n--)o=o.inverse().add(r[n]);if(o.sub(e).abs().valueOf()<t)return o.mul(this.s)}return this},divisible:function(t,e){return l(t,e),!(!(o.n*this.d)||this.n*o.d%(o.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,r="",i=this.n,o=this.d;return this.s<0&&(r+="-"),1===o?r+=i:(t&&(e=Math.floor(i/o))>0&&(r+=e,r+=" ",i%=o),r+=i,r+="/",r+=o),r},toLatex:function(t){var e,r="",i=this.n,o=this.d;return this.s<0&&(r+="-"),1===o?r+=i:(t&&(e=Math.floor(i/o))>0&&(r+=e,i%=o),r+="\\frac{",r+=i,r+="}{",r+=o,r+="}"),r},toContinued:function(){var t,e=this.n,r=this.d,i=[];if(isNaN(e)||isNaN(r))return i;do{i.push(Math.floor(e/r)),t=e%r,e=r,r=t}while(1!==e);return i},toString:function(t){var e=this.n,r=this.d;if(isNaN(e)||isNaN(r))return"NaN";t=t||15;var i=function(t,e){for(;e%2==0;e/=2);for(;e%5==0;e/=5);if(1===e)return 0;for(var r=10%e,i=1;1!==r;i++)if(r=10*r%e,i>2e3)return 0;return i}(0,r),o=function(t,e,r){for(var i=1,o=function(t,e,r){for(var i=1;e>0;t=t*t%r,e>>=1)1&e&&(i=i*t%r);return i}(10,r,e),n=0;n<300;n++){if(i===o)return n;i=10*i%e,o=10*o%e}return 0}(0,r,i),n=this.s<0?"-":"";if(n+=e/r|0,e%=r,(e*=10)&&(n+="."),i){for(var a=o;a--;)n+=e/r|0,e%=r,e*=10;for(n+="(",a=i;a--;)n+=e/r|0,e%=r,e*=10;n+=")"}else for(a=t;e&&a--;)n+=e/r|0,e%=r,e*=10;return n}},void 0===(i=function(){return h}.apply(e,[]))||(t.exports=i)}()},function(t,e,r){var i=r(105),o=r(75);t.exports=Object.keys||function(t){return i(t,o)}},function(t,e,r){var i=r(0),o=r(26),n=r(4),a=r(79),s="["+a+"]",l=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),h=function(t,e,r){var o={},s=n((function(){return!!a[t]()||"​"!="​"[t]()})),l=o[t]=s?e(u):a[t];r&&(o[r]=l),i(i.P+i.F*s,"String",o)},u=h.trim=function(t,e){return t=String(o(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(c,"")),t};t.exports=h},function(t,e,r){var i=r(9).f,o=r(16),n=r(7)("toStringTag");t.exports=function(t,e,r){t&&!o(t=r?t:t.prototype,n)&&i(t,n,{configurable:!0,value:e})}},function(t,e,r){var i=r(22),o=r(7)("toStringTag"),n="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,r,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?r:n?i(e):"Object"==(a=i(e))&&"function"==typeof e.callee?"Arguments":a}},,function(t,e,r){var i=r(20),o=r(3),n=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:r(31)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,r){var i=r(22);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,r){"use strict";var i=r(2);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e){t.exports={}},function(t,e,r){var i=r(17),o=r(6),n=r(39);t.exports=function(t){return function(e,r,a){var s,l=i(e),c=o(l.length),h=n(a,c);if(t&&r!=r){for(;c>h;)if((s=l[h++])!=s)return!0}else for(;c>h;h++)if((t||h in l)&&l[h]===r)return t||h||0;return!t&&-1}}},function(t,e,r){var i=r(22);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,r){var i=r(23),o=r(26);t.exports=function(t){return function(e,r){var n,a,s=String(o(e)),l=i(r),c=s.length;return l<0||l>=c?t?"":void 0:(n=s.charCodeAt(l))<55296||n>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):n:t?s.slice(l,l+2):a-56320+(n-55296<<10)+65536}}},function(t,e,r){var i=r(5),o=r(22),n=r(7)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[n])?!!e:"RegExp"==o(t))}},function(t,e,r){var i=r(7)("iterator"),o=!1;try{var n=[7][i]();n.return=function(){o=!0},Array.from(n,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var r=!1;try{var n=[7],a=n[i]();a.next=function(){return{done:r=!0}},n[i]=function(){return a},t(n)}catch(t){}return r}},function(t,e,r){"use strict";var i=r(50),o=RegExp.prototype.exec;t.exports=function(t,e){var r=t.exec;if("function"==typeof r){var n=r.call(t,e);if("object"!=typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},function(t,e,r){"use strict";r(159);var i=r(15),o=r(14),n=r(4),a=r(26),s=r(7),l=r(93),c=s("species"),h=!n((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),u=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return 2===r.length&&"a"===r[0]&&"b"===r[1]}();t.exports=function(t,e,r){var d=s(t),p=!n((function(){var e={};return e[d]=function(){return 7},7!=""[t](e)})),f=p?!n((function(){var e=!1,r=/a/;return r.exec=function(){return e=!0,null},"split"===t&&(r.constructor={},r.constructor[c]=function(){return r}),r[d](""),!e})):void 0;if(!p||!f||"replace"===t&&!h||"split"===t&&!u){var g=/./[d],m=r(a,d,""[t],(function(t,e,r,i,o){return e.exec===l?p&&!o?{done:!0,value:g.call(e,r,i)}:{done:!0,value:t.call(r,e,i)}:{done:!1}})),y=m[0],v=m[1];i(String.prototype,t,y),o(RegExp.prototype,d,2==e?function(t,e){return v.call(t,this,e)}:function(t){return v.call(t,this)})}}},function(t,e,r){var i=r(2),o=r(11),n=r(7)("species");t.exports=function(t,e){var r,a=i(t).constructor;return void 0===a||null==(r=i(a)[n])?e:o(r)}},function(t,e,r){"use strict";var i=r(3),o=r(0),n=r(15),a=r(44),s=r(32),l=r(43),c=r(42),h=r(5),u=r(4),d=r(62),p=r(49),f=r(82);t.exports=function(t,e,r,g,m,y){var v=i[t],_=v,E=m?"set":"add",T=_&&_.prototype,b={},S=function(t){var e=T[t];n(T,t,"delete"==t||"has"==t?function(t){return!(y&&!h(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return y&&!h(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,r){return e.call(this,0===t?0:t,r),this})};if("function"==typeof _&&(y||T.forEach&&!u((function(){(new _).entries().next()})))){var x=new _,w=x[E](y?{}:-0,1)!=x,O=u((function(){x.has(1)})),I=d((function(t){new _(t)})),A=!y&&u((function(){for(var t=new _,e=5;e--;)t[E](e,e);return!t.has(-0)}));I||((_=e((function(e,r){c(e,_,t);var i=f(new v,e,_);return null!=r&&l(r,m,i[E],i),i}))).prototype=T,T.constructor=_),(O||A)&&(S("delete"),S("has"),m&&S("get")),(A||w)&&S(E),y&&T.clear&&delete T.clear}else _=g.getConstructor(e,t,m,E),a(_.prototype,r),s.NEED=!0;return p(_,t),b[t]=_,o(o.G+o.W+o.F*(_!=v),b),y||g.setStrong(_,t,m),_}},function(t,e,r){for(var i,o=r(3),n=r(14),a=r(37),s=a("typed_array"),l=a("view"),c=!(!o.ArrayBuffer||!o.DataView),h=c,u=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");u<9;)(i=o[d[u++]])?(n(i.prototype,s,!0),n(i.prototype,l,!0)):h=!1;t.exports={ABV:c,CONSTR:h,TYPED:s,VIEW:l}},function(t,e,r){"use strict";t.exports=r(31)||!r(4)((function(){var t=Math.random();__defineSetter__.call(null,t,(function(){})),delete r(3)[t]}))},function(t,e,r){"use strict";var i=r(0);t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,r){"use strict";var i=r(0),o=r(11),n=r(21),a=r(43);t.exports=function(t){i(i.S,t,{from:function(t){var e,r,i,s,l=arguments[1];return o(this),(e=void 0!==l)&&o(l),null==t?new this:(r=[],e?(i=0,s=n(l,arguments[2],2),a(t,!1,(function(t){r.push(s(t,i++))}))):a(t,!1,r.push,r),new this(r))}})}},function(t,e){function r(){return t.exports=r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},t.exports.__esModule=!0,t.exports.default=t.exports,r.apply(this,arguments)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var i;(function(){var r=function(t){return t instanceof r?t:this instanceof r?void(this.EXIFwrapped=t):new r(t)};t.exports&&(e=t.exports=r),e.EXIF=r;var o=r.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},a=r.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},s=r.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},l=r.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},c=r.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function h(t){return!!t.exifdata}function u(t,e){function i(i){var o=d(i);t.exifdata=o||{};var n=function(t){var e=new DataView(t);if(255!=e.getUint8(0)||216!=e.getUint8(1))return!1;for(var r=2,i=t.byteLength,o=function(t,e){return 56===t.getUint8(e)&&66===t.getUint8(e+1)&&73===t.getUint8(e+2)&&77===t.getUint8(e+3)&&4===t.getUint8(e+4)&&4===t.getUint8(e+5)};r<i;){if(o(e,r)){var n=e.getUint8(r+7);return n%2!=0&&(n+=1),0===n&&(n=4),f(t,r+8+n,e.getUint16(r+6+n))}r++}}(i);if(t.iptcdata=n||{},r.isXmpEnabled){var a=function(t){if("DOMParser"in self){var e=new DataView(t);if(255!=e.getUint8(0)||216!=e.getUint8(1))return!1;for(var r=2,i=t.byteLength,o=new DOMParser;r<i-4;){if("http"==y(e,r,4)){var n=r-1,a=e.getUint16(r-2)-1,s=y(e,n,a),l=s.indexOf("xmpmeta>")+8,c=(s=s.substring(s.indexOf("<x:xmpmeta"),l)).indexOf("x:xmpmeta")+10;return s=s.slice(0,c)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+s.slice(c),E(o.parseFromString(s,"text/xml"))}r++}}}(i);t.xmpdata=a||{}}e&&e.call(t)}if(t.src)if(/^data\:/i.test(t.src))i(function(t,e){e=e||t.match(/^data\:([^\;]+)\;base64,/im)[1]||"",t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var r=atob(t),i=r.length,o=new ArrayBuffer(i),n=new Uint8Array(o),a=0;a<i;a++)n[a]=r.charCodeAt(a);return o}(t.src));else if(/^blob\:/i.test(t.src))(n=new FileReader).onload=function(t){i(t.target.result)},function(t,e){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="blob",r.onload=function(t){200!=this.status&&0!==this.status||function(t){n.readAsArrayBuffer(t)}(this.response)},r.send()}(t.src);else{var o=new XMLHttpRequest;o.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";i(o.response),o=null},o.open("GET",t.src,!0),o.responseType="arraybuffer",o.send(null)}else if(self.FileReader&&(t instanceof self.Blob||t instanceof self.File)){var n;(n=new FileReader).onload=function(t){i(t.target.result)},n.readAsArrayBuffer(t)}}function d(t){var e=new DataView(t);if(255!=e.getUint8(0)||216!=e.getUint8(1))return!1;for(var r=2,i=t.byteLength;r<i;){if(255!=e.getUint8(r))return!1;if(225==e.getUint8(r+1))return v(e,r+4,e.getUint16(r+2));r+=2+e.getUint16(r+2)}}var p={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function f(t,e,r){for(var i,o,n,a,s=new DataView(t),l={},c=e;c<e+r;)28===s.getUint8(c)&&2===s.getUint8(c+1)&&(a=s.getUint8(c+2))in p&&(n=s.getInt16(c+3),o=p[a],i=y(s,c+5,n),l.hasOwnProperty(o)?l[o]instanceof Array?l[o].push(i):l[o]=[l[o],i]:l[o]=i),c++;return l}function g(t,e,r,i,o){var n,a,s=t.getUint16(r,!o),l={};for(a=0;a<s;a++)n=r+12*a+2,l[i[t.getUint16(n,!o)]]=m(t,n,e,r,o);return l}function m(t,e,r,i,o){var n,a,s,l,c,h,u=t.getUint16(e+2,!o),d=t.getUint32(e+4,!o),p=t.getUint32(e+8,!o)+r;switch(u){case 1:case 7:if(1==d)return t.getUint8(e+8,!o);for(n=d>4?p:e+8,a=[],l=0;l<d;l++)a[l]=t.getUint8(n+l);return a;case 2:return y(t,n=d>4?p:e+8,d-1);case 3:if(1==d)return t.getUint16(e+8,!o);for(n=d>2?p:e+8,a=[],l=0;l<d;l++)a[l]=t.getUint16(n+2*l,!o);return a;case 4:if(1==d)return t.getUint32(e+8,!o);for(a=[],l=0;l<d;l++)a[l]=t.getUint32(p+4*l,!o);return a;case 5:if(1==d)return c=t.getUint32(p,!o),h=t.getUint32(p+4,!o),(s=new Number(c/h)).numerator=c,s.denominator=h,s;for(a=[],l=0;l<d;l++)c=t.getUint32(p+8*l,!o),h=t.getUint32(p+4+8*l,!o),a[l]=new Number(c/h),a[l].numerator=c,a[l].denominator=h;return a;case 9:if(1==d)return t.getInt32(e+8,!o);for(a=[],l=0;l<d;l++)a[l]=t.getInt32(p+4*l,!o);return a;case 10:if(1==d)return t.getInt32(p,!o)/t.getInt32(p+4,!o);for(a=[],l=0;l<d;l++)a[l]=t.getInt32(p+8*l,!o)/t.getInt32(p+4+8*l,!o);return a}}function y(t,e,r){var i="";for(n=e;n<e+r;n++)i+=String.fromCharCode(t.getUint8(n));return i}function v(t,e){if("Exif"!=y(t,e,4))return!1;var r,i,n,h,u,d=e+6;if(18761==t.getUint16(d))r=!1;else{if(19789!=t.getUint16(d))return!1;r=!0}if(42!=t.getUint16(d+2,!r))return!1;var p=t.getUint32(d+4,!r);if(p<8)return!1;if((i=g(t,d,d+p,a,r)).ExifIFDPointer)for(n in h=g(t,d,d+i.ExifIFDPointer,o,r)){switch(n){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":h[n]=c[n][h[n]];break;case"ExifVersion":case"FlashpixVersion":h[n]=String.fromCharCode(h[n][0],h[n][1],h[n][2],h[n][3]);break;case"ComponentsConfiguration":h[n]=c.Components[h[n][0]]+c.Components[h[n][1]]+c.Components[h[n][2]]+c.Components[h[n][3]]}i[n]=h[n]}if(i.GPSInfoIFDPointer)for(n in u=g(t,d,d+i.GPSInfoIFDPointer,s,r)){switch(n){case"GPSVersionID":u[n]=u[n][0]+"."+u[n][1]+"."+u[n][2]+"."+u[n][3]}i[n]=u[n]}return i.thumbnail=function(t,e,r,i){var o=function(t,e,r){var i=t.getUint16(e,!r);return t.getUint32(e+2+12*i,!r)}(t,e+r,i);if(!o)return{};if(o>t.byteLength)return{};var n=g(t,e,e+o,l,i);if(n.Compression)switch(n.Compression){case 6:if(n.JpegIFOffset&&n.JpegIFByteCount){var a=e+n.JpegIFOffset,s=n.JpegIFByteCount;n.blob=new Blob([new Uint8Array(t.buffer,a,s)],{type:"image/jpeg"})}}else n.PhotometricInterpretation;return n}(t,d,p,r),i}function _(t){var e={};if(1==t.nodeType){if(t.attributes.length>0){e["@attributes"]={};for(var r=0;r<t.attributes.length;r++){var i=t.attributes.item(r);e["@attributes"][i.nodeName]=i.nodeValue}}}else if(3==t.nodeType)return t.nodeValue;if(t.hasChildNodes())for(var o=0;o<t.childNodes.length;o++){var n=t.childNodes.item(o),a=n.nodeName;if(null==e[a])e[a]=_(n);else{if(null==e[a].push){var s=e[a];e[a]=[],e[a].push(s)}e[a].push(_(n))}}return e}function E(t){try{var e={};if(t.children.length>0)for(var r=0;r<t.children.length;r++){var i=t.children.item(r),o=i.attributes;for(var n in o){var a=o[n],s=a.nodeName,l=a.nodeValue;void 0!==s&&(e[s]=l)}var c=i.nodeName;if(void 0===e[c])e[c]=_(i);else{if(void 0===e[c].push){var h=e[c];e[c]=[],e[c].push(h)}e[c].push(_(i))}}else e=t.textContent;return e}catch(t){}}r.enableXmp=function(){r.isXmpEnabled=!0},r.disableXmp=function(){r.isXmpEnabled=!1},r.getData=function(t,e){return!((self.Image&&t instanceof self.Image||self.HTMLImageElement&&t instanceof self.HTMLImageElement)&&!t.complete||(h(t)?e&&e.call(t):u(t,e),0))},r.getTag=function(t,e){if(h(t))return t.exifdata[e]},r.getIptcTag=function(t,e){if(h(t))return t.iptcdata[e]},r.getAllTags=function(t){if(!h(t))return{};var e,r=t.exifdata,i={};for(e in r)r.hasOwnProperty(e)&&(i[e]=r[e]);return i},r.getAllIptcTags=function(t){if(!h(t))return{};var e,r=t.iptcdata,i={};for(e in r)r.hasOwnProperty(e)&&(i[e]=r[e]);return i},r.pretty=function(t){if(!h(t))return"";var e,r=t.exifdata,i="";for(e in r)r.hasOwnProperty(e)&&("object"==typeof r[e]?r[e]instanceof Number?i+=e+" : "+r[e]+" ["+r[e].numerator+"/"+r[e].denominator+"]\r\n":i+=e+" : ["+r[e].length+" values]\r\n":i+=e+" : "+r[e]+"\r\n");return i},r.readFromBinaryFile=function(t){return d(t)},void 0===(i=function(){return r}.apply(e,[]))||(t.exports=i)}).call(this)},function(t,e,r){var i=r(5),o=r(3).document,n=i(o)&&i(o.createElement);t.exports=function(t){return n?o.createElement(t):{}}},function(t,e,r){var i=r(52)("keys"),o=r(37);t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,r){var i=r(3).document;t.exports=i&&i.documentElement},function(t,e,r){var i=r(185);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,r){"use strict";var i=r(23),o=r(26);t.exports=function(t){var e=String(o(this)),r="",n=i(t);if(n<0||n==1/0)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(r+=e);return r}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,r){var i=r(3),o=r(20),n=r(31),a=r(149),s=r(9).f;t.exports=function(t){var e=o.Symbol||(o.Symbol=n?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,r){var i=r(5),o=r(2),n=function(t,e){if(o(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=r(21)(Function.call,r(18).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,r){return n(t,r),e?t.__proto__=r:i(t,r),t}}({},!1):void 0),check:n}},function(t,e,r){var i=r(5),o=r(81).set;t.exports=function(t,e,r){var n,a=e.constructor;return a!==r&&"function"==typeof a&&(n=a.prototype)!==r.prototype&&i(n)&&o&&o(t,n),t}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,e,r){"use strict";var i=r(31),o=r(0),n=r(15),a=r(14),s=r(56),l=r(86),c=r(49),h=r(19),u=r(7)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,r,f,g,m,y){l(r,e,f);var v,_,E,T=function(t){if(!d&&t in w)return w[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},b=e+" Iterator",S="values"==g,x=!1,w=t.prototype,O=w[u]||w["@@iterator"]||g&&w[g],I=O||T(g),A=g?S?T("entries"):I:void 0,D="Array"==e&&w.entries||O;if(D&&(E=h(D.call(new t)))!==Object.prototype&&E.next&&(c(E,b,!0),i||"function"==typeof E[u]||a(E,u,p)),S&&O&&"values"!==O.name&&(x=!0,I=function(){return O.call(this)}),i&&!y||!d&&!x&&w[u]||a(w,u,I),s[e]=I,s[b]=p,g)if(v={values:S?I:T("values"),keys:m?I:T("keys"),entries:A},y)for(_ in v)_ in w||n(w,_,v[_]);else o(o.P+o.F*(d||x),e,v);return v}},function(t,e,r){"use strict";var i=r(38),o=r(36),n=r(49),a={};r(14)(a,r(7)("iterator"),(function(){return this})),t.exports=function(t,e,r){t.prototype=i(a,{next:o(1,r)}),n(t,e+" Iterator")}},function(t,e,r){var i=r(61),o=r(26);t.exports=function(t,e,r){if(i(e))throw TypeError("String#"+r+" doesn't accept regex!");return String(o(t))}},function(t,e,r){var i=r(7)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[i]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,r){var i=r(56),o=r(7)("iterator"),n=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||n[o]===t)}},function(t,e,r){"use strict";var i=r(9),o=r(36);t.exports=function(t,e,r){e in t?i.f(t,e,o(0,r)):t[e]=r}},function(t,e,r){var i=r(50),o=r(7)("iterator"),n=r(56);t.exports=r(20).getIteratorMethod=function(t){if(null!=t)return t[o]||t["@@iterator"]||n[i(t)]}},function(t,e,r){"use strict";var i=r(10),o=r(39),n=r(6);t.exports=function(t){for(var e=i(this),r=n(e.length),a=arguments.length,s=o(a>1?arguments[1]:void 0,r),l=a>2?arguments[2]:void 0,c=void 0===l?r:o(l,r);c>s;)e[s++]=t;return e}},function(t,e,r){"use strict";var i,o,n=r(55),a=RegExp.prototype.exec,s=String.prototype.replace,l=a,c=(i=/a/,o=/b*/g,a.call(i,"a"),a.call(o,"a"),0!==i.lastIndex||0!==o.lastIndex),h=void 0!==/()??/.exec("")[1];(c||h)&&(l=function(t){var e,r,i,o,l=this;return h&&(r=new RegExp("^"+l.source+"$(?!\\s)",n.call(l))),c&&(e=l.lastIndex),i=a.call(l,t),c&&i&&(l.lastIndex=l.global?i.index+i[0].length:e),h&&i&&i.length>1&&s.call(i[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i}),t.exports=l},function(t,e,r){"use strict";var i=r(60)(!0);t.exports=function(t,e,r){return e+(r?i(t,e).length:1)}},function(t,e,r){var i=r(3),o=r(160).set,n=i.MutationObserver||i.WebKitMutationObserver,a=i.process,s=i.Promise,l="process"==r(22)(a);t.exports=function(){var t,e,r,c=function(){var i,o;for(l&&(i=a.domain)&&i.exit();t;){o=t.fn,t=t.next;try{o()}catch(i){throw t?r():e=void 0,i}}e=void 0,i&&i.enter()};if(l)r=function(){a.nextTick(c)};else if(!n||i.navigator&&i.navigator.standalone)if(s&&s.resolve){var h=s.resolve(void 0);r=function(){h.then(c)}}else r=function(){o.call(i,c)};else{var u=!0,d=document.createTextNode("");new n(c).observe(d,{characterData:!0}),r=function(){d.data=u=!u}}return function(i){var o={fn:i,next:void 0};e&&(e.next=o),t||(t=o,r()),e=o}}},function(t,e,r){"use strict";var i=r(11);t.exports.f=function(t){return new function(t){var e,r;this.promise=new t((function(t,i){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=i})),this.resolve=i(e),this.reject=i(r)}(t)}},function(t,e,r){var i=r(3).navigator;t.exports=i&&i.userAgent||""},function(t,e,r){"use strict";var i=r(3),o=r(8),n=r(31),a=r(67),s=r(14),l=r(44),c=r(4),h=r(42),u=r(23),d=r(6),p=r(167),f=r(40).f,g=r(9).f,m=r(92),y=r(49),v="prototype",_="Wrong index!",E=i.ArrayBuffer,T=i.DataView,b=i.Math,S=i.RangeError,x=i.Infinity,w=E,O=b.abs,I=b.pow,A=b.floor,D=b.log,C=b.LN2,P=o?"_b":"buffer",L=o?"_l":"byteLength",M=o?"_o":"byteOffset";function R(t,e,r){var i,o,n,a=new Array(r),s=8*r-e-1,l=(1<<s)-1,c=l>>1,h=23===e?I(2,-24)-I(2,-77):0,u=0,d=t<0||0===t&&1/t<0?1:0;for((t=O(t))!=t||t===x?(o=t!=t?1:0,i=l):(i=A(D(t)/C),t*(n=I(2,-i))<1&&(i--,n*=2),(t+=i+c>=1?h/n:h*I(2,1-c))*n>=2&&(i++,n/=2),i+c>=l?(o=0,i=l):i+c>=1?(o=(t*n-1)*I(2,e),i+=c):(o=t*I(2,c-1)*I(2,e),i=0));e>=8;a[u++]=255&o,o/=256,e-=8);for(i=i<<e|o,s+=e;s>0;a[u++]=255&i,i/=256,s-=8);return a[--u]|=128*d,a}function N(t,e,r){var i,o=8*r-e-1,n=(1<<o)-1,a=n>>1,s=o-7,l=r-1,c=t[l--],h=127&c;for(c>>=7;s>0;h=256*h+t[l],l--,s-=8);for(i=h&(1<<-s)-1,h>>=-s,s+=e;s>0;i=256*i+t[l],l--,s-=8);if(0===h)h=1-a;else{if(h===n)return i?NaN:c?-x:x;i+=I(2,e),h-=a}return(c?-1:1)*i*I(2,h-e)}function B(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function k(t){return[255&t]}function F(t){return[255&t,t>>8&255]}function U(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function H(t){return R(t,52,8)}function G(t){return R(t,23,4)}function q(t,e,r){g(t[v],e,{get:function(){return this[r]}})}function W(t,e,r,i){var o=p(+r);if(o+e>t[L])throw S(_);var n=t[P]._b,a=o+t[M],s=n.slice(a,a+e);return i?s:s.reverse()}function Y(t,e,r,i,o,n){var a=p(+r);if(a+e>t[L])throw S(_);for(var s=t[P]._b,l=a+t[M],c=i(+o),h=0;h<e;h++)s[l+h]=c[n?h:e-h-1]}if(a.ABV){if(!c((function(){E(1)}))||!c((function(){new E(-1)}))||c((function(){return new E,new E(1.5),new E(NaN),"ArrayBuffer"!=E.name}))){for(var z,j=(E=function(t){return h(this,E),new w(p(t))})[v]=w[v],V=f(w),X=0;V.length>X;)(z=V[X++])in E||s(E,z,w[z]);n||(j.constructor=E)}var J=new T(new E(2)),K=T[v].setInt8;J.setInt8(0,2147483648),J.setInt8(1,2147483649),!J.getInt8(0)&&J.getInt8(1)||l(T[v],{setInt8:function(t,e){K.call(this,t,e<<24>>24)},setUint8:function(t,e){K.call(this,t,e<<24>>24)}},!0)}else E=function(t){h(this,E,"ArrayBuffer");var e=p(t);this._b=m.call(new Array(e),0),this[L]=e},T=function(t,e,r){h(this,T,"DataView"),h(t,E,"DataView");var i=t[L],o=u(e);if(o<0||o>i)throw S("Wrong offset!");if(o+(r=void 0===r?i-o:d(r))>i)throw S("Wrong length!");this[P]=t,this[M]=o,this[L]=r},o&&(q(E,"byteLength","_l"),q(T,"buffer","_b"),q(T,"byteLength","_l"),q(T,"byteOffset","_o")),l(T[v],{getInt8:function(t){return W(this,1,t)[0]<<24>>24},getUint8:function(t){return W(this,1,t)[0]},getInt16:function(t){var e=W(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=W(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return B(W(this,4,t,arguments[1]))},getUint32:function(t){return B(W(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return N(W(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return N(W(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){Y(this,1,t,k,e)},setUint8:function(t,e){Y(this,1,t,k,e)},setInt16:function(t,e){Y(this,2,t,F,e,arguments[2])},setUint16:function(t,e){Y(this,2,t,F,e,arguments[2])},setInt32:function(t,e){Y(this,4,t,U,e,arguments[2])},setUint32:function(t,e){Y(this,4,t,U,e,arguments[2])},setFloat32:function(t,e){Y(this,4,t,G,e,arguments[2])},setFloat64:function(t,e){Y(this,8,t,H,e,arguments[2])}});y(E,"ArrayBuffer"),y(T,"DataView"),s(T[v],a.VIEW,!0),e.ArrayBuffer=E,e.DataView=T},function(t,e,r){var i,o=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function o(t,e){if(!i[t]){i[t]={};for(var r=0;r<t.length;r++)i[t][t.charAt(r)]=r}return i[t][e]}var n={compressToBase64:function(t){if(null==t)return"";var r=n._compress(t,6,(function(t){return e.charAt(t)}));switch(r.length%4){default:case 0:return r;case 1:return r+"===";case 2:return r+"==";case 3:return r+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:n._decompress(t.length,32,(function(r){return o(e,t.charAt(r))}))},compressToUTF16:function(e){return null==e?"":n._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:n._decompress(t.length,16384,(function(e){return t.charCodeAt(e)-32}))},compressToUint8Array:function(t){for(var e=n.compress(t),r=new Uint8Array(2*e.length),i=0,o=e.length;i<o;i++){var a=e.charCodeAt(i);r[2*i]=a>>>8,r[2*i+1]=a%256}return r},decompressFromUint8Array:function(e){if(null==e)return n.decompress(e);for(var r=new Array(e.length/2),i=0,o=r.length;i<o;i++)r[i]=256*e[2*i]+e[2*i+1];var a=[];return r.forEach((function(e){a.push(t(e))})),n.decompress(a.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":n._compress(t,6,(function(t){return r.charAt(t)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),n._decompress(t.length,32,(function(e){return o(r,t.charAt(e))})))},compress:function(e){return n._compress(e,16,(function(e){return t(e)}))},_compress:function(t,e,r){if(null==t)return"";var i,o,n,a={},s={},l="",c="",h="",u=2,d=3,p=2,f=[],g=0,m=0;for(n=0;n<t.length;n+=1)if(l=t.charAt(n),Object.prototype.hasOwnProperty.call(a,l)||(a[l]=d++,s[l]=!0),c=h+l,Object.prototype.hasOwnProperty.call(a,c))h=c;else{if(Object.prototype.hasOwnProperty.call(s,h)){if(h.charCodeAt(0)<256){for(i=0;i<p;i++)g<<=1,m==e-1?(m=0,f.push(r(g)),g=0):m++;for(o=h.charCodeAt(0),i=0;i<8;i++)g=g<<1|1&o,m==e-1?(m=0,f.push(r(g)),g=0):m++,o>>=1}else{for(o=1,i=0;i<p;i++)g=g<<1|o,m==e-1?(m=0,f.push(r(g)),g=0):m++,o=0;for(o=h.charCodeAt(0),i=0;i<16;i++)g=g<<1|1&o,m==e-1?(m=0,f.push(r(g)),g=0):m++,o>>=1}0==--u&&(u=Math.pow(2,p),p++),delete s[h]}else for(o=a[h],i=0;i<p;i++)g=g<<1|1&o,m==e-1?(m=0,f.push(r(g)),g=0):m++,o>>=1;0==--u&&(u=Math.pow(2,p),p++),a[c]=d++,h=String(l)}if(""!==h){if(Object.prototype.hasOwnProperty.call(s,h)){if(h.charCodeAt(0)<256){for(i=0;i<p;i++)g<<=1,m==e-1?(m=0,f.push(r(g)),g=0):m++;for(o=h.charCodeAt(0),i=0;i<8;i++)g=g<<1|1&o,m==e-1?(m=0,f.push(r(g)),g=0):m++,o>>=1}else{for(o=1,i=0;i<p;i++)g=g<<1|o,m==e-1?(m=0,f.push(r(g)),g=0):m++,o=0;for(o=h.charCodeAt(0),i=0;i<16;i++)g=g<<1|1&o,m==e-1?(m=0,f.push(r(g)),g=0):m++,o>>=1}0==--u&&(u=Math.pow(2,p),p++),delete s[h]}else for(o=a[h],i=0;i<p;i++)g=g<<1|1&o,m==e-1?(m=0,f.push(r(g)),g=0):m++,o>>=1;0==--u&&(u=Math.pow(2,p),p++)}for(o=2,i=0;i<p;i++)g=g<<1|1&o,m==e-1?(m=0,f.push(r(g)),g=0):m++,o>>=1;for(;;){if(g<<=1,m==e-1){f.push(r(g));break}m++}return f.join("")},decompress:function(t){return null==t?"":""==t?null:n._decompress(t.length,32768,(function(e){return t.charCodeAt(e)}))},_decompress:function(e,r,i){var o,n,a,s,l,c,h,u=[],d=4,p=4,f=3,g="",m=[],y={val:i(0),position:r,index:1};for(o=0;o<3;o+=1)u[o]=o;for(a=0,l=Math.pow(2,2),c=1;c!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),a|=(s>0?1:0)*c,c<<=1;switch(a){case 0:for(a=0,l=Math.pow(2,8),c=1;c!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),a|=(s>0?1:0)*c,c<<=1;h=t(a);break;case 1:for(a=0,l=Math.pow(2,16),c=1;c!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),a|=(s>0?1:0)*c,c<<=1;h=t(a);break;case 2:return""}for(u[3]=h,n=h,m.push(h);;){if(y.index>e)return"";for(a=0,l=Math.pow(2,f),c=1;c!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),a|=(s>0?1:0)*c,c<<=1;switch(h=a){case 0:for(a=0,l=Math.pow(2,8),c=1;c!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),a|=(s>0?1:0)*c,c<<=1;u[p++]=t(a),h=p-1,d--;break;case 1:for(a=0,l=Math.pow(2,16),c=1;c!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),a|=(s>0?1:0)*c,c<<=1;u[p++]=t(a),h=p-1,d--;break;case 2:return m.join("")}if(0==d&&(d=Math.pow(2,f),f++),u[h])g=u[h];else{if(h!==p)return null;g=n+n.charAt(0)}m.push(g),u[p++]=n+g.charAt(0),n=g,0==--d&&(d=Math.pow(2,f),f++)}}};return n}();void 0===(i=function(){return o}.call(e,r,e,t))||(t.exports=i)},function(t,e,r){var i;!function(o){"use strict";var n,a,s,l=9e15,c=1e9,h="0123456789abcdef",u="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",d="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",p={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-l,maxE:l,crypto:!1},f=!0,g="[DecimalError] ",m=g+"Invalid argument: ",y=g+"Precision limit exceeded",v=g+"crypto unavailable",_="[object Decimal]",E=Math.floor,T=Math.pow,b=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,S=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,x=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,w=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,O=1e7,I=u.length-1,A=d.length-1,D={toStringTag:_};function C(t){var e,r,i,o=t.length-1,n="",a=t[0];if(o>0){for(n+=a,e=1;e<o;e++)(r=7-(i=t[e]+"").length)&&(n+=G(r)),n+=i;(r=7-(i=(a=t[e])+"").length)&&(n+=G(r))}else if(0===a)return"0";for(;a%10==0;)a/=10;return n+a}function P(t,e,r){if(t!==~~t||t<e||t>r)throw Error(m+t)}function L(t,e,r,i){var o,n,a,s;for(n=t[0];n>=10;n/=10)--e;return--e<0?(e+=7,o=0):(o=Math.ceil((e+1)/7),e%=7),n=T(10,7-e),s=t[o]%n|0,null==i?e<3?(0==e?s=s/100|0:1==e&&(s=s/10|0),a=r<4&&99999==s||r>3&&49999==s||5e4==s||0==s):a=(r<4&&s+1==n||r>3&&s+1==n/2)&&(t[o+1]/n/100|0)==T(10,e-2)-1||(s==n/2||0==s)&&0==(t[o+1]/n/100|0):e<4?(0==e?s=s/1e3|0:1==e?s=s/100|0:2==e&&(s=s/10|0),a=(i||r<4)&&9999==s||!i&&r>3&&4999==s):a=((i||r<4)&&s+1==n||!i&&r>3&&s+1==n/2)&&(t[o+1]/n/1e3|0)==T(10,e-3)-1,a}function M(t,e,r){for(var i,o,n=[0],a=0,s=t.length;a<s;){for(o=n.length;o--;)n[o]*=e;for(n[0]+=h.indexOf(t.charAt(a++)),i=0;i<n.length;i++)n[i]>r-1&&(void 0===n[i+1]&&(n[i+1]=0),n[i+1]+=n[i]/r|0,n[i]%=r)}return n.reverse()}D.absoluteValue=D.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),N(t)},D.ceil=function(){return N(new this.constructor(this),this.e+1,2)},D.clampedTo=D.clamp=function(t,e){var r=this,i=r.constructor;if(t=new i(t),e=new i(e),!t.s||!e.s)return new i(NaN);if(t.gt(e))throw Error(m+e);return r.cmp(t)<0?t:r.cmp(e)>0?e:new i(r)},D.comparedTo=D.cmp=function(t){var e,r,i,o,n=this,a=n.d,s=(t=new n.constructor(t)).d,l=n.s,c=t.s;if(!a||!s)return l&&c?l!==c?l:a===s?0:!a^l<0?1:-1:NaN;if(!a[0]||!s[0])return a[0]?l:s[0]?-c:0;if(l!==c)return l;if(n.e!==t.e)return n.e>t.e^l<0?1:-1;for(e=0,r=(i=a.length)<(o=s.length)?i:o;e<r;++e)if(a[e]!==s[e])return a[e]>s[e]^l<0?1:-1;return i===o?0:i>o^l<0?1:-1},D.cosine=D.cos=function(){var t,e,r=this,i=r.constructor;return r.d?r.d[0]?(t=i.precision,e=i.rounding,i.precision=t+Math.max(r.e,r.sd())+7,i.rounding=1,r=function(t,e){var r,i,o;if(e.isZero())return e;(i=e.d.length)<32?o=(1/Z(4,r=Math.ceil(i/3))).toString():(r=16,o="2.3283064365386962890625e-10"),t.precision+=r,e=K(t,1,e.times(o),new t(1));for(var n=r;n--;){var a=e.times(e);e=a.times(a).minus(a).times(8).plus(1)}return t.precision-=r,e}(i,Q(i,r)),i.precision=t,i.rounding=e,N(2==s||3==s?r.neg():r,t,e,!0)):new i(1):new i(NaN)},D.cubeRoot=D.cbrt=function(){var t,e,r,i,o,n,a,s,l,c,h=this,u=h.constructor;if(!h.isFinite()||h.isZero())return new u(h);for(f=!1,(n=h.s*T(h.s*h,1/3))&&Math.abs(n)!=1/0?i=new u(n.toString()):(r=C(h.d),(n=((t=h.e)-r.length+1)%3)&&(r+=1==n||-2==n?"0":"00"),n=T(r,1/3),t=E((t+1)/3)-(t%3==(t<0?-1:2)),(i=new u(r=n==1/0?"5e"+t:(r=n.toExponential()).slice(0,r.indexOf("e")+1)+t)).s=h.s),a=(t=u.precision)+3;;)if(c=(l=(s=i).times(s).times(s)).plus(h),i=R(c.plus(h).times(s),c.plus(l),a+2,1),C(s.d).slice(0,a)===(r=C(i.d)).slice(0,a)){if("9999"!=(r=r.slice(a-3,a+1))&&(o||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(N(i,t+1,1),e=!i.times(i).times(i).eq(h));break}if(!o&&(N(s,t+1,0),s.times(s).times(s).eq(h))){i=s;break}a+=4,o=1}return f=!0,N(i,t,u.rounding,e)},D.decimalPlaces=D.dp=function(){var t,e=this.d,r=NaN;if(e){if(r=7*((t=e.length-1)-E(this.e/7)),t=e[t])for(;t%10==0;t/=10)r--;r<0&&(r=0)}return r},D.dividedBy=D.div=function(t){return R(this,new this.constructor(t))},D.dividedToIntegerBy=D.divToInt=function(t){var e=this.constructor;return N(R(this,new e(t),0,1,1),e.precision,e.rounding)},D.equals=D.eq=function(t){return 0===this.cmp(t)},D.floor=function(){return N(new this.constructor(this),this.e+1,3)},D.greaterThan=D.gt=function(t){return this.cmp(t)>0},D.greaterThanOrEqualTo=D.gte=function(t){var e=this.cmp(t);return 1==e||0===e},D.hyperbolicCosine=D.cosh=function(){var t,e,r,i,o,n=this,a=n.constructor,s=new a(1);if(!n.isFinite())return new a(n.s?1/0:NaN);if(n.isZero())return s;r=a.precision,i=a.rounding,a.precision=r+Math.max(n.e,n.sd())+4,a.rounding=1,(o=n.d.length)<32?e=(1/Z(4,t=Math.ceil(o/3))).toString():(t=16,e="2.3283064365386962890625e-10"),n=K(a,1,n.times(e),new a(1),!0);for(var l,c=t,h=new a(8);c--;)l=n.times(n),n=s.minus(l.times(h.minus(l.times(h))));return N(n,a.precision=r,a.rounding=i,!0)},D.hyperbolicSine=D.sinh=function(){var t,e,r,i,o=this,n=o.constructor;if(!o.isFinite()||o.isZero())return new n(o);if(e=n.precision,r=n.rounding,n.precision=e+Math.max(o.e,o.sd())+4,n.rounding=1,(i=o.d.length)<3)o=K(n,2,o,o,!0);else{t=(t=1.4*Math.sqrt(i))>16?16:0|t,o=K(n,2,o=o.times(1/Z(5,t)),o,!0);for(var a,s=new n(5),l=new n(16),c=new n(20);t--;)a=o.times(o),o=o.times(s.plus(a.times(l.times(a).plus(c))))}return n.precision=e,n.rounding=r,N(o,e,r,!0)},D.hyperbolicTangent=D.tanh=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+7,i.rounding=1,R(r.sinh(),r.cosh(),i.precision=t,i.rounding=e)):new i(r.s)},D.inverseCosine=D.acos=function(){var t,e=this,r=e.constructor,i=e.abs().cmp(1),o=r.precision,n=r.rounding;return-1!==i?0===i?e.isNeg()?U(r,o,n):new r(0):new r(NaN):e.isZero()?U(r,o+4,n).times(.5):(r.precision=o+6,r.rounding=1,e=e.asin(),t=U(r,o+4,n).times(.5),r.precision=o,r.rounding=n,t.minus(e))},D.inverseHyperbolicCosine=D.acosh=function(){var t,e,r=this,i=r.constructor;return r.lte(1)?new i(r.eq(1)?0:NaN):r.isFinite()?(t=i.precision,e=i.rounding,i.precision=t+Math.max(Math.abs(r.e),r.sd())+4,i.rounding=1,f=!1,r=r.times(r).minus(1).sqrt().plus(r),f=!0,i.precision=t,i.rounding=e,r.ln()):new i(r)},D.inverseHyperbolicSine=D.asinh=function(){var t,e,r=this,i=r.constructor;return!r.isFinite()||r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+2*Math.max(Math.abs(r.e),r.sd())+6,i.rounding=1,f=!1,r=r.times(r).plus(1).sqrt().plus(r),f=!0,i.precision=t,i.rounding=e,r.ln())},D.inverseHyperbolicTangent=D.atanh=function(){var t,e,r,i,o=this,n=o.constructor;return o.isFinite()?o.e>=0?new n(o.abs().eq(1)?o.s/0:o.isZero()?o:NaN):(t=n.precision,e=n.rounding,i=o.sd(),Math.max(i,t)<2*-o.e-1?N(new n(o),t,e,!0):(n.precision=r=i-o.e,o=R(o.plus(1),new n(1).minus(o),r+t,1),n.precision=t+4,n.rounding=1,o=o.ln(),n.precision=t,n.rounding=e,o.times(.5))):new n(NaN)},D.inverseSine=D.asin=function(){var t,e,r,i,o=this,n=o.constructor;return o.isZero()?new n(o):(e=o.abs().cmp(1),r=n.precision,i=n.rounding,-1!==e?0===e?((t=U(n,r+4,i).times(.5)).s=o.s,t):new n(NaN):(n.precision=r+6,n.rounding=1,o=o.div(new n(1).minus(o.times(o)).sqrt().plus(1)).atan(),n.precision=r,n.rounding=i,o.times(2)))},D.inverseTangent=D.atan=function(){var t,e,r,i,o,n,a,s,l,c=this,h=c.constructor,u=h.precision,d=h.rounding;if(c.isFinite()){if(c.isZero())return new h(c);if(c.abs().eq(1)&&u+4<=A)return(a=U(h,u+4,d).times(.25)).s=c.s,a}else{if(!c.s)return new h(NaN);if(u+4<=A)return(a=U(h,u+4,d).times(.5)).s=c.s,a}for(h.precision=s=u+10,h.rounding=1,t=r=Math.min(28,s/7+2|0);t;--t)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(f=!1,e=Math.ceil(s/7),i=1,l=c.times(c),a=new h(c),o=c;-1!==t;)if(o=o.times(l),n=a.minus(o.div(i+=2)),o=o.times(l),void 0!==(a=n.plus(o.div(i+=2))).d[e])for(t=e;a.d[t]===n.d[t]&&t--;);return r&&(a=a.times(2<<r-1)),f=!0,N(a,h.precision=u,h.rounding=d,!0)},D.isFinite=function(){return!!this.d},D.isInteger=D.isInt=function(){return!!this.d&&E(this.e/7)>this.d.length-2},D.isNaN=function(){return!this.s},D.isNegative=D.isNeg=function(){return this.s<0},D.isPositive=D.isPos=function(){return this.s>0},D.isZero=function(){return!!this.d&&0===this.d[0]},D.lessThan=D.lt=function(t){return this.cmp(t)<0},D.lessThanOrEqualTo=D.lte=function(t){return this.cmp(t)<1},D.logarithm=D.log=function(t){var e,r,i,o,n,a,s,l,c=this.constructor,h=c.precision,u=c.rounding;if(null==t)t=new c(10),e=!0;else{if(r=(t=new c(t)).d,t.s<0||!r||!r[0]||t.eq(1))return new c(NaN);e=t.eq(10)}if(r=this.d,this.s<0||!r||!r[0]||this.eq(1))return new c(r&&!r[0]?-1/0:1!=this.s?NaN:r?0:1/0);if(e)if(r.length>1)n=!0;else{for(o=r[0];o%10==0;)o/=10;n=1!==o}if(f=!1,a=j(this,s=h+5),i=e?F(c,s+10):j(t,s),L((l=R(a,i,s,1)).d,o=h,u))do{if(a=j(this,s+=10),i=e?F(c,s+10):j(t,s),l=R(a,i,s,1),!n){+C(l.d).slice(o+1,o+15)+1==1e14&&(l=N(l,h+1,0));break}}while(L(l.d,o+=10,u));return f=!0,N(l,h,u)},D.minus=D.sub=function(t){var e,r,i,o,n,a,s,l,c,h,u,d,p=this,g=p.constructor;if(t=new g(t),!p.d||!t.d)return p.s&&t.s?p.d?t.s=-t.s:t=new g(t.d||p.s!==t.s?p:NaN):t=new g(NaN),t;if(p.s!=t.s)return t.s=-t.s,p.plus(t);if(c=p.d,d=t.d,s=g.precision,l=g.rounding,!c[0]||!d[0]){if(d[0])t.s=-t.s;else{if(!c[0])return new g(3===l?-0:0);t=new g(p)}return f?N(t,s,l):t}if(r=E(t.e/7),h=E(p.e/7),c=c.slice(),n=h-r){for((u=n<0)?(e=c,n=-n,a=d.length):(e=d,r=h,a=c.length),n>(i=Math.max(Math.ceil(s/7),a)+2)&&(n=i,e.length=1),e.reverse(),i=n;i--;)e.push(0);e.reverse()}else{for((u=(i=c.length)<(a=d.length))&&(a=i),i=0;i<a;i++)if(c[i]!=d[i]){u=c[i]<d[i];break}n=0}for(u&&(e=c,c=d,d=e,t.s=-t.s),a=c.length,i=d.length-a;i>0;--i)c[a++]=0;for(i=d.length;i>n;){if(c[--i]<d[i]){for(o=i;o&&0===c[--o];)c[o]=O-1;--c[o],c[i]+=O}c[i]-=d[i]}for(;0===c[--a];)c.pop();for(;0===c[0];c.shift())--r;return c[0]?(t.d=c,t.e=k(c,r),f?N(t,s,l):t):new g(3===l?-0:0)},D.modulo=D.mod=function(t){var e,r=this,i=r.constructor;return t=new i(t),!r.d||!t.s||t.d&&!t.d[0]?new i(NaN):!t.d||r.d&&!r.d[0]?N(new i(r),i.precision,i.rounding):(f=!1,9==i.modulo?(e=R(r,t.abs(),0,3,1)).s*=t.s:e=R(r,t,0,i.modulo,1),e=e.times(t),f=!0,r.minus(e))},D.naturalExponential=D.exp=function(){return z(this)},D.naturalLogarithm=D.ln=function(){return j(this)},D.negated=D.neg=function(){var t=new this.constructor(this);return t.s=-t.s,N(t)},D.plus=D.add=function(t){var e,r,i,o,n,a,s,l,c,h,u=this,d=u.constructor;if(t=new d(t),!u.d||!t.d)return u.s&&t.s?u.d||(t=new d(t.d||u.s===t.s?u:NaN)):t=new d(NaN),t;if(u.s!=t.s)return t.s=-t.s,u.minus(t);if(c=u.d,h=t.d,s=d.precision,l=d.rounding,!c[0]||!h[0])return h[0]||(t=new d(u)),f?N(t,s,l):t;if(n=E(u.e/7),i=E(t.e/7),c=c.slice(),o=n-i){for(o<0?(r=c,o=-o,a=h.length):(r=h,i=n,a=c.length),o>(a=(n=Math.ceil(s/7))>a?n+1:a+1)&&(o=a,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for((a=c.length)-(o=h.length)<0&&(o=a,r=h,h=c,c=r),e=0;o;)e=(c[--o]=c[o]+h[o]+e)/O|0,c[o]%=O;for(e&&(c.unshift(e),++i),a=c.length;0==c[--a];)c.pop();return t.d=c,t.e=k(c,i),f?N(t,s,l):t},D.precision=D.sd=function(t){var e,r=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(m+t);return r.d?(e=H(r.d),t&&r.e+1>e&&(e=r.e+1)):e=NaN,e},D.round=function(){var t=this,e=t.constructor;return N(new e(t),t.e+1,e.rounding)},D.sine=D.sin=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+Math.max(r.e,r.sd())+7,i.rounding=1,r=function(t,e){var r,i=e.d.length;if(i<3)return e.isZero()?e:K(t,2,e,e);r=(r=1.4*Math.sqrt(i))>16?16:0|r,e=K(t,2,e=e.times(1/Z(5,r)),e);for(var o,n=new t(5),a=new t(16),s=new t(20);r--;)o=e.times(e),e=e.times(n.plus(o.times(a.times(o).minus(s))));return e}(i,Q(i,r)),i.precision=t,i.rounding=e,N(s>2?r.neg():r,t,e,!0)):new i(NaN)},D.squareRoot=D.sqrt=function(){var t,e,r,i,o,n,a=this,s=a.d,l=a.e,c=a.s,h=a.constructor;if(1!==c||!s||!s[0])return new h(!c||c<0&&(!s||s[0])?NaN:s?a:1/0);for(f=!1,0==(c=Math.sqrt(+a))||c==1/0?(((e=C(s)).length+l)%2==0&&(e+="0"),c=Math.sqrt(e),l=E((l+1)/2)-(l<0||l%2),i=new h(e=c==1/0?"5e"+l:(e=c.toExponential()).slice(0,e.indexOf("e")+1)+l)):i=new h(c.toString()),r=(l=h.precision)+3;;)if(i=(n=i).plus(R(a,n,r+2,1)).times(.5),C(n.d).slice(0,r)===(e=C(i.d)).slice(0,r)){if("9999"!=(e=e.slice(r-3,r+1))&&(o||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(N(i,l+1,1),t=!i.times(i).eq(a));break}if(!o&&(N(n,l+1,0),n.times(n).eq(a))){i=n;break}r+=4,o=1}return f=!0,N(i,l,h.rounding,t)},D.tangent=D.tan=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+10,i.rounding=1,(r=r.sin()).s=1,r=R(r,new i(1).minus(r.times(r)).sqrt(),t+10,0),i.precision=t,i.rounding=e,N(2==s||4==s?r.neg():r,t,e,!0)):new i(NaN)},D.times=D.mul=function(t){var e,r,i,o,n,a,s,l,c,h=this,u=h.constructor,d=h.d,p=(t=new u(t)).d;if(t.s*=h.s,!(d&&d[0]&&p&&p[0]))return new u(!t.s||d&&!d[0]&&!p||p&&!p[0]&&!d?NaN:d&&p?0*t.s:t.s/0);for(r=E(h.e/7)+E(t.e/7),(l=d.length)<(c=p.length)&&(n=d,d=p,p=n,a=l,l=c,c=a),n=[],i=a=l+c;i--;)n.push(0);for(i=c;--i>=0;){for(e=0,o=l+i;o>i;)s=n[o]+p[i]*d[o-i-1]+e,n[o--]=s%O|0,e=s/O|0;n[o]=(n[o]+e)%O|0}for(;!n[--a];)n.pop();return e?++r:n.shift(),t.d=n,t.e=k(n,r),f?N(t,u.precision,u.rounding):t},D.toBinary=function(t,e){return $(this,2,t,e)},D.toDecimalPlaces=D.toDP=function(t,e){var r=this,i=r.constructor;return r=new i(r),void 0===t?r:(P(t,0,c),void 0===e?e=i.rounding:P(e,0,8),N(r,t+r.e+1,e))},D.toExponential=function(t,e){var r,i=this,o=i.constructor;return void 0===t?r=B(i,!0):(P(t,0,c),void 0===e?e=o.rounding:P(e,0,8),r=B(i=N(new o(i),t+1,e),!0,t+1)),i.isNeg()&&!i.isZero()?"-"+r:r},D.toFixed=function(t,e){var r,i,o=this,n=o.constructor;return void 0===t?r=B(o):(P(t,0,c),void 0===e?e=n.rounding:P(e,0,8),r=B(i=N(new n(o),t+o.e+1,e),!1,t+i.e+1)),o.isNeg()&&!o.isZero()?"-"+r:r},D.toFraction=function(t){var e,r,i,o,n,a,s,l,c,h,u,d,p=this,g=p.d,y=p.constructor;if(!g)return new y(p);if(c=r=new y(1),a=(n=(e=new y(i=l=new y(0))).e=H(g)-p.e-1)%7,e.d[0]=T(10,a<0?7+a:a),null==t)t=n>0?e:c;else{if(!(s=new y(t)).isInt()||s.lt(c))throw Error(m+s);t=s.gt(e)?n>0?e:c:s}for(f=!1,s=new y(C(g)),h=y.precision,y.precision=n=7*g.length*2;u=R(s,e,0,1,1),1!=(o=r.plus(u.times(i))).cmp(t);)r=i,i=o,o=c,c=l.plus(u.times(o)),l=o,o=e,e=s.minus(u.times(o)),s=o;return o=R(t.minus(r),i,0,1,1),l=l.plus(o.times(c)),r=r.plus(o.times(i)),l.s=c.s=p.s,d=R(c,i,n,1).minus(p).abs().cmp(R(l,r,n,1).minus(p).abs())<1?[c,i]:[l,r],y.precision=h,f=!0,d},D.toHexadecimal=D.toHex=function(t,e){return $(this,16,t,e)},D.toNearest=function(t,e){var r=this,i=r.constructor;if(r=new i(r),null==t){if(!r.d)return r;t=new i(1),e=i.rounding}else{if(t=new i(t),void 0===e?e=i.rounding:P(e,0,8),!r.d)return t.s?r:t;if(!t.d)return t.s&&(t.s=r.s),t}return t.d[0]?(f=!1,r=R(r,t,0,e,1).times(t),f=!0,N(r)):(t.s=r.s,r=t),r},D.toNumber=function(){return+this},D.toOctal=function(t,e){return $(this,8,t,e)},D.toPower=D.pow=function(t){var e,r,i,o,n,a,s=this,l=s.constructor,c=+(t=new l(t));if(!(s.d&&t.d&&s.d[0]&&t.d[0]))return new l(T(+s,c));if((s=new l(s)).eq(1))return s;if(i=l.precision,n=l.rounding,t.eq(1))return N(s,i,n);if((e=E(t.e/7))>=t.d.length-1&&(r=c<0?-c:c)<=9007199254740991)return o=q(l,s,r,i),t.s<0?new l(1).div(o):N(o,i,n);if((a=s.s)<0){if(e<t.d.length-1)return new l(NaN);if(0==(1&t.d[e])&&(a=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=a,s}return(e=0!=(r=T(+s,c))&&isFinite(r)?new l(r+"").e:E(c*(Math.log("0."+C(s.d))/Math.LN10+s.e+1)))>l.maxE+1||e<l.minE-1?new l(e>0?a/0:0):(f=!1,l.rounding=s.s=1,r=Math.min(12,(e+"").length),(o=z(t.times(j(s,i+r)),i)).d&&L((o=N(o,i+5,1)).d,i,n)&&(e=i+10,+C((o=N(z(t.times(j(s,e+r)),e),e+5,1)).d).slice(i+1,i+15)+1==1e14&&(o=N(o,i+1,0))),o.s=a,f=!0,l.rounding=n,N(o,i,n))},D.toPrecision=function(t,e){var r,i=this,o=i.constructor;return void 0===t?r=B(i,i.e<=o.toExpNeg||i.e>=o.toExpPos):(P(t,1,c),void 0===e?e=o.rounding:P(e,0,8),r=B(i=N(new o(i),t,e),t<=i.e||i.e<=o.toExpNeg,t)),i.isNeg()&&!i.isZero()?"-"+r:r},D.toSignificantDigits=D.toSD=function(t,e){var r=this.constructor;return void 0===t?(t=r.precision,e=r.rounding):(P(t,1,c),void 0===e?e=r.rounding:P(e,0,8)),N(new r(this),t,e)},D.toString=function(){var t=this,e=t.constructor,r=B(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+r:r},D.truncated=D.trunc=function(){return N(new this.constructor(this),this.e+1,1)},D.valueOf=D.toJSON=function(){var t=this,e=t.constructor,r=B(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+r:r};var R=function(){function t(t,e,r){var i,o=0,n=t.length;for(t=t.slice();n--;)i=t[n]*e+o,t[n]=i%r|0,o=i/r|0;return o&&t.unshift(o),t}function e(t,e,r,i){var o,n;if(r!=i)n=r>i?1:-1;else for(o=n=0;o<r;o++)if(t[o]!=e[o]){n=t[o]>e[o]?1:-1;break}return n}function r(t,e,r,i){for(var o=0;r--;)t[r]-=o,o=t[r]<e[r]?1:0,t[r]=o*i+t[r]-e[r];for(;!t[0]&&t.length>1;)t.shift()}return function(i,o,n,s,l,c){var h,u,d,p,f,g,m,y,v,_,T,b,S,x,w,I,A,D,C,P,L=i.constructor,M=i.s==o.s?1:-1,R=i.d,B=o.d;if(!(R&&R[0]&&B&&B[0]))return new L(i.s&&o.s&&(R?!B||R[0]!=B[0]:B)?R&&0==R[0]||!B?0*M:M/0:NaN);for(c?(f=1,u=i.e-o.e):(c=O,f=7,u=E(i.e/f)-E(o.e/f)),C=B.length,A=R.length,_=(v=new L(M)).d=[],d=0;B[d]==(R[d]||0);d++);if(B[d]>(R[d]||0)&&u--,null==n?(x=n=L.precision,s=L.rounding):x=l?n+(i.e-o.e)+1:n,x<0)_.push(1),g=!0;else{if(x=x/f+2|0,d=0,1==C){for(p=0,B=B[0],x++;(d<A||p)&&x--;d++)w=p*c+(R[d]||0),_[d]=w/B|0,p=w%B|0;g=p||d<A}else{for((p=c/(B[0]+1)|0)>1&&(B=t(B,p,c),R=t(R,p,c),C=B.length,A=R.length),I=C,b=(T=R.slice(0,C)).length;b<C;)T[b++]=0;(P=B.slice()).unshift(0),D=B[0],B[1]>=c/2&&++D;do{p=0,(h=e(B,T,C,b))<0?(S=T[0],C!=b&&(S=S*c+(T[1]||0)),(p=S/D|0)>1?(p>=c&&(p=c-1),1==(h=e(m=t(B,p,c),T,y=m.length,b=T.length))&&(p--,r(m,C<y?P:B,y,c))):(0==p&&(h=p=1),m=B.slice()),(y=m.length)<b&&m.unshift(0),r(T,m,b,c),-1==h&&(h=e(B,T,C,b=T.length))<1&&(p++,r(T,C<b?P:B,b,c)),b=T.length):0===h&&(p++,T=[0]),_[d++]=p,h&&T[0]?T[b++]=R[I]||0:(T=[R[I]],b=1)}while((I++<A||void 0!==T[0])&&x--);g=void 0!==T[0]}_[0]||_.shift()}if(1==f)v.e=u,a=g;else{for(d=1,p=_[0];p>=10;p/=10)d++;v.e=d+u*f-1,N(v,l?n+v.e+1:n,s,g)}return v}}();function N(t,e,r,i){var o,n,a,s,l,c,h,u,d,p=t.constructor;t:if(null!=e){if(!(u=t.d))return t;for(o=1,s=u[0];s>=10;s/=10)o++;if((n=e-o)<0)n+=7,a=e,l=(h=u[d=0])/T(10,o-a-1)%10|0;else if((d=Math.ceil((n+1)/7))>=(s=u.length)){if(!i)break t;for(;s++<=d;)u.push(0);h=l=0,o=1,a=(n%=7)-7+1}else{for(h=s=u[d],o=1;s>=10;s/=10)o++;l=(a=(n%=7)-7+o)<0?0:h/T(10,o-a-1)%10|0}if(i=i||e<0||void 0!==u[d+1]||(a<0?h:h%T(10,o-a-1)),c=r<4?(l||i)&&(0==r||r==(t.s<0?3:2)):l>5||5==l&&(4==r||i||6==r&&(n>0?a>0?h/T(10,o-a):0:u[d-1])%10&1||r==(t.s<0?8:7)),e<1||!u[0])return u.length=0,c?(e-=t.e+1,u[0]=T(10,(7-e%7)%7),t.e=-e||0):u[0]=t.e=0,t;if(0==n?(u.length=d,s=1,d--):(u.length=d+1,s=T(10,7-n),u[d]=a>0?(h/T(10,o-a)%T(10,a)|0)*s:0),c)for(;;){if(0==d){for(n=1,a=u[0];a>=10;a/=10)n++;for(a=u[0]+=s,s=1;a>=10;a/=10)s++;n!=s&&(t.e++,u[0]==O&&(u[0]=1));break}if(u[d]+=s,u[d]!=O)break;u[d--]=0,s=1}for(n=u.length;0===u[--n];)u.pop()}return f&&(t.e>p.maxE?(t.d=null,t.e=NaN):t.e<p.minE&&(t.e=0,t.d=[0])),t}function B(t,e,r){if(!t.isFinite())return V(t);var i,o=t.e,n=C(t.d),a=n.length;return e?(r&&(i=r-a)>0?n=n.charAt(0)+"."+n.slice(1)+G(i):a>1&&(n=n.charAt(0)+"."+n.slice(1)),n=n+(t.e<0?"e":"e+")+t.e):o<0?(n="0."+G(-o-1)+n,r&&(i=r-a)>0&&(n+=G(i))):o>=a?(n+=G(o+1-a),r&&(i=r-o-1)>0&&(n=n+"."+G(i))):((i=o+1)<a&&(n=n.slice(0,i)+"."+n.slice(i)),r&&(i=r-a)>0&&(o+1===a&&(n+="."),n+=G(i))),n}function k(t,e){var r=t[0];for(e*=7;r>=10;r/=10)e++;return e}function F(t,e,r){if(e>I)throw f=!0,r&&(t.precision=r),Error(y);return N(new t(u),e,1,!0)}function U(t,e,r){if(e>A)throw Error(y);return N(new t(d),e,r,!0)}function H(t){var e=t.length-1,r=7*e+1;if(e=t[e]){for(;e%10==0;e/=10)r--;for(e=t[0];e>=10;e/=10)r++}return r}function G(t){for(var e="";t--;)e+="0";return e}function q(t,e,r,i){var o,n=new t(1),a=Math.ceil(i/7+4);for(f=!1;;){if(r%2&&tt((n=n.times(e)).d,a)&&(o=!0),0===(r=E(r/2))){r=n.d.length-1,o&&0===n.d[r]&&++n.d[r];break}tt((e=e.times(e)).d,a)}return f=!0,n}function W(t){return 1&t.d[t.d.length-1]}function Y(t,e,r){for(var i,o=new t(e[0]),n=0;++n<e.length;){if(!(i=new t(e[n])).s){o=i;break}o[r](i)&&(o=i)}return o}function z(t,e){var r,i,o,n,a,s,l,c=0,h=0,u=0,d=t.constructor,p=d.rounding,g=d.precision;if(!t.d||!t.d[0]||t.e>17)return new d(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(null==e?(f=!1,l=g):l=e,s=new d(.03125);t.e>-2;)t=t.times(s),u+=5;for(l+=i=Math.log(T(2,u))/Math.LN10*2+5|0,r=n=a=new d(1),d.precision=l;;){if(n=N(n.times(t),l,1),r=r.times(++h),C((s=a.plus(R(n,r,l,1))).d).slice(0,l)===C(a.d).slice(0,l)){for(o=u;o--;)a=N(a.times(a),l,1);if(null!=e)return d.precision=g,a;if(!(c<3&&L(a.d,l-i,p,c)))return N(a,d.precision=g,p,f=!0);d.precision=l+=10,r=n=s=new d(1),h=0,c++}a=s}}function j(t,e){var r,i,o,n,a,s,l,c,h,u,d,p=1,g=t,m=g.d,y=g.constructor,v=y.rounding,_=y.precision;if(g.s<0||!m||!m[0]||!g.e&&1==m[0]&&1==m.length)return new y(m&&!m[0]?-1/0:1!=g.s?NaN:m?0:g);if(null==e?(f=!1,h=_):h=e,y.precision=h+=10,i=(r=C(m)).charAt(0),!(Math.abs(n=g.e)<15e14))return c=F(y,h+2,_).times(n+""),g=j(new y(i+"."+r.slice(1)),h-10).plus(c),y.precision=_,null==e?N(g,_,v,f=!0):g;for(;i<7&&1!=i||1==i&&r.charAt(1)>3;)i=(r=C((g=g.times(t)).d)).charAt(0),p++;for(n=g.e,i>1?(g=new y("0."+r),n++):g=new y(i+"."+r.slice(1)),u=g,l=a=g=R(g.minus(1),g.plus(1),h,1),d=N(g.times(g),h,1),o=3;;){if(a=N(a.times(d),h,1),C((c=l.plus(R(a,new y(o),h,1))).d).slice(0,h)===C(l.d).slice(0,h)){if(l=l.times(2),0!==n&&(l=l.plus(F(y,h+2,_).times(n+""))),l=R(l,new y(p),h,1),null!=e)return y.precision=_,l;if(!L(l.d,h-10,v,s))return N(l,y.precision=_,v,f=!0);y.precision=h+=10,c=a=g=R(u.minus(1),u.plus(1),h,1),d=N(g.times(g),h,1),o=s=1}l=c,o+=2}}function V(t){return String(t.s*t.s/0)}function X(t,e){var r,i,o;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(r<0&&(r=i),r+=+e.slice(i+1),e=e.substring(0,i)):r<0&&(r=e.length),i=0;48===e.charCodeAt(i);i++);for(o=e.length;48===e.charCodeAt(o-1);--o);if(e=e.slice(i,o)){if(o-=i,t.e=r=r-i-1,t.d=[],i=(r+1)%7,r<0&&(i+=7),i<o){for(i&&t.d.push(+e.slice(0,i)),o-=7;i<o;)t.d.push(+e.slice(i,i+=7));i=7-(e=e.slice(i)).length}else i-=o;for(;i--;)e+="0";t.d.push(+e),f&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function J(t,e){var r,i,o,a,s,l,c,h,u;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),w.test(e))return X(t,e)}else if("Infinity"===e||"NaN"===e)return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(S.test(e))r=16,e=e.toLowerCase();else if(b.test(e))r=2;else{if(!x.test(e))throw Error(m+e);r=8}for((a=e.search(/p/i))>0?(c=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),s=(a=e.indexOf("."))>=0,i=t.constructor,s&&(a=(l=(e=e.replace(".","")).length)-a,o=q(i,new i(r),a,2*a)),a=u=(h=M(e,r,O)).length-1;0===h[a];--a)h.pop();return a<0?new i(0*t.s):(t.e=k(h,u),t.d=h,f=!1,s&&(t=R(t,o,4*l)),c&&(t=t.times(Math.abs(c)<54?T(2,c):n.pow(2,c))),f=!0,t)}function K(t,e,r,i,o){var n,a,s,l,c=t.precision,h=Math.ceil(c/7);for(f=!1,l=r.times(r),s=new t(i);;){if(a=R(s.times(l),new t(e++*e++),c,1),s=o?i.plus(a):i.minus(a),i=R(a.times(l),new t(e++*e++),c,1),void 0!==(a=s.plus(i)).d[h]){for(n=h;a.d[n]===s.d[n]&&n--;);if(-1==n)break}n=s,s=i,i=a,a=n}return f=!0,a.d.length=h+1,a}function Z(t,e){for(var r=t;--e;)r*=t;return r}function Q(t,e){var r,i=e.s<0,o=U(t,t.precision,1),n=o.times(.5);if((e=e.abs()).lte(n))return s=i?4:1,e;if((r=e.divToInt(o)).isZero())s=i?3:2;else{if((e=e.minus(r.times(o))).lte(n))return s=W(r)?i?2:3:i?4:1,e;s=W(r)?i?1:4:i?3:2}return e.minus(o).abs()}function $(t,e,r,i){var o,n,s,l,u,d,p,f,g,m=t.constructor,y=void 0!==r;if(y?(P(r,1,c),void 0===i?i=m.rounding:P(i,0,8)):(r=m.precision,i=m.rounding),t.isFinite()){for(y?(o=2,16==e?r=4*r-3:8==e&&(r=3*r-2)):o=e,(s=(p=B(t)).indexOf("."))>=0&&(p=p.replace(".",""),(g=new m(1)).e=p.length-s,g.d=M(B(g),10,o),g.e=g.d.length),n=u=(f=M(p,10,o)).length;0==f[--u];)f.pop();if(f[0]){if(s<0?n--:((t=new m(t)).d=f,t.e=n,f=(t=R(t,g,r,i,0,o)).d,n=t.e,d=a),s=f[r],l=o/2,d=d||void 0!==f[r+1],d=i<4?(void 0!==s||d)&&(0===i||i===(t.s<0?3:2)):s>l||s===l&&(4===i||d||6===i&&1&f[r-1]||i===(t.s<0?8:7)),f.length=r,d)for(;++f[--r]>o-1;)f[r]=0,r||(++n,f.unshift(1));for(u=f.length;!f[u-1];--u);for(s=0,p="";s<u;s++)p+=h.charAt(f[s]);if(y){if(u>1)if(16==e||8==e){for(s=16==e?4:3,--u;u%s;u++)p+="0";for(u=(f=M(p,o,e)).length;!f[u-1];--u);for(s=1,p="1.";s<u;s++)p+=h.charAt(f[s])}else p=p.charAt(0)+"."+p.slice(1);p=p+(n<0?"p":"p+")+n}else if(n<0){for(;++n;)p="0"+p;p="0."+p}else if(++n>u)for(n-=u;n--;)p+="0";else n<u&&(p=p.slice(0,n)+"."+p.slice(n))}else p=y?"0p+0":"0";p=(16==e?"0x":2==e?"0b":8==e?"0o":"")+p}else p=V(t);return t.s<0?"-"+p:p}function tt(t,e){if(t.length>e)return t.length=e,!0}function et(t){return new this(t).abs()}function rt(t){return new this(t).acos()}function it(t){return new this(t).acosh()}function ot(t,e){return new this(t).plus(e)}function nt(t){return new this(t).asin()}function at(t){return new this(t).asinh()}function st(t){return new this(t).atan()}function lt(t){return new this(t).atanh()}function ct(t,e){t=new this(t),e=new this(e);var r,i=this.precision,o=this.rounding,n=i+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(r=e.s<0?U(this,i,o):new this(0)).s=t.s:!t.d||e.isZero()?(r=U(this,n,1).times(.5)).s=t.s:e.s<0?(this.precision=n,this.rounding=1,r=this.atan(R(t,e,n,1)),e=U(this,n,1),this.precision=i,this.rounding=o,r=t.s<0?r.minus(e):r.plus(e)):r=this.atan(R(t,e,n,1)):(r=U(this,n,1).times(e.s>0?.25:.75)).s=t.s:r=new this(NaN),r}function ht(t){return new this(t).cbrt()}function ut(t){return N(t=new this(t),t.e+1,2)}function dt(t,e,r){return new this(t).clamp(e,r)}function pt(t){if(!t||"object"!=typeof t)throw Error(g+"Object expected");var e,r,i,o=!0===t.defaults,n=["precision",1,c,"rounding",0,8,"toExpNeg",-l,0,"toExpPos",0,l,"maxE",0,l,"minE",-l,0,"modulo",0,9];for(e=0;e<n.length;e+=3)if(r=n[e],o&&(this[r]=p[r]),void 0!==(i=t[r])){if(!(E(i)===i&&i>=n[e+1]&&i<=n[e+2]))throw Error(m+r+": "+i);this[r]=i}if(r="crypto",o&&(this[r]=p[r]),void 0!==(i=t[r])){if(!0!==i&&!1!==i&&0!==i&&1!==i)throw Error(m+r+": "+i);if(i){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(v);this[r]=!0}else this[r]=!1}return this}function ft(t){return new this(t).cos()}function gt(t){return new this(t).cosh()}function mt(t,e){return new this(t).div(e)}function yt(t){return new this(t).exp()}function vt(t){return N(t=new this(t),t.e+1,3)}function _t(){var t,e,r=new this(0);for(f=!1,t=0;t<arguments.length;)if((e=new this(arguments[t++])).d)r.d&&(r=r.plus(e.times(e)));else{if(e.s)return f=!0,new this(1/0);r=e}return f=!0,r.sqrt()}function Et(t){return t instanceof n||t&&t.toStringTag===_||!1}function Tt(t){return new this(t).ln()}function bt(t,e){return new this(t).log(e)}function St(t){return new this(t).log(2)}function xt(t){return new this(t).log(10)}function wt(){return Y(this,arguments,"lt")}function Ot(){return Y(this,arguments,"gt")}function It(t,e){return new this(t).mod(e)}function At(t,e){return new this(t).mul(e)}function Dt(t,e){return new this(t).pow(e)}function Ct(t){var e,r,i,o,n=0,a=new this(1),s=[];if(void 0===t?t=this.precision:P(t,1,c),i=Math.ceil(t/7),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(i));n<i;)(o=e[n])>=429e7?e[n]=crypto.getRandomValues(new Uint32Array(1))[0]:s[n++]=o%1e7;else{if(!crypto.randomBytes)throw Error(v);for(e=crypto.randomBytes(i*=4);n<i;)(o=e[n]+(e[n+1]<<8)+(e[n+2]<<16)+((127&e[n+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,n):(s.push(o%1e7),n+=4);n=i/4}else for(;n<i;)s[n++]=1e7*Math.random()|0;for(t%=7,(i=s[--n])&&t&&(o=T(10,7-t),s[n]=(i/o|0)*o);0===s[n];n--)s.pop();if(n<0)r=0,s=[0];else{for(r=-1;0===s[0];r-=7)s.shift();for(i=1,o=s[0];o>=10;o/=10)i++;i<7&&(r-=7-i)}return a.e=r,a.d=s,a}function Pt(t){return N(t=new this(t),t.e+1,this.rounding)}function Lt(t){return(t=new this(t)).d?t.d[0]?t.s:0*t.s:t.s||NaN}function Mt(t){return new this(t).sin()}function Rt(t){return new this(t).sinh()}function Nt(t){return new this(t).sqrt()}function Bt(t,e){return new this(t).sub(e)}function kt(){var t=0,e=arguments,r=new this(e[t]);for(f=!1;r.s&&++t<e.length;)r=r.plus(e[t]);return f=!0,N(r,this.precision,this.rounding)}function Ft(t){return new this(t).tan()}function Ut(t){return new this(t).tanh()}function Ht(t){return N(t=new this(t),t.e+1,1)}(n=function t(e){var r,i,o;function n(t){var e,r,i,o=this;if(!(o instanceof n))return new n(t);if(o.constructor=n,Et(t))return o.s=t.s,void(f?!t.d||t.e>n.maxE?(o.e=NaN,o.d=null):t.e<n.minE?(o.e=0,o.d=[0]):(o.e=t.e,o.d=t.d.slice()):(o.e=t.e,o.d=t.d?t.d.slice():t.d));if("number"==(i=typeof t)){if(0===t)return o.s=1/t<0?-1:1,o.e=0,void(o.d=[0]);if(t<0?(t=-t,o.s=-1):o.s=1,t===~~t&&t<1e7){for(e=0,r=t;r>=10;r/=10)e++;return void(f?e>n.maxE?(o.e=NaN,o.d=null):e<n.minE?(o.e=0,o.d=[0]):(o.e=e,o.d=[t]):(o.e=e,o.d=[t]))}return 0*t!=0?(t||(o.s=NaN),o.e=NaN,void(o.d=null)):X(o,t.toString())}if("string"!==i)throw Error(m+t);return 45===(r=t.charCodeAt(0))?(t=t.slice(1),o.s=-1):(43===r&&(t=t.slice(1)),o.s=1),w.test(t)?X(o,t):J(o,t)}if(n.prototype=D,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.EUCLID=9,n.config=n.set=pt,n.clone=t,n.isDecimal=Et,n.abs=et,n.acos=rt,n.acosh=it,n.add=ot,n.asin=nt,n.asinh=at,n.atan=st,n.atanh=lt,n.atan2=ct,n.cbrt=ht,n.ceil=ut,n.clamp=dt,n.cos=ft,n.cosh=gt,n.div=mt,n.exp=yt,n.floor=vt,n.hypot=_t,n.ln=Tt,n.log=bt,n.log10=xt,n.log2=St,n.max=wt,n.min=Ot,n.mod=It,n.mul=At,n.pow=Dt,n.random=Ct,n.round=Pt,n.sign=Lt,n.sin=Mt,n.sinh=Rt,n.sqrt=Nt,n.sub=Bt,n.sum=kt,n.tan=Ft,n.tanh=Ut,n.trunc=Ht,void 0===e&&(e={}),e&&!0!==e.defaults)for(o=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<o.length;)e.hasOwnProperty(i=o[r++])||(e[i]=this[i]);return n.config(e),n}(p)).prototype.constructor=n,n.default=n.Decimal=n,u=new n(u),d=new n(d),void 0===(i=function(){return n}.call(e,r,e,t))||(t.exports=i)}()},function(t,e,r){"use strict";var i,o;void 0===(o="function"==typeof(i=function(){function t(){return!0}function e(){return!1}function r(){}return function i(){var o=[{name:"number",test:function(t){return"number"==typeof t}},{name:"string",test:function(t){return"string"==typeof t}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"Function",test:function(t){return"function"==typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:function(t){return"object"==typeof t&&null!==t&&t.constructor===Object}},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],n={name:"any",test:t},a=[],s=[],l={types:o,conversions:s,ignore:a};function c(t){var e=H(l.types,(function(e){return e.name===t}));if(e)return e;if("any"===t)return n;var r=H(l.types,(function(e){return e.name.toLowerCase()===t.toLowerCase()}));throw new TypeError('Unknown type "'+t+'"'+(r?'. Did you mean "'+r.name+'"?':""))}function h(t){return t===n?999:l.types.indexOf(t)}function u(t){var e=H(l.types,(function(e){return e.test(t)}));if(e)return e.name;throw new TypeError("Value has unknown type. Value: "+t)}function d(t){return t.map((function(t){var e=t.types.map(E);return(t.restParam?"...":"")+e.join("|")})).join(",")}function p(t,e){var r=0===t.indexOf("..."),i=(r?t.length>3?t.slice(3):"any":t).split("|").map(M).filter(R).filter(L),o=function(t,e){var r={};return t.forEach((function(t){-1!==e.indexOf(t.from)||-1===e.indexOf(t.to)||r[t.from]||(r[t.from]=t)})),Object.keys(r).map((function(t){return r[t]}))}(e,i),n=i.map((function(t){var e=c(t);return{name:t,typeIndex:h(e),test:e.test,conversion:null,conversionIndex:-1}})),a=o.map((function(t){var r=c(t.from);return{name:t.from,typeIndex:h(r),test:r.test,conversion:t,conversionIndex:e.indexOf(t)}}));return{types:n.concat(a),restParam:r}}function f(t){var e=k(t);return!!e&&e.restParam}function g(t){return t.types.some((function(t){return null!=t.conversion}))}function m(e){if(e&&0!==e.types.length){if(1===e.types.length)return c(e.types[0].name).test;if(2===e.types.length){var r=c(e.types[0].name).test,i=c(e.types[1].name).test;return function(t){return r(t)||i(t)}}var o=e.types.map((function(t){return c(t.name).test}));return function(t){for(var e=0;e<o.length;e++)if(o[e](t))return!0;return!1}}return t}function y(t){var e,r,i,o;if(f(t)){var n=(e=(o=t,o.slice(0,o.length-1)).map(m)).length,a=m(k(t));return function(t){for(var r=0;r<e.length;r++)if(!e[r](t[r]))return!1;return function(t){for(var e=n;e<t.length;e++)if(!a(t[e]))return!1;return!0}(t)&&t.length>=n+1}}return 0===t.length?function(t){return 0===t.length}:1===t.length?(r=m(t[0]),function(t){return r(t[0])&&1===t.length}):2===t.length?(r=m(t[0]),i=m(t[1]),function(t){return r(t[0])&&i(t[1])&&2===t.length}):(e=t.map(m),function(t){for(var r=0;r<e.length;r++)if(!e[r](t[r]))return!1;return t.length===e.length})}function v(t,e){return e<t.params.length?t.params[e]:f(t.params)?k(t.params):null}function _(t,e,r){var i=v(t,e);return(i?r?i.types.filter(T):i.types:[]).map(E)}function E(t){return t.name}function T(t){return null===t.conversion||void 0===t.conversion}function b(t,e){var r=function(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=!0;return Object.keys(e)}(G(t,(function(t){return _(t,e,!1)})));return-1!==r.indexOf("any")?["any"]:r}function S(t,e,r){var i,o,n,a=t||"unnamed",s=r;for(n=0;n<e.length;n++){var l=s.filter((function(t){var r=m(v(t,n));return(n<t.params.length||f(t.params))&&r(e[n])}));if(0===l.length){if((o=b(s,n)).length>0){var c=u(e[n]);return(i=new TypeError("Unexpected type of argument in function "+a+" (expected: "+o.join(" or ")+", actual: "+c+", index: "+n+")")).data={category:"wrongType",fn:a,index:n,actual:c,expected:o},i}}else s=l}var h=s.map((function(t){return f(t.params)?1/0:t.params.length}));if(e.length<Math.min.apply(null,h))return o=b(s,n),(i=new TypeError("Too few arguments in function "+a+" (expected: "+o.join(" or ")+", index: "+e.length+")")).data={category:"tooFewArgs",fn:a,index:e.length,expected:o},i;var d=Math.max.apply(null,h);return e.length>d?((i=new TypeError("Too many arguments in function "+a+" (expected: "+d+", actual: "+e.length+")")).data={category:"tooManyArgs",fn:a,index:e.length,expectedLength:d},i):((i=new TypeError('Arguments of type "'+e.join(", ")+'" do not match any of the defined signatures of function '+a+".")).data={category:"mismatch",actual:e.map(u)},i)}function x(t){for(var e=999,r=0;r<t.types.length;r++)T(t.types[r])&&(e=Math.min(e,t.types[r].typeIndex));return e}function w(t){for(var e=999,r=0;r<t.types.length;r++)T(t.types[r])||(e=Math.min(e,t.types[r].conversionIndex));return e}function O(t,e){var r;return 0!=(r=t.restParam-e.restParam)||0!=(r=g(t)-g(e))||0!=(r=x(t)-x(e))?r:w(t)-w(e)}function I(t,e){var r,i,o=Math.min(t.params.length,e.params.length);if(0!=(i=t.params.some(g)-e.params.some(g)))return i;for(r=0;r<o;r++)if(0!=(i=g(t.params[r])-g(e.params[r])))return i;for(r=0;r<o;r++)if(0!==(i=O(t.params[r],e.params[r])))return i;return t.params.length-e.params.length}function A(t){var e,r,i,o,n=[],a=[];switch(t.types.forEach((function(t){t.conversion&&(n.push(c(t.conversion.from).test),a.push(t.conversion.convert))})),a.length){case 0:return function(t){return t};case 1:return e=n[0],i=a[0],function(t){return e(t)?i(t):t};case 2:return e=n[0],r=n[1],i=a[0],o=a[1],function(t){return e(t)?i(t):r(t)?o(t):t};default:return function(t){for(var e=0;e<a.length;e++)if(n[e](t))return a[e](t);return t}}}function D(t,e){return function t(r,i,o){if(i<r.length){var n,a=r[i],s=e?a.types.filter(T):a.types;if(a.restParam){var l=s.filter(T);n=l.length<s.length?[l,s]:[s]}else n=s.map((function(t){return[t]}));return G(n,(function(e){return t(r,i+1,o.concat([e]))}))}return[o.map((function(t,e){return{types:t,restParam:e===r.length-1&&f(r)}}))]}(t,0,[])}function C(t,i){if(0===Object.keys(i).length)throw new SyntaxError("No signatures provided");var o=[];Object.keys(i).map((function(t){return function(t,e,r){var i=[];return""!==t.trim()&&(i=t.split(",").map(M).map((function(t,e,i){var o=p(t,r);if(o.restParam&&e!==i.length-1)throw new SyntaxError('Unexpected rest parameter "'+t+'": only allowed for the last parameter');return o}))),i.some(B)?null:{params:i,fn:e}}(t,i[t],l.conversions)})).filter(N).forEach((function(t){var e=H(o,(function(e){return function(t,e){for(var r=Math.max(t.params.length,e.params.length),i=0;i<r;i++){if(!U(_(t,i,!0),_(e,i,!0)))return!1}var o=t.params.length,n=e.params.length,a=f(t.params),s=f(e.params);return a?s?o===n:n>=o:s?o>=n:o===n}(e,t)}));if(e)throw new TypeError('Conflicting signatures "'+d(e.params)+'" and "'+d(t.params)+'".');o.push(t)}));var n=G(o,(function(t){return(t?D(t.params,!1):[]).map((function(e){return{params:e,fn:t.fn}}))})).filter(N);n.sort(I);var a=n[0]&&n[0].params.length<=2&&!f(n[0].params),s=n[1]&&n[1].params.length<=2&&!f(n[1].params),c=n[2]&&n[2].params.length<=2&&!f(n[2].params),h=n[3]&&n[3].params.length<=2&&!f(n[3].params),u=n[4]&&n[4].params.length<=2&&!f(n[4].params),v=n[5]&&n[5].params.length<=2&&!f(n[5].params),E=a&&s&&c&&h&&u&&v,T=n.map((function(t){return y(t.params)})),b=a?m(n[0].params[0]):e,S=s?m(n[1].params[0]):e,x=c?m(n[2].params[0]):e,w=h?m(n[3].params[0]):e,O=u?m(n[4].params[0]):e,C=v?m(n[5].params[0]):e,P=a?m(n[0].params[1]):e,L=s?m(n[1].params[1]):e,R=c?m(n[2].params[1]):e,k=h?m(n[3].params[1]):e,q=u?m(n[4].params[1]):e,W=v?m(n[5].params[1]):e,Y=n.map((function(t){return function(t,e){var r=e;if(t.some(g)){var i=f(t),o=t.map(A);r=function(){for(var t=[],r=i?arguments.length-1:arguments.length,n=0;n<r;n++)t[n]=o[n](arguments[n]);return i&&(t[r]=arguments[r].map(o[r])),e.apply(this,t)}}var n=r;if(f(t)){var a=t.length-1;n=function(){return r.apply(this,F(arguments,0,a).concat([F(arguments,a)]))}}return n}(t.params,t.fn)})),z=a?Y[0]:r,j=s?Y[1]:r,V=c?Y[2]:r,X=h?Y[3]:r,J=u?Y[4]:r,K=v?Y[5]:r,Z=a?n[0].params.length:-1,Q=s?n[1].params.length:-1,$=c?n[2].params.length:-1,tt=h?n[3].params.length:-1,et=u?n[4].params.length:-1,rt=v?n[5].params.length:-1,it=E?6:0,ot=n.length,nt=function e(r,i){return arguments.length===Z&&b(r)&&P(i)?z.apply(e,arguments):arguments.length===Q&&S(r)&&L(i)?j.apply(e,arguments):arguments.length===$&&x(r)&&R(i)?V.apply(e,arguments):arguments.length===tt&&w(r)&&k(i)?X.apply(e,arguments):arguments.length===et&&O(r)&&q(i)?J.apply(e,arguments):arguments.length===rt&&C(r)&&W(i)?K.apply(e,arguments):function(){for(var e=it;e<ot;e++)if(T[e](arguments))return Y[e].apply(this,arguments);return l.onMismatch(t,arguments,n)}.apply(e,arguments)};try{Object.defineProperty(nt,"name",{value:t})}catch(t){}return nt.signatures=function(t){var e={};return t.forEach((function(t){t.params.some(g)||D(t.params,!0).forEach((function(r){e[d(r)]=t.fn}))})),e}(n),nt}function P(t,e,r){throw S(t,e,r)}function L(t){return-1===l.ignore.indexOf(t)}function M(t){return t.trim()}function R(t){return!!t}function N(t){return null!==t}function B(t){return 0===t.types.length}function k(t){return t[t.length-1]}function F(t,e,r){return Array.prototype.slice.call(t,e,r)}function U(t,e){for(var r=0;r<t.length;r++)if(i=e,o=t[r],-1!==i.indexOf(o))return!0;var i,o;return!1}function H(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return t[r]}function G(t,e){return Array.prototype.concat.apply([],t.map(e))}function q(t){for(var e="",r=0;r<t.length;r++){var i=t[r];if(("object"==typeof i.signatures||"string"==typeof i.signature)&&""!==i.name)if(""===e)e=i.name;else if(e!==i.name){var o=new Error("Function names do not match (expected: "+e+", actual: "+i.name+")");throw o.data={actual:i.name,expected:e},o}}return e}function W(t){var e,r={};function i(t,i){if(r.hasOwnProperty(t)&&i!==r[t])throw(e=new Error('Signature "'+t+'" is defined twice')).data={signature:t},e}for(var o=0;o<t.length;o++){var n=t[o];if("object"==typeof n.signatures)for(var a in n.signatures)n.signatures.hasOwnProperty(a)&&(i(a,n.signatures[a]),r[a]=n.signatures[a]);else{if("string"!=typeof n.signature)throw(e=new TypeError("Function is no typed-function (index: "+o+")")).data={index:o},e;i(n.signature,n),r[n.signature]=n}}return r}return(l=C("typed",{"string, Object":C,Object:function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(t[r]);return C(q(e),t)},"...Function":function(t){return C(q(t),W(t))},"string, ...Function":function(t,e){return C(t,W(e))}})).create=i,l.types=o,l.conversions=s,l.ignore=a,l.onMismatch=P,l.throwMismatchError=P,l.createError=S,l.convert=function(t,e){var r=u(t);if(e===r)return t;for(var i=0;i<l.conversions.length;i++){var o=l.conversions[i];if(o.from===r&&o.to===e)return o.convert(t)}throw new Error("Cannot convert from "+r+" to "+e)},l.find=function(t,e){if(!t.signatures)throw new TypeError("Function is no typed-function");var r;if("string"==typeof e){r=e.split(",");for(var i=0;i<r.length;i++)r[i]=r[i].trim()}else{if(!Array.isArray(e))throw new TypeError("String array or a comma separated string expected");r=e}var o=r.join(","),n=t.signatures[o];if(n)return n;throw new TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+r.join(", ")+"))")},l.addType=function(t,e){if(!t||"string"!=typeof t.name||"function"!=typeof t.test)throw new TypeError("Object with properties {name: string, test: function} expected");if(!1!==e)for(var r=0;r<l.types.length;r++)if("Object"===l.types[r].name)return void l.types.splice(r,0,t);l.types.push(t)},l.addConversion=function(t){if(!t||"string"!=typeof t.from||"string"!=typeof t.to||"function"!=typeof t.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");l.conversions.push(t)},l}()})?i.apply(e,[]):i)||(t.exports=o)},function(t,e,r){var i=r(0);i(i.S,"Object",{create:r(38)})},function(t,e,r){t.exports=!r(8)&&!r(4)((function(){return 7!=Object.defineProperty(r(73)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,r){var i=r(9),o=r(2),n=r(47);t.exports=r(8)?Object.defineProperties:function(t,e){o(t);for(var r,a=n(e),s=a.length,l=0;s>l;)i.f(t,r=a[l++],e[r]);return t}},function(t,e,r){var i=r(16),o=r(17),n=r(57)(!1),a=r(74)("IE_PROTO");t.exports=function(t,e){var r,s=o(t),l=0,c=[];for(r in s)r!=a&&i(s,r)&&c.push(r);for(;e.length>l;)i(s,r=e[l++])&&(~n(c,r)||c.push(r));return c}},function(t,e,r){var i=r(0);i(i.S+i.F*!r(8),"Object",{defineProperty:r(9).f})},function(t,e,r){var i=r(0);i(i.S+i.F*!r(8),"Object",{defineProperties:r(104)})},function(t,e,r){var i=r(17),o=r(18).f;r(27)("getOwnPropertyDescriptor",(function(){return function(t,e){return o(i(t),e)}}))},function(t,e,r){var i=r(10),o=r(19);r(27)("getPrototypeOf",(function(){return function(t){return o(i(t))}}))},function(t,e,r){var i=r(10),o=r(47);r(27)("keys",(function(){return function(t){return o(i(t))}}))},function(t,e,r){r(27)("getOwnPropertyNames",(function(){return r(112).f}))},function(t,e,r){var i=r(17),o=r(40).f,n={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==n.call(t)?function(t){try{return o(t)}catch(t){return a.slice()}}(t):o(i(t))}},function(t,e,r){var i=r(5),o=r(32).onFreeze;r(27)("freeze",(function(t){return function(e){return t&&i(e)?t(o(e)):e}}))},function(t,e,r){var i=r(5),o=r(32).onFreeze;r(27)("seal",(function(t){return function(e){return t&&i(e)?t(o(e)):e}}))},function(t,e,r){var i=r(5),o=r(32).onFreeze;r(27)("preventExtensions",(function(t){return function(e){return t&&i(e)?t(o(e)):e}}))},function(t,e,r){var i=r(5);r(27)("isFrozen",(function(t){return function(e){return!i(e)||!!t&&t(e)}}))},function(t,e,r){var i=r(5);r(27)("isSealed",(function(t){return function(e){return!i(e)||!!t&&t(e)}}))},function(t,e,r){var i=r(5);r(27)("isExtensible",(function(t){return function(e){return!!i(e)&&(!t||t(e))}}))},function(t,e,r){var i=r(0);i(i.P,"Function",{bind:r(120)})},function(t,e,r){"use strict";var i=r(11),o=r(5),n=r(121),a=[].slice,s={};t.exports=Function.bind||function(t){var e=i(this),r=a.call(arguments,1),l=function(){var i=r.concat(a.call(arguments));return this instanceof l?function(t,e,r){if(!(e in s)){for(var i=[],o=0;o<e;o++)i[o]="a["+o+"]";s[e]=Function("F,a","return new F("+i.join(",")+")")}return s[e](t,r)}(e,i.length,i):n(e,i,t)};return o(e.prototype)&&(l.prototype=e.prototype),l}},function(t,e){t.exports=function(t,e,r){var i=void 0===r;switch(e.length){case 0:return i?t():t.call(r);case 1:return i?t(e[0]):t.call(r,e[0]);case 2:return i?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)}},function(t,e,r){var i=r(0);i(i.S,"Array",{isArray:r(58)})},function(t,e,r){"use strict";var i=r(0),o=r(17),n=[].join;i(i.P+i.F*(r(53)!=Object||!r(24)(n)),"Array",{join:function(t){return n.call(o(this),void 0===t?",":t)}})},function(t,e,r){"use strict";var i=r(0),o=r(76),n=r(22),a=r(39),s=r(6),l=[].slice;i(i.P+i.F*r(4)((function(){o&&l.call(o)})),"Array",{slice:function(t,e){var r=s(this.length),i=n(this);if(e=void 0===e?r:e,"Array"==i)return l.call(this,t,e);for(var o=a(t,r),c=a(e,r),h=s(c-o),u=new Array(h),d=0;d<h;d++)u[d]="String"==i?this.charAt(o+d):this[o+d];return u}})},function(t,e,r){"use strict";var i=r(0),o=r(11),n=r(10),a=r(4),s=[].sort,l=[1,2,3];i(i.P+i.F*(a((function(){l.sort(void 0)}))||!a((function(){l.sort(null)}))||!r(24)(s)),"Array",{sort:function(t){return void 0===t?s.call(n(this)):s.call(n(this),o(t))}})},function(t,e,r){"use strict";var i=r(0),o=r(28)(0),n=r(24)([].forEach,!0);i(i.P+i.F*!n,"Array",{forEach:function(t){return o(this,t,arguments[1])}})},function(t,e,r){"use strict";var i=r(0),o=r(28)(1);i(i.P+i.F*!r(24)([].map,!0),"Array",{map:function(t){return o(this,t,arguments[1])}})},function(t,e,r){"use strict";var i=r(0),o=r(28)(2);i(i.P+i.F*!r(24)([].filter,!0),"Array",{filter:function(t){return o(this,t,arguments[1])}})},function(t,e,r){"use strict";var i=r(0),o=r(28)(3);i(i.P+i.F*!r(24)([].some,!0),"Array",{some:function(t){return o(this,t,arguments[1])}})},function(t,e,r){"use strict";var i=r(0),o=r(28)(4);i(i.P+i.F*!r(24)([].every,!0),"Array",{every:function(t){return o(this,t,arguments[1])}})},function(t,e,r){"use strict";var i=r(0),o=r(132);i(i.P+i.F*!r(24)([].reduce,!0),"Array",{reduce:function(t){return o(this,t,arguments.length,arguments[1],!1)}})},function(t,e,r){var i=r(11),o=r(10),n=r(53),a=r(6);t.exports=function(t,e,r,s,l){i(e);var c=o(t),h=n(c),u=a(c.length),d=l?u-1:0,p=l?-1:1;if(r<2)for(;;){if(d in h){s=h[d],d+=p;break}if(d+=p,l?d<0:u<=d)throw TypeError("Reduce of empty array with no initial value")}for(;l?d>=0:u>d;d+=p)d in h&&(s=e(s,h[d],d,c));return s}},function(t,e,r){"use strict";var i=r(0),o=r(132);i(i.P+i.F*!r(24)([].reduceRight,!0),"Array",{reduceRight:function(t){return o(this,t,arguments.length,arguments[1],!0)}})},function(t,e,r){"use strict";var i=r(0),o=r(57)(!1),n=[].indexOf,a=!!n&&1/[1].indexOf(1,-0)<0;i(i.P+i.F*(a||!r(24)(n)),"Array",{indexOf:function(t){return a?n.apply(this,arguments)||0:o(this,t,arguments[1])}})},function(t,e,r){"use strict";var i=r(0),o=r(17),n=r(23),a=r(6),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;i(i.P+i.F*(l||!r(24)(s)),"Array",{lastIndexOf:function(t){if(l)return s.apply(this,arguments)||0;var e=o(this),r=a(e.length),i=r-1;for(arguments.length>1&&(i=Math.min(i,n(arguments[1]))),i<0&&(i=r+i);i>=0;i--)if(i in e&&e[i]===t)return i||0;return-1}})},function(t,e,r){"use strict";var i=r(0),o=r(23),n=r(137),a=r(78),s=1..toFixed,l=Math.floor,c=[0,0,0,0,0,0],h="Number.toFixed: incorrect invocation!",u=function(t,e){for(var r=-1,i=e;++r<6;)i+=t*c[r],c[r]=i%1e7,i=l(i/1e7)},d=function(t){for(var e=6,r=0;--e>=0;)r+=c[e],c[e]=l(r/t),r=r%t*1e7},p=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==c[t]){var r=String(c[t]);e=""===e?r:e+a.call("0",7-r.length)+r}return e},f=function(t,e,r){return 0===e?r:e%2==1?f(t,e-1,r*t):f(t*t,e/2,r)};i(i.P+i.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)((function(){s.call({})}))),"Number",{toFixed:function(t){var e,r,i,s,l=n(this,h),c=o(t),g="",m="0";if(c<0||c>20)throw RangeError(h);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(g="-",l=-l),l>1e-21)if(r=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(l*f(2,69,1))-69)<0?l*f(2,-e,1):l/f(2,e,1),r*=4503599627370496,(e=52-e)>0){for(u(0,r),i=c;i>=7;)u(1e7,0),i-=7;for(u(f(10,i,1),0),i=e-1;i>=23;)d(1<<23),i-=23;d(1<<i),u(1,1),d(2),m=p()}else u(0,r),u(1<<-e,0),m=p()+a.call("0",c);return c>0?g+((s=m.length)<=c?"0."+a.call("0",c-s)+m:m.slice(0,s-c)+"."+m.slice(s-c)):g+m}})},function(t,e,r){var i=r(22);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=i(t))throw TypeError(e);return+t}},function(t,e,r){"use strict";var i=r(0),o=r(4),n=r(137),a=1..toPrecision;i(i.P+i.F*(o((function(){return"1"!==a.call(1,void 0)}))||!o((function(){a.call({})}))),"Number",{toPrecision:function(t){var e=n(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(e):a.call(e,t)}})},function(t,e,r){var i=r(0);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,r){var i=r(0),o=r(186);i(i.P+i.F*(Date.prototype.toISOString!==o),"Date",{toISOString:o})},function(t,e,r){"use strict";var i=r(0),o=r(10),n=r(25);i(i.P+i.F*r(4)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(t){var e=o(this),r=n(e);return"number"!=typeof r||isFinite(r)?e.toISOString():null}})},function(t,e,r){var i=r(0),o=r(143);i(i.G+i.F*(parseInt!=o),{parseInt:o})},function(t,e,r){var i=r(3).parseInt,o=r(48).trim,n=r(79),a=/^[-+]?0[xX]/;t.exports=8!==i(n+"08")||22!==i(n+"0x16")?function(t,e){var r=o(String(t),3);return i(r,e>>>0||(a.test(r)?16:10))}:i},function(t,e,r){var i=r(0),o=r(145);i(i.G+i.F*(parseFloat!=o),{parseFloat:o})},function(t,e,r){var i=r(3).parseFloat,o=r(48).trim;t.exports=1/i(r(79)+"-0")!=-1/0?function(t){var e=o(String(t),3),r=i(e);return 0===r&&"-"==e.charAt(0)?-0:r}:i},function(t,e,r){"use strict";r(48)("trim",(function(t){return function(){return t(this,3)}}))},function(t,e,r){"use strict";r(148);var i=r(2),o=r(55),n=r(8),a=/./.toString,s=function(t){r(15)(RegExp.prototype,"toString",t,!0)};r(4)((function(){return"/a/b"!=a.call({source:"a",flags:"b"})}))?s((function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!n&&t instanceof RegExp?o.call(t):void 0)})):"toString"!=a.name&&s((function(){return a.call(this)}))},function(t,e,r){r(8)&&"g"!=/./g.flags&&r(9).f(RegExp.prototype,"flags",{configurable:!0,get:r(55)})},function(t,e,r){e.f=r(7)},function(t,e,r){"use strict";var i=r(8),o=r(47),n=r(59),a=r(54),s=r(10),l=r(53),c=Object.assign;t.exports=!c||r(4)((function(){var t={},e={},r=Symbol(),i="abcdefghijklmnopqrst";return t[r]=7,i.split("").forEach((function(t){e[t]=t})),7!=c({},t)[r]||Object.keys(c({},e)).join("")!=i}))?function(t,e){for(var r=s(t),c=arguments.length,h=1,u=n.f,d=a.f;c>h;)for(var p,f=l(arguments[h++]),g=u?o(f).concat(u(f)):o(f),m=g.length,y=0;m>y;)p=g[y++],i&&!d.call(f,p)||(r[p]=f[p]);return r}:c},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,r){var i=r(5),o=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&o(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,r){var i=r(83),o=Math.pow,n=o(2,-52),a=o(2,-23),s=o(2,127)*(2-a),l=o(2,-126);t.exports=Math.fround||function(t){var e,r,o=Math.abs(t),c=i(t);return o<l?c*(o/l/a+1/n-1/n)*l*a:(r=(e=(1+a/n)*o)-(e-o))>s||r!=r?c*(1/0):c*r}},function(t,e,r){var i=r(2);t.exports=function(t,e,r,o){try{return o?e(i(r)[0],r[1]):e(r)}catch(e){var n=t.return;throw void 0!==n&&i(n.call(t)),e}}},function(t,e,r){"use strict";var i=r(10),o=r(39),n=r(6);t.exports=[].copyWithin||function(t,e){var r=i(this),a=n(r.length),s=o(t,a),l=o(e,a),c=arguments.length>2?arguments[2]:void 0,h=Math.min((void 0===c?a:o(c,a))-l,a-s),u=1;for(l<s&&s<l+h&&(u=-1,l+=h-1,s+=h-1);h-- >0;)l in r?r[s]=r[l]:delete r[s],s+=u,l+=u;return r}},function(t,e,r){"use strict";var i=r(33),o=r(158),n=r(56),a=r(17);t.exports=r(85)(Array,"Array",(function(t,e){this._t=a(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,o(1)):o(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])}),"values"),n.Arguments=n.Array,i("keys"),i("values"),i("entries")},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,r){"use strict";var i=r(93);r(0)({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},function(t,e,r){var i,o,n,a=r(21),s=r(121),l=r(76),c=r(73),h=r(3),u=h.process,d=h.setImmediate,p=h.clearImmediate,f=h.MessageChannel,g=h.Dispatch,m=0,y={},v=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},_=function(t){v.call(t.data)};d&&p||(d=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return y[++m]=function(){s("function"==typeof t?t:Function(t),e)},i(m),m},p=function(t){delete y[t]},"process"==r(22)(u)?i=function(t){u.nextTick(a(v,t,1))}:g&&g.now?i=function(t){g.now(a(v,t,1))}:f?(n=(o=new f).port2,o.port1.onmessage=_,i=a(n.postMessage,n,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(i=function(t){h.postMessage(t+"","*")},h.addEventListener("message",_,!1)):i="onreadystatechange"in c("script")?function(t){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),v.call(t)}}:function(t){setTimeout(a(v,t,1),0)}),t.exports={set:d,clear:p}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,r){"use strict";var i=r(163),o=r(45);t.exports=r(66)("Map",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=i.getEntry(o(this,"Map"),t);return e&&e.v},set:function(t,e){return i.def(o(this,"Map"),0===t?0:t,e)}},i,!0)},function(t,e,r){"use strict";var i=r(9).f,o=r(38),n=r(44),a=r(21),s=r(42),l=r(43),c=r(85),h=r(158),u=r(41),d=r(8),p=r(32).fastKey,f=r(45),g=d?"_s":"size",m=function(t,e){var r,i=p(e);if("F"!==i)return t._i[i];for(r=t._f;r;r=r.n)if(r.k==e)return r};t.exports={getConstructor:function(t,e,r,c){var h=t((function(t,i){s(t,h,e,"_i"),t._t=e,t._i=o(null),t._f=void 0,t._l=void 0,t[g]=0,null!=i&&l(i,r,t[c],t)}));return n(h.prototype,{clear:function(){for(var t=f(this,e),r=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete r[i.i];t._f=t._l=void 0,t[g]=0},delete:function(t){var r=f(this,e),i=m(r,t);if(i){var o=i.n,n=i.p;delete r._i[i.i],i.r=!0,n&&(n.n=o),o&&(o.p=n),r._f==i&&(r._f=o),r._l==i&&(r._l=n),r[g]--}return!!i},forEach:function(t){f(this,e);for(var r,i=a(t,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(i(r.v,r.k,this);r&&r.r;)r=r.p},has:function(t){return!!m(f(this,e),t)}}),d&&i(h.prototype,"size",{get:function(){return f(this,e)[g]}}),h},def:function(t,e,r){var i,o,n=m(t,e);return n?n.v=r:(t._l=n={i:o=p(e,!0),k:e,v:r,p:i=t._l,n:void 0,r:!1},t._f||(t._f=n),i&&(i.n=n),t[g]++,"F"!==o&&(t._i[o]=n)),t},getEntry:m,setStrong:function(t,e,r){c(t,e,(function(t,r){this._t=f(t,e),this._k=r,this._l=void 0}),(function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?h(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,h(1))}),r?"entries":"values",!r,!0),u(e)}}},function(t,e,r){"use strict";var i=r(163),o=r(45);t.exports=r(66)("Set",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return i.def(o(this,"Set"),t=0===t?0:t,t)}},i)},function(t,e,r){"use strict";var i,o=r(3),n=r(28)(0),a=r(15),s=r(32),l=r(150),c=r(166),h=r(5),u=r(45),d=r(45),p=!o.ActiveXObject&&"ActiveXObject"in o,f=s.getWeak,g=Object.isExtensible,m=c.ufstore,y=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(t){if(h(t)){var e=f(t);return!0===e?m(u(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return c.def(u(this,"WeakMap"),t,e)}},_=t.exports=r(66)("WeakMap",y,v,c,!0,!0);d&&p&&(l((i=c.getConstructor(y,"WeakMap")).prototype,v),s.NEED=!0,n(["delete","has","get","set"],(function(t){var e=_.prototype,r=e[t];a(e,t,(function(e,o){if(h(e)&&!g(e)){this._f||(this._f=new i);var n=this._f[t](e,o);return"set"==t?this:n}return r.call(this,e,o)}))})))},function(t,e,r){"use strict";var i=r(44),o=r(32).getWeak,n=r(2),a=r(5),s=r(42),l=r(43),c=r(28),h=r(16),u=r(45),d=c(5),p=c(6),f=0,g=function(t){return t._l||(t._l=new m)},m=function(){this.a=[]},y=function(t,e){return d(t.a,(function(t){return t[0]===e}))};m.prototype={get:function(t){var e=y(this,t);if(e)return e[1]},has:function(t){return!!y(this,t)},set:function(t,e){var r=y(this,t);r?r[1]=e:this.a.push([t,e])},delete:function(t){var e=p(this.a,(function(e){return e[0]===t}));return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,r,n){var c=t((function(t,i){s(t,c,e,"_i"),t._t=e,t._i=f++,t._l=void 0,null!=i&&l(i,r,t[n],t)}));return i(c.prototype,{delete:function(t){if(!a(t))return!1;var r=o(t);return!0===r?g(u(this,e)).delete(t):r&&h(r,this._i)&&delete r[this._i]},has:function(t){if(!a(t))return!1;var r=o(t);return!0===r?g(u(this,e)).has(t):r&&h(r,this._i)}}),c},def:function(t,e,r){var i=o(n(e),!0);return!0===i?g(t).set(e,r):i[t._i]=r,t},ufstore:g}},function(t,e,r){var i=r(23),o=r(6);t.exports=function(t){if(void 0===t)return 0;var e=i(t),r=o(e);if(e!==r)throw RangeError("Wrong length!");return r}},function(t,e,r){var i=r(40),o=r(59),n=r(2),a=r(3).Reflect;t.exports=a&&a.ownKeys||function(t){var e=i.f(n(t)),r=o.f;return r?e.concat(r(t)):e}},function(t,e,r){"use strict";var i=r(58),o=r(5),n=r(6),a=r(21),s=r(7)("isConcatSpreadable");t.exports=function t(e,r,l,c,h,u,d,p){for(var f,g,m=h,y=0,v=!!d&&a(d,p,3);y<c;){if(y in l){if(f=v?v(l[y],y,r):l[y],g=!1,o(f)&&(g=void 0!==(g=f[s])?!!g:i(f)),g&&u>0)m=t(e,r,f,n(f.length),m,u-1)-1;else{if(m>=9007199254740991)throw TypeError();e[m]=f}m++}y++}return m}},function(t,e,r){var i=r(6),o=r(78),n=r(26);t.exports=function(t,e,r,a){var s=String(n(t)),l=s.length,c=void 0===r?" ":String(r),h=i(e);if(h<=l||""==c)return s;var u=h-l,d=o.call(c,Math.ceil(u/c.length));return d.length>u&&(d=d.slice(0,u)),a?d+s:s+d}},function(t,e,r){var i=r(8),o=r(47),n=r(17),a=r(54).f;t.exports=function(t){return function(e){for(var r,s=n(e),l=o(s),c=l.length,h=0,u=[];c>h;)r=l[h++],i&&!a.call(s,r)||u.push(t?[r,s[r]]:s[r]);return u}}},function(t,e,r){var i=r(50),o=r(173);t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return o(this)}}},function(t,e,r){var i=r(43);t.exports=function(t,e){var r=[];return i(t,!1,r.push,r,e),r}},function(t,e){t.exports=Math.scale||function(t,e,r,i,o){return 0===arguments.length||t!=t||e!=e||r!=r||i!=i||o!=o?NaN:t===1/0||t===-1/0?t:(t-e)*(o-i)/(r-e)+i}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){function r(){}r.prototype={on:function(t,e,r){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:r}),this},once:function(t,e,r){var i=this;function o(){i.off(t,o),e.apply(r,arguments)}return o._=e,this.on(t,o,r)},emit:function(t){for(var e=[].slice.call(arguments,1),r=((this.e||(this.e={}))[t]||[]).slice(),i=0,o=r.length;i<o;i++)r[i].fn.apply(r[i].ctx,e);return this},off:function(t,e){var r=this.e||(this.e={}),i=r[t],o=[];if(i&&e)for(var n=0,a=i.length;n<a;n++)i[n].fn!==e&&i[n].fn._!==e&&o.push(i[n]);return o.length?r[t]=o:delete r[t],this}},t.exports=r,t.exports.TinyEmitter=r},function(t,e){t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){"use strict";t.exports=function(t,e,r,i){var o=self||window;try{try{var n;try{n=new o.Blob([t])}catch(e){(n=new(o.BlobBuilder||o.WebKitBlobBuilder||o.MozBlobBuilder||o.MSBlobBuilder)).append(t),n=n.getBlob()}var a=o.URL||o.webkitURL,s=a.createObjectURL(n),l=new o[e](s,r);return a.revokeObjectURL(s),l}catch(i){return new o[e]("data:application/javascript,".concat(encodeURIComponent(t)),r)}}catch(t){if(!i)throw Error("Inline worker is not supported");return new o[e](i,r)}}},function(t,e,r){!function(){function e(t){return Math.sqrt(t.x*t.x+t.y*t.y)}var r=function(t){this.handlers=[],this.el=t};function i(t,e){var i=new r(t);return i.add(e),i}r.prototype.add=function(t){this.handlers.push(t)},r.prototype.del=function(t){t||(this.handlers=[]);for(var e=this.handlers.length;e>=0;e--)this.handlers[e]===t&&this.handlers.splice(e,1)},r.prototype.dispatch=function(){for(var t=0,e=this.handlers.length;t<e;t++){var r=this.handlers[t];"function"==typeof r&&r.apply(this.el,arguments)}};var o=function(t,e){this.element="string"==typeof t?document.querySelector(t):t,this.start=this.start.bind(this),this.move=this.move.bind(this),this.end=this.end.bind(this),this.cancel=this.cancel.bind(this),this.element.addEventListener("touchstart",this.start,!1),this.element.addEventListener("touchmove",this.move,!1),this.element.addEventListener("touchend",this.end,!1),this.element.addEventListener("touchcancel",this.cancel,!1),this.preV={x:null,y:null},this.pinchStartLen=null,this.zoom=1,this.isDoubleTap=!1;var r=function(){};this.rotate=i(this.element,e.rotate||r),this.touchStart=i(this.element,e.touchStart||r),this.multipointStart=i(this.element,e.multipointStart||r),this.multipointEnd=i(this.element,e.multipointEnd||r),this.pinch=i(this.element,e.pinch||r),this.swipe=i(this.element,e.swipe||r),this.tap=i(this.element,e.tap||r),this.doubleTap=i(this.element,e.doubleTap||r),this.longTap=i(this.element,e.longTap||r),this.singleTap=i(this.element,e.singleTap||r),this.pressMove=i(this.element,e.pressMove||r),this.twoFingerPressMove=i(this.element,e.twoFingerPressMove||r),this.touchMove=i(this.element,e.touchMove||r),this.touchEnd=i(this.element,e.touchEnd||r),this.touchCancel=i(this.element,e.touchCancel||r),this._cancelAllHandler=this.cancelAll.bind(this),window.addEventListener("scroll",this._cancelAllHandler),this.delta=null,this.last=null,this.now=null,this.tapTimeout=null,this.singleTapTimeout=null,this.longTapTimeout=null,this.swipeTimeout=null,this.x1=this.x2=this.y1=this.y2=null,this.preTapPosition={x:null,y:null}};o.prototype={start:function(t){if(t.touches){this.now=Date.now(),this.x1=t.touches[0].pageX,this.y1=t.touches[0].pageY,this.delta=this.now-(this.last||this.now),this.touchStart.dispatch(t,this.element),null!==this.preTapPosition.x&&(this.isDoubleTap=this.delta>0&&this.delta<=250&&Math.abs(this.preTapPosition.x-this.x1)<30&&Math.abs(this.preTapPosition.y-this.y1)<30,this.isDoubleTap&&clearTimeout(this.singleTapTimeout)),this.preTapPosition.x=this.x1,this.preTapPosition.y=this.y1,this.last=this.now;var r=this.preV;if(t.touches.length>1){this._cancelLongTap(),this._cancelSingleTap();var i={x:t.touches[1].pageX-this.x1,y:t.touches[1].pageY-this.y1};r.x=i.x,r.y=i.y,this.pinchStartLen=e(r),this.multipointStart.dispatch(t,this.element)}this._preventTap=!1,this.longTapTimeout=setTimeout(function(){this.longTap.dispatch(t,this.element),this._preventTap=!0}.bind(this),750)}},move:function(t){if(t.touches){var r=this.preV,i=t.touches.length,o=t.touches[0].pageX,n=t.touches[0].pageY;if(this.isDoubleTap=!1,i>1){var a=t.touches[1].pageX,s=t.touches[1].pageY,l={x:t.touches[1].pageX-o,y:t.touches[1].pageY-n};null!==r.x&&(this.pinchStartLen>0&&(t.zoom=e(l)/this.pinchStartLen,this.pinch.dispatch(t,this.element)),t.angle=function(t,r){var i=function(t,r){var i=e(t)*e(r);if(0===i)return 0;var o=function(t,e){return t.x*e.x+t.y*e.y}(t,r)/i;return o>1&&(o=1),Math.acos(o)}(t,r);return function(t,e){return t.x*e.y-e.x*t.y}(t,r)>0&&(i*=-1),180*i/Math.PI}(l,r),this.rotate.dispatch(t,this.element)),r.x=l.x,r.y=l.y,null!==this.x2&&null!==this.sx2?(t.deltaX=(o-this.x2+a-this.sx2)/2,t.deltaY=(n-this.y2+s-this.sy2)/2):(t.deltaX=0,t.deltaY=0),this.twoFingerPressMove.dispatch(t,this.element),this.sx2=a,this.sy2=s}else{if(null!==this.x2){t.deltaX=o-this.x2,t.deltaY=n-this.y2;var c=Math.abs(this.x1-this.x2),h=Math.abs(this.y1-this.y2);(c>10||h>10)&&(this._preventTap=!0)}else t.deltaX=0,t.deltaY=0;this.pressMove.dispatch(t,this.element)}this.touchMove.dispatch(t,this.element),this._cancelLongTap(),this.x2=o,this.y2=n,i>1&&t.preventDefault()}},end:function(t){if(t.changedTouches){this._cancelLongTap();var e=this;t.touches.length<2&&(this.multipointEnd.dispatch(t,this.element),this.sx2=this.sy2=null),this.x2&&Math.abs(this.x1-this.x2)>30||this.y2&&Math.abs(this.y1-this.y2)>30?(t.direction=this._swipeDirection(this.x1,this.x2,this.y1,this.y2),this.swipeTimeout=setTimeout((function(){e.swipe.dispatch(t,e.element)}),0)):(this.tapTimeout=setTimeout((function(){e._preventTap||e.tap.dispatch(t,e.element),e.isDoubleTap&&(e.doubleTap.dispatch(t,e.element),e.isDoubleTap=!1)}),0),e.isDoubleTap||(e.singleTapTimeout=setTimeout((function(){e.singleTap.dispatch(t,e.element)}),250))),this.touchEnd.dispatch(t,this.element),this.preV.x=0,this.preV.y=0,this.zoom=1,this.pinchStartLen=null,this.x1=this.x2=this.y1=this.y2=null}},cancelAll:function(){this._preventTap=!0,clearTimeout(this.singleTapTimeout),clearTimeout(this.tapTimeout),clearTimeout(this.longTapTimeout),clearTimeout(this.swipeTimeout)},cancel:function(t){this.cancelAll(),this.touchCancel.dispatch(t,this.element)},_cancelLongTap:function(){clearTimeout(this.longTapTimeout)},_cancelSingleTap:function(){clearTimeout(this.singleTapTimeout)},_swipeDirection:function(t,e,r,i){return Math.abs(t-e)>=Math.abs(r-i)?t-e>0?"Left":"Right":r-i>0?"Up":"Down"},on:function(t,e){this[t]&&this[t].add(e)},off:function(t,e){this[t]&&this[t].del(e)},destroy:function(){return this.singleTapTimeout&&clearTimeout(this.singleTapTimeout),this.tapTimeout&&clearTimeout(this.tapTimeout),this.longTapTimeout&&clearTimeout(this.longTapTimeout),this.swipeTimeout&&clearTimeout(this.swipeTimeout),this.element.removeEventListener("touchstart",this.start),this.element.removeEventListener("touchmove",this.move),this.element.removeEventListener("touchend",this.end),this.element.removeEventListener("touchcancel",this.cancel),this.rotate.del(),this.touchStart.del(),this.multipointStart.del(),this.multipointEnd.del(),this.pinch.del(),this.swipe.del(),this.tap.del(),this.doubleTap.del(),this.longTap.del(),this.singleTap.del(),this.pressMove.del(),this.twoFingerPressMove.del(),this.touchMove.del(),this.touchEnd.del(),this.touchCancel.del(),this.preV=this.pinchStartLen=this.zoom=this.isDoubleTap=this.delta=this.last=this.now=this.tapTimeout=this.singleTapTimeout=this.longTapTimeout=this.swipeTimeout=this.x1=this.x2=this.y1=this.y2=this.preTapPosition=this.rotate=this.touchStart=this.multipointStart=this.multipointEnd=this.pinch=this.swipe=this.tap=this.doubleTap=this.longTap=this.singleTap=this.pressMove=this.touchMove=this.touchEnd=this.touchCancel=this.twoFingerPressMove=null,window.removeEventListener("scroll",this._cancelAllHandler),null}},t.exports=o}()},function(t,e){t.exports=i;var r=null;try{r=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function i(t,e,r){this.low=0|t,this.high=0|e,this.unsigned=!!r}function o(t){return!0===(t&&t.__isLong__)}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=o;var n={},a={};function s(t,e){var r,i,o;return e?(o=0<=(t>>>=0)&&t<256)&&(i=a[t])?i:(r=c(t,(0|t)<0?-1:0,!0),o&&(a[t]=r),r):(o=-128<=(t|=0)&&t<128)&&(i=n[t])?i:(r=c(t,t<0?-1:0,!1),o&&(n[t]=r),r)}function l(t,e){if(isNaN(t))return e?v:y;if(e){if(t<0)return v;if(t>=f)return S}else{if(t<=-g)return x;if(t+1>=g)return b}return t<0?l(-t,e).neg():c(t%p|0,t/p|0,e)}function c(t,e,r){return new i(t,e,r)}i.fromInt=s,i.fromNumber=l,i.fromBits=c;var h=Math.pow;function u(t,e,r){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return y;if("number"==typeof e?(r=e,e=!1):e=!!e,(r=r||10)<2||36<r)throw RangeError("radix");var i;if((i=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return u(t.substring(1),e,r).neg();for(var o=l(h(r,8)),n=y,a=0;a<t.length;a+=8){var s=Math.min(8,t.length-a),c=parseInt(t.substring(a,a+s),r);if(s<8){var d=l(h(r,s));n=n.mul(d).add(l(c))}else n=(n=n.mul(o)).add(l(c))}return n.unsigned=e,n}function d(t,e){return"number"==typeof t?l(t,e):"string"==typeof t?u(t,e):c(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}i.fromString=u,i.fromValue=d;var p=4294967296,f=p*p,g=f/2,m=s(1<<24),y=s(0);i.ZERO=y;var v=s(0,!0);i.UZERO=v;var _=s(1);i.ONE=_;var E=s(1,!0);i.UONE=E;var T=s(-1);i.NEG_ONE=T;var b=c(-1,2147483647,!1);i.MAX_VALUE=b;var S=c(-1,-1,!0);i.MAX_UNSIGNED_VALUE=S;var x=c(0,-2147483648,!1);i.MIN_VALUE=x;var w=i.prototype;w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},w.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(x)){var e=l(t),r=this.div(e),i=r.mul(e).sub(this);return r.toString(t)+i.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var o=l(h(t,6),this.unsigned),n=this,a="";;){var s=n.div(o),c=(n.sub(s.mul(o)).toInt()>>>0).toString(t);if((n=s).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(x)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},w.isZero=function(){return 0===this.high&&0===this.low},w.eqz=w.isZero,w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||this.high>=0},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(t){return o(t)||(t=d(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},w.eq=w.equals,w.notEquals=function(t){return!this.eq(t)},w.neq=w.notEquals,w.ne=w.notEquals,w.lessThan=function(t){return this.comp(t)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(t){return this.comp(t)<=0},w.lte=w.lessThanOrEqual,w.le=w.lessThanOrEqual,w.greaterThan=function(t){return this.comp(t)>0},w.gt=w.greaterThan,w.greaterThanOrEqual=function(t){return this.comp(t)>=0},w.gte=w.greaterThanOrEqual,w.ge=w.greaterThanOrEqual,w.compare=function(t){if(o(t)||(t=d(t)),this.eq(t))return 0;var e=this.isNegative(),r=t.isNegative();return e&&!r?-1:!e&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(x)?x:this.not().add(_)},w.neg=w.negate,w.add=function(t){o(t)||(t=d(t));var e=this.high>>>16,r=65535&this.high,i=this.low>>>16,n=65535&this.low,a=t.high>>>16,s=65535&t.high,l=t.low>>>16,h=0,u=0,p=0,f=0;return p+=(f+=n+(65535&t.low))>>>16,u+=(p+=i+l)>>>16,h+=(u+=r+s)>>>16,h+=e+a,c((p&=65535)<<16|(f&=65535),(h&=65535)<<16|(u&=65535),this.unsigned)},w.subtract=function(t){return o(t)||(t=d(t)),this.add(t.neg())},w.sub=w.subtract,w.multiply=function(t){if(this.isZero())return y;if(o(t)||(t=d(t)),r)return c(r.mul(this.low,this.high,t.low,t.high),r.get_high(),this.unsigned);if(t.isZero())return y;if(this.eq(x))return t.isOdd()?x:y;if(t.eq(x))return this.isOdd()?x:y;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(m)&&t.lt(m))return l(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,i=65535&this.high,n=this.low>>>16,a=65535&this.low,s=t.high>>>16,h=65535&t.high,u=t.low>>>16,p=65535&t.low,f=0,g=0,v=0,_=0;return v+=(_+=a*p)>>>16,g+=(v+=n*p)>>>16,v&=65535,g+=(v+=a*u)>>>16,f+=(g+=i*p)>>>16,g&=65535,f+=(g+=n*u)>>>16,g&=65535,f+=(g+=a*h)>>>16,f+=e*p+i*u+n*h+a*s,c((v&=65535)<<16|(_&=65535),(f&=65535)<<16|(g&=65535),this.unsigned)},w.mul=w.multiply,w.divide=function(t){if(o(t)||(t=d(t)),t.isZero())throw Error("division by zero");var e,i,n;if(r)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?c((this.unsigned?r.div_u:r.div_s)(this.low,this.high,t.low,t.high),r.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:y;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return v;if(t.gt(this.shru(1)))return E;n=v}else{if(this.eq(x))return t.eq(_)||t.eq(T)?x:t.eq(x)?_:(e=this.shr(1).div(t).shl(1)).eq(y)?t.isNegative()?_:T:(i=this.sub(t.mul(e)),n=e.add(i.div(t)));if(t.eq(x))return this.unsigned?v:y;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();n=y}for(i=this;i.gte(t);){e=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(e)/Math.LN2),s=a<=48?1:h(2,a-48),u=l(e),p=u.mul(t);p.isNegative()||p.gt(i);)p=(u=l(e-=s,this.unsigned)).mul(t);u.isZero()&&(u=_),n=n.add(u),i=i.sub(p)}return n},w.div=w.divide,w.modulo=function(t){return o(t)||(t=d(t)),r?c((this.unsigned?r.rem_u:r.rem_s)(this.low,this.high,t.low,t.high),r.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},w.mod=w.modulo,w.rem=w.modulo,w.not=function(){return c(~this.low,~this.high,this.unsigned)},w.and=function(t){return o(t)||(t=d(t)),c(this.low&t.low,this.high&t.high,this.unsigned)},w.or=function(t){return o(t)||(t=d(t)),c(this.low|t.low,this.high|t.high,this.unsigned)},w.xor=function(t){return o(t)||(t=d(t)),c(this.low^t.low,this.high^t.high,this.unsigned)},w.shiftLeft=function(t){return o(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):c(0,this.low<<t-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(t){return o(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):c(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(t){if(o(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?c(this.low>>>t|e<<32-t,e>>>t,this.unsigned):c(32===t?e:e>>>t-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.shr_u=w.shiftRightUnsigned,w.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},w.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},w.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},i.fromBytes=function(t,e,r){return r?i.fromBytesLE(t,e):i.fromBytesBE(t,e)},i.fromBytesLE=function(t,e){return new i(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},i.fromBytesBE=function(t,e){return new i(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},function(t,e,r){r(102),r(106),r(107),r(108),r(109),r(110),r(111),r(113),r(114),r(115),r(116),r(117),r(118),r(119),r(122),r(123),r(124),r(125),r(126),r(127),r(128),r(129),r(130),r(131),r(133),r(134),r(135),r(136),r(138),r(139),r(140),r(141),r(142),r(144),r(146),r(147),t.exports=r(20)},function(t,e,r){t.exports=r(52)("native-function-to-string",Function.toString)},function(t,e,r){var i=r(5),o=r(58),n=r(7)("species");t.exports=function(t){var e;return o(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!o(e.prototype)||(e=void 0),i(e)&&null===(e=e[n])&&(e=void 0)),void 0===e?Array:e}},function(t,e,r){"use strict";var i=r(4),o=Date.prototype.getTime,n=Date.prototype.toISOString,a=function(t){return t>9?t:"0"+t};t.exports=i((function(){return"0385-07-25T07:06:39.999Z"!=n.call(new Date(-50000000000001))}))||!i((function(){n.call(new Date(NaN))}))?function(){if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),r=t.getUTCMilliseconds(),i=e<0?"-":e>9999?"+":"";return i+("00000"+Math.abs(e)).slice(i?-6:-4)+"-"+a(t.getUTCMonth()+1)+"-"+a(t.getUTCDate())+"T"+a(t.getUTCHours())+":"+a(t.getUTCMinutes())+":"+a(t.getUTCSeconds())+"."+(r>99?r:"0"+a(r))+"Z"}:n},function(t,e,r){r(188),r(102),r(106),r(107),r(108),r(109),r(110),r(111),r(113),r(114),r(115),r(116),r(117),r(118),r(190),r(191),r(192),r(193),r(119),r(194),r(195),r(142),r(144),r(196),r(136),r(138),r(197),r(198),r(199),r(200),r(201),r(202),r(203),r(204),r(205),r(206),r(207),r(208),r(209),r(210),r(211),r(212),r(213),r(214),r(215),r(216),r(217),r(218),r(219),r(220),r(221),r(222),r(223),r(224),r(146),r(225),r(226),r(227),r(228),r(229),r(230),r(231),r(232),r(233),r(234),r(235),r(236),r(237),r(238),r(239),r(240),r(241),r(242),r(243),r(139),r(141),r(140),r(244),r(245),r(122),r(247),r(248),r(123),r(124),r(125),r(126),r(127),r(128),r(129),r(130),r(131),r(133),r(134),r(135),r(249),r(250),r(251),r(252),r(253),r(157),r(254),r(159),r(147),r(148),r(255),r(256),r(257),r(258),r(259),r(162),r(164),r(165),r(261),r(262),r(263),r(264),r(265),r(266),r(267),r(268),r(269),r(270),r(271),r(272),r(273),r(274),r(275),r(276),r(277),r(278),r(279),r(280),r(281),r(282),r(283),r(284),r(285),r(286),t.exports=r(20)},function(t,e,r){"use strict";var i=r(3),o=r(16),n=r(8),a=r(0),s=r(15),l=r(32).KEY,c=r(4),h=r(52),u=r(49),d=r(37),p=r(7),f=r(149),g=r(80),m=r(189),y=r(58),v=r(2),_=r(5),E=r(10),T=r(17),b=r(25),S=r(36),x=r(38),w=r(112),O=r(18),I=r(59),A=r(9),D=r(47),C=O.f,P=A.f,L=w.f,M=i.Symbol,R=i.JSON,N=R&&R.stringify,B=p("_hidden"),k=p("toPrimitive"),F={}.propertyIsEnumerable,U=h("symbol-registry"),H=h("symbols"),G=h("op-symbols"),q=Object.prototype,W="function"==typeof M&&!!I.f,Y=i.QObject,z=!Y||!Y.prototype||!Y.prototype.findChild,j=n&&c((function(){return 7!=x(P({},"a",{get:function(){return P(this,"a",{value:7}).a}})).a}))?function(t,e,r){var i=C(q,e);i&&delete q[e],P(t,e,r),i&&t!==q&&P(q,e,i)}:P,V=function(t){var e=H[t]=x(M.prototype);return e._k=t,e},X=W&&"symbol"==typeof M.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof M},J=function(t,e,r){return t===q&&J(G,e,r),v(t),e=b(e,!0),v(r),o(H,e)?(r.enumerable?(o(t,B)&&t[B][e]&&(t[B][e]=!1),r=x(r,{enumerable:S(0,!1)})):(o(t,B)||P(t,B,S(1,{})),t[B][e]=!0),j(t,e,r)):P(t,e,r)},K=function(t,e){v(t);for(var r,i=m(e=T(e)),o=0,n=i.length;n>o;)J(t,r=i[o++],e[r]);return t},Z=function(t){var e=F.call(this,t=b(t,!0));return!(this===q&&o(H,t)&&!o(G,t))&&(!(e||!o(this,t)||!o(H,t)||o(this,B)&&this[B][t])||e)},Q=function(t,e){if(t=T(t),e=b(e,!0),t!==q||!o(H,e)||o(G,e)){var r=C(t,e);return!r||!o(H,e)||o(t,B)&&t[B][e]||(r.enumerable=!0),r}},$=function(t){for(var e,r=L(T(t)),i=[],n=0;r.length>n;)o(H,e=r[n++])||e==B||e==l||i.push(e);return i},tt=function(t){for(var e,r=t===q,i=L(r?G:T(t)),n=[],a=0;i.length>a;)!o(H,e=i[a++])||r&&!o(q,e)||n.push(H[e]);return n};W||(s((M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(r){this===q&&e.call(G,r),o(this,B)&&o(this[B],t)&&(this[B][t]=!1),j(this,t,S(1,r))};return n&&z&&j(q,t,{configurable:!0,set:e}),V(t)}).prototype,"toString",(function(){return this._k})),O.f=Q,A.f=J,r(40).f=w.f=$,r(54).f=Z,I.f=tt,n&&!r(31)&&s(q,"propertyIsEnumerable",Z,!0),f.f=function(t){return V(p(t))}),a(a.G+a.W+a.F*!W,{Symbol:M});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;et.length>rt;)p(et[rt++]);for(var it=D(p.store),ot=0;it.length>ot;)g(it[ot++]);a(a.S+a.F*!W,"Symbol",{for:function(t){return o(U,t+="")?U[t]:U[t]=M(t)},keyFor:function(t){if(!X(t))throw TypeError(t+" is not a symbol!");for(var e in U)if(U[e]===t)return e},useSetter:function(){z=!0},useSimple:function(){z=!1}}),a(a.S+a.F*!W,"Object",{create:function(t,e){return void 0===e?x(t):K(x(t),e)},defineProperty:J,defineProperties:K,getOwnPropertyDescriptor:Q,getOwnPropertyNames:$,getOwnPropertySymbols:tt});var nt=c((function(){I.f(1)}));a(a.S+a.F*nt,"Object",{getOwnPropertySymbols:function(t){return I.f(E(t))}}),R&&a(a.S+a.F*(!W||c((function(){var t=M();return"[null]"!=N([t])||"{}"!=N({a:t})||"{}"!=N(Object(t))}))),"JSON",{stringify:function(t){for(var e,r,i=[t],o=1;arguments.length>o;)i.push(arguments[o++]);if(r=e=i[1],(_(e)||void 0!==t)&&!X(t))return y(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!X(e))return e}),i[1]=e,N.apply(R,i)}}),M.prototype[k]||r(14)(M.prototype,k,M.prototype.valueOf),u(M,"Symbol"),u(Math,"Math",!0),u(i.JSON,"JSON",!0)},function(t,e,r){var i=r(47),o=r(59),n=r(54);t.exports=function(t){var e=i(t),r=o.f;if(r)for(var a,s=r(t),l=n.f,c=0;s.length>c;)l.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,r){var i=r(0);i(i.S+i.F,"Object",{assign:r(150)})},function(t,e,r){var i=r(0);i(i.S,"Object",{is:r(151)})},function(t,e,r){var i=r(0);i(i.S,"Object",{setPrototypeOf:r(81).set})},function(t,e,r){"use strict";var i=r(50),o={};o[r(7)("toStringTag")]="z",o+""!="[object z]"&&r(15)(Object.prototype,"toString",(function(){return"[object "+i(this)+"]"}),!0)},function(t,e,r){var i=r(9).f,o=Function.prototype,n=/^\s*function ([^ (]*)/;"name"in o||r(8)&&i(o,"name",{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(t){return""}}})},function(t,e,r){"use strict";var i=r(5),o=r(19),n=r(7)("hasInstance"),a=Function.prototype;n in a||r(9).f(a,n,{value:function(t){if("function"!=typeof this||!i(t))return!1;if(!i(this.prototype))return t instanceof this;for(;t=o(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,r){"use strict";var i=r(3),o=r(16),n=r(22),a=r(82),s=r(25),l=r(4),c=r(40).f,h=r(18).f,u=r(9).f,d=r(48).trim,p=i.Number,f=p,g=p.prototype,m="Number"==n(r(38)(g)),y="trim"in String.prototype,v=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var r,i,o,n=(e=y?e.trim():d(e,3)).charCodeAt(0);if(43===n||45===n){if(88===(r=e.charCodeAt(2))||120===r)return NaN}else if(48===n){switch(e.charCodeAt(1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+e}for(var a,l=e.slice(2),c=0,h=l.length;c<h;c++)if((a=l.charCodeAt(c))<48||a>o)return NaN;return parseInt(l,i)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,r=this;return r instanceof p&&(m?l((function(){g.valueOf.call(r)})):"Number"!=n(r))?a(new f(v(e)),r,p):v(e)};for(var _,E=r(8)?c(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),T=0;E.length>T;T++)o(f,_=E[T])&&!o(p,_)&&u(p,_,h(f,_));p.prototype=g,g.constructor=p,r(15)(i,"Number",p)}},function(t,e,r){var i=r(0);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,r){var i=r(0),o=r(3).isFinite;i(i.S,"Number",{isFinite:function(t){return"number"==typeof t&&o(t)}})},function(t,e,r){var i=r(0);i(i.S,"Number",{isInteger:r(152)})},function(t,e,r){var i=r(0);i(i.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,r){var i=r(0),o=r(152),n=Math.abs;i(i.S,"Number",{isSafeInteger:function(t){return o(t)&&n(t)<=9007199254740991}})},function(t,e,r){var i=r(0);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,r){var i=r(0);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,r){var i=r(0),o=r(145);i(i.S+i.F*(Number.parseFloat!=o),"Number",{parseFloat:o})},function(t,e,r){var i=r(0),o=r(143);i(i.S+i.F*(Number.parseInt!=o),"Number",{parseInt:o})},function(t,e,r){var i=r(0),o=r(153),n=Math.sqrt,a=Math.acosh;i(i.S+i.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:o(t-1+n(t-1)*n(t+1))}})},function(t,e,r){var i=r(0),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,r){var i=r(0),o=Math.atanh;i(i.S+i.F*!(o&&1/o(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,r){var i=r(0),o=r(83);i(i.S,"Math",{cbrt:function(t){return o(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,r){var i=r(0);i(i.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,r){var i=r(0),o=Math.exp;i(i.S,"Math",{cosh:function(t){return(o(t=+t)+o(-t))/2}})},function(t,e,r){var i=r(0),o=r(84);i(i.S+i.F*(o!=Math.expm1),"Math",{expm1:o})},function(t,e,r){var i=r(0);i(i.S,"Math",{fround:r(154)})},function(t,e,r){var i=r(0),o=Math.abs;i(i.S,"Math",{hypot:function(t,e){for(var r,i,n=0,a=0,s=arguments.length,l=0;a<s;)l<(r=o(arguments[a++]))?(n=n*(i=l/r)*i+1,l=r):n+=r>0?(i=r/l)*i:r;return l===1/0?1/0:l*Math.sqrt(n)}})},function(t,e,r){var i=r(0),o=Math.imul;i(i.S+i.F*r(4)((function(){return-5!=o(4294967295,5)||2!=o.length})),"Math",{imul:function(t,e){var r=+t,i=+e,o=65535&r,n=65535&i;return 0|o*n+((65535&r>>>16)*n+o*(65535&i>>>16)<<16>>>0)}})},function(t,e,r){var i=r(0);i(i.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,r){var i=r(0);i(i.S,"Math",{log1p:r(153)})},function(t,e,r){var i=r(0);i(i.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,r){var i=r(0);i(i.S,"Math",{sign:r(83)})},function(t,e,r){var i=r(0),o=r(84),n=Math.exp;i(i.S+i.F*r(4)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(o(t)-o(-t))/2:(n(t-1)-n(-t-1))*(Math.E/2)}})},function(t,e,r){var i=r(0),o=r(84),n=Math.exp;i(i.S,"Math",{tanh:function(t){var e=o(t=+t),r=o(-t);return e==1/0?1:r==1/0?-1:(e-r)/(n(t)+n(-t))}})},function(t,e,r){var i=r(0);i(i.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,r){var i=r(0),o=r(39),n=String.fromCharCode,a=String.fromCodePoint;i(i.S+i.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,r=[],i=arguments.length,a=0;i>a;){if(e=+arguments[a++],o(e,1114111)!==e)throw RangeError(e+" is not a valid code point");r.push(e<65536?n(e):n(55296+((e-=65536)>>10),e%1024+56320))}return r.join("")}})},function(t,e,r){var i=r(0),o=r(17),n=r(6);i(i.S,"String",{raw:function(t){for(var e=o(t.raw),r=n(e.length),i=arguments.length,a=[],s=0;r>s;)a.push(String(e[s++])),s<i&&a.push(String(arguments[s]));return a.join("")}})},function(t,e,r){"use strict";var i=r(60)(!0);r(85)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=i(e,r),this._i+=t.length,{value:t,done:!1})}))},function(t,e,r){"use strict";var i=r(0),o=r(60)(!1);i(i.P,"String",{codePointAt:function(t){return o(this,t)}})},function(t,e,r){"use strict";var i=r(0),o=r(6),n=r(87),a="".endsWith;i(i.P+i.F*r(88)("endsWith"),"String",{endsWith:function(t){var e=n(this,t,"endsWith"),r=arguments.length>1?arguments[1]:void 0,i=o(e.length),s=void 0===r?i:Math.min(o(r),i),l=String(t);return a?a.call(e,l,s):e.slice(s-l.length,s)===l}})},function(t,e,r){"use strict";var i=r(0),o=r(87);i(i.P+i.F*r(88)("includes"),"String",{includes:function(t){return!!~o(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,r){var i=r(0);i(i.P,"String",{repeat:r(78)})},function(t,e,r){"use strict";var i=r(0),o=r(6),n=r(87),a="".startsWith;i(i.P+i.F*r(88)("startsWith"),"String",{startsWith:function(t){var e=n(this,t,"startsWith"),r=o(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return a?a.call(e,i,r):e.slice(r,r+i.length)===i}})},function(t,e,r){"use strict";r(13)("anchor",(function(t){return function(e){return t(this,"a","name",e)}}))},function(t,e,r){"use strict";r(13)("big",(function(t){return function(){return t(this,"big","","")}}))},function(t,e,r){"use strict";r(13)("blink",(function(t){return function(){return t(this,"blink","","")}}))},function(t,e,r){"use strict";r(13)("bold",(function(t){return function(){return t(this,"b","","")}}))},function(t,e,r){"use strict";r(13)("fixed",(function(t){return function(){return t(this,"tt","","")}}))},function(t,e,r){"use strict";r(13)("fontcolor",(function(t){return function(e){return t(this,"font","color",e)}}))},function(t,e,r){"use strict";r(13)("fontsize",(function(t){return function(e){return t(this,"font","size",e)}}))},function(t,e,r){"use strict";r(13)("italics",(function(t){return function(){return t(this,"i","","")}}))},function(t,e,r){"use strict";r(13)("link",(function(t){return function(e){return t(this,"a","href",e)}}))},function(t,e,r){"use strict";r(13)("small",(function(t){return function(){return t(this,"small","","")}}))},function(t,e,r){"use strict";r(13)("strike",(function(t){return function(){return t(this,"strike","","")}}))},function(t,e,r){"use strict";r(13)("sub",(function(t){return function(){return t(this,"sub","","")}}))},function(t,e,r){"use strict";r(13)("sup",(function(t){return function(){return t(this,"sup","","")}}))},function(t,e,r){var i=Date.prototype,o=i.toString,n=i.getTime;new Date(NaN)+""!="Invalid Date"&&r(15)(i,"toString",(function(){var t=n.call(this);return t==t?o.call(this):"Invalid Date"}))},function(t,e,r){var i=r(7)("toPrimitive"),o=Date.prototype;i in o||r(14)(o,i,r(246))},function(t,e,r){"use strict";var i=r(2),o=r(25);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return o(i(this),"number"!=t)}},function(t,e,r){"use strict";var i=r(21),o=r(0),n=r(10),a=r(155),s=r(89),l=r(6),c=r(90),h=r(91);o(o.S+o.F*!r(62)((function(t){Array.from(t)})),"Array",{from:function(t){var e,r,o,u,d=n(t),p="function"==typeof this?this:Array,f=arguments.length,g=f>1?arguments[1]:void 0,m=void 0!==g,y=0,v=h(d);if(m&&(g=i(g,f>2?arguments[2]:void 0,2)),null==v||p==Array&&s(v))for(r=new p(e=l(d.length));e>y;y++)c(r,y,m?g(d[y],y):d[y]);else for(u=v.call(d),r=new p;!(o=u.next()).done;y++)c(r,y,m?a(u,g,[o.value,y],!0):o.value);return r.length=y,r}})},function(t,e,r){"use strict";var i=r(0),o=r(90);i(i.S+i.F*r(4)((function(){function t(){}return!(Array.of.call(t)instanceof t)})),"Array",{of:function(){for(var t=0,e=arguments.length,r=new("function"==typeof this?this:Array)(e);e>t;)o(r,t,arguments[t++]);return r.length=e,r}})},function(t,e,r){var i=r(0);i(i.P,"Array",{copyWithin:r(156)}),r(33)("copyWithin")},function(t,e,r){var i=r(0);i(i.P,"Array",{fill:r(92)}),r(33)("fill")},function(t,e,r){"use strict";var i=r(0),o=r(28)(5),n=!0;"find"in[]&&Array(1).find((function(){n=!1})),i(i.P+i.F*n,"Array",{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),r(33)("find")},function(t,e,r){"use strict";var i=r(0),o=r(28)(6),n="findIndex",a=!0;n in[]&&Array(1)[n]((function(){a=!1})),i(i.P+i.F*a,"Array",{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),r(33)(n)},function(t,e,r){r(41)("Array")},function(t,e,r){var i=r(3),o=r(82),n=r(9).f,a=r(40).f,s=r(61),l=r(55),c=i.RegExp,h=c,u=c.prototype,d=/a/g,p=/a/g,f=new c(d)!==d;if(r(8)&&(!f||r(4)((function(){return p[r(7)("match")]=!1,c(d)!=d||c(p)==p||"/a/i"!=c(d,"i")})))){c=function(t,e){var r=this instanceof c,i=s(t),n=void 0===e;return!r&&i&&t.constructor===c&&n?t:o(f?new h(i&&!n?t.source:t,e):h((i=t instanceof c)?t.source:t,i&&n?l.call(t):e),r?this:u,c)};for(var g=function(t){t in c||n(c,t,{configurable:!0,get:function(){return h[t]},set:function(e){h[t]=e}})},m=a(h),y=0;m.length>y;)g(m[y++]);u.constructor=c,c.prototype=u,r(15)(i,"RegExp",c)}r(41)("RegExp")},function(t,e,r){"use strict";var i=r(2),o=r(6),n=r(94),a=r(63);r(64)("match",1,(function(t,e,r,s){return[function(r){var i=t(this),o=null==r?void 0:r[e];return void 0!==o?o.call(r,i):new RegExp(r)[e](String(i))},function(t){var e=s(r,t,this);if(e.done)return e.value;var l=i(t),c=String(this);if(!l.global)return a(l,c);var h=l.unicode;l.lastIndex=0;for(var u,d=[],p=0;null!==(u=a(l,c));){var f=String(u[0]);d[p]=f,""===f&&(l.lastIndex=n(c,o(l.lastIndex),h)),p++}return 0===p?null:d}]}))},function(t,e,r){"use strict";var i=r(2),o=r(10),n=r(6),a=r(23),s=r(94),l=r(63),c=Math.max,h=Math.min,u=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;r(64)("replace",2,(function(t,e,r,f){return[function(i,o){var n=t(this),a=null==i?void 0:i[e];return void 0!==a?a.call(i,n,o):r.call(String(n),i,o)},function(t,e){var o=f(r,t,this,e);if(o.done)return o.value;var u=i(t),d=String(this),p="function"==typeof e;p||(e=String(e));var m=u.global;if(m){var y=u.unicode;u.lastIndex=0}for(var v=[];;){var _=l(u,d);if(null===_)break;if(v.push(_),!m)break;""===String(_[0])&&(u.lastIndex=s(d,n(u.lastIndex),y))}for(var E,T="",b=0,S=0;S<v.length;S++){_=v[S];for(var x=String(_[0]),w=c(h(a(_.index),d.length),0),O=[],I=1;I<_.length;I++)O.push(void 0===(E=_[I])?E:String(E));var A=_.groups;if(p){var D=[x].concat(O,w,d);void 0!==A&&D.push(A);var C=String(e.apply(void 0,D))}else C=g(x,d,w,O,A,e);w>=b&&(T+=d.slice(b,w)+C,b=w+x.length)}return T+d.slice(b)}];function g(t,e,i,n,a,s){var l=i+t.length,c=n.length,h=p;return void 0!==a&&(a=o(a),h=d),r.call(s,h,(function(r,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,i);case"'":return e.slice(l);case"<":s=a[o.slice(1,-1)];break;default:var h=+o;if(0===h)return r;if(h>c){var d=u(h/10);return 0===d?r:d<=c?void 0===n[d-1]?o.charAt(1):n[d-1]+o.charAt(1):r}s=n[h-1]}return void 0===s?"":s}))}}))},function(t,e,r){"use strict";var i=r(2),o=r(151),n=r(63);r(64)("search",1,(function(t,e,r,a){return[function(r){var i=t(this),o=null==r?void 0:r[e];return void 0!==o?o.call(r,i):new RegExp(r)[e](String(i))},function(t){var e=a(r,t,this);if(e.done)return e.value;var s=i(t),l=String(this),c=s.lastIndex;o(c,0)||(s.lastIndex=0);var h=n(s,l);return o(s.lastIndex,c)||(s.lastIndex=c),null===h?-1:h.index}]}))},function(t,e,r){"use strict";var i=r(61),o=r(2),n=r(65),a=r(94),s=r(6),l=r(63),c=r(93),h=r(4),u=Math.min,d=[].push,p=!h((function(){RegExp(4294967295,"y")}));r(64)("split",2,(function(t,e,r,h){var f;return f="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,e){var o=String(this);if(void 0===t&&0===e)return[];if(!i(t))return r.call(o,t,e);for(var n,a,s,l=[],h=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),u=0,p=void 0===e?4294967295:e>>>0,f=new RegExp(t.source,h+"g");(n=c.call(f,o))&&!((a=f.lastIndex)>u&&(l.push(o.slice(u,n.index)),n.length>1&&n.index<o.length&&d.apply(l,n.slice(1)),s=n[0].length,u=a,l.length>=p));)f.lastIndex===n.index&&f.lastIndex++;return u===o.length?!s&&f.test("")||l.push(""):l.push(o.slice(u)),l.length>p?l.slice(0,p):l}:"0".split(void 0,0).length?function(t,e){return void 0===t&&0===e?[]:r.call(this,t,e)}:r,[function(r,i){var o=t(this),n=null==r?void 0:r[e];return void 0!==n?n.call(r,o,i):f.call(String(o),r,i)},function(t,e){var i=h(f,t,this,e,f!==r);if(i.done)return i.value;var c=o(t),d=String(this),g=n(c,RegExp),m=c.unicode,y=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(p?"y":"g"),v=new g(p?c:"^(?:"+c.source+")",y),_=void 0===e?4294967295:e>>>0;if(0===_)return[];if(0===d.length)return null===l(v,d)?[d]:[];for(var E=0,T=0,b=[];T<d.length;){v.lastIndex=p?T:0;var S,x=l(v,p?d:d.slice(T));if(null===x||(S=u(s(v.lastIndex+(p?0:T)),d.length))===E)T=a(d,T,m);else{if(b.push(d.slice(E,T)),b.length===_)return b;for(var w=1;w<=x.length-1;w++)if(b.push(x[w]),b.length===_)return b;T=E=S}}return b.push(d.slice(E)),b}]}))},function(t,e,r){"use strict";var i,o,n,a,s=r(31),l=r(3),c=r(21),h=r(50),u=r(0),d=r(5),p=r(11),f=r(42),g=r(43),m=r(65),y=r(160).set,v=r(95)(),_=r(96),E=r(161),T=r(97),b=r(260),S=l.TypeError,x=l.process,w=x&&x.versions,O=w&&w.v8||"",I=l.Promise,A="process"==h(x),D=function(){},C=o=_.f,P=!!function(){try{var t=I.resolve(1),e=(t.constructor={})[r(7)("species")]=function(t){t(D,D)};return(A||"function"==typeof PromiseRejectionEvent)&&t.then(D)instanceof e&&0!==O.indexOf("6.6")&&-1===T.indexOf("Chrome/66")}catch(t){}}(),L=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},M=function(t,e){if(!t._n){t._n=!0;var r=t._c;v((function(){for(var i=t._v,o=1==t._s,n=0,a=function(e){var r,n,a,s=o?e.ok:e.fail,l=e.resolve,c=e.reject,h=e.domain;try{s?(o||(2==t._h&&B(t),t._h=1),!0===s?r=i:(h&&h.enter(),r=s(i),h&&(h.exit(),a=!0)),r===e.promise?c(S("Promise-chain cycle")):(n=L(r))?n.call(r,l,c):l(r)):c(i)}catch(t){h&&!a&&h.exit(),c(t)}};r.length>n;)a(r[n++]);t._c=[],t._n=!1,e&&!t._h&&R(t)}))}},R=function(t){y.call(l,(function(){var e,r,i,o=t._v,n=N(t);if(n&&(e=E((function(){A?x.emit("unhandledRejection",o,t):(r=l.onunhandledrejection)?r({promise:t,reason:o}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",o)})),t._h=A||N(t)?2:1),t._a=void 0,n&&e.e)throw e.v}))},N=function(t){return 1!==t._h&&0===(t._a||t._c).length},B=function(t){y.call(l,(function(){var e;A?x.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})}))},k=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),M(e,!0))},F=function(t){var e,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw S("Promise can't be resolved itself");(e=L(t))?v((function(){var i={_w:r,_d:!1};try{e.call(t,c(F,i,1),c(k,i,1))}catch(t){k.call(i,t)}})):(r._v=t,r._s=1,M(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};P||(I=function(t){f(this,I,"Promise","_h"),p(t),i.call(this);try{t(c(F,this,1),c(k,this,1))}catch(t){k.call(this,t)}},(i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(44)(I.prototype,{then:function(t,e){var r=C(m(this,I));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=A?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&M(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),n=function(){var t=new i;this.promise=t,this.resolve=c(F,t,1),this.reject=c(k,t,1)},_.f=C=function(t){return t===I||t===a?new n(t):o(t)}),u(u.G+u.W+u.F*!P,{Promise:I}),r(49)(I,"Promise"),r(41)("Promise"),a=r(20).Promise,u(u.S+u.F*!P,"Promise",{reject:function(t){var e=C(this);return(0,e.reject)(t),e.promise}}),u(u.S+u.F*(s||!P),"Promise",{resolve:function(t){return b(s&&this===a?I:this,t)}}),u(u.S+u.F*!(P&&r(62)((function(t){I.all(t).catch(D)}))),"Promise",{all:function(t){var e=this,r=C(e),i=r.resolve,o=r.reject,n=E((function(){var r=[],n=0,a=1;g(t,!1,(function(t){var s=n++,l=!1;r.push(void 0),a++,e.resolve(t).then((function(t){l||(l=!0,r[s]=t,--a||i(r))}),o)})),--a||i(r)}));return n.e&&o(n.v),r.promise},race:function(t){var e=this,r=C(e),i=r.reject,o=E((function(){g(t,!1,(function(t){e.resolve(t).then(r.resolve,i)}))}));return o.e&&i(o.v),r.promise}})},function(t,e,r){var i=r(2),o=r(5),n=r(96);t.exports=function(t,e){if(i(t),o(e)&&e.constructor===t)return e;var r=n.f(t);return(0,r.resolve)(e),r.promise}},function(t,e,r){"use strict";var i=r(166),o=r(45);r(66)("WeakSet",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return i.def(o(this,"WeakSet"),t,!0)}},i,!1,!0)},function(t,e,r){"use strict";var i=r(0),o=r(67),n=r(98),a=r(2),s=r(39),l=r(6),c=r(5),h=r(3).ArrayBuffer,u=r(65),d=n.ArrayBuffer,p=n.DataView,f=o.ABV&&h.isView,g=d.prototype.slice,m=o.VIEW;i(i.G+i.W+i.F*(h!==d),{ArrayBuffer:d}),i(i.S+i.F*!o.CONSTR,"ArrayBuffer",{isView:function(t){return f&&f(t)||c(t)&&m in t}}),i(i.P+i.U+i.F*r(4)((function(){return!new d(2).slice(1,void 0).byteLength})),"ArrayBuffer",{slice:function(t,e){if(void 0!==g&&void 0===e)return g.call(a(this),t);for(var r=a(this).byteLength,i=s(t,r),o=s(void 0===e?r:e,r),n=new(u(this,d))(l(o-i)),c=new p(this),h=new p(n),f=0;i<o;)h.setUint8(f++,c.getUint8(i++));return n}}),r(41)("ArrayBuffer")},function(t,e,r){var i=r(0);i(i.G+i.W+i.F*!r(67).ABV,{DataView:r(98).DataView})},function(t,e,r){r(29)("Int8",1,(function(t){return function(e,r,i){return t(this,e,r,i)}}))},function(t,e,r){r(29)("Uint8",1,(function(t){return function(e,r,i){return t(this,e,r,i)}}))},function(t,e,r){r(29)("Uint8",1,(function(t){return function(e,r,i){return t(this,e,r,i)}}),!0)},function(t,e,r){r(29)("Int16",2,(function(t){return function(e,r,i){return t(this,e,r,i)}}))},function(t,e,r){r(29)("Uint16",2,(function(t){return function(e,r,i){return t(this,e,r,i)}}))},function(t,e,r){r(29)("Int32",4,(function(t){return function(e,r,i){return t(this,e,r,i)}}))},function(t,e,r){r(29)("Uint32",4,(function(t){return function(e,r,i){return t(this,e,r,i)}}))},function(t,e,r){r(29)("Float32",4,(function(t){return function(e,r,i){return t(this,e,r,i)}}))},function(t,e,r){r(29)("Float64",8,(function(t){return function(e,r,i){return t(this,e,r,i)}}))},function(t,e,r){var i=r(0),o=r(11),n=r(2),a=(r(3).Reflect||{}).apply,s=Function.apply;i(i.S+i.F*!r(4)((function(){a((function(){}))})),"Reflect",{apply:function(t,e,r){var i=o(t),l=n(r);return a?a(i,e,l):s.call(i,e,l)}})},function(t,e,r){var i=r(0),o=r(38),n=r(11),a=r(2),s=r(5),l=r(4),c=r(120),h=(r(3).Reflect||{}).construct,u=l((function(){function t(){}return!(h((function(){}),[],t)instanceof t)})),d=!l((function(){h((function(){}))}));i(i.S+i.F*(u||d),"Reflect",{construct:function(t,e){n(t),a(e);var r=arguments.length<3?t:n(arguments[2]);if(d&&!u)return h(t,e,r);if(t==r){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var i=[null];return i.push.apply(i,e),new(c.apply(t,i))}var l=r.prototype,p=o(s(l)?l:Object.prototype),f=Function.apply.call(t,p,e);return s(f)?f:p}})},function(t,e,r){var i=r(9),o=r(0),n=r(2),a=r(25);o(o.S+o.F*r(4)((function(){Reflect.defineProperty(i.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(t,e,r){n(t),e=a(e,!0),n(r);try{return i.f(t,e,r),!0}catch(t){return!1}}})},function(t,e,r){var i=r(0),o=r(18).f,n=r(2);i(i.S,"Reflect",{deleteProperty:function(t,e){var r=o(n(t),e);return!(r&&!r.configurable)&&delete t[e]}})},function(t,e,r){"use strict";var i=r(0),o=r(2),n=function(t){this._t=o(t),this._i=0;var e,r=this._k=[];for(e in t)r.push(e)};r(86)(n,"Object",(function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}})),i(i.S,"Reflect",{enumerate:function(t){return new n(t)}})},function(t,e,r){var i=r(18),o=r(19),n=r(16),a=r(0),s=r(5),l=r(2);a(a.S,"Reflect",{get:function t(e,r){var a,c,h=arguments.length<3?e:arguments[2];return l(e)===h?e[r]:(a=i.f(e,r))?n(a,"value")?a.value:void 0!==a.get?a.get.call(h):void 0:s(c=o(e))?t(c,r,h):void 0}})},function(t,e,r){var i=r(18),o=r(0),n=r(2);o(o.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return i.f(n(t),e)}})},function(t,e,r){var i=r(0),o=r(19),n=r(2);i(i.S,"Reflect",{getPrototypeOf:function(t){return o(n(t))}})},function(t,e,r){var i=r(0);i(i.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,r){var i=r(0),o=r(2),n=Object.isExtensible;i(i.S,"Reflect",{isExtensible:function(t){return o(t),!n||n(t)}})},function(t,e,r){var i=r(0);i(i.S,"Reflect",{ownKeys:r(168)})},function(t,e,r){var i=r(0),o=r(2),n=Object.preventExtensions;i(i.S,"Reflect",{preventExtensions:function(t){o(t);try{return n&&n(t),!0}catch(t){return!1}}})},function(t,e,r){var i=r(9),o=r(18),n=r(19),a=r(16),s=r(0),l=r(36),c=r(2),h=r(5);s(s.S,"Reflect",{set:function t(e,r,s){var u,d,p=arguments.length<4?e:arguments[3],f=o.f(c(e),r);if(!f){if(h(d=n(e)))return t(d,r,s,p);f=l(0)}if(a(f,"value")){if(!1===f.writable||!h(p))return!1;if(u=o.f(p,r)){if(u.get||u.set||!1===u.writable)return!1;u.value=s,i.f(p,r,u)}else i.f(p,r,l(0,s));return!0}return void 0!==f.set&&(f.set.call(p,s),!0)}})},function(t,e,r){var i=r(0),o=r(81);o&&i(i.S,"Reflect",{setPrototypeOf:function(t,e){o.check(t,e);try{return o.set(t,e),!0}catch(t){return!1}}})},function(t,e,r){r(288),r(289),r(290),r(291),r(292),r(293),r(294),r(295),r(296),r(297),r(298),r(299),r(300),r(301),r(302),r(303),r(304),r(305),r(306),r(307),r(308),r(309),r(310),r(311),r(312),r(313),r(314),r(315),r(316),r(317),r(318),r(319),r(320),r(321),r(322),r(323),r(324),r(325),r(326),r(327),r(328),r(329),r(330),r(331),r(332),r(333),r(334),r(335),r(336),r(337),r(338),r(339),r(340),r(341),r(342),t.exports=r(20)},function(t,e,r){"use strict";var i=r(0),o=r(57)(!0);i(i.P,"Array",{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),r(33)("includes")},function(t,e,r){"use strict";var i=r(0),o=r(169),n=r(10),a=r(6),s=r(11),l=r(77);i(i.P,"Array",{flatMap:function(t){var e,r,i=n(this);return s(t),e=a(i.length),r=l(i,0),o(r,i,i,e,0,1,t,arguments[1]),r}}),r(33)("flatMap")},function(t,e,r){"use strict";var i=r(0),o=r(169),n=r(10),a=r(6),s=r(23),l=r(77);i(i.P,"Array",{flatten:function(){var t=arguments[0],e=n(this),r=a(e.length),i=l(e,0);return o(i,e,e,r,0,void 0===t?1:s(t)),i}}),r(33)("flatten")},function(t,e,r){"use strict";var i=r(0),o=r(60)(!0);i(i.P,"String",{at:function(t){return o(this,t)}})},function(t,e,r){"use strict";var i=r(0),o=r(170),n=r(97),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n);i(i.P+i.F*a,"String",{padStart:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,r){"use strict";var i=r(0),o=r(170),n=r(97),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n);i(i.P+i.F*a,"String",{padEnd:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,r){"use strict";r(48)("trimLeft",(function(t){return function(){return t(this,1)}}),"trimStart")},function(t,e,r){"use strict";r(48)("trimRight",(function(t){return function(){return t(this,2)}}),"trimEnd")},function(t,e,r){"use strict";var i=r(0),o=r(26),n=r(6),a=r(61),s=r(55),l=RegExp.prototype,c=function(t,e){this._r=t,this._s=e};r(86)(c,"RegExp String",(function(){var t=this._r.exec(this._s);return{value:t,done:null===t}})),i(i.P,"String",{matchAll:function(t){if(o(this),!a(t))throw TypeError(t+" is not a regexp!");var e=String(this),r="flags"in l?String(t.flags):s.call(t),i=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return i.lastIndex=n(t.lastIndex),new c(i,e)}})},function(t,e,r){r(80)("asyncIterator")},function(t,e,r){r(80)("observable")},function(t,e,r){var i=r(0),o=r(168),n=r(17),a=r(18),s=r(90);i(i.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,r,i=n(t),l=a.f,c=o(i),h={},u=0;c.length>u;)void 0!==(r=l(i,e=c[u++]))&&s(h,e,r);return h}})},function(t,e,r){var i=r(0),o=r(171)(!1);i(i.S,"Object",{values:function(t){return o(t)}})},function(t,e,r){var i=r(0),o=r(171)(!0);i(i.S,"Object",{entries:function(t){return o(t)}})},function(t,e,r){"use strict";var i=r(0),o=r(10),n=r(11),a=r(9);r(8)&&i(i.P+r(68),"Object",{__defineGetter__:function(t,e){a.f(o(this),t,{get:n(e),enumerable:!0,configurable:!0})}})},function(t,e,r){"use strict";var i=r(0),o=r(10),n=r(11),a=r(9);r(8)&&i(i.P+r(68),"Object",{__defineSetter__:function(t,e){a.f(o(this),t,{set:n(e),enumerable:!0,configurable:!0})}})},function(t,e,r){"use strict";var i=r(0),o=r(10),n=r(25),a=r(19),s=r(18).f;r(8)&&i(i.P+r(68),"Object",{__lookupGetter__:function(t){var e,r=o(this),i=n(t,!0);do{if(e=s(r,i))return e.get}while(r=a(r))}})},function(t,e,r){"use strict";var i=r(0),o=r(10),n=r(25),a=r(19),s=r(18).f;r(8)&&i(i.P+r(68),"Object",{__lookupSetter__:function(t){var e,r=o(this),i=n(t,!0);do{if(e=s(r,i))return e.set}while(r=a(r))}})},function(t,e,r){var i=r(0);i(i.P+i.R,"Map",{toJSON:r(172)("Map")})},function(t,e,r){var i=r(0);i(i.P+i.R,"Set",{toJSON:r(172)("Set")})},function(t,e,r){r(69)("Map")},function(t,e,r){r(69)("Set")},function(t,e,r){r(69)("WeakMap")},function(t,e,r){r(69)("WeakSet")},function(t,e,r){r(70)("Map")},function(t,e,r){r(70)("Set")},function(t,e,r){r(70)("WeakMap")},function(t,e,r){r(70)("WeakSet")},function(t,e,r){var i=r(0);i(i.G,{global:r(3)})},function(t,e,r){var i=r(0);i(i.S,"System",{global:r(3)})},function(t,e,r){var i=r(0),o=r(22);i(i.S,"Error",{isError:function(t){return"Error"===o(t)}})},function(t,e,r){var i=r(0);i(i.S,"Math",{clamp:function(t,e,r){return Math.min(r,Math.max(e,t))}})},function(t,e,r){var i=r(0);i(i.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(t,e,r){var i=r(0),o=180/Math.PI;i(i.S,"Math",{degrees:function(t){return t*o}})},function(t,e,r){var i=r(0),o=r(174),n=r(154);i(i.S,"Math",{fscale:function(t,e,r,i,a){return n(o(t,e,r,i,a))}})},function(t,e,r){var i=r(0);i(i.S,"Math",{iaddh:function(t,e,r,i){var o=t>>>0,n=r>>>0;return(e>>>0)+(i>>>0)+((o&n|(o|n)&~(o+n>>>0))>>>31)|0}})},function(t,e,r){var i=r(0);i(i.S,"Math",{isubh:function(t,e,r,i){var o=t>>>0,n=r>>>0;return(e>>>0)-(i>>>0)-((~o&n|~(o^n)&o-n>>>0)>>>31)|0}})},function(t,e,r){var i=r(0);i(i.S,"Math",{imulh:function(t,e){var r=+t,i=+e,o=65535&r,n=65535&i,a=r>>16,s=i>>16,l=(a*n>>>0)+(o*n>>>16);return a*s+(l>>16)+((o*s>>>0)+(65535&l)>>16)}})},function(t,e,r){var i=r(0);i(i.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(t,e,r){var i=r(0),o=Math.PI/180;i(i.S,"Math",{radians:function(t){return t*o}})},function(t,e,r){var i=r(0);i(i.S,"Math",{scale:r(174)})},function(t,e,r){var i=r(0);i(i.S,"Math",{umulh:function(t,e){var r=+t,i=+e,o=65535&r,n=65535&i,a=r>>>16,s=i>>>16,l=(a*n>>>0)+(o*n>>>16);return a*s+(l>>>16)+((o*s>>>0)+(65535&l)>>>16)}})},function(t,e,r){var i=r(0);i(i.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},function(t,e,r){"use strict";var i=r(0),o=r(96),n=r(161);i(i.S,"Promise",{try:function(t){var e=o.f(this),r=n(t);return(r.e?e.reject:e.resolve)(r.v),e.promise}})},function(t,e,r){var i=r(30),o=r(2),n=i.key,a=i.set;i.exp({defineMetadata:function(t,e,r,i){a(t,e,o(r),n(i))}})},function(t,e,r){var i=r(30),o=r(2),n=i.key,a=i.map,s=i.store;i.exp({deleteMetadata:function(t,e){var r=arguments.length<3?void 0:n(arguments[2]),i=a(o(e),r,!1);if(void 0===i||!i.delete(t))return!1;if(i.size)return!0;var l=s.get(e);return l.delete(r),!!l.size||s.delete(e)}})},function(t,e,r){var i=r(30),o=r(2),n=r(19),a=i.has,s=i.get,l=i.key,c=function(t,e,r){if(a(t,e,r))return s(t,e,r);var i=n(e);return null!==i?c(t,i,r):void 0};i.exp({getMetadata:function(t,e){return c(t,o(e),arguments.length<3?void 0:l(arguments[2]))}})},function(t,e,r){var i=r(164),o=r(173),n=r(30),a=r(2),s=r(19),l=n.keys,c=n.key,h=function(t,e){var r=l(t,e),n=s(t);if(null===n)return r;var a=h(n,e);return a.length?r.length?o(new i(r.concat(a))):a:r};n.exp({getMetadataKeys:function(t){return h(a(t),arguments.length<2?void 0:c(arguments[1]))}})},function(t,e,r){var i=r(30),o=r(2),n=i.get,a=i.key;i.exp({getOwnMetadata:function(t,e){return n(t,o(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,r){var i=r(30),o=r(2),n=i.keys,a=i.key;i.exp({getOwnMetadataKeys:function(t){return n(o(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,e,r){var i=r(30),o=r(2),n=r(19),a=i.has,s=i.key,l=function(t,e,r){if(a(t,e,r))return!0;var i=n(e);return null!==i&&l(t,i,r)};i.exp({hasMetadata:function(t,e){return l(t,o(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,r){var i=r(30),o=r(2),n=i.has,a=i.key;i.exp({hasOwnMetadata:function(t,e){return n(t,o(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,r){var i=r(30),o=r(2),n=r(11),a=i.key,s=i.set;i.exp({metadata:function(t,e){return function(r,i){s(t,e,(void 0!==i?o:n)(r),a(i))}}})},function(t,e,r){var i=r(0),o=r(95)(),n=r(3).process,a="process"==r(22)(n);i(i.G,{asap:function(t){var e=a&&n.domain;o(e?e.bind(t):t)}})},function(t,e,r){"use strict";var i=r(0),o=r(3),n=r(20),a=r(95)(),s=r(7)("observable"),l=r(11),c=r(2),h=r(42),u=r(44),d=r(14),p=r(43),f=p.RETURN,g=function(t){return null==t?void 0:l(t)},m=function(t){var e=t._c;e&&(t._c=void 0,e())},y=function(t){return void 0===t._o},v=function(t){y(t)||(t._o=void 0,m(t))},_=function(t,e){c(t),this._c=void 0,this._o=t,t=new E(this);try{var r=e(t),i=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){i.unsubscribe()}:l(r),this._c=r)}catch(e){return void t.error(e)}y(this)&&m(this)};_.prototype=u({},{unsubscribe:function(){v(this)}});var E=function(t){this._s=t};E.prototype=u({},{next:function(t){var e=this._s;if(!y(e)){var r=e._o;try{var i=g(r.next);if(i)return i.call(r,t)}catch(t){try{v(e)}finally{throw t}}}},error:function(t){var e=this._s;if(y(e))throw t;var r=e._o;e._o=void 0;try{var i=g(r.error);if(!i)throw t;t=i.call(r,t)}catch(t){try{m(e)}finally{throw t}}return m(e),t},complete:function(t){var e=this._s;if(!y(e)){var r=e._o;e._o=void 0;try{var i=g(r.complete);t=i?i.call(r,t):void 0}catch(t){try{m(e)}finally{throw t}}return m(e),t}}});var T=function(t){h(this,T,"Observable","_f")._f=l(t)};u(T.prototype,{subscribe:function(t){return new _(t,this._f)},forEach:function(t){var e=this;return new(n.Promise||o.Promise)((function(r,i){l(t);var o=e.subscribe({next:function(e){try{return t(e)}catch(t){i(t),o.unsubscribe()}},error:i,complete:r})}))}}),u(T,{from:function(t){var e="function"==typeof this?this:T,r=g(c(t)[s]);if(r){var i=c(r.call(t));return i.constructor===e?i:new e((function(t){return i.subscribe(t)}))}return new e((function(e){var r=!1;return a((function(){if(!r){try{if(p(t,!1,(function(t){if(e.next(t),r)return f}))===f)return}catch(t){if(r)throw t;return void e.error(t)}e.complete()}})),function(){r=!0}}))},of:function(){for(var t=0,e=arguments.length,r=new Array(e);t<e;)r[t]=arguments[t++];return new("function"==typeof this?this:T)((function(t){var e=!1;return a((function(){if(!e){for(var i=0;i<r.length;++i)if(t.next(r[i]),e)return;t.complete()}})),function(){e=!0}}))}}),d(T.prototype,s,(function(){return this})),i(i.G,{Observable:T}),r(41)("Observable")},function(t,e,r){var i=r(344).default;function o(){"use strict";
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t.exports=o=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function u(t,e,r,i){var o=e&&e.prototype instanceof f?e:f,n=Object.create(o.prototype),a=new O(i||[]);return n._invoke=function(t,e,r){var i="suspendedStart";return function(o,n){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===o)throw n;return{value:void 0,done:!0}}for(r.method=o,r.arg=n;;){var a=r.delegate;if(a){var s=S(a,r);if(s){if(s===p)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var l=d(t,e,r);if("normal"===l.type){if(i=r.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i="completed",r.method="throw",r.arg=l.arg)}}}(t,r,a),n}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p={};function f(){}function g(){}function m(){}var y={};h(y,s,(function(){return this}));var v=Object.getPrototypeOf,_=v&&v(v(I([])));_&&_!==r&&n.call(_,s)&&(y=_);var E=m.prototype=f.prototype=Object.create(y);function T(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){var r;this._invoke=function(o,a){function s(){return new e((function(r,s){!function r(o,a,s,l){var c=d(t[o],t,a);if("throw"!==c.type){var h=c.arg,u=h.value;return u&&"object"==i(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,s,l)}),(function(t){r("throw",t,s,l)})):e.resolve(u).then((function(t){h.value=t,s(h)}),(function(t){return r("throw",t,s,l)}))}l(c.arg)}(o,a,r,s)}))}return r=r?r.then(s,s):s()}}function S(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return p;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=d(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,p;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function I(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return g.prototype=m,h(E,"constructor",m),h(m,"constructor",g),g.displayName=h(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,h(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},T(b.prototype),h(b.prototype,l,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,i,o,n){void 0===n&&(n=Promise);var a=new b(u(t,r,i,o),n);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},T(E),h(E,c,"Generator"),h(E,s,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var i=e.pop();if(i in t)return r.value=i,r.done=!1,r}return r.done=!0,r}},e.values=I,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,i){return a.type="throw",a.arg=t,e.next=r,i&&(e.method="next",e.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),w(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var o=i.arg;w(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:I(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},e}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){function r(e){return t.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var i=r(175);t.exports=function(t){if(Array.isArray(t))return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var i=r(175);t.exports=function(t,e){if(t){if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){"use strict";r.r(e);var i=new function(){this.setPlatform=function(t){this.PLATFORM=t},this.getPlatform=function(){return this.PLATFORM},this.setNativeVersion=function(t){this.NATIVEVERSION=t},this.VERSION="2.9.7",this.UPDATETIME="20250207_1029",this.REPORT_VERSION=this.VERSION+"_"+this.UPDATETIME,this.NATIVEVERSION="web",this.PLATFORM="web"},o={ALL:"ALL",TIW_SERVER:"TIW_SERVER",TIW_RESOURCE:"TIW_RESOURCE",PPT_THUMBNAIL:"PPT_THUMBNAIL",LOG_SERVER:"LOG_SERVER",LOG_KEY:"LOG_KEY",LOG_VERBOSE:"LOG_VERBOSE"},n="[[ProxyTarget]]",a="[[Get]]",s="[[Set]]",l="[[Call]]",c=Object.defineProperty,h=Object.defineProperties,u=Object.getPrototypeOf,d=Object.getOwnPropertyDescriptor,p=!!h&&g(h),f=p?Object.__proto__?u:function(t){return"function"==typeof t?t.__proto__||{}:u(t)}:function(t){return _isVbObject(t)&&_getVbInternalOf(t).__proto__||{}};function g(t){return"function"==typeof t&&/\[native code\]/.test(t.toString())}function m(t,e){if(this instanceof m)return y(new v(t,e));E("Constructor Proxy requires 'new'")}function y(t){var e=t[n];return"function"==typeof e?function(t){var e=t[n];function r(){return this instanceof r?t["[[Construct]]"](arguments,r):t[l](this,arguments)}if(r.prototype=e.prototype,p){var i=I(t),o=w(u(e),i);for(var a in x(r,o),i=A(e,t))b(r,a)&&delete i[a];h(r,i)}else O(r,e);return r}(t):e instanceof Array?function(t){var e,r,i=t[n];return p&&((e=I(t)).concat.get=function(){var e=t[a]("concat",this);return e===Array.prototype.concat?e.bind(i):e},r=w(u(i),e)),(e=A(i,t)).length.set=function(e){var r=e-i.length;t[s]("length",e,this),r&&function(t,e,r){var i=r[n];if(t>0)for(var o=i.length,a=o-t;a<o;++a){var s=d(e,a);s?c(i,a,s):i[a]=void 0,s=D(i,a,r),c(e,a,s)}else for(var l=(a=i.length)-t;a<l;++a)delete e[a]}(r,this,t)},w(r,e)}(t):function(t){var e,r,i=t[n];return p&&(e=I(t),r=w(u(i),e)),e=A(i,t),w(r,e)}(t)}function v(t,e){T(t)&&T(e)||E("Cannot create proxy with a non-object as target or handler"),"REVOKED"===(f(t).__PROXY__||f(e).__PROXY__)&&E("Cannot create proxy with a revoked proxy as target or handler"),this[n]=t,this["[[ProxyHandler]]"]=e}function _(t,e){t||E("Cannot perform '"+e+"' on a proxy that has been revoked")}function E(t){throw new TypeError(t)}function T(t){return!!t&&("object"==typeof t||"function"==typeof t)}function b(t,e){return Object.prototype.hasOwnProperty.call(t,e)}m.revocable=function(t,e){this instanceof m.revocable&&E("Proxy.revocable is not a constructor");var r=new v(t,e),i=y(r);return{proxy:i,revoke:function(){r[n]=void 0,r["[[ProxyHandler]]"]=void 0,p||(f(i).__PROXY__="REVOKED")}}},v.prototype[a]=function(t,e){var r=this["[[ProxyHandler]]"];return _(r,"get"),null==r.get?this[n][t]:"function"==typeof r.get?r.get(this[n],t,e):void E("Trap 'get' is not a function: "+r.get)},v.prototype[s]=function(t,e,r){var i=this["[[ProxyHandler]]"];if(_(i,"set"),null==i.set)this[n][t]=e;else{if("function"==typeof i.set){var o=i.set(this[n],t,e,r);return Boolean(o)}E("Trap 'set' is not a function: "+i.set)}},v.prototype[l]=function(t,e){var r=this["[[ProxyHandler]]"];return _(r,"apply"),null==r.apply?this[n].apply(t,e):"function"==typeof r.apply?r.apply(this[n],t,e):void E("Trap 'apply' is not a function: "+r.apply)},v.prototype["[[Construct]]"]=function(t,e){var r,i=this["[[ProxyHandler]]"];if(_(i,"construct"),null==i.construct?r=function(t,e){for(var r=[],i=0,o=e.length;i<o;++i)r.push("args["+i+"]");return new Function("Ctor","args","return new Ctor("+r.join(", ")+")")(t,e)}(this[n],t):"function"==typeof i.construct?r=i.construct(this[n],t,e):E("Trap 'construct' is not a function: "+i.construct),T(r))return r;E("Trap 'construct' returned non-object: "+r)};var S=Object.getOwnPropertyNames||function(t){var e=[];for(var r in t)b(t,r)&&e.push(r);return e},x=g(Object.setPrototypeOf)?Object.setPrototypeOf:Object.__proto__?function(t,e){return t.__proto__=e,t}:function(t,e){return c(t,"__proto__",{value:e})},w=p?Object.create:function(t,e){var r=h({},e);if(_isVbObject(r)){_getVbInternalOf(r).__proto__={__PROXY__:void 0}}return r},O=Object.assign||function(t,e){for(var r in e)b(e,r)&&(t[r]=e[r]);return t};function I(t){for(var e={},r=t[n];r=u(r);){var i=A(r,t);O(e,i)}return e.__PROXY__={get:function(){return t[n]?void 0:"REVOKED"}},e}function A(t,e){for(var r=S(t),i={},o=r.length-1;o>=0;--o)i[r[o]]=D(t,r[o],e);return i}function D(t,e,r){var i=d(t,e);return{get:function(){return r[a](e,this)},set:function(t){r[s](e,t,this)},enumerable:i.enumerable,configurable:i.configurable}}var C="undefined"==typeof Proxy?m:Proxy,P=function(){function t(){var e;this.initEnvUrl=function(){var t=this;this.SERVER_URL=this.SERVER_PATH+"/whiteboard?sdkappid=",this.COS_SERVER_URL=this.SERVER_PATH+"/cos",this.WHITELIST_SERVER_URL=this.SERVER_PATH+"/whitelist?sdkappid=",this.TRANSCODE_SERVER_URL=this.SERVER_PATH+"/transcode?sdkappid=",this.HEARTBEAT_SERVER_URL="/v4/ilvb_heartbeat/report_heartbeat?sdkappid=",this.TEST_SERVER_URL="/v4/ilvb_test/whiteboard?sdkappid=",this.TEST_COS_SERVER_URL="/v4/ilvb_test/cos",this.TEST_WHITELIST_SERVER_URL="/v4/ilvb_test/whitelist?sdkappid=",this.TEST_TRANSCODE_SERVER_URL="/v4/ilvb_test/transcode?sdkappid=",this.TEST_HEARTBEAT_SERVER_URL="/v4/ilvb_test/report_heartbeat?sdkappid=",this.ELKLOG_WATER_HOSTNAME="https://report-log-lv0.api.qcloud.com",this.ELKLOG_KEY_HOSTNAME="https://report-log-lv1.api.qcloud.com",this.exifUrl=this.getResourceUrl("/board/third/exif/exif-js.min.js"),this.fontUrl=this.getResourceUrl("/board/fonts/simhei-Regular.ttf"),this.noneCursorIcon=this.getResourceUrl("/board/icons/none.png"),this.penCursorIcon=this.getResourceUrl("/board/icons/pen2.png"),this.laserCursorIcon=this.getResourceUrl("/board/icons/laserpen.png"),this.defaultLoadingImage=this.getResourceUrl("/board/icons/default-loading-96px.png"),this.zoomInIcon=this.getResourceUrl("/board/icons/zoomin.svg"),this.zoomOutIcon=this.getResourceUrl("/board/icons/zoomout.svg"),this.mathGraphURL=this.getResourceUrl("/board/third/mathTools/mathgraph.min.js"),this.mathjaxURL=this.getResourceUrl("/board/third/mathTools/tex-svg.js"),this.pptPreloaderURL=this.getResourceUrl("/board/third/pptPreloader/2.9.2/loader.html"),this.audioIcons=new C({startIcon:this.getResourceUrl("/board/icons/start.svg"),pauseIcon:this.getResourceUrl("/board/icons/pause.svg"),mutedIcon:this.getResourceUrl("/board/icons/muted.svg"),unmutedIcon:this.getResourceUrl("/board/icons/unmuted.svg"),closeIcon:this.getResourceUrl("/board/icons/close.svg"),disableStartIcon:this.getResourceUrl("/board/icons/start-disable.svg"),disablePauseIcon:this.getResourceUrl("/board/icons/pause-disable.svg"),disableMutedIcon:this.getResourceUrl("/board/icons/muted-disable.svg"),disableUnmutedIcon:this.getResourceUrl("/board/icons/unmuted-disable.svg"),disableCloseIcon:this.getResourceUrl("/board/icons/close-disable.svg")},{get:function(e,r){return t.getProxySetting(e[r])}}),this.html2canvasUrl=this.getResourceUrl("/board/third/html2canvas/html2canvas.min.js"),this.cursorLayerImages=new C({rotateImgSrc:this.getResourceUrl("/board/icons/rotate-icon.png"),rotateCursorImgSrc:this.getResourceUrl("/board/icons/rotate-cursor-icon.png"),rotateCursorImgSrc2:this.getResourceUrl("/board/icons/rotate-cursor-icon2.png")},{get:function(e,r){return t.getProxySetting(e[r])}}),this.tiwLoggerUrl=this.getResourceUrl("/board/third/tiwlogger/tiwlogger-sdk.min.js")},this.updateAccessibleHostName=function(){this.SERVER_HOSTNAME.push(this.SERVER_HOSTNAME.shift()),this.hostName=this.SERVER_HOSTNAME[0]},this.getHostName=function(){return this.hostName.includes("http")?this.hostName:"https://".concat(this.hostName)},this.setProxyServer=function(t,e){this.PROXY_SERVER_MAP[t]=e},this.getWhiteBoardServerUrl=function(t){var e=this.getHostName();return"".concat(e).concat(t?this.TEST_SERVER_URL:this.SERVER_URL)},this.getCosServerUrl=function(t){var e=this.getHostName();return"".concat(e).concat(t?this.TEST_COS_SERVER_URL:this.COS_SERVER_URL)},this.getWhiteListServerUrl=function(t){var e=this.getHostName();return"".concat(e).concat(t?this.TEST_WHITELIST_SERVER_URL:this.WHITELIST_SERVER_URL)},this.getTranscodeServerUrl=function(t){var e=this.getHostName();return"".concat(e).concat(t?this.TEST_TRANSCODE_SERVER_URL:this.TRANSCODE_SERVER_URL)},this.getHeartbeatServerUrl=function(t){var e=this.getHostName();return"".concat(e).concat(t?this.TEST_HEARTBEAT_SERVER_URL:this.HEARTBEAT_SERVER_URL)},this.getProxySetting=function(t){var e=null;if(t.includes("yun.tim.qq.com")||t.includes("api.my-imcloud.com")?e=this.PROXY_SERVER_MAP[o.TIW_SERVER]:t.includes("log.qcloudtiw.com")?e=this.PROXY_SERVER_MAP[o.LOG_SERVER]:t.includes("report-log-lv0.api.qcloud.com")?e=this.PROXY_SERVER_MAP[o.LOG_VERBOSE]:t.includes("report-log-lv1.api.qcloud.com")?e=this.PROXY_SERVER_MAP[o.LOG_KEY]:t.includes("res.qcloudtiw.com")?e=this.PROXY_SERVER_MAP[o.TIW_RESOURCE]:t.includes("thumbnail.qcloudtiw.com")&&(e=this.PROXY_SERVER_MAP[o.PPT_THUMBNAIL]),!e)return t;var r=new URL(t),i=null;try{i=new URL(e)}catch(t){i=r}return r.protocol=i.protocol||r.protocol,r.host=i.host,r.pathname="".concat("/"===i.pathname?"":i.pathname).concat(r.pathname),r.toString()},this.replaceAssetsProtocol=function(t){return t&&"https"!==this.assetsProtocol&&(t=t.replace(/^.*:\/\//,this.assetsProtocol+"://")),t},this.reReplaceAssetsProtocol=function(t){return t&&"https"!==this.assetsProtocol&&t.indexOf(this.assetsProtocol)>-1&&(t=t.replace(/^.*:\/\//,"https://")),t},this.historyRealtimeDataReplaceAssetsProtocol=function(t){return t&&t.indexOf("teducache")>-1&&(t=t.replace(/^.*:\/\//,"https://")),t},this.getResourceUrl=function(t){if("https"!==this.assetsProtocol)return"".concat(this.assetsProtocol,"://").concat(this.RESOURCE_HOSTNAME.replace(/^https?:\/\//,"")).concat(t);var e=0===this.RESOURCE_HOSTNAME.indexOf("http")?"":"https://";return"".concat(e).concat(this.RESOURCE_HOSTNAME).concat(t)},this.enablePrivateEnv=function(t){void 0===t&&(t=!1),this._privateEnv=t||!1},this.isPrivateEnv=function(){return this._privateEnv},this.setPrivateEnvConfig=function(e){this.customServerConfig=e;var r=e.serverHost,i=e.resourceHost,o=e.serverPath;r?(this.SERVER_HOSTNAME=[r],this.hostName=this.SERVER_HOSTNAME[0]):(this.SERVER_HOSTNAME=t.BoardServerHost,this.hostName=this.SERVER_HOSTNAME[0]),i&&(this.RESOURCE_HOSTNAME=i),o?this.SERVER_PATH=o:this.isPrivateEnv()&&(this.SERVER_PATH=""),this.initEnvUrl(),M.initCursorIcons()},this.customServerConfig={},this.assetsProtocol="https",this.SERVER_HOSTNAME=t.BoardServerHost,this.hostName=this.SERVER_HOSTNAME[0],this.SERVER_PATH="/v4/ilvb_edu",this.RESOURCE_HOSTNAME="res.qcloudtiw.com",this.THUMBNAIL_HOSTNAME="https://thumbnail.qcloudtiw.com",this.CDN_DOMAIN="qcloudtiw.com",this.PROXY_SERVER_MAP=((e={})[o.TIW_SERVER]=null,e[o.TIW_RESOURCE]=null,e[o.PPT_THUMBNAIL]=null,e[o.LOG_SERVER]=null,e[o.LOG_KEY]=null,e[o.LOG_VERBOSE]=null,e),this.initEnvUrl()}return t.BoardServerHost=["yun.tim.qq.com","api.my-imcloud.com"],t}(),L=new C(new P,{get:function(t,e,r){return["exifUrl","fontUrl","noneCursorIcon","penCursorIcon","laserCursorIcon","defaultLoadingImage","zoomInIcon","zoomOutIcon","html2canvasUrl","tiwLoggerUrl","THUMBNAIL_HOSTNAME","mathGraphURL"].includes(e)?t.getProxySetting(t[e]):Reflect.get(t,e,r)}}),M=new(function(){function t(){this.BOARD_MODE={BOARD:0,FILE:1},this.BACKGROUND_TYPE={IMAGE:0,H5:1},this.FILL_MODE={DEFAULT:0,LEFT:4,TOP:5,RIGHT:6,BOTTOM:7},this.COLOR={RED:4278190335,WHITE:4294967295},this.EVENT={HISTROY_DATA_COMPLETE:"histroy_data_complete",ADD_BOARD:"add_board",RT_DATA:"real_time_data",REAL_TIME_DATA:"real_time_data",ADD_DATA_ERROR:"add_data_error",DELETE_BOARD:"delete_board",SWITCH_BOARD:"switch_board",ADD_FILE:"add_group",ADD_H5PPT_FILE:"add_h5ppt_file",DELETE_FILE:"delete_group",SWITCH_FILE:"switch_group",IMG_START_LOAD:"img_start_load",IMG_LOAD:"img_load",IMG_ERROR:"img_error",IMG_ABORT:"img_abort",PRELOAD:"preload",BOARD_CAN_UNDO:"board_can_undo",BOARD_CAN_REDO:"board_can_redo",VERIFY_SDK_SUCC:"verify_sdk_succ",VERIFY_SDK_ERROR:"verify_sdk_error",CANVAS_MOUSEDOWN:"canvas_mousedown",CANVAS_MOUSEMOVE:"canvas_mousemove",CANVAS_MOUSEUP:"canvas_mouseup",CANVAS_MOUSELEAVE:"canvas_mouseleave",CANVAS_TOUCHSTART:"canvas_touchstart",CANVAS_TOUCHMOVE:"canvas_touchmove",CANVAS_TOUCHEND:"CANVAS_touchend",CANVAS_TOUCHCANCEL:"canvas_touchcancel",UPDATE_BACKGROUND_IMAGE_SUCCESS:"update_background_image_success",UPDATE_BACKGROUND_IMAGE_ERROR:"update_background_image_error",COS:{GET_SIGN_ERROR:"get_sign_error",TASK_READY:"task_ready",HASH_PROGRESS:"hash_progress",PROGRESS:"progress",GET_SIGN_SUCCESS:"get_sign_success",DOES_NOT_SUPPORT_UPLOAD:"does_not_support_upload",UPLOAD_SUCCESS:"upload_success",UPLOAD_ERROR:"upload_error"}},this.PROTOCOL_ACTION={LINE_START_ACTION:1,LINE_MOVE_ACTION:2,LINE_END_ACTION:3,RASER_SHOW_ACTION:6,RASER_HIDE_ACTION:7,ERASER_ACTION:8,MOVE_LINE_GRAPH_ACTION:9,GRAPH_LINE_ACTION:10,GRAPH_CIRCLE_ACTION:11,GRAPH_RECT_ACTION:12,INPUT_TEXT_ACTION:13,REALTIME_SYNC_GRAPH_ACTION:16,IMAGE_ELEMENT:20,H5Web_ELEMENT:21,CUSTOM_GRAPH_ELEMENT:22,AUDIO_ELEMENT:23,GLOBAL_AUDIO_ELEMENT:24,JSXGRAPH_BOARD_ELEMENT:25,JSXGRAPH_GRAPH_ELEMENT:26,MAGIC_LINE_ELEMENT:27,FORMULA_ELEMENT:28,GRAPH_ARC_ELEMENT:29,GRAPH_RIGHT_TRIANGLE_ACTION:30,GRAPH_ISOSCELES_TRIANGLE_ACTION:31,GRAPH_PARALLELOPGRAM_ACTION:32,GRAPH_CUBE_ACTION:33,GRAPH_CYLINDER_ACTION:34,GRAPH_CONE_ACTION:35,GRAPH_COORDINATE_ACTION:36,MATH_TOOL_ACTION:37,WATERMARK_ACTION:38,FILE_MESSAGE_ACTION:40,SLICE_MESSAGE_ACTION:50,GRAPH_CLEAR_ALL_ACTION:101,GRAPH_CLEAR_ACTION:102,FILE_CLEAR_ACTION:103,RESET_DATA_ACTION:104,SET_BOARD_RATIO_ACTION:105,SET_BOARD_FIT_MODE_ACTION:106,SET_BOARD_REMARK_ACTION:107,POINT_ERASER_ACTION:108,SPLIT_LINE_ACTION:109,UPDATE_BG_IMG_ACTION:201,DELETE_BG_IMG_ACTION:202,UPDATE_BG_COLOR_ACTION:203,BOARD_MOVE_SCALE_ACTION:301,FILE_SCALE_ACTION:302,SWITCH_ACTION:401,ADD_FILE_ACTION:501,PPT_EVENT_ACTION:601,WPS_EVENT_ACTION:651,VIDEO_EVENT_ACTION:701,H5WEB_EVENT_ACTION:801,USERINFO_EVENT_ACTION:901,DISCUSSION_GROUP_SWITCH_ACTION:1001,DISCUSSION_GROUP_SETTING_ACTION:1002,BROADCAST_SINGLE_BOARD_DATA:2001,MEDIA_PLAY_IN_PPT:2002,BROADCAST_ELEMENT_STYLE:2003,BROADCAST_LINUX_FORCEREFRESH:2004},this.SUB_CMD={GET_BOARD_DATA:"get_board_data",REPORT_BOARD_DATA:"report_board_data"},this.PROGRESS_ENABLE=!1,this.PROGRESS_SHOW_DELAY=100,this.SYNC_VIDEO_STATUS_INTERVAL=3e3,this.SYNC_VIDEO_STATUS_PRECISION=3e3,this.VIDEO_ACTION_TRYTIMES=5,this.COMMON_GROUP="#DEFAULT",this.COMMON_DEFAULT_BOARD="#DEFAULT",this.SCALE=100,this.MAX_SCALE=1600,this.MIN_SCALE=100,this.RATIO="16:9",this.TOP=50,this.LEFT=50,this.THIN=100,this.SMOOTH_LEVEL=0,this.MIN_LINE_WIDTH=1,this.MIN_FONT_SIZE=1,this.TEXT_MAX_LENGTH=2e3,this.TEXT_SIZE=320,this.TEXT_COLOR="#000000",this.TEXT_FONT_FAMILY="customFontFamily,sans-serif,serif,monospace",this.DATA_SYNC_ENABLE=!0,this.PRELOAD_DEPTH=5,this.IMAGESFILE_MAX_URL_LENGTH=5e3,this.REALTIMEDATA_MAX_LENGTH=7e3,this.RENDER_INTERVAL=20,this.IMAGE_TIMEOUT=10,this.H5PPT_TIMEOUT=10,this.TEXT_FONT_STYLE={NORMAL:0,BOLD:1,ITALIC:2,BOLD_ITALIC:3},this.FILE_TYPE={IMG:0,H5PPT:1,VOD:2,LIVE:3,H5FILE:4,VODFILE:5,IMAGESFILE:6},this.VIDEO_STATUS={STOP:0,PLAY:1,PAUSE:2},this.VIDEO_ACTION={PASSIVE:1,API:2,EXCEPTIOIN:3,SEEK_FIXED:4},this.VIDEO_FORMAT={NONE:"",MP4:"mp4",M3U8:"m3u8",FLV:"flv",RTMP:"rtmp"},this.ABOUTBLANK="about:blank",this.PPTMODE="WPS",this.BITRATE_LIMIT=2048,this.ICONS={},this.HIGHLIGHTER_COLOR="rgba(221, 253, 142, 0.5)",this.MOUSE_TOUCH_ID="mouse_touch_id",this.initCursorIcons()}return t.prototype.initCursorIcons=function(){this.ICONS={0:{cursor:"auto"},1:{cursor:"url",url:L.penCursorIcon,offsetX:0,offsetY:0},2:{cursor:"auto"},3:{cursor:"url",url:L.laserCursorIcon,offsetX:32,offsetY:32},4:{cursor:"crosshair"},5:{cursor:"crosshair"},6:{cursor:"crosshair"},7:{cursor:"crosshair"},8:{cursor:"crosshair"},9:{cursor:"auto"},10:{cursor:"crosshair"},11:{cursor:"text"},12:{cursor:"url",url:L.zoomInIcon},13:{cursor:"crosshair"},14:{cursor:"crosshair"},15:{cursor:"crosshair"},16:{cursor:"crosshair"},17:{cursor:"crosshair"},18:{cursor:"crosshair"},19:{cursor:"url",url:L.penCursorIcon,offsetX:0,offsetY:0},20:{cursor:"crosshair"},21:{cursor:"crosshair"},22:{cursor:"crosshair"},23:{cursor:"crosshair"},24:{cursor:"crosshair"},25:{cursor:"crosshair"},26:{cursor:"crosshair"}}},t}()),R=function(t){return"[object String]"==Object.prototype.toString.call(t)},N=function(t){return"[object Object]"==Object.prototype.toString.call(t)},B=function(t){return"[object Array]"==Object.prototype.toString.call(t)},k=function(t){return"[object Function]"==Object.prototype.toString.call(t)},F=function(t){return"[object Undefined]"==Object.prototype.toString.call(t)},U=function(t){return"[object Null]"==Object.prototype.toString.call(t)},H=function(t){return"[object Number]"==Object.prototype.toString.call(t)},G=function(t,e){void 0===e&&(e=!1);var r=[M.FILE_TYPE.VOD,M.FILE_TYPE.LIVE,M.FILE_TYPE.H5FILE,M.FILE_TYPE.VODFILE];return e&&(r=r.filter((function(t){return t!==M.FILE_TYPE.H5FILE}))),r.indexOf(t)>-1},q=function(t){return t.indexOf("for_tiw=1")>-1?"WPS":"ISPRING"},W=function(t){var e="";return H(t)?e=z(t):R(t)&&(0==(t=t.replace(/\s*/g,"")).indexOf("#")?e=j(t):t.startsWith("rgb(")?e=t.replace("rgb(","rgba(").replace(")",",1)"):t.startsWith("rgba(")&&(e=t)),e},Y=function(t){var e="";return t.substring(t.indexOf("(")+1,t.lastIndexOf(")")).split(",").forEach((function(t,r){var i="";r<3?i=Number(t).toString(16):3===r&&(i=Math.min(255,Math.floor(255*+t)).toString(16)),1==i.length&&(i="0"+i),e+=i})),parseInt(e,16)},z=function(t){var e,r=t>>24&255,i=t>>16&255,o=t>>8&255;return e=t<0?1:parseFloat(((255&t)/255).toFixed(2)),"rgba(".concat(r,",").concat(i,",").concat(o,",").concat(e,")")},j=function(t){if(3==(t=t.replace("#","")).length){var e=t.substring(0,1),r=t.substring(1,2),i=t.substring(2,3);t=e+e+r+r+i+i+"ff"}else 6==t.length?t=t.substring(0,6)+"ff":t.length>=8&&(t=t.substring(0,8));var o=parseInt(t,16);return z(o)},V=function(){function t(t,e,r,i){this._boardWidth=0,this._boardHeight=0,this._nativeVersion="",this._disablePointerEvent=!1,this._sdkAppId=t,this._classId=e,this._userId=r,this._userSig=i}return Object.defineProperty(t.prototype,"sdkAppId",{get:function(){return this._sdkAppId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"classId",{get:function(){return this._classId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this._userId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userSig",{get:function(){return this._userSig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"boardWidth",{get:function(){return this._boardWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"boardHeight",{get:function(){return this._boardHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tiwConfig",{get:function(){return this._tiwConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"event",{get:function(){return this._event},set:function(t){this._event=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logger",{get:function(){return this._logger},set:function(t){this._logger=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nativeVersion",{get:function(){return this._nativeVersion},set:function(t){this._nativeVersion=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"proxyServer",{get:function(){return this._proxyServer},set:function(t){this._proxyServer=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"teduToolType",{get:function(){return this._teduToolType},set:function(t){this._teduToolType=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"eventListener",{get:function(){return this._eventListener},set:function(t){this._eventListener=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"settingConfig",{get:function(){return this._settingConfig},set:function(t){this._settingConfig=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"permissionHandler",{get:function(){return this._permissionHandler},set:function(t){this._permissionHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"seqUtil",{get:function(){return this._seqUtil},set:function(t){this._seqUtil=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disablePointerEvent",{get:function(){return this._disablePointerEvent},set:function(t){this._disablePointerEvent=t},enumerable:!1,configurable:!0}),t}(),X=function(){function t(e){if(this.loggerModuleName="Core",this.brushColor=W(M.COLOR.RED),this._instanceKey=e,!t.tiwInstanceMap.has(e))throw new Error("instance not found: ".concat(e));this._coreData=t.tiwInstanceMap.get(e),this.loggerModuleName=this.constructor.name}return t.register=function(e,r,i,o,n){if(!t.tiwInstanceMap.has(e+"")){var a=new V(r,i,o,n);t.tiwInstanceMap.set(e+"",a)}},Object.defineProperty(t.prototype,"event",{get:function(){return this._coreData.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logger",{get:function(){return this._coreData.logger},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sdkAppId",{get:function(){return this._coreData.sdkAppId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"classId",{get:function(){return Number(this._coreData.classId).valueOf()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"identifier",{get:function(){return this._coreData.userId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userSig",{get:function(){return this._coreData.userSig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"instanceKey",{get:function(){return this._instanceKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nativeVersion",{get:function(){return this._coreData.nativeVersion},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"proxyServer",{get:function(){return this._coreData.proxyServer},enumerable:!1,configurable:!0}),t.prototype.setNativeVersion=function(t){this._coreData.nativeVersion=t},t.prototype.setProxyServerForCore=function(t){this._coreData.proxyServer=t},t.prototype.setEvent=function(t){this._coreData.event=t},t.prototype.setLogger=function(t){this._coreData.logger=t},t.prototype.setTEduToolType=function(t){this._coreData.teduToolType=t},Object.defineProperty(t.prototype,"teduToolType",{get:function(){return this._coreData.teduToolType},enumerable:!1,configurable:!0}),t.prototype.setTEduEventListener=function(t){this._coreData.eventListener=t},Object.defineProperty(t.prototype,"teduEventListener",{get:function(){return this._coreData.eventListener},enumerable:!1,configurable:!0}),t.prototype.setSettingConfig=function(t){this._coreData.settingConfig=t},Object.defineProperty(t.prototype,"settingConfig",{get:function(){return this._coreData.settingConfig},enumerable:!1,configurable:!0}),t.prototype.destroyCore=function(e){t.tiwInstanceMap.delete(e)},t.prototype.setPermissionHandler=function(t){this._coreData.permissionHandler=t},Object.defineProperty(t.prototype,"permissionHandler",{get:function(){return this._coreData.permissionHandler},enumerable:!1,configurable:!0}),t.prototype.setSeqUtil=function(t){this._coreData.seqUtil=t},Object.defineProperty(t.prototype,"seqUtil",{get:function(){return this._coreData.seqUtil},enumerable:!1,configurable:!0}),t.prototype.setDisablePointerEvent=function(t){this._coreData.disablePointerEvent=t},Object.defineProperty(t.prototype,"disablePointerEvent",{get:function(){return this._coreData.disablePointerEvent},enumerable:!1,configurable:!0}),t.tiwInstanceMap=new Map,t}();r(183),r(187),r(287),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild&&this.parentNode.removeChild(this)}})})),window.scrollTo||(window.scrollTo=function(t,e){window.pageXOffset=t,window.pageYOffset=e}),window.scrollBy||(window.scrollBy=function(t,e){window.pageXOffset+=t,window.pageYOffset+=e}),Element.prototype.scrollTo||(Element.prototype.scrollTo=function(t,e){this.scrollLeft=t,this.scrollTop=e}),Element.prototype.scrollBy||(Element.prototype.scrollBy=function(t,e){this.scrollLeft+=t,this.scrollTop+=e}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(t,e){return e=!e||e<0?0:+e,this.substring(e,e+t.length)===t}}),String.prototype.padStart||Object.defineProperty(String.prototype,"padStart",{configurable:!0,writable:!0,value:function(t,e){return t>>=0,e=String(void 0!==e?e:" "),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),e.slice(0,t)+String(this))}}),String.prototype.padEnd||Object.defineProperty(String.prototype,"padEnd",{configurable:!0,writable:!0,value:function(t,e){return t>>=0,e=String(void 0!==e?e:" "),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),String(this)+e.slice(0,t))}}),String.prototype.repeat||Object.defineProperty(String.prototype,"repeat",{configurable:!0,writable:!0,value:function(t){if(null==this)throw new TypeError("can't convert "+this+" to object");var e=""+this;if((t=+t)!=t&&(t=0),t<0)throw new RangeError("repeat count must be non-negative");if(t==1/0)throw new RangeError("repeat count must be less than infinity");if(t=Math.floor(t),0==e.length||0==t)return"";if(e.length*t>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var r="";1==(1&t)&&(r+=e),0!=(t>>>=1);)e+=e;return r}}),"undefined"!=typeof window&&window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var r=0;r<this.length;r++)t.call(e,this[r],r,this)});var J,K=function(t,e,r){void 0===e&&(e=null),void 0===r&&(r=!1);var i=document.createElement("script");i.type="text/javascript",r&&(i.setAttribute("rel","preload"),i.setAttribute("as","script")),i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=null,e&&e())}:i.onload=function(){e&&e()},i.src=t,document.getElementsByTagName("head")[0].appendChild(i)},Z=function(t){t&&((new Image).src=t)},Q=function(){K(L.tiwLoggerUrl),function(){var t=L.audioIcons;for(var e in t){var r=t[e];Z(r)}}()},$={TEDU_BOARD_WARNING_SYNC_DATA_PARSE_FAILED:1,TEDU_BOARD_WARNING_H5PPT_ALREADY_EXISTS:3,TEDU_BOARD_WANNING_ILLEGAL_OPERATION:5,TEDU_BOARD_WARNING_H5FILE_ALREADY_EXISTS:6,TEDU_BOARD_WARNING_VIDEO_ALREADY_EXISTS:7,TEDU_BOARD_WARNING_IMAGESFILE_ALREADY_EXISTS:8,TEDU_BOARD_WARNING_GRAFFITI_LOST:9,TEDU_BOARD_WARNING_CUSTOM_GRAPH_URL_NON_EXISTS:10,TEDU_BOARD_WARNING_IMAGESFILE_TOO_LARGE:11,TEDU_BOARD_WARNING_IMAGE_COURSEWARE_ALREADY_EXISTS:12,TEDU_BOARD_WARNING_IMAGE_MEDIA_BITRATE_TOO_LARGE:13,TEDU_BOARD_WARNING_IMAGE_WATERMARK_ALREADY_EXISTS:14,TEDU_BOARD_WARNING_FORMULA_LIB_NOT_LOADED:15,TEDU_BOARD_WARNING_ILLEGAL_FORMULA_EXPRESSION:16,TEDU_BOARD_WARNING_TEXT_WATERMARK_ALREADY_EXISTS:17,TEDU_BOARD_WARNING_EXPORTIMPORT_FILTERRULE_ILLEGAL:18,TEDU_BOARD_WARNING_ELEMENTTYPE_NOT_EXISTS:19,TEDU_BOARD_WARNING_ELEMENTID_NOT_EXISTS:20,TEDU_BOARD_WARNING_ELEMENT_IS_LOCKED:21,TEDU_BOARD_WARNING_FILE_NOT_FOUND:22,TEDU_BOARD_WARNING_SEPT_RATE_LIMITING:23,TEDU_BOARD_WARNING_DOWNGRADE:24},tt={TEB_INIT:"TEB_INIT",TEB_ERROR:"TEB_ERROR",TEB_WARNING:"TEB_WARNING",TEB_SYNCDATA:"TEB_SYNCDATA",TEB_HISTROYDATA_SYNCCOMPLETED:"TEB_HISTROYDATA_SYNCCOMPLETED",TEB_OPERATE_CANUNDO_STATUS_CHANGED:"TEB_OPERATE_CANUNDO_STATUS_CHANGED",TEB_OPERATE_CANREDO_STATUS_CHANGED:"TEB_OPERATE_CANREDO_STATUS_CHANGED",TEB_IMAGE_STATUS_CHANGED:"TEB_IMAGE_STATUS_CHANGED",TEB_H5BACKGROUND_STATUS_CHANGED:"TEB_H5BACKGROUND_STATUS_CHANGED",TEB_H5FILE_STATUS_CHANGED:"TEB_H5FILE_STATUS_CHANGED",TEB_VIDEO_STATUS_CHANGED:"TEB_VIDEO_STATUS_CHANGED",TEB_AUDIO_STATUS_CHANGED:"TEB_AUDIO_STATUS_CHANGED",TEB_FILEUPLOADSTATUS:"TEB_FILEUPLOADSTATUS",TEB_H5PPT_STATUS_CHANGED:"TEB_H5PPT_STATUS_CHANGED",TEB_ADDBOARD:"TEB_ADDBOARD",TEB_DELETEBOARD:"TEB_DELETEBOARD",TEB_GOTOBOARD:"TEB_GOTOBOARD",TEB_ADDH5PPTFILE:"TEB_ADDH5PPTFILE",TEB_ADDFILE:"TEB_ADDFILE",TEB_DELETEFILE:"TEB_DELETEFILE",TEB_SWITCHFILE:"TEB_SWITCHFILE",TEB_SETBACKGROUNDIMAGE:"TEB_SETBACKGROUNDIMAGE",TEB_FILEUPLOADPROGRESS:"TEB_FILEUPLOADPROGRESS",TEB_ADDTRANSCODEFILE:"TEB_ADDTRANSCODEFILE",TEB_GOTOSTEP:"TEB_GOTOSTEP",TEB_TRANSCODEPROGRESS:"TEB_TRANSCODEPROGRESS",TEB_VODEXTPARAM:"TEB_VODEXTPARAM",TEB_ADDIMAGEELEMENT:"TEB_ADDIMAGEELEMENT",TEB_ADDIMAGESFILE:"TEB_ADDIMAGESFILE",TEB_RECTSELECTED:"TEB_RECTSELECTED",TEB_ADDELEMENT:"TEB_ADDELEMENT",TEB_REFRESH:"TEB_REFRESH",TEB_SNAPSHOT:"TEB_SNAPSHOT",TEB_REPORT_LOG:"TEB_REPORT_LOG",TEB_REMOVEELEMENT:"TEB_REMOVEELEMENT",TEB_BOARD_SCALE_CHANGE:"TEB_BOARD_SCALE_CHANGE",TEB_TEXT_COMPONENT_STATUS_CHANGE:"TEB_TEXT_ELEMENT_STATUS_CHANGED",TEB_TEXT_ELEMENT_STATUS_CHANGED:"TEB_TEXT_ELEMENT_STATUS_CHANGED",TEB_IMAGE_ELEMENT_STATUS_CHANGED:"TEB_IMAGE_ELEMENT_STATUS_CHANGED",TEB_TEXT_ELEMENT_WARNING:"TEB_TEXT_ELEMENT_WARNING",TEB_SELECTED_ELEMENTS:"TEB_SELECTED_ELEMENTS",TEB_MATH_GRAPH_EVENT:"TEB_MATH_GRAPH_EVENT",TEB_ZOOM_DRAG_STATUS:"TEB_ZOOM_DRAG_STATUS",TEB_OFFLINE_WARNING:"TEB_OFFLINE_WARNING",TEB_BOARD_REMARK_CHANGED:"TEB_BOARD_REMARK_CHANGED",TEB_CLASS_GROUP_STATUS_CHANGED:"TEB_CLASS_GROUP_STATUS_CHANGED",TEB_BOARD_SCROLL_CHANGED:"TEB_BOARD_SCROLL_CHANGED",TEB_BOARD_CURSOR_POSITION:"TEB_BOARD_CURSOR_POSITION",TEB_FIRST_FRAME_RENDERED:"TEB_FIRST_FRAME_RENDERED",TEB_BOARD_TOOLTYPE_CHANGE:"TEB_BOARD_TOOLTYPE_CHANGE",TEB_BOARD_ELEMENT_POSITION_CHANGE:"TEB_BOARD_ELEMENT_POSITION_CHANGE",TEB_BOARD_AUDIOCONTROL_ENABLE_CHANGE:"TEB_BOARD_AUDIOCONTROL_ENABLE_CHANGE",TEB_BOARD_PERMISSION_DENIED:"TEB_BOARD_PERMISSION_DENIED",TIW_HIDE_LASER_DATA:"TIW_HIDE_LASER_DATA",TIW_RESET_DATA:"TIW_RESET_DATA",TIW_DESTROY:"TIW_DESTROY",TIW_USERINFO_CHANGE:"TIW_USERINFO_CHANGE",TEB_DRAW_FACE:"TEB_DRAW_FACE",TEB_BOARD_PERMISSION_CHANGED:"TEB_BOARD_PERMISSION_CHANGED",TEB_BOARD_IMPORTINLOCALMODE_COMPLETED:"TEB_BOARD_IMPORTINLOCALMODE_COMPLETED",TEB_H5PPT_MEDIA_STATUS_CHANGED:"TEB_H5PPT_MEDIA_STATUS_CHANGED",TEB_BOARD_ELEMENT_LOCKED_CHANGED:"TEB_BOARD_ELEMENT_LOCKED_CHANGED",TEB_BOARD_LINUX_FORCE_REFRESH:"TEB_BOARD_LINUX_FORCE_REFRESH",TEB_DRAW_STATUS_CHANGED:"TEB_DRAW_STATUS_CHANGED",TEB_H5PPT_DOWN_GRADE:"TEB_H5PPT_DOWN_GRADE",TEB_H5PPT_DOWN_GRADE_INTERNAL_OPERATOR:"TEB_H5PPT_DOWN_GRADE_INTERNAL_OPERATOR",TEB_H5PPT_MEDIA_PLAY_ERROR:"TEB_H5PPT_MEDIA_PLAY_ERROR"},et=(J=function(t,e){return(J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}J(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),rt=function(){return(rt=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},it=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},ot=function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},nt=function(t){function e(e){var r=t.call(this,e)||this;return r._cbs={},r}return et(e,t),e.prototype.on=function(t,e){return this._cbs=this._cbs||{},(this._cbs[t]||(this._cbs[t]=[])).unshift(e),this},e.prototype.off=function(t,e){if(this._cbs=this._cbs||{},!t)return this._cbs={};if(!e)return delete this._cbs[t];for(var r,i=this._cbs[t]||[];i&&~(r=i.indexOf(e));)i.splice(r,1);return this},e.prototype.fire=function(t,e){void 0===t&&(t=this);for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];this._cbs=this._cbs||{};var o=this._cbs[e];if(o)for(var n=o.length;n--;)try{o[n].apply(t,ot([],it(r),!1))}catch(t){"stack:".concat(t.stack,", message:").concat(t.message)}return this},e.prototype.fireMediaBitrateWaringEvent=function(t,e){this.fire(this,tt.TEB_WARNING,$.TEDU_BOARD_WARNING_IMAGE_MEDIA_BITRATE_TOO_LARGE,JSON.stringify({fid:t,bitrate:e+"kb/s"}))},e.prototype.firstFrameRendered=function(){this.fire(this,tt.TEB_FIRST_FRAME_RENDERED)},e.prototype.fireH5pptMediaStatusChangedEvent=function(t){var e=t.fileId,r=t.mediaId,i=t.status,o=t.currentTime;this.fire(this,tt.TEB_H5PPT_MEDIA_STATUS_CHANGED,e,r,i,o)},e.prototype.fireH5pptStatusChangedEvent=function(t,e){var r;this.fire(this,tt.TEB_H5PPT_STATUS_CHANGED,t,e),null===(r=this.logger)||void 0===r||r.reportInfo(this.loggerModuleName,"h5pptStatusChangedEvent",{param:{extraInfo:JSON.stringify(rt({status:t},e))}})},e.prototype.fireGotoStepEvent=function(t,e){this.fire(this,tt.TEB_GOTOSTEP,t,e)},e.prototype.fireWarningIllegalOperateEvent=function(t){this.fireWarningEvent($.TEDU_BOARD_WANNING_ILLEGAL_OPERATION,"the "+t+" method call failed, please call it after the history data is loaded.")},e.prototype.fireWarningEvent=function(t,e){var r;this.fire(this,tt.TEB_WARNING,t,e),null===(r=this.logger)||void 0===r||r.reportWarn(this.loggerModuleName,"warnEvent",{code:t,message:e,param:{}}),this.logger.warn(this.loggerModuleName,"","code:".concat(t,", message:").concat(e),!0)},e.prototype.fireErrorEvent=function(t,e){var r;this.fire(this,tt.TEB_ERROR,t,e),null===(r=this.logger)||void 0===r||r.reportError(this.loggerModuleName,"errorEvent",{code:t,message:e,param:{}}),this.logger.error(this.loggerModuleName,"","code:".concat(t,", message:").concat(e),!0)},e.prototype._fireBoardScrollEvent=function(t){this.fire(this,"on_board_scroll",t)},e.prototype.fireImageStatusChangedEvent=function(t,e){var r;this.fire(this,tt.TEB_IMAGE_STATUS_CHANGED,t,e),null===(r=this.logger)||void 0===r||r.reportInfo(this.loggerModuleName,"imageStatusChangedEvent",{param:{extraInfo:JSON.stringify(rt({status:t},e))}})},e.prototype.fireH5BackgroundStatusChangedEvent=function(t,e){this.fire(this,tt.TEB_H5BACKGROUND_STATUS_CHANGED,t,e)},e.prototype.fireVideoStatusChangedEvent=function(t){var e;this.fire(this,tt.TEB_VIDEO_STATUS_CHANGED,t),null===(e=this.logger)||void 0===e||e.reportInfo(this.loggerModuleName,"videoStatusChangedEvent",{param:{extraInfo:JSON.stringify(rt({},t))}})},e.prototype.fireSnapshotEvent=function(t){this.fire(this,tt.TEB_SNAPSHOT,t)},e.prototype.fireRefreshEvent=function(){this.fire(this,tt.TEB_REFRESH)},e.prototype.fireTextElementStatusChangedEvent=function(t){this.fire(this,tt.TEB_TEXT_ELEMENT_STATUS_CHANGED,t)},e.prototype.fireTextElementWarningEvent=function(t){this.fire(this,tt.TEB_TEXT_ELEMENT_WARNING,t)},e.prototype.fireH5FileStatusChangedEvent=function(t){this.fire(this,tt.TEB_H5FILE_STATUS_CHANGED,t)},e.prototype.fireClassGroupStatusChangedEvent=function(t){this.fire(this,tt.TEB_CLASS_GROUP_STATUS_CHANGED,t)},e.prototype.fireAddElementEvent=function(t){this.fire(this,tt.TEB_ADDELEMENT,t)},e.prototype.fireRemoveElementEvent=function(t){this.fire(this,tt.TEB_REMOVEELEMENT,t)},e.prototype.fireBoardCursorPositionEvent=function(t){this.fire(this,tt.TEB_BOARD_CURSOR_POSITION,t)},e.prototype.fireBoardScrollChangedEvent=function(t){this.fire(this,tt.TEB_BOARD_SCROLL_CHANGED,t)},e.prototype.fireUploadFileStatusChangedEvent=function(t,e){this.fire(this,tt.TEB_FILEUPLOADSTATUS,t,e)},e.prototype.fireUploadFileProgressEvent=function(t){this.fire(this,tt.TEB_FILEUPLOADPROGRESS,t)},e.prototype.fireMathGraphEvent=function(t){this.fire(this,tt.TEB_MATH_GRAPH_EVENT,t)},e.prototype.fireAddMathGraphEvent=function(t){this.fire(this,"add_math_graph",t)},e.prototype.fireTiwInitEvent=function(){this.fire(this,tt.TEB_INIT)},e.prototype.fireHistoryDataSyncCompletedEvent=function(){this.fire(this,tt.TEB_HISTROYDATA_SYNCCOMPLETED)},e.prototype.fireAddBoardEvent=function(t,e){this.fire(this,tt.TEB_ADDBOARD,t,e)},e.prototype.fireDeleteBoardEvent=function(t,e){this.fire(this,tt.TEB_DELETEBOARD,t,e)},e.prototype.fireGotoBoardEvent=function(t,e,r){this.fire(this,tt.TEB_GOTOBOARD,t,e,r)},e.prototype.fireAddTranscodeFileEvent=function(t){this.fire(this,tt.TEB_ADDTRANSCODEFILE,t)},e.prototype.fireAddFileEvent=function(t){this.fire(this,tt.TEB_ADDFILE,t)},e.prototype.fireAddImagesFileEvent=function(t){this.fire(this,tt.TEB_ADDIMAGESFILE,t)},e.prototype.fireAddH5PPTFileEvent=function(t){this.fire(this,tt.TEB_ADDH5PPTFILE,t)},e.prototype.fireToolTypeChanged=function(t){this.fire(this,tt.TEB_BOARD_TOOLTYPE_CHANGE,t)},e.prototype.fireDrawLaserEvent=function(t){this.fire(this,"draw_laser",t)},e.prototype.fireSyncDataEvent=function(t){this.fire(this,tt.TEB_SYNCDATA,t)},e.prototype.fireDrawFaceEvent=function(){this.fire(this,tt.TEB_DRAW_FACE)},e.prototype.fireSwitchFileEvent=function(t){this.fire(this,tt.TEB_SWITCHFILE,t)},e.prototype.fireZoomDragStatusEvent=function(t){this.fire(this,tt.TEB_ZOOM_DRAG_STATUS,t)},e.prototype.fireRenderVideoEvent=function(t){this.fire(this,"render_video",t)},e.prototype.fireDeleteFileEvent=function(t){this.fire(this,tt.TEB_DELETEFILE,t)},e.prototype.fireBoardScaleChangeEvent=function(t){this.fire(this,tt.TEB_BOARD_SCALE_CHANGE,t)},e.prototype.fireAddImageElementEvent=function(t,e,r){this.fire(this,tt.TEB_ADDIMAGEELEMENT,t,e,r)},e.prototype.fireSetBackgroundImageEvent=function(t,e,r){this.fire(this,tt.TEB_SETBACKGROUNDIMAGE,t,e,r)},e.prototype.fireAudioControlEnableChangedEvent=function(t){this.fire(this,tt.TEB_BOARD_AUDIOCONTROL_ENABLE_CHANGE,t)},e.prototype.fireAudioStatusChangedEvent=function(t){var e;this.fire(this,tt.TEB_AUDIO_STATUS_CHANGED,t),null===(e=this.logger)||void 0===e||e.reportInfo(this.loggerModuleName,"audioStatusChangedEvent",{param:{extraInfo:JSON.stringify(rt({},t))}})},e.prototype.fireOfflineWarning=function(t){this.fire(this,tt.TEB_OFFLINE_WARNING,{count:t})},e.prototype.fireCanRedoStatusChangedEvent=function(t){this.fire(this,tt.TEB_OPERATE_CANREDO_STATUS_CHANGED,t)},e.prototype.fireCanUndoStatusChangedEvent=function(t){this.fire(this,tt.TEB_OPERATE_CANUNDO_STATUS_CHANGED,t)},e.prototype.fireBoardRemarkChanged=function(t){this.fire(this,tt.TEB_BOARD_REMARK_CHANGED,t)},e.prototype.fireSelectedElements=function(t){this.fire(this,tt.TEB_SELECTED_ELEMENTS,t)},e.prototype.fireReportLogEvent=function(t){var e=this;setTimeout((function(){try{e.fire(e,tt.TEB_REPORT_LOG,t)}catch(t){}}),0)},e.prototype.fireElementPositionChangeEvent=function(t,e){this.fire(this,tt.TEB_BOARD_ELEMENT_POSITION_CHANGE,t,e)},e.prototype.fireImageElementStatusChangedEvent=function(t,e){this.fire(this,tt.TEB_IMAGE_ELEMENT_STATUS_CHANGED,t,e)},e.prototype.fireHideLaserDataEvent=function(){this.fire(this,tt.TIW_HIDE_LASER_DATA)},e.prototype.fireResetData=function(){this.fire(this,tt.TIW_RESET_DATA)},e.prototype.firePermissionDenied=function(t){var e;this.fire(this,tt.TEB_BOARD_PERMISSION_DENIED,t),null===(e=this.logger)||void 0===e||e.reportError(this.loggerModuleName,"PermissionDenied",{code:-1,message:t,param:{}})},e.prototype.firePermissionChanged=function(t,e){this.fire(this,tt.TEB_BOARD_PERMISSION_CHANGED,t,e)},e.prototype.fireDestroyEvent=function(){this.fire(this,tt.TIW_DESTROY)},e.prototype.fireUserInfoChange=function(t,e){this.fire(this,tt.TIW_USERINFO_CHANGE,t,e)},e.prototype.fireImportInLocalMode=function(t){this.fire(this,tt.TEB_BOARD_IMPORTINLOCALMODE_COMPLETED,t)},e.prototype.fireElementLockedChanged=function(t,e){this.fire(this,tt.TEB_BOARD_ELEMENT_LOCKED_CHANGED,t,e)},e.prototype.fireLinuxRefreshEvent=function(){this.fire(this,tt.TEB_BOARD_LINUX_FORCE_REFRESH)},e.prototype.fireDrawStatusChanged=function(t){this.fire(this,tt.TEB_DRAW_STATUS_CHANGED,t)},e.prototype.fireH5PPtDownGradeWaringEvent=function(t,e){this.fire(this,tt.TEB_H5PPT_DOWN_GRADE,t,e)},e.prototype.fireH5PPtDownGradeInernalOperatorEvent=function(t,e){this.fire(this,tt.TEB_H5PPT_DOWN_GRADE_INTERNAL_OPERATOR,t,e)},e.prototype.fireH5pptMediaPlayError=function(t){this.fire(this,tt.TEB_H5PPT_MEDIA_PLAY_ERROR,t)},e}(X),at=r(99),st=r.n(at),lt=function(t){return t?st.a.compressToBase64(t):""},ct=function(t){return t&&st.a.decompressFromBase64(t)||""},ht={ALL:0,INFO:1,WARNING:2,ERROR:3,OFF:4},ut=r(72),dt=r.n(ut);function pt(t,e){try{dt.a.enableXmp(),dt.a.getData(t,(function(){e(dt.a.getAllTags(this),"success")}))}catch(t){e({Orientation:-1},"exif exception")}}var ft=function(t,e,r){R(t)?function(t,e,r){var i=new XMLHttpRequest;i.open("GET",t,!0),i.timeout=1e3*(e||M.IMAGE_TIMEOUT),i.responseType="blob",i.onload=function(t){if(4===i.readyState)if(200===i.status){var e=this.response;r(window.URL.createObjectURL(e))}else r("")},i.onerror=function(t){r("")},i.send(null)}(t,e,(function(t){var i=!1;if(t){var o=setTimeout((function(){i||(i=!0,r({Orientation:-1},"img onload timeout: "+t))}),1e3*(e||M.IMAGE_TIMEOUT)),n=new Image;n.onload=function(){clearTimeout(o),i||(i=!0,pt(n,r))},n.onerror=function(){clearTimeout(o),i||(i=!0,r({Orientation:-1},"img onerror: "+t))},n.onabort=function(){clearTimeout(o),i||(i=!0,r({Orientation:-1},"img onabort: "+t))},n.src=t}else i||(i=!0,r({Orientation:-1},"getBlob error"))})):pt(t,r)},gt=function(){var t=navigator.userAgent.toLowerCase();if(!(t.indexOf("macintosh")>-1))return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(t);try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}},mt=function(){var t=navigator.userAgent.toLowerCase();if(!(t.indexOf("macintosh")>-1))return/iphone|ipad|ipod/i.test(t);try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}},yt=function(){return!!mt()&&!!navigator.userAgent.toLowerCase().match(/OS (8|9|10)[_\d]* like Mac OS X/i)},vt=function(){if(mt()){var t=navigator.userAgent.toLowerCase(),e=t.match(/OS (8|9|10|11|12)[_\d]* like Mac OS X/i),r=t.match(/version\/([\d\.]+).*safari/i),i=13;return r&&(i=parseInt(r[1])),!(i<13||e)}return!0},_t=function(){var t=navigator.userAgent.toLowerCase();return/android/i.test(t)},Et=function(){var t=navigator.userAgent.toLowerCase();return/wechat/gi.test(t)},Tt=function(){var t,e={},r=navigator.userAgent.toLowerCase();return(t=r.match(/rv:([\d.]+)\) like gecko/))||(t=r.match(/msie ([\d\.]+)/))?e.ie=t[1]:(t=r.match(/edge\/([\d\.]+)/))?e.edge=t[1]:(t=r.match(/firefox\/([\d\.]+)/))?e.firefox=t[1]:(t=r.match(/(?:opera|opr).([\d\.]+)/))?e.opera=t[1]:(t=r.match(/chrome\/([\d\.]+)/))?e.chrome=t[1]:(t=r.match(/version\/([\d\.]+).*safari/))?e.safari=t[1]:(t=r.match(/OS ([\d\_]+).* like Mac OS X/i))&&(e.cpuos=t[1]),e.ie?["IE",e.ie]:e.edge?["EDGE",e.edge]:e.firefox?["Firefox",e.firefox]:e.chrome?["Chrome",e.chrome]:e.opera?["Opera",e.opera]:e.safari?["Safari",e.safari]:e.cpuos?["Safari",e.cpuos.replace(/_/g,".")]:["Unknown","0"]},bt=function(t,e){var r=t.split("."),i=e.split("."),o=i.length-r.length;if(o<0)for(;o++;)i.push("0");else for(;o--;)r.push("0");var n=r.map((function(t){return t.padStart(5,"0")})).join("."),a=i.map((function(t){return t.padStart(5,"0")})).join(".");return n<a?-1:n===a?0:1},St=function(){var t=navigator.userAgent.toLowerCase().match(/obs\/([\d.]+)/);if(t&&t[1]){var e=t[1].split(".");return e&&parseInt(e[0])<28}return!1},xt=function(t,e){var r,i,o=e.split(":").map((function(t){return+t}));try{var n=t.split(":");r=+n[0],r=isNaN(r)?o[0]:r,i=+n[1],i=isNaN(i)?o[1]:i}catch(t){return{ratioWidth:o[0],ratioHeight:o[1]}}return{ratioWidth:r,ratioHeight:i}},wt=function(t){return t&&t.changedTouches&&t.changedTouches[0]?{clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY,force:t.changedTouches[0].force,identifier:t.changedTouches[0].identifier,pageX:t.changedTouches[0].pageX,pageY:t.changedTouches[0].pageY,radiusX:t.changedTouches[0].radiusX,radiusY:t.changedTouches[0].radiusY,rotationAngle:t.changedTouches[0].rotationAngle,screenX:t.changedTouches[0].screenX,screenY:t.changedTouches[0].screenY}:{}},Ot=function(t){return t.substring(t.indexOf("#"))},It=function(t){if(t===M.COMMON_DEFAULT_BOARD)return"";var e="";try{var r=t.match(/_\d+_\d+_#\w+$/);r&&(e=(e=t.substring(0,r.index)).substring(e.indexOf("_")+1))}catch(t){}return e},At={TEDU_BOARD_ARROW_TYPE_NONE:1,TEDU_BOARD_ARROW_TYPE_NORMAL:2,TEDU_BOARD_ARROW_TYPE_SOLID:3},Dt=function(t,e){var r,i,o,n,a=0,s=e.length;for(o=e[0],r=1;r<=s;r++)n=e[r%s],t[0]>Math.min(o[0],n[0])&&t[0]<=Math.max(o[0],n[0])&&t[1]<=Math.max(o[1],n[1])&&o[0]!=n[0]&&(i=(t[0]-o[0])*(n[1]-o[1])/(n[0]-o[0])+o[1],(o[1]==n[1]||t[1]<=i)&&a++),o=n;return!!(a%2)},Ct=function(t,e){return t&&e?0!==e?Ct(e,t%e):t:1},Pt=function(t,e,r,i){var o=r-t,n=i-e;return o*o+n*n},Lt=function(t,e,r,i){return Math.sqrt(Pt(t,e,r,i))},Mt=function(t,e,r,i,o,n){var a,s,l=o-r,c=n-i,h=l*l+c*c,u=-1;return 0!=h&&(u=((t-r)*l+(e-i)*c)/h),u<0?(a=r,s=i):u>1?(a=o,s=n):(a=r+u*l,s=i+u*c),Pt(t,e,a,s)},Rt=function(t,e){return t.x*e.x+t.y*e.y},Nt=function(t,e,r,i){var o={x:r.x-t.x,y:r.y-t.y},n={x:e.x-t.x,y:e.y-t.y},a={x:i.x-t.x,y:i.y-t.y},s=Rt(o,o)*Rt(n,n)-Rt(o,n)*Rt(n,o),l=(Rt(n,n)*Rt(a,o)-Rt(n,o)*Rt(a,n))/s,c=(Rt(o,o)*Rt(a,n)-Rt(o,n)*Rt(a,o))/s;return l>=0&&c>=0&&l+c<=1},Bt=function(t,e){var r=(t+"").match(/([\d.]+)(.*)/);if(!r)return 0;var i=r[1];return"%"===r[2]?100*parseFloat(i):parseFloat(i)*e},kt=function(t){var e=Math.round(180*Math.asin(+t[0])/Math.PI),r=Math.round(180*Math.acos(+t[1])/Math.PI),i=Math.round(180*Math.asin(+t[2])/Math.PI),o=Math.round(180*Math.acos(+t[3])/Math.PI),n=0;return e==r||-e==r?n=o:-e+r==180?n=180+i:e+r==180&&(n=360-i||360-o),n>=360?0:n},Ft=function(t,e){var r=document.defaultView.getComputedStyle(t,null).transform.substring(7),i=r.match(/\(([^)]*)\)/),o=i?i[1].split(","):r.split(",");return"x"==e||null==e?o.length>6?parseFloat(o[12]):parseFloat(o[4]):"y"==e?o.length>6?parseFloat(o[13]):parseFloat(o[5]):"z"==e?o.length>6?parseFloat(o[14]):0:"rotate"==e?o.length>6?kt([parseFloat(o[0]),parseFloat(o[1]),parseFloat(o[4]),parseFloat(o[5])]):kt(o):void 0},Ut=function(t,e,r,i,o,n){var a=(t-r)*n.boardWidth/1e4,s=(e-i)*n.boardHeight/1e4;return Math.pow(a,2)/Math.pow(o,2)+Math.pow(s,2)/Math.pow(o,2)<=1},Ht=function(t){return!t.changedTouches},Gt=function(t){return 0===t.button},qt=function(t,e){return t<=0?t=Math.floor(e/2):t>=1e4&&(t=1e4-Math.floor(e/2)),t},Wt={performanceNow:0,serverTime:0,localTime:0,localServerTimeDiff:0,timeOffset:0,setTimeOffset:function(t){Wt.timeOffset=Math.floor(t)},adjustLocalTime:function(t,e){window&&window.performance&&window.performance.now&&!gt()?(Wt.performanceNow=window.performance.now(),Wt.serverTime=t+e):(Wt.localTime=Date.now(),Wt.serverTime=t+e,Wt.localServerTimeDiff=Wt.localTime-Wt.serverTime)},getCurrentTimeStamp:function(){var t=0;return window&&window.performance&&window.performance.now&&!gt()?t=0===Wt.serverTime?Date.now():Wt.serverTime+Math.floor(window.performance.now()-Wt.performanceNow):(isNaN(Wt.localServerTimeDiff)&&(Wt.localServerTimeDiff=0),t=Date.now()-Wt.localServerTimeDiff),t+Wt.timeOffset},getAVSdkTimestamp:function(){var t=Wt.getTimeStamp()+"",e=t.substring(0,5)+"00000000",r=t.substr(5),i=parseInt(e,10).toString(2).substr(-32);return parseInt(i,2)+(4294967295&parseInt(r))},getTimeStamp:function(){return Wt.getCurrentTimeStamp()},getSecondTime:function(){return Math.floor(Wt.getTimeStamp()/1e3)},getTimeDiff:function(t){return Wt.getTimeStamp()-t},formatDateTime:function(t){var e=t?new Date(t):new Date,r=e.getFullYear(),i=e.getMonth()+1,o=e.getDate(),n=e.getHours(),a=e.getMinutes(),s=e.getSeconds();return i=i<10?"0"+i:i,o=o<10?"0"+o:o,n=n<10?"0"+n:n,a=a<10?"0"+a:a,s=s<10?"0"+s:s,String(r)+String(i)+String(o)+String(n)+String(a)+String(s)}},Yt=function(){return(Yt=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},zt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},jt=function(t,e,r,i){var o={x:0,y:0,w:1},n=(1-t)*(1-t),a=2*t*(1-t),s=t*t;return o.x=n*e.x+a*r.x+s*i.x,o.y=n*e.y+a*r.y+s*i.y,o.w=n*e.w+a*r.w+s*i.w,o},Vt=function(t,e,r,i){var o={x:0,y:0,w:1},n=(1-t)*(1-t),a=2*t*(1-t),s=t*t;return o.x=(r.x-s*i.x-n*e.x)/a,o.y=(r.y-s*i.y-n*e.y)/a,o.w=(r.w-s*i.w-n*e.w)/a,o},Xt={TEDU_BOARD_ERROR_INIT:1,TEDU_BOARD_ERROR_AUTH:2,TEDU_BOARD_ERROR_LOAD:3,TEDU_BOARD_ERROR_HISTORYDATA:6,TEDU_BOARD_ERROR_RUNTIME:7,TEDU_BOARD_ERROR_AUTH_TIMEOUT:8,TEDU_BOARD_MAX_BOARD_LIMITED:10,TEDU_BOARD_SIGNATURE_EXPIRED:11},Jt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Kt=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},Zt=function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},Qt=function(t,e){void 0===e&&(e=300);var r=null;return function(){var i=this,o=arguments;clearTimeout(r),r=setTimeout((function(){t.apply(i,o)}),e)}},$t=function(t,e,r){var i;void 0===e&&(e=300),void 0===r&&(r=!1);var o=0,n=null;return function(){for(var a=this,s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];var c=Date.now(),h=e-(c-o);h<=0?(clearTimeout(i),o=c,t.apply(this,s)):i?r&&(n=s):i=setTimeout((function(){o=Date.now(),i=void 0,t.apply(a,s),r&&n&&t.apply(a,n)}),h)}},te=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},ee=function(t){if(t.startsWith("https")||(t=t.startsWith("http")?t.replace("http","https"):"https://"+t),t.endsWith("/"))return t;t.indexOf("?")>-1&&(t=t.substring(0,t.indexOf("?")));var e="//";t.indexOf(e)>-1&&(t=t.substring(t.indexOf(e)+e.length)),e=".";var r=t.indexOf(e);return e=".com","https://"+t.substr(0,r)+".preview.myqcloud.com"+t.substring(t.indexOf(e)+e.length)+"?cmd=doc_preview&of=pic&page="},re=function(t){for(var e={},r=t.substring(t.indexOf("?")+1,t.length).split("&"),i=0,o=r.length;i<o;i++){var n=te(r[i].split("="),2),a=n[0],s=n[1];e[a]=s}return e},ie=function(t){var e={};return t&&t.split("\r\n").forEach((function(t){var r=t.split(":");e[r[0]]=r[1]})),e},oe=function(t){var e=t.match(/^(.*\/\/)?([^/]+)/i);return e?e[2]:""},ne=function(t,e){var r=new RegExp("".concat(e,"=(\\d)"),"i"),i=t.match(r),o=i&&parseInt(i[1])||0,n=t;if(i)n=n.replace(r,"".concat(e,"=").concat(o+1));else{var a="?";t.indexOf("?")>-1&&(a="&"),n+="".concat(a).concat(e,"=").concat(o+1)}return n},ae=function(t){try{var e=new URL(t),r=encodeURIComponent(decodeURI(e.pathname)).replace(/%2F/g,"/"),i=decodeURI(e.search).substring(1),o=e.protocol+"//"+e.host+r;return i&&(o+="?"+i),o}catch(e){return t}},se=r(71),le=r.n(se);function ce(t){return"number"==typeof t}function he(t){return!(!t||"object"!=typeof t||"function"!=typeof t.constructor)&&(!0===t.isBigNumber&&"object"==typeof t.constructor.prototype&&!0===t.constructor.prototype.isBigNumber||"function"==typeof t.constructor.isDecimal&&!0===t.constructor.isDecimal(t))}function ue(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isComplex||!1}function de(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isFraction||!1}function pe(t){return t&&!0===t.constructor.prototype.isUnit||!1}function fe(t){return"string"==typeof t}var ge=Array.isArray;function me(t){return t&&!0===t.constructor.prototype.isMatrix||!1}function ye(t){return Array.isArray(t)||me(t)}function ve(t){return t&&t.isDenseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function _e(t){return t&&t.isSparseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function Ee(t){return t&&!0===t.constructor.prototype.isRange||!1}function Te(t){return t&&!0===t.constructor.prototype.isIndex||!1}function be(t){return"boolean"==typeof t}function Se(t){return t&&!0===t.constructor.prototype.isResultSet||!1}function xe(t){return t&&!0===t.constructor.prototype.isHelp||!1}function we(t){return"function"==typeof t}function Oe(t){return t instanceof Date}function Ie(t){return t instanceof RegExp}function Ae(t){return!(!t||"object"!=typeof t||t.constructor!==Object||ue(t)||de(t))}function De(t){return null===t}function Ce(t){return void 0===t}function Pe(t){return t&&!0===t.isAccessorNode&&!0===t.constructor.prototype.isNode||!1}function Le(t){return t&&!0===t.isArrayNode&&!0===t.constructor.prototype.isNode||!1}function Me(t){return t&&!0===t.isAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function Re(t){return t&&!0===t.isBlockNode&&!0===t.constructor.prototype.isNode||!1}function Ne(t){return t&&!0===t.isConditionalNode&&!0===t.constructor.prototype.isNode||!1}function Be(t){return t&&!0===t.isConstantNode&&!0===t.constructor.prototype.isNode||!1}function ke(t){return t&&!0===t.isFunctionAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function Fe(t){return t&&!0===t.isFunctionNode&&!0===t.constructor.prototype.isNode||!1}function Ue(t){return t&&!0===t.isIndexNode&&!0===t.constructor.prototype.isNode||!1}function He(t){return t&&!0===t.isNode&&!0===t.constructor.prototype.isNode||!1}function Ge(t){return t&&!0===t.isObjectNode&&!0===t.constructor.prototype.isNode||!1}function qe(t){return t&&!0===t.isOperatorNode&&!0===t.constructor.prototype.isNode||!1}function We(t){return t&&!0===t.isParenthesisNode&&!0===t.constructor.prototype.isNode||!1}function Ye(t){return t&&!0===t.isRangeNode&&!0===t.constructor.prototype.isNode||!1}function ze(t){return t&&!0===t.isSymbolNode&&!0===t.constructor.prototype.isNode||!1}function je(t){return t&&!0===t.constructor.prototype.isChain||!1}function Ve(t){var e=typeof t;return"object"===e?null===t?"null":Array.isArray(t)?"Array":t instanceof Date?"Date":t instanceof RegExp?"RegExp":he(t)?"BigNumber":ue(t)?"Complex":de(t)?"Fraction":me(t)?"Matrix":pe(t)?"Unit":Te(t)?"Index":Ee(t)?"Range":Se(t)?"ResultSet":He(t)?t.type:je(t)?"Chain":xe(t)?"Help":"Object":"function"===e?"Function":e}function Xe(t){var e=typeof t;if("number"===e||"string"===e||"boolean"===e||null==t)return t;if("function"==typeof t.clone)return t.clone();if(Array.isArray(t))return t.map((function(t){return Xe(t)}));if(t instanceof Date)return new Date(t.valueOf());if(he(t))return t;if(t instanceof RegExp)throw new TypeError("Cannot clone "+t);return Je(t,Xe)}function Je(t,e){var r={};for(var i in t)$e(t,i)&&(r[i]=e(t[i]));return r}function Ke(t,e){for(var r in e)$e(e,r)&&(t[r]=e[r]);return t}function Ze(t,e){var r,i,o;if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(i=0,o=t.length;i<o;i++)if(!Ze(t[i],e[i]))return!1;return!0}if("function"==typeof t)return t===e;if(t instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(r in t)if(!(r in e)||!Ze(t[r],e[r]))return!1;for(r in e)if(!(r in t)||!Ze(t[r],e[r]))return!1;return!0}return t===e}function Qe(t,e,r){var i,o=!0;Object.defineProperty(t,e,{get:function(){return o&&(i=r(),o=!1),i},set:function(t){i=t,o=!1},configurable:!0,enumerable:!0})}function $e(t,e){return t&&Object.hasOwnProperty.call(t,e)}function tr(t){return Object.keys(t).map((function(e){return t[e]}))}var er=r(176),rr=r.n(er),ir=r(177),or=r.n(ir);function nr(t){return"boolean"==typeof t||!!isFinite(t)&&t===Math.round(t)}var ar=Math.sign||function(t){return t>0?1:t<0?-1:0};function sr(t,e,r){var i={2:"0b",8:"0o",16:"0x"}[e],o="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!nr(r))throw new Error("size must be an integer");if(t>Math.pow(2,r-1)-1||t<-Math.pow(2,r-1))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!nr(t))throw new Error("Value must be an integer");t<0&&(t+=Math.pow(2,r)),o="i".concat(r)}var n="";return t<0&&(t=-t,n="-"),"".concat(n).concat(i).concat(t.toString(e)).concat(o)}function lr(t,e){if("function"==typeof e)return e(t);if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity";if(isNaN(t))return"NaN";var r,i,o="auto";if(e&&(e.notation&&(o=e.notation),ce(e)?r=e:ce(e.precision)&&(r=e.precision),e.wordSize&&"number"!=typeof(i=e.wordSize)))throw new Error('Option "wordSize" must be a number');switch(o){case"fixed":return function(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=cr(t),i="number"==typeof e?ur(r,r.exponent+1+e):r,o=i.coefficients,n=i.exponent+1,a=n+(e||0);return o.length<a&&(o=o.concat(dr(a-o.length))),n<0&&(o=dr(1-n).concat(o),n=1),n<o.length&&o.splice(n,0,0===n?"0.":"."),i.sign+o.join("")}(t,r);case"exponential":return hr(t,r);case"engineering":return function(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=ur(cr(t),e),i=r.exponent,o=r.coefficients,n=i%3==0?i:i<0?i-3-i%3:i-i%3;if(ce(e))for(;e>o.length||i-n+1>o.length;)o.push(0);else for(var a=Math.abs(i-n)-(o.length-1),s=0;s<a;s++)o.push(0);for(var l=Math.abs(i-n),c=1;l>0;)c++,l--;var h=o.slice(c).join(""),u=ce(e)&&h.length||h.match(/[1-9]/)?"."+h:"",d=o.slice(0,c).join("")+u+"e"+(i>=0?"+":"")+n.toString();return r.sign+d}(t,r);case"bin":return sr(t,2,i);case"oct":return sr(t,8,i);case"hex":return sr(t,16,i);case"auto":return function(t,e,r){if(isNaN(t)||!isFinite(t))return String(t);var i=r&&void 0!==r.lowerExp?r.lowerExp:-3,o=r&&void 0!==r.upperExp?r.upperExp:5,n=cr(t),a=e?ur(n,e):n;if(a.exponent<i||a.exponent>=o)return hr(t,e);var s=a.coefficients,l=a.exponent;s.length<e&&(s=s.concat(dr(e-s.length))),s=s.concat(dr(l-s.length+1+(s.length<e?e-s.length:0)));var c=l>0?l:0;return c<(s=dr(-l).concat(s)).length-1&&s.splice(c+1,0,"."),a.sign+s.join("")}(t,r,e&&e).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+o+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function cr(t){var e=String(t).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+t);var r=e[1],i=e[2],o=parseFloat(e[4]||"0"),n=i.indexOf(".");o+=-1!==n?n-1:i.length-1;var a=i.replace(".","").replace(/^0*/,(function(t){return o-=t.length,""})).replace(/0*$/,"").split("").map((function(t){return parseInt(t)}));return 0===a.length&&(a.push(0),o++),{sign:r,coefficients:a,exponent:o}}function hr(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=cr(t),i=e?ur(r,e):r,o=i.coefficients,n=i.exponent;o.length<e&&(o=o.concat(dr(e-o.length)));var a=o.shift();return i.sign+a+(o.length>0?"."+o.join(""):"")+"e"+(n>=0?"+":"")+n}function ur(t,e){for(var r={sign:t.sign,coefficients:t.coefficients,exponent:t.exponent},i=r.coefficients;e<=0;)i.unshift(0),r.exponent++,e++;if(i.length>e&&i.splice(e,i.length-e)[0]>=5){var o=e-1;for(i[o]++;10===i[o];)i.pop(),0===o&&(i.unshift(0),r.exponent++,o++),i[--o]++}return r}function dr(t){for(var e=[],r=0;r<t;r++)e.push(0);return e}Math.log2,Math.log10,Math.log1p,Math.cbrt,Math.expm1;var pr=Number.EPSILON||2220446049250313e-31;function fr(t,e,r){if(null==r)return t===e;if(t===e)return!0;if(isNaN(t)||isNaN(e))return!1;if(isFinite(t)&&isFinite(e)){var i=Math.abs(t-e);return i<pr||i<=Math.max(Math.abs(t),Math.abs(e))*r}return!1}function gr(t,e,r){var i=new(0,t.constructor)(2),o="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!nr(r))throw new Error("size must be an integer");if(t.greaterThan(i.pow(r-1).sub(1))||t.lessThan(i.pow(r-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!t.isInteger())throw new Error("Value must be an integer");t.lessThan(0)&&(t=t.add(i.pow(r))),o="i".concat(r)}switch(e){case 2:return"".concat(t.toBinary()).concat(o);case 8:return"".concat(t.toOctal()).concat(o);case 16:return"".concat(t.toHexadecimal()).concat(o);default:throw new Error("Base ".concat(e," not supported "))}}function mr(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()}function yr(t,e){return"number"==typeof t?lr(t,e):he(t)?function(t,e){if("function"==typeof e)return e(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var r,i,o="auto";if(void 0!==e&&(e.notation&&(o=e.notation),"number"==typeof e?r=e:e.precision&&(r=e.precision),e.wordSize&&"number"!=typeof(i=e.wordSize)))throw new Error('Option "wordSize" must be a number');switch(o){case"fixed":return function(t,e){return t.toFixed(e)}(t,r);case"exponential":return mr(t,r);case"engineering":return function(t,e){var r=t.e,i=r%3==0?r:r<0?r-3-r%3:r-r%3,o=t.mul(Math.pow(10,-i)),n=o.toPrecision(e);return-1!==n.indexOf("e")&&(n=o.toString()),n+"e"+(r>=0?"+":"")+i.toString()}(t,r);case"bin":return gr(t,2,i);case"oct":return gr(t,8,i);case"hex":return gr(t,16,i);case"auto":var n=e&&void 0!==e.lowerExp?e.lowerExp:-3,a=e&&void 0!==e.upperExp?e.upperExp:5;if(t.isZero())return"0";var s=t.toSignificantDigits(r),l=s.e;return(l>=n&&l<a?s.toFixed():mr(t,r)).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+o+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}(t,e):function(t){return t&&"object"==typeof t&&"number"==typeof t.s&&"number"==typeof t.n&&"number"==typeof t.d||!1}(t)?e&&"decimal"===e.fraction?t.toString():t.s*t.n+"/"+t.d:Array.isArray(t)?function t(e,r){if(Array.isArray(e)){for(var i="[",o=e.length,n=0;n<o;n++)0!==n&&(i+=", "),i+=t(e[n],r);return i+"]"}return yr(e,r)}(t,e):fe(t)?'"'+t+'"':"function"==typeof t?t.syntax?String(t.syntax):"function":t&&"object"==typeof t?"function"==typeof t.format?t.format(e):t&&t.toString(e)!=={}.toString()?t.toString(e):"{"+Object.keys(t).map((function(r){return'"'+r+'": '+yr(t[r],e)})).join(", ")+"}":String(t)}function vr(t,e,r){if(!(this instanceof vr))throw new SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=r,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=(new Error).stack}function _r(t,e,r){if(!(this instanceof _r))throw new SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=r),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function Er(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e}function Tr(t,e){if(0===e.length){if(Array.isArray(t))throw new vr(t.length,0)}else!function t(e,r,i){var o,n=e.length;if(n!==r[i])throw new vr(n,r[i]);if(i<r.length-1){var a=i+1;for(o=0;o<n;o++){var s=e[o];if(!Array.isArray(s))throw new vr(r.length-1,r.length,"<");t(e[o],r,a)}}else for(o=0;o<n;o++)if(Array.isArray(e[o]))throw new vr(r.length+1,r.length,">")}(t,e,0)}function br(t,e){if(!ce(t)||!nr(t))throw new TypeError("Index must be an integer (value: "+t+")");if(t<0||"number"==typeof e&&t>=e)throw new _r(t,e)}function Sr(t,e,r){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Error("Resizing to scalar is not supported");return e.forEach((function(t){if(!ce(t)||!nr(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+yr(e)+")")})),function t(e,r,i,o){var n,a,s=e.length,l=r[i],c=Math.min(s,l);if(e.length=l,i<r.length-1){var h=i+1;for(n=0;n<c;n++)a=e[n],Array.isArray(a)||(a=[a],e[n]=a),t(a,r,h,o);for(n=c;n<l;n++)a=[],e[n]=a,t(a,r,h,o)}else{for(n=0;n<c;n++)for(;Array.isArray(e[n]);)e[n]=e[n][0];for(n=c;n<l;n++)e[n]=o}}(t,e,0,void 0!==r?r:0),t}function xr(t,e){var r=Ar(t),i=r.length;if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new vr(0,i,"!=");var o=Or(e=wr(e,i));if(i!==o)throw new vr(o,i,"!=");try{return function(t,e){for(var r,i=t,o=e.length-1;o>0;o--){var n=e[o];r=[];for(var a=i.length/n,s=0;s<a;s++)r.push(i.slice(s*n,(s+1)*n));i=r}return i}(r,e)}catch(t){if(t instanceof vr)throw new vr(o,i,"!=");throw t}}function wr(t,e){var r=Or(t),i=t.slice(),o=t.indexOf(-1);if(t.indexOf(-1,o+1)>=0)throw new Error("More than one wildcard in sizes");if(o>=0){if(e%r!=0)throw new Error("Could not replace wildcard, since "+e+" is no multiple of "+-r);i[o]=-e/r}return i}function Or(t){return t.reduce((function(t,e){return t*e}),1)}function Ir(t,e,r,i){var o=i||Er(t);if(r)for(var n=0;n<r;n++)t=[t],o.unshift(1);for(t=function t(e,r,i){var o,n;if(Array.isArray(e)){var a=i+1;for(o=0,n=e.length;o<n;o++)e[o]=t(e[o],r,a)}else for(var s=i;s<r;s++)e=[e];return e}(t,e,0);o.length<e;)o.push(1);return t}function Ar(t){if(!Array.isArray(t))return t;var e=[];return t.forEach((function t(r){Array.isArray(r)?r.forEach(t):e.push(r)})),e}function Dr(t,e){for(var r,i=0,o=0;o<t.length;o++){var n=t[o],a=Array.isArray(n);if(0===o&&a&&(i=n.length),a&&n.length!==i)return;var s=a?Dr(n,e):e(n);if(void 0===r)r=s;else if(r!==s)return"mixed"}return r}function Cr(t,e){return-1!==t.indexOf(e)}function Pr(t,e,r,i){function o(i){var o=function(t,e){for(var r={},i=0;i<e.length;i++){var o=e[i],n=t[o];void 0!==n&&(r[o]=n)}return r}(i,e.map(Mr));return function(t,e,r){if(!e.filter((function(t){return!function(t){return t&&"?"===t[0]}(t)})).every((function(t){return void 0!==r[t]}))){var i=e.filter((function(t){return void 0===r[t]}));throw new Error('Cannot create function "'.concat(t,'", ')+"some dependencies are missing: ".concat(i.map((function(t){return'"'.concat(t,'"')})).join(", "),"."))}}(t,e,i),r(o)}return o.isFactory=!0,o.fn=t,o.dependencies=e.slice().sort(),i&&(o.meta=i),o}function Lr(t){return"function"==typeof t&&"string"==typeof t.fn&&Array.isArray(t.dependencies)}function Mr(t){return t&&"?"===t[0]?t.slice(1):t}function Rr(t,e,r,i){if(!(this instanceof Rr))throw new SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=r,this.max=i,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+r+(null!=i?"-"+i:"")+" expected)",this.stack=(new Error).stack}Math.acosh,Math.asinh,Math.atanh,Math.cosh,Math.sinh,Math.tanh,vr.prototype=new RangeError,vr.prototype.constructor=RangeError,vr.prototype.name="DimensionError",vr.prototype.isDimensionError=!0,_r.prototype=new RangeError,_r.prototype.constructor=RangeError,_r.prototype.name="IndexError",_r.prototype.isIndexError=!0,Rr.prototype=new Error,Rr.prototype.constructor=Error,Rr.prototype.name="ArgumentsError",Rr.prototype.isArgumentsError=!0;var Nr={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null},Br=["Matrix","Array"],kr=["number","BigNumber","Fraction"];function Fr(t,e,r){var i,o;void 0!==t[e]&&(i=r,o=t[e],i.indexOf(o))}var Ur=r(100),Hr=r.n(Ur),Gr={createBigNumberClass:Pr("BigNumber",["?on","config"],(function(t){var e=t.on,r=t.config,i=Hr.a.clone({precision:r.precision,modulo:Hr.a.EUCLID});return i.prototype=Object.create(i.prototype),i.prototype.type="BigNumber",i.prototype.isBigNumber=!0,i.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},i.fromJSON=function(t){return new i(t.value)},e&&e("config",(function(t,e){t.precision!==e.precision&&i.config({precision:t.precision})})),i}),{isClass:!0})},qr=r(12),Wr=r.n(qr),Yr={createComplexClass:Pr("Complex",[],(function(){return Wr.a.prototype.type="Complex",Wr.a.prototype.isComplex=!0,Wr.a.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Wr.a.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Wr.a.prototype.format=function(t){var e=this.im,r=this.re,i=lr(this.re,t),o=lr(this.im,t),n=ce(t)?t:t?t.precision:null;if(null!==n){var a=Math.pow(10,-n);Math.abs(r/e)<a&&(r=0),Math.abs(e/r)<a&&(e=0)}return 0===e?i:0===r?1===e?"i":-1===e?"-i":o+"i":e<0?-1===e?i+" - i":i+" - "+o.substring(1)+"i":1===e?i+" + i":i+" + "+o+"i"},Wr.a.fromPolar=function(t){switch(arguments.length){case 1:var e=arguments[0];if("object"==typeof e)return Wr()(e);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var r=arguments[0],i=arguments[1];if(ce(r)){if(pe(i)&&i.hasBase("ANGLE")&&(i=i.toNumber("rad")),ce(i))return new Wr.a({r:r,phi:i});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Wr.a.prototype.valueOf=Wr.a.prototype.toString,Wr.a.fromJSON=function(t){return new Wr.a(t)},Wr.a.compare=function(t,e){return t.re>e.re?1:t.re<e.re?-1:t.im>e.im?1:t.im<e.im?-1:0},Wr.a}),{isClass:!0})},zr={createMatrixClass:Pr("Matrix",[],(function(){function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator")}return t.prototype.type="Matrix",t.prototype.isMatrix=!0,t.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},t.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},t.prototype.create=function(t,e){throw new Error("Cannot invoke create on a Matrix interface")},t.prototype.subset=function(t,e,r){throw new Error("Cannot invoke subset on a Matrix interface")},t.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},t.prototype.set=function(t,e,r){throw new Error("Cannot invoke set on a Matrix interface")},t.prototype.resize=function(t,e){throw new Error("Cannot invoke resize on a Matrix interface")},t.prototype.reshape=function(t,e){throw new Error("Cannot invoke reshape on a Matrix interface")},t.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},t.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},t.prototype.map=function(t,e){throw new Error("Cannot invoke map on a Matrix interface")},t.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},t.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},t.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},t.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},t.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},t.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},t}),{isClass:!0})},jr=r(34),Vr=r.n(jr);function Xr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var Jr={MatrixDependencies:zr,createDenseMatrixClass:Pr("DenseMatrix",["Matrix"],(function(t){var e=t.Matrix;function r(t,e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!fe(e))throw new Error("Invalid datatype: "+e);if(me(t))"DenseMatrix"===t.type?(this._data=Xe(t._data),this._size=Xe(t._size),this._datatype=e||t._datatype):(this._data=t.toArray(),this._size=t.size(),this._datatype=e||t._datatype);else if(t&&ge(t.data)&&ge(t.size))this._data=t.data,this._size=t.size,Tr(this._data,this._size),this._datatype=e||t.datatype;else if(ge(t))this._data=function t(e){for(var r=0,i=e.length;r<i;r++){var o=e[r];ge(o)?e[r]=t(o):o&&!0===o.isMatrix&&(e[r]=t(o.valueOf()))}return e}(t),this._size=Er(this._data),Tr(this._data,this._size),this._datatype=e;else{if(t)throw new TypeError("Unsupported type of data ("+Ve(t)+")");this._data=[],this._size=[0],this._datatype=e}}function i(t,e,r){if(0===e.length){for(var i=t._data;ge(i);)i=i[0];return i}return t._size=e.slice(0),t._data=Sr(t._data,t._size,r),t}function o(t,e,r){for(var o=t._size.slice(0),n=!1;o.length<e.length;)o.push(0),n=!0;for(var a=0,s=e.length;a<s;a++)e[a]>o[a]&&(o[a]=e[a],n=!0);n&&i(t,o,r)}return r.prototype=new e,r.prototype.createDenseMatrix=function(t,e){return new r(t,e)},r.prototype.type="DenseMatrix",r.prototype.isDenseMatrix=!0,r.prototype.getDataType=function(){return Dr(this._data,Ve)},r.prototype.storage=function(){return"dense"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(t,e){return new r(t,e)},r.prototype.subset=function(t,e,i){switch(arguments.length){case 1:return function(t,e){if(!Te(e))throw new TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var i=e.size();if(i.length!==t._size.length)throw new vr(i.length,t._size.length);for(var o=e.min(),n=e.max(),a=0,s=t._size.length;a<s;a++)br(o[a],t._size[a]),br(n[a],t._size[a]);return new r(function t(e,r,i,o){var n=o===i-1,a=r.dimension(o);return n?a.map((function(t){return br(t,e.length),e[t]})).valueOf():a.map((function(n){br(n,e.length);var a=e[n];return t(a,r,i,o+1)})).valueOf()}(t._data,e,i.length,0),t._datatype)}(this,t);case 2:case 3:return function(t,e,r,i){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var n,a=e.size(),s=e.isScalar();if(me(r)?(n=r.size(),r=r.valueOf()):n=Er(r),s){if(0!==n.length)throw new TypeError("Scalar expected");t.set(e.min(),r,i)}else{if(a.length<t._size.length)throw new vr(a.length,t._size.length,"<");if(n.length<a.length){for(var l=0,c=0;1===a[l]&&1===n[l];)l++;for(;1===a[l];)c++,l++;r=Ir(r,a.length,c,n)}if(!Ze(a,n))throw new vr(a,n,">");o(t,e.max().map((function(t){return t+1})),i);var h=a.length;!function t(e,r,i,o,n){var a=n===o-1,s=r.dimension(n);a?s.forEach((function(t,r){br(t),e[t]=i[r[0]]})):s.forEach((function(a,s){br(a),t(e[a],r,i[s[0]],o,n+1)}))}(t._data,e,r,h,0)}return t}(this,t,e,i);default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.get=function(t){if(!ge(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new vr(t.length,this._size.length);for(var e=0;e<t.length;e++)br(t[e],this._size[e]);for(var r=this._data,i=0,o=t.length;i<o;i++){var n=t[i];br(n,r.length),r=r[n]}return r},r.prototype.set=function(t,e,r){if(!ge(t))throw new TypeError("Array expected");if(t.length<this._size.length)throw new vr(t.length,this._size.length,"<");var i,n,a;o(this,t.map((function(t){return t+1})),r);var s=this._data;for(i=0,n=t.length-1;i<n;i++)br(a=t[i],s.length),s=s[a];return br(a=t[t.length-1],s.length),s[a]=e,this},r.prototype.resize=function(t,e,r){if(!ye(t))throw new TypeError("Array or Matrix expected");var o=t.valueOf().map((function(t){return Array.isArray(t)&&1===t.length?t[0]:t}));return i(r?this.clone():this,o,e)},r.prototype.reshape=function(t,e){var r=e?this.clone():this;r._data=xr(r._data,t);var i=r._size.reduce((function(t,e){return t*e}));return r._size=wr(t,i),r},r.prototype.clone=function(){return new r({data:Xe(this._data),size:Xe(this._size),datatype:this._datatype})},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(t){var e=this,i=function r(i,o){return ge(i)?i.map((function(t,e){return r(t,o.concat(e))})):t(i,o,e)}(this._data,[]);return new r(i,void 0!==this._datatype?Dr(i,Ve):void 0)},r.prototype.forEach=function(t){var e=this;!function r(i,o){ge(i)?i.forEach((function(t,e){r(t,o.concat(e))})):t(i,o,e)}(this._data,[])},r.prototype[Symbol.iterator]=Vr.a.mark((function t(){var e;return Vr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Vr.a.mark((function t(e,r){var i;return Vr.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!ge(e)){o.next=9;break}i=0;case 2:if(!(i<e.length)){o.next=7;break}return o.delegateYield(t(e[i],r.concat(i)),"t0",4);case 4:i++,o.next=2;break;case 7:o.next=11;break;case 9:return o.next=11,{value:e,index:r};case 11:case"end":return o.stop()}}),t)})),t.delegateYield(e(this._data,[]),"t0",2);case 2:case"end":return t.stop()}}),t,this)})),r.prototype.rows=function(){var t=[];if(2!==this.size().length)throw new TypeError("Rows can only be returned for a 2D matrix.");var e,i=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Xr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,n=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw n}}}}(this._data);try{for(i.s();!(e=i.n()).done;){var o=e.value;t.push(new r([o],this._datatype))}}catch(t){i.e(t)}finally{i.f()}return t},r.prototype.columns=function(){var t=this,e=[],i=this.size();if(2!==i.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var o=this._data,n=function(i){var n=o.map((function(t){return[t[i]]}));e.push(new r(n,t._datatype))},a=0;a<i[1];a++)n(a);return e},r.prototype.toArray=function(){return Xe(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.format=function(t){return yr(this._data,t)},r.prototype.toString=function(){return yr(this._data)},r.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(t){if(t){if(he(t)&&(t=t.toNumber()),!ce(t)||!nr(t))throw new TypeError("The parameter k must be an integer number")}else t=0;for(var e=t>0?t:0,i=t<0?-t:0,o=this._size[0],n=this._size[1],a=Math.min(o-i,n-e),s=[],l=0;l<a;l++)s[l]=this._data[l+i][l+e];return new r({data:s,size:[a],datatype:this._datatype})},r.diagonal=function(t,e,i,o){if(!ge(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(he(t)&&(t=t.toNumber()),!ce(t)||!nr(t)||t<1)throw new Error("Size values must be positive integers");return t})),i){if(he(i)&&(i=i.toNumber()),!ce(i)||!nr(i))throw new TypeError("The parameter k must be an integer number")}else i=0;var n,a=i>0?i:0,s=i<0?-i:0,l=t[0],c=t[1],h=Math.min(l-s,c-a);if(ge(e)){if(e.length!==h)throw new Error("Invalid value array length");n=function(t){return e[t]}}else if(me(e)){var u=e.size();if(1!==u.length||u[0]!==h)throw new Error("Invalid matrix length");n=function(t){return e.get([t])}}else n=function(){return e};o||(o=he(n(0))?n(0).mul(0):0);var d=[];if(t.length>0){d=Sr(d,t,o);for(var p=0;p<h;p++)d[p+s][p+a]=n(p)}return new r({data:d,size:[l,c]})},r.fromJSON=function(t){return new r(t)},r.prototype.swapRows=function(t,e){if(!(ce(t)&&nr(t)&&ce(e)&&nr(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return br(t,this._size[0]),br(e,this._size[0]),r._swapRows(t,e,this._data),this},r._swapRows=function(t,e,r){var i=r[t];r[t]=r[e],r[e]=i},r}),{isClass:!0})},Kr=r(46),Zr=r.n(Kr),Qr={createFractionClass:Pr("Fraction",[],(function(){return Zr.a.prototype.type="Fraction",Zr.a.prototype.isFraction=!0,Zr.a.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},Zr.a.fromJSON=function(t){return new Zr.a(t)},Zr.a}),{isClass:!0})},$r=r(101),ti=r.n($r),ei=r(178),ri=r.n(ei),ii=r(179),oi=r.n(ii);function ni(t,e){return!(!t||"object"!=typeof t||!$e(si,e)&&(e in Object.prototype||e in Function.prototype))}function ai(t){return"object"==typeof t&&t&&t.constructor===Object}var si={length:!0,name:!0},li={toString:!0,valueOf:!0,toLocaleString:!0},ci=function(){function t(e){ri()(this,t),this.wrappedObject=e}return oi()(t,[{key:"keys",value:function(){return Object.keys(this.wrappedObject)}},{key:"get",value:function(t){return function(t,e){if(ai(t)&&ni(t,e))return t[e];if("function"==typeof t[e]&&function(t,e){return!(null==t||"function"!=typeof t[e]||$e(t,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(t)||!$e(li,e)&&(e in Object.prototype||e in Function.prototype))}(t,e))throw new Error('Cannot access method "'+e+'" as a property');throw new Error('No access to property "'+e+'"')}(this.wrappedObject,t)}},{key:"set",value:function(t,e){return function(t,e,r){if(ai(t)&&ni(t,e))return t[e]=r,r;throw new Error('No access to property "'+e+'"')}(this.wrappedObject,t,e),this}},{key:"has",value:function(t){return t in this.wrappedObject}}]),t}();function hi(t){return!!t&&(t instanceof Map||t instanceof ci||"function"==typeof t.set&&"function"==typeof t.get&&"function"==typeof t.keys&&"function"==typeof t.has)}var ui=function(){return ui=ti.a.create,ti.a};function di(t){throw new Error("Cannot convert value ".concat(t," into a BigNumber: no class 'BigNumber' provided"))}function pi(t){throw new Error("Cannot convert value ".concat(t," into a Complex number: no class 'Complex' provided"))}function fi(t){throw new Error("Cannot convert value ".concat(t," into a Fraction, no class 'Fraction' provided."))}var gi={BigNumberDependencies:Gr,ComplexDependencies:Yr,DenseMatrixDependencies:Jr,FractionDependencies:Qr,createTyped:Pr("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],(function(t){var e=t.BigNumber,r=t.Complex,i=t.DenseMatrix,o=t.Fraction,n=ui();return n.types=[{name:"number",test:ce},{name:"Complex",test:ue},{name:"BigNumber",test:he},{name:"Fraction",test:de},{name:"Unit",test:pe},{name:"string",test:fe},{name:"Chain",test:je},{name:"Array",test:ge},{name:"Matrix",test:me},{name:"DenseMatrix",test:ve},{name:"SparseMatrix",test:_e},{name:"Range",test:Ee},{name:"Index",test:Te},{name:"boolean",test:be},{name:"ResultSet",test:Se},{name:"Help",test:xe},{name:"function",test:we},{name:"Date",test:Oe},{name:"RegExp",test:Ie},{name:"null",test:De},{name:"undefined",test:Ce},{name:"AccessorNode",test:Pe},{name:"ArrayNode",test:Le},{name:"AssignmentNode",test:Me},{name:"BlockNode",test:Re},{name:"ConditionalNode",test:Ne},{name:"ConstantNode",test:Be},{name:"FunctionNode",test:Fe},{name:"FunctionAssignmentNode",test:ke},{name:"IndexNode",test:Ue},{name:"Node",test:He},{name:"ObjectNode",test:Ge},{name:"OperatorNode",test:qe},{name:"ParenthesisNode",test:We},{name:"RangeNode",test:Ye},{name:"SymbolNode",test:ze},{name:"Map",test:hi},{name:"Object",test:Ae}],n.conversions=[{from:"number",to:"BigNumber",convert:function(t){if(e||di(t),t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+t+"). Use function bignumber(x) to convert to BigNumber.");return new e(t)}},{from:"number",to:"Complex",convert:function(t){return r||pi(t),new r(t,0)}},{from:"number",to:"string",convert:function(t){return t+""}},{from:"BigNumber",to:"Complex",convert:function(t){return r||pi(t),new r(t.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(t){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(t){return r||pi(t),new r(t.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(t){o||fi(t);var e=new o(t);if(e.valueOf()!==t)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+t+"). Use function fraction(x) to convert to Fraction.");return e}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw new Error('Cannot convert "'+t+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(t){e||di(t);try{return new e(t)}catch(e){throw new Error('Cannot convert "'+t+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(t){o||fi(t);try{return new o(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(t){r||pi(t);try{return new r(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Complex')}}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(t){return e||di(t),new e(+t)}},{from:"boolean",to:"Fraction",convert:function(t){return o||fi(t),new o(+t)}},{from:"boolean",to:"string",convert:function(t){return String(t)}},{from:"Array",to:"Matrix",convert:function(t){return i||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new i(t)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}],n}))},mi="number",yi="number, number";function vi(t){return Math.abs(t)}function _i(t,e){return t+e}function Ei(t,e){return t*e}function Ti(t){return-t}function bi(t){return ar(t)}vi.signature=mi,_i.signature=yi,Ei.signature=yi,Ti.signature=mi,bi.signature=mi;var Si={typedDependencies:gi,createAddScalar:Pr("addScalar",["typed"],(function(t){return(0,t.typed)("addScalar",{"number, number":_i,"Complex, Complex":function(t,e){return t.add(e)},"BigNumber, BigNumber":function(t,e){return t.plus(e)},"Fraction, Fraction":function(t,e){return t.add(e)},"Unit, Unit":function(t,e){if(null===t.value||void 0===t.value)throw new Error("Parameter x contains a unit with undefined value");if(null===e.value||void 0===e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var r=t.clone();return r.value=this(r.value,e.value),r.fixPrefix=!1,r}})}))};function xi(t,e,r){return t&&"function"==typeof t.map?t.map((function(t){return xi(t,e,r)})):e(t)}var wi={typedDependencies:gi,createConj:Pr("conj",["typed"],(function(t){return(0,t.typed)("conj",{number:function(t){return t},BigNumber:function(t){return t},Complex:function(t){return t.conjugate()},"Array | Matrix":function(t){return xi(t,this)}})}))},Oi={typedDependencies:gi,createMultiplyScalar:Pr("multiplyScalar",["typed"],(function(t){return(0,t.typed)("multiplyScalar",{"number, number":Ei,"Complex, Complex":function(t,e){return t.mul(e)},"BigNumber, BigNumber":function(t,e){return t.times(e)},"Fraction, Fraction":function(t,e){return t.mul(e)},"number | Fraction | BigNumber | Complex, Unit":function(t,e){var r=e.clone();return r.value=null===r.value?r._normalize(t):this(r.value,t),r},"Unit, number | Fraction | BigNumber | Complex":function(t,e){var r=t.clone();return r.value=null===r.value?r._normalize(e):this(r.value,e),r},"Unit, Unit":function(t,e){return t.multiply(e)}})}))};function Ii(t,e,r){if(null==r)return t.eq(e);if(t.eq(e))return!0;if(t.isNaN()||e.isNaN())return!1;if(t.isFinite()&&e.isFinite()){var i=t.minus(e).abs();if(i.isZero())return!0;var o=t.constructor.max(t.abs(),e.abs());return i.lte(o.times(r))}return!1}var Ai=Pr("equalScalar",["typed","config"],(function(t){var e=t.typed,r=t.config;return e("equalScalar",{"boolean, boolean":function(t,e){return t===e},"number, number":function(t,e){return fr(t,e,r.epsilon)},"BigNumber, BigNumber":function(t,e){return t.eq(e)||Ii(t,e,r.epsilon)},"Fraction, Fraction":function(t,e){return t.equals(e)},"Complex, Complex":function(t,e){return function(t,e,r){return fr(t.re,e.re,r)&&fr(t.im,e.im,r)}(t,e,r.epsilon)},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)}})})),Di=(Pr("equalScalar",["typed","config"],(function(t){var e=t.typed,r=t.config;return e("equalScalar",{"number, number":function(t,e){return fr(t,e,r.epsilon)}})})),{typedDependencies:gi,createEqualScalar:Ai}),Ci={MatrixDependencies:zr,equalScalarDependencies:Di,typedDependencies:gi,createSparseMatrixClass:Pr("SparseMatrix",["typed","equalScalar","Matrix"],(function(t){var e=t.typed,r=t.equalScalar,i=t.Matrix;function o(t,e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!fe(e))throw new Error("Invalid datatype: "+e);if(me(t))!function(t,e,r){"SparseMatrix"===e.type?(t._values=e._values?Xe(e._values):void 0,t._index=Xe(e._index),t._ptr=Xe(e._ptr),t._size=Xe(e._size),t._datatype=r||e._datatype):n(t,e.valueOf(),r||e._datatype)}(this,t,e);else if(t&&ge(t.index)&&ge(t.ptr)&&ge(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=e||t.datatype;else if(ge(t))n(this,t,e);else{if(t)throw new TypeError("Unsupported type of data ("+Ve(t)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}}function n(t,i,o){t._values=[],t._index=[],t._ptr=[],t._datatype=o;var n=i.length,a=0,s=r,l=0;if(fe(o)&&(s=e.find(r,[o,o])||r,l=e.convert(0,o)),n>0){var c=0;do{t._ptr.push(t._index.length);for(var h=0;h<n;h++){var u=i[h];if(ge(u)){if(0===c&&a<u.length&&(a=u.length),c<u.length){var d=u[c];s(d,l)||(t._values.push(d),t._index.push(h))}}else 0===c&&a<1&&(a=1),s(u,l)||(t._values.push(u),t._index.push(h))}c++}while(c<a)}t._ptr.push(t._index.length),t._size=[n,a]}function a(t,e,r,i){if(r-e==0)return r;for(var o=e;o<r;o++)if(i[o]===t)return o;return e}function s(t,e,r,i,o,n,a){o.splice(t,0,i),n.splice(t,0,e);for(var s=r+1;s<a.length;s++)a[s]++}function l(t,i,o,n){var a=n||0,s=r,l=0;fe(t._datatype)&&(s=e.find(r,[t._datatype,t._datatype])||r,l=e.convert(0,t._datatype),a=e.convert(a,t._datatype));var c,h,u,d=!s(a,l),p=t._size[0],f=t._size[1];if(o>f){for(h=f;h<o;h++)if(t._ptr[h]=t._values.length,d)for(c=0;c<p;c++)t._values.push(a),t._index.push(c);t._ptr[o]=t._values.length}else o<f&&(t._ptr.splice(o+1,f-o),t._values.splice(t._ptr[o],t._values.length),t._index.splice(t._ptr[o],t._index.length));if(f=o,i>p){if(d){var g=0;for(h=0;h<f;h++){t._ptr[h]=t._ptr[h]+g,u=t._ptr[h+1]+g;var m=0;for(c=p;c<i;c++,m++)t._values.splice(u+m,0,a),t._index.splice(u+m,0,c),g++}t._ptr[f]=t._values.length}}else if(i<p){var y=0;for(h=0;h<f;h++){t._ptr[h]=t._ptr[h]-y;var v=t._ptr[h],_=t._ptr[h+1]-y;for(u=v;u<_;u++)(c=t._index[u])>i-1&&(t._values.splice(u,1),t._index.splice(u,1),y++)}t._ptr[h]=t._values.length}return t._size[0]=i,t._size[1]=o,t}function c(t,e,r,i,o){var n,a,s=i[0],l=i[1],c=[];for(n=0;n<s;n++)for(c[n]=[],a=0;a<l;a++)c[n][a]=0;for(a=0;a<l;a++)for(var h=r[a],u=r[a+1],d=h;d<u;d++)c[n=e[d]][a]=t?o?Xe(t[d]):t[d]:1;return c}return o.prototype=new i,o.prototype.createSparseMatrix=function(t,e){return new o(t,e)},o.prototype.type="SparseMatrix",o.prototype.isSparseMatrix=!0,o.prototype.getDataType=function(){return Dr(this._values,Ve)},o.prototype.storage=function(){return"sparse"},o.prototype.datatype=function(){return this._datatype},o.prototype.create=function(t,e){return new o(t,e)},o.prototype.density=function(){var t=this._size[0],e=this._size[1];return 0!==t&&0!==e?this._index.length/(t*e):0},o.prototype.subset=function(t,e,r){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(t,e){if(!Te(e))throw new TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var r,i,n,a,s=e.size();if(s.length!==t._size.length)throw new vr(s.length,t._size.length);var l=e.min(),c=e.max();for(r=0,i=t._size.length;r<i;r++)br(l[r],t._size[r]),br(c[r],t._size[r]);var h=t._values,u=t._index,d=t._ptr,p=e.dimension(0),f=e.dimension(1),g=[],m=[];p.forEach((function(t,e){m[t]=e[0],g[t]=!0}));var y=h?[]:void 0,v=[],_=[];return f.forEach((function(t){for(_.push(v.length),n=d[t],a=d[t+1];n<a;n++)r=u[n],!0===g[r]&&(v.push(m[r]),y&&y.push(h[n]))})),_.push(v.length),new o({values:y,index:v,ptr:_,size:s,datatype:t._datatype})}(this,t);case 2:case 3:return function(t,e,r,i){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var o,n=e.size(),a=e.isScalar();if(me(r)?(o=r.size(),r=r.toArray()):o=Er(r),a){if(0!==o.length)throw new TypeError("Scalar expected");t.set(e.min(),r,i)}else{if(1!==n.length&&2!==n.length)throw new vr(n.length,t._size.length,"<");if(o.length<n.length){for(var s=0,l=0;1===n[s]&&1===o[s];)s++;for(;1===n[s];)l++,s++;r=Ir(r,n.length,l,o)}if(!Ze(n,o))throw new vr(n,o,">");for(var c=e.min()[0],h=e.min()[1],u=o[0],d=o[1],p=0;p<u;p++)for(var f=0;f<d;f++){var g=r[p][f];t.set([p+c,f+h],g,i)}}return t}(this,t,e,r);default:throw new SyntaxError("Wrong number of arguments")}},o.prototype.get=function(t){if(!ge(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new vr(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var e=t[0],r=t[1];br(e,this._size[0]),br(r,this._size[1]);var i=a(e,this._ptr[r],this._ptr[r+1],this._index);return i<this._ptr[r+1]&&this._index[i]===e?this._values[i]:0},o.prototype.set=function(t,i,o){if(!ge(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new vr(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var n=t[0],c=t[1],h=this._size[0],u=this._size[1],d=r,p=0;fe(this._datatype)&&(d=e.find(r,[this._datatype,this._datatype])||r,p=e.convert(0,this._datatype)),(n>h-1||c>u-1)&&(l(this,Math.max(n+1,h),Math.max(c+1,u),o),h=this._size[0],u=this._size[1]),br(n,h),br(c,u);var f=a(n,this._ptr[c],this._ptr[c+1],this._index);return f<this._ptr[c+1]&&this._index[f]===n?d(i,p)?function(t,e,r,i,o){r.splice(t,1),i.splice(t,1);for(var n=e+1;n<o.length;n++)o[n]--}(f,c,this._values,this._index,this._ptr):this._values[f]=i:s(f,n,c,i,this._values,this._index,this._ptr),this},o.prototype.resize=function(t,e,r){if(!ye(t))throw new TypeError("Array or Matrix expected");var i=t.valueOf().map((function(t){return Array.isArray(t)&&1===t.length?t[0]:t}));if(2!==i.length)throw new Error("Only two dimensions matrix are supported");return i.forEach((function(t){if(!ce(t)||!nr(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+yr(i)+")")})),l(r?this.clone():this,i[0],i[1],e)},o.prototype.reshape=function(t,e){if(!ge(t))throw new TypeError("Array expected");if(2!==t.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");t.forEach((function(e){if(!ce(e)||!nr(e)||e<=-2||0===e)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+yr(t)+")")}));var r=this._size[0]*this._size[1];if(r!==(t=wr(t,r))[0]*t[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var i=e?this.clone():this;if(this._size[0]===t[0]&&this._size[1]===t[1])return i;for(var o=[],n=0;n<i._ptr.length;n++)for(var l=0;l<i._ptr[n+1]-i._ptr[n];l++)o.push(n);for(var c=i._values.slice(),h=i._index.slice(),u=0;u<i._index.length;u++){var d=h[u],p=o[u],f=d*i._size[1]+p;o[u]=f%t[1],h[u]=Math.floor(f/t[1])}i._values.length=0,i._index.length=0,i._ptr.length=t[1]+1,i._size=t.slice();for(var g=0;g<i._ptr.length;g++)i._ptr[g]=0;for(var m=0;m<c.length;m++){var y=h[m],v=o[m],_=c[m];s(a(y,i._ptr[v],i._ptr[v+1],i._index),y,v,_,i._values,i._index,i._ptr)}return i},o.prototype.clone=function(){return new o({values:this._values?Xe(this._values):void 0,index:Xe(this._index),ptr:Xe(this._ptr),size:Xe(this._size),datatype:this._datatype})},o.prototype.size=function(){return this._size.slice(0)},o.prototype.map=function(t,i){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var n=this;return function(t,i,n,a,s,l,c){var h=[],u=[],d=[],p=r,f=0;fe(t._datatype)&&(p=e.find(r,[t._datatype,t._datatype])||r,f=e.convert(0,t._datatype));for(var g=function(t,e,r){t=l(t,e,r),p(t,f)||(h.push(t),u.push(e))},m=0;m<=s;m++){d.push(h.length);var y=t._ptr[m],v=t._ptr[m+1];if(c)for(var _=y;_<v;_++){var E=t._index[_];E>=0&&E<=n&&g(t._values[_],E-0,m-0)}else{for(var T={},b=y;b<v;b++){T[t._index[b]]=t._values[b]}for(var S=0;S<=n;S++){g(S in T?T[S]:0,S-0,m-0)}}}return d.push(h.length),new o({values:h,index:u,ptr:d,size:[n-0+1,s-0+1]})}(this,0,this._size[0]-1,0,this._size[1]-1,(function(e,r,i){return t(e,[r,i],n)}),i)},o.prototype.forEach=function(t,e){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var r=this._size[0],i=this._size[1],o=0;o<i;o++){var n=this._ptr[o],a=this._ptr[o+1];if(e)for(var s=n;s<a;s++){var l=this._index[s];t(this._values[s],[l,o],this)}else{for(var c={},h=n;h<a;h++)c[this._index[h]]=this._values[h];for(var u=0;u<r;u++)t(u in c?c[u]:0,[u,o],this)}}},o.prototype[Symbol.iterator]=Vr.a.mark((function t(){var e,r,i,o,n,a;return Vr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._values){t.next=2;break}throw new Error("Cannot iterate a Pattern only matrix");case 2:e=this._size[1],r=0;case 4:if(!(r<e)){t.next=18;break}i=this._ptr[r],o=this._ptr[r+1],n=i;case 8:if(!(n<o)){t.next=15;break}return a=this._index[n],t.next=12,{value:this._values[n],index:[a,r]};case 12:n++,t.next=8;break;case 15:r++,t.next=4;break;case 18:case"end":return t.stop()}}),t,this)})),o.prototype.toArray=function(){return c(this._values,this._index,this._ptr,this._size,!0)},o.prototype.valueOf=function(){return c(this._values,this._index,this._ptr,this._size,!1)},o.prototype.format=function(t){for(var e=this._size[0],r=this._size[1],i=this.density(),o="Sparse Matrix ["+yr(e,t)+" x "+yr(r,t)+"] density: "+yr(i,t)+"\n",n=0;n<r;n++)for(var a=this._ptr[n],s=this._ptr[n+1],l=a;l<s;l++)o+="\n    ("+yr(this._index[l],t)+", "+yr(n,t)+") ==> "+(this._values?yr(this._values[l],t):"X");return o},o.prototype.toString=function(){return yr(this.toArray())},o.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},o.prototype.diagonal=function(t){if(t){if(he(t)&&(t=t.toNumber()),!ce(t)||!nr(t))throw new TypeError("The parameter k must be an integer number")}else t=0;var e=t>0?t:0,r=t<0?-t:0,i=this._size[0],n=this._size[1],a=Math.min(i-r,n-e),s=[],l=[],c=[];c[0]=0;for(var h=e;h<n&&s.length<a;h++)for(var u=this._ptr[h],d=this._ptr[h+1],p=u;p<d;p++){var f=this._index[p];if(f===h-e+r){s.push(this._values[p]),l[s.length-1]=f-r;break}}return c.push(s.length),new o({values:s,index:l,ptr:c,size:[a,1]})},o.fromJSON=function(t){return new o(t)},o.diagonal=function(t,i,n,a,s){if(!ge(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(he(t)&&(t=t.toNumber()),!ce(t)||!nr(t)||t<1)throw new Error("Size values must be positive integers");return t})),n){if(he(n)&&(n=n.toNumber()),!ce(n)||!nr(n))throw new TypeError("The parameter k must be an integer number")}else n=0;var l=r,c=0;fe(s)&&(l=e.find(r,[s,s])||r,c=e.convert(0,s));var h,u=n>0?n:0,d=n<0?-n:0,p=t[0],f=t[1],g=Math.min(p-d,f-u);if(ge(i)){if(i.length!==g)throw new Error("Invalid value array length");h=function(t){return i[t]}}else if(me(i)){var m=i.size();if(1!==m.length||m[0]!==g)throw new Error("Invalid matrix length");h=function(t){return i.get([t])}}else h=function(){return i};for(var y=[],v=[],_=[],E=0;E<f;E++){_.push(y.length);var T=E-u;if(T>=0&&T<g){var b=h(T);l(b,c)||(v.push(T+d),y.push(b))}}return _.push(y.length),new o({values:y,index:v,ptr:_,size:[p,f]})},o.prototype.swapRows=function(t,e){if(!(ce(t)&&nr(t)&&ce(e)&&nr(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return br(t,this._size[0]),br(e,this._size[0]),o._swapRows(t,e,this._size[1],this._values,this._index,this._ptr),this},o._forEachRow=function(t,e,r,i,o){for(var n=i[t],a=i[t+1],s=n;s<a;s++)o(r[s],e[s])},o._swapRows=function(t,e,r,i,o,n){for(var s=0;s<r;s++){var l=n[s],c=n[s+1],h=a(t,l,c,o),u=a(e,l,c,o);if(h<c&&u<c&&o[h]===t&&o[u]===e){if(i){var d=i[h];i[h]=i[u],i[u]=d}}else if(h<c&&o[h]===t&&(u>=c||o[u]!==e)){var p=i?i[h]:void 0;o.splice(u,0,e),i&&i.splice(u,0,p),o.splice(u<=h?h+1:h,1),i&&i.splice(u<=h?h+1:h,1)}else if(u<c&&o[u]===e&&(h>=c||o[h]!==t)){var f=i?i[u]:void 0;o.splice(h,0,t),i&&i.splice(h,0,f),o.splice(h<=u?u+1:u,1),i&&i.splice(h<=u?u+1:u,1)}}},o}),{isClass:!0})},Pi={DenseMatrixDependencies:Jr,MatrixDependencies:zr,SparseMatrixDependencies:Ci,typedDependencies:gi,createMatrix:Pr("matrix",["typed","Matrix","DenseMatrix","SparseMatrix"],(function(t){var e=t.typed,r=(t.Matrix,t.DenseMatrix),i=t.SparseMatrix;return e("matrix",{"":function(){return o([])},string:function(t){return o([],t)},"string, string":function(t,e){return o([],t,e)},Array:function(t){return o(t)},Matrix:function(t){return o(t,t.storage())},"Array | Matrix, string":o,"Array | Matrix, string, string":o});function o(t,e,o){if("dense"===e||"default"===e||void 0===e)return new r(t,o);if("sparse"===e)return new i(t,o);throw new TypeError("Unknown matrix type "+JSON.stringify(e)+".")}}))};function Li(){throw new Error('No "bignumber" implementation available')}function Mi(){throw new Error('No "fraction" implementation available')}function Ri(){throw new Error('No "matrix" implementation available')}var Ni={matrixDependencies:Pi,typedDependencies:gi,createSize:Pr("size",["typed","config","?matrix"],(function(t){var e=t.typed,r=t.config,i=t.matrix;return e("size",{Matrix:function(t){return t.create(t.size())},Array:Er,string:function(t){return"Array"===r.matrix?[t.length]:i([t.length])},"number | Complex | BigNumber | Unit | boolean | null":function(t){return"Array"===r.matrix?[]:i?i([]):Ri()}})}))},Bi={addScalarDependencies:Si,conjDependencies:wi,multiplyScalarDependencies:Oi,sizeDependencies:Ni,typedDependencies:gi,createDot:Pr("dot",["typed","addScalar","multiplyScalar","conj","size"],(function(t){var e=t.typed,r=t.addScalar,i=t.multiplyScalar,o=t.conj,n=t.size;return e("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(t,n){var l=a(t,n),c=me(t)?t._data:t,h=me(t)?t._datatype:void 0,u=me(n)?n._data:n,d=me(n)?n._datatype:void 0,p=2===s(t).length,f=2===s(n).length,g=r,m=i;if(h&&d&&h===d&&"string"==typeof h){var y=h;g=e.find(r,[y,y]),m=e.find(i,[y,y])}if(!p&&!f){for(var v=m(o(c[0]),u[0]),_=1;_<l;_++)v=g(v,m(o(c[_]),u[_]));return v}if(!p&&f){for(var E=m(o(c[0]),u[0][0]),T=1;T<l;T++)E=g(E,m(o(c[T]),u[T][0]));return E}if(p&&!f){for(var b=m(o(c[0][0]),u[0]),S=1;S<l;S++)b=g(b,m(o(c[S][0]),u[S]));return b}if(p&&f){for(var x=m(o(c[0][0]),u[0][0]),w=1;w<l;w++)x=g(x,m(o(c[w][0]),u[w][0]));return x}},"SparseMatrix, SparseMatrix":function(t,e){a(t,e);for(var o=t._index,n=t._values,s=e._index,l=e._values,c=0,h=r,u=i,d=0,p=0;d<o.length&&p<s.length;){var f=o[d],g=s[p];f<g?d++:f>g?p++:f===g&&(c=h(c,u(n[d],l[p])),d++,p++)}return c}});function a(t,e){var r,i,o=s(t),n=s(e);if(1===o.length)r=o[0];else{if(2!==o.length||1!==o[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+o.join(", ")+")");r=o[0]}if(1===n.length)i=n[0];else{if(2!==n.length||1!==n[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+n.join(", ")+")");i=n[0]}if(r!==i)throw new RangeError("Vectors must have equal length ("+r+" != "+i+")");if(0===r)throw new RangeError("Cannot calculate the dot product of empty vectors");return r}function s(t){return me(t)?t.size():n(t)}}))},ki=Pr("algorithm11",["typed","equalScalar"],(function(t){var e=t.typed,r=t.equalScalar;return function(t,i,o,n){var a=t._values,s=t._index,l=t._ptr,c=t._size,h=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var u,d=c[0],p=c[1],f=r,g=0,m=o;"string"==typeof h&&(u=h,f=e.find(r,[u,u]),g=e.convert(0,u),i=e.convert(i,u),m=e.find(o,[u,u]));for(var y=[],v=[],_=[],E=0;E<p;E++){_[E]=v.length;for(var T=l[E],b=l[E+1],S=T;S<b;S++){var x=s[S],w=n?m(i,a[S]):m(a[S],i);f(w,g)||(v.push(x),y.push(w))}}return _[p]=v.length,t.createSparseMatrix({values:y,index:v,ptr:_,size:[d,p],datatype:u})}})),Fi=Pr("algorithm14",["typed"],(function(t){var e=t.typed;return function(t,r,i,o){var n,a=t._data,s=t._size,l=t._datatype,c=i;"string"==typeof l&&(n=l,r=e.convert(r,n),c=e.find(i,[n,n]));var h=s.length>0?function t(e,r,i,o,n,a,s){var l=[];if(r===i.length-1)for(var c=0;c<o;c++)l[c]=s?e(a,n[c]):e(n[c],a);else for(var h=0;h<o;h++)l[h]=t(e,r+1,i,i[r+1],n[h],a,s);return l}(c,0,s,s[0],a,r,o):[];return t.createDenseMatrix({data:h,size:Xe(s),datatype:n})}})),Ui={addScalarDependencies:Si,dotDependencies:Bi,equalScalarDependencies:Di,matrixDependencies:Pi,multiplyScalarDependencies:Oi,typedDependencies:gi,createMultiply:Pr("multiply",["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],(function(t){var e=t.typed,r=t.matrix,i=t.addScalar,o=t.multiplyScalar,n=t.equalScalar,a=t.dot,s=ki({typed:e,equalScalar:n}),l=Fi({typed:e});function c(t,e){switch(t.length){case 1:switch(e.length){case 1:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+t[0]+") must match Matrix rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+t[1]+") must match Vector length ("+e[0]+")");break;case 2:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+t[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+t.length+" dimensions)")}}function h(t,r){if("dense"!==r.storage())throw new Error("Support for SparseMatrix not implemented");return function(t,r){var n,a=t._data,s=t._size,l=t._datatype,c=r._data,h=r._size,u=r._datatype,d=s[0],p=h[1],f=i,g=o;l&&u&&l===u&&"string"==typeof l&&(n=l,f=e.find(i,[n,n]),g=e.find(o,[n,n]));for(var m=[],y=0;y<p;y++){for(var v=g(a[0],c[0][y]),_=1;_<d;_++)v=f(v,g(a[_],c[_][y]));m[y]=v}return t.createDenseMatrix({data:m,size:[p],datatype:n})}(t,r)}var u=e("_multiplyMatrixVector",{"DenseMatrix, any":function(t,r){var n,a=t._data,s=t._size,l=t._datatype,c=r._data,h=r._datatype,u=s[0],d=s[1],p=i,f=o;l&&h&&l===h&&"string"==typeof l&&(n=l,p=e.find(i,[n,n]),f=e.find(o,[n,n]));for(var g=[],m=0;m<u;m++){for(var y=a[m],v=f(y[0],c[0]),_=1;_<d;_++)v=p(v,f(y[_],c[_]));g[m]=v}return t.createDenseMatrix({data:g,size:[u],datatype:n})},"SparseMatrix, any":function(t,r){var a=t._values,s=t._index,l=t._ptr,c=t._datatype;if(!a)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var h,u=r._data,d=r._datatype,p=t._size[0],f=r._size[0],g=[],m=[],y=[],v=i,_=o,E=n,T=0;c&&d&&c===d&&"string"==typeof c&&(h=c,v=e.find(i,[h,h]),_=e.find(o,[h,h]),E=e.find(n,[h,h]),T=e.convert(0,h));var b=[],S=[];y[0]=0;for(var x=0;x<f;x++){var w=u[x];if(!E(w,T))for(var O=l[x],I=l[x+1],A=O;A<I;A++){var D=s[A];S[D]?b[D]=v(b[D],_(w,a[A])):(S[D]=!0,m.push(D),b[D]=_(w,a[A]))}}for(var C=m.length,P=0;P<C;P++){var L=m[P];g[P]=b[L]}return y[1]=m.length,t.createSparseMatrix({values:g,index:m,ptr:y,size:[p,1],datatype:h})}}),d=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(t,r){var n,a=t._data,s=t._size,l=t._datatype,c=r._data,h=r._size,u=r._datatype,d=s[0],p=s[1],f=h[1],g=i,m=o;l&&u&&l===u&&"string"==typeof l&&(n=l,g=e.find(i,[n,n]),m=e.find(o,[n,n]));for(var y=[],v=0;v<d;v++){var _=a[v];y[v]=[];for(var E=0;E<f;E++){for(var T=m(_[0],c[0][E]),b=1;b<p;b++)T=g(T,m(_[b],c[b][E]));y[v][E]=T}}return t.createDenseMatrix({data:y,size:[d,f],datatype:n})},"DenseMatrix, SparseMatrix":function(t,r){var a=t._data,s=t._size,l=t._datatype,c=r._values,h=r._index,u=r._ptr,d=r._size,p=r._datatype;if(!c)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var f,g=s[0],m=d[1],y=i,v=o,_=n,E=0;l&&p&&l===p&&"string"==typeof l&&(f=l,y=e.find(i,[f,f]),v=e.find(o,[f,f]),_=e.find(n,[f,f]),E=e.convert(0,f));for(var T=[],b=[],S=[],x=r.createSparseMatrix({values:T,index:b,ptr:S,size:[g,m],datatype:f}),w=0;w<m;w++){S[w]=b.length;var O=u[w],I=u[w+1];if(I>O)for(var A=0,D=0;D<g;D++){for(var C=D+1,P=void 0,L=O;L<I;L++){var M=h[L];A!==C?(P=v(a[D][M],c[L]),A=C):P=y(P,v(a[D][M],c[L]))}A!==C||_(P,E)||(b.push(D),T.push(P))}}return S[m]=b.length,x},"SparseMatrix, DenseMatrix":function(t,r){var a=t._values,s=t._index,l=t._ptr,c=t._datatype;if(!a)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var h,u=r._data,d=r._datatype,p=t._size[0],f=r._size[0],g=r._size[1],m=i,y=o,v=n,_=0;c&&d&&c===d&&"string"==typeof c&&(h=c,m=e.find(i,[h,h]),y=e.find(o,[h,h]),v=e.find(n,[h,h]),_=e.convert(0,h));for(var E=[],T=[],b=[],S=t.createSparseMatrix({values:E,index:T,ptr:b,size:[p,g],datatype:h}),x=[],w=[],O=0;O<g;O++){b[O]=T.length;for(var I=O+1,A=0;A<f;A++){var D=u[A][O];if(!v(D,_))for(var C=l[A],P=l[A+1],L=C;L<P;L++){var M=s[L];w[M]!==I?(w[M]=I,T.push(M),x[M]=y(D,a[L])):x[M]=m(x[M],y(D,a[L]))}}for(var R=b[O],N=T.length,B=R;B<N;B++){var k=T[B];E[B]=x[k]}}return b[g]=T.length,S},"SparseMatrix, SparseMatrix":function(t,r){var n,a=t._values,s=t._index,l=t._ptr,c=t._datatype,h=r._values,u=r._index,d=r._ptr,p=r._datatype,f=t._size[0],g=r._size[1],m=a&&h,y=i,v=o;c&&p&&c===p&&"string"==typeof c&&(n=c,y=e.find(i,[n,n]),v=e.find(o,[n,n]));for(var _,E,T,b,S,x,w,O,I=m?[]:void 0,A=[],D=[],C=t.createSparseMatrix({values:I,index:A,ptr:D,size:[f,g],datatype:n}),P=m?[]:void 0,L=[],M=0;M<g;M++){D[M]=A.length;var R=M+1;for(S=d[M],x=d[M+1],b=S;b<x;b++)if(O=u[b],m)for(E=l[O],T=l[O+1],_=E;_<T;_++)L[w=s[_]]!==R?(L[w]=R,A.push(w),P[w]=v(h[b],a[_])):P[w]=y(P[w],v(h[b],a[_]));else for(E=l[O],T=l[O+1],_=E;_<T;_++)L[w=s[_]]!==R&&(L[w]=R,A.push(w));if(m)for(var N=D[M],B=A.length,k=N;k<B;k++){var F=A[k];I[k]=P[F]}}return D[g]=A.length,C}});return e("multiply",Ke({"Array, Array":function(t,e){c(Er(t),Er(e));var i=this(r(t),r(e));return me(i)?i.valueOf():i},"Matrix, Matrix":function(t,e){var r=t.size(),i=e.size();return c(r,i),1===r.length?1===i.length?function(t,e,r){if(0===r)throw new Error("Cannot multiply two empty vectors");return a(t,e)}(t,e,r[0]):h(t,e):1===i.length?u(t,e):d(t,e)},"Matrix, Array":function(t,e){return this(t,r(e))},"Array, Matrix":function(t,e){return this(r(t,e.storage()),e)},"SparseMatrix, any":function(t,e){return s(t,e,o,!1)},"DenseMatrix, any":function(t,e){return l(t,e,o,!1)},"any, SparseMatrix":function(t,e){return s(e,t,o,!0)},"any, DenseMatrix":function(t,e){return l(e,t,o,!0)},"Array, any":function(t,e){return l(r(t),e,o,!1).valueOf()},"any, Array":function(t,e){return l(r(e),t,o,!0).valueOf()},"any, any":o,"any, any, ...any":function(t,e,r){for(var i=this(t,e),o=0;o<r.length;o++)i=this(i,r[o]);return i}},o.signatures))}))},Hi={ComplexDependencies:Yr,typedDependencies:gi,createSqrt:Pr("sqrt",["config","typed","Complex"],(function(t){var e=t.config,r=t.typed,i=t.Complex;return r("sqrt",{number:o,Complex:function(t){return t.sqrt()},BigNumber:function(t){return!t.isNegative()||e.predictable?t.sqrt():o(t.toNumber())},"Array | Matrix":function(t){return xi(t,this,!0)},Unit:function(t){return t.pow(.5)}});function o(t){return isNaN(t)?NaN:t>=0||e.predictable?Math.sqrt(t):new i(t,0).sqrt()}}))};function Gi(t,e){var r,i=(r=e,Object.keys(r.signatures||{}).reduce((function(t,e){var r=(e.match(/,/g)||[]).length+1;return Math.max(t,r)}),-1));!function r(o,n){Array.isArray(o)?function(t,e){Array.prototype.forEach.call(t,(function(t,e){r(t,n.concat(e))}))}(o):1===i?e(o):2===i?e(o,n):e(o,n,t)}(t,[])}var qi={typedDependencies:gi,createForEach:Pr("forEach",["typed"],(function(t){return(0,t.typed)("forEach",{"Array, function":Gi,"Matrix, function":function(t,e){return t.forEach(e)}})}))},Wi={DenseMatrixDependencies:Jr,SparseMatrixDependencies:Ci,matrixDependencies:Pi,typedDependencies:gi,createDiag:Pr("diag",["typed","matrix","DenseMatrix","SparseMatrix"],(function(t){var e=t.typed,r=t.matrix,i=t.DenseMatrix,o=t.SparseMatrix;return e("diag",{Array:function(t){return n(t,0,Er(t),null)},"Array, number":function(t,e){return n(t,e,Er(t),null)},"Array, BigNumber":function(t,e){return n(t,e.toNumber(),Er(t),null)},"Array, string":function(t,e){return n(t,0,Er(t),e)},"Array, number, string":function(t,e,r){return n(t,e,Er(t),r)},"Array, BigNumber, string":function(t,e,r){return n(t,e.toNumber(),Er(t),r)},Matrix:function(t){return n(t,0,t.size(),t.storage())},"Matrix, number":function(t,e){return n(t,e,t.size(),t.storage())},"Matrix, BigNumber":function(t,e){return n(t,e.toNumber(),t.size(),t.storage())},"Matrix, string":function(t,e){return n(t,0,t.size(),e)},"Matrix, number, string":function(t,e,r){return n(t,e,t.size(),r)},"Matrix, BigNumber, string":function(t,e,r){return n(t,e.toNumber(),t.size(),r)}});function n(t,e,n,a){if(!nr(e))throw new TypeError("Second parameter in function diag must be an integer");var s=e>0?e:0,l=e<0?-e:0;switch(n.length){case 1:return function(t,e,r,n,a,s){var l=[n+a,n+s];if(r&&"sparse"!==r&&"dense"!==r)throw new TypeError("Unknown matrix type ".concat(r,'"'));var c="sparse"===r?o.diagonal(l,t,e):i.diagonal(l,t,e);return null!==r?c:c.valueOf()}(t,e,a,n[0],l,s);case 2:return function(t,e,i,o,n,a){if(me(t)){var s=t.diagonal(e);return null!==i?i!==s.storage()?r(s,i):s:s.valueOf()}for(var l=Math.min(o[0]-n,o[1]-a),c=[],h=0;h<l;h++)c[h]=t[h+n][h+a];return null!==i?r(c):c}(t,e,a,n,l,s)}throw new RangeError("Matrix for function diag must be 2 dimensional")}}))},Yi={typedDependencies:gi,createAbs:Pr("abs",["typed"],(function(t){return(0,t.typed)("abs",{number:vi,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},Fraction:function(t){return t.abs()},"Array | Matrix":function(t){return xi(t,this,!0)},Unit:function(t){return t.abs()}})}))},zi=Pr("algorithm03",["typed"],(function(t){var e=t.typed;return function(t,r,i,o){var n=t._data,a=t._size,s=t._datatype,l=r._values,c=r._index,h=r._ptr,u=r._size,d=r._datatype;if(a.length!==u.length)throw new vr(a.length,u.length);if(a[0]!==u[0]||a[1]!==u[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+u+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p,f=a[0],g=a[1],m=0,y=i;"string"==typeof s&&s===d&&(p=s,m=e.convert(0,p),y=e.find(i,[p,p]));for(var v=[],_=0;_<f;_++)v[_]=[];for(var E=[],T=[],b=0;b<g;b++){for(var S=b+1,x=h[b],w=h[b+1],O=x;O<w;O++){var I=c[O];E[I]=o?y(l[O],n[I][b]):y(n[I][b],l[O]),T[I]=S}for(var A=0;A<f;A++)T[A]===S?v[A][b]=E[A]:v[A][b]=o?y(m,n[A][b]):y(n[A][b],m)}return t.createDenseMatrix({data:v,size:[f,g],datatype:p})}})),ji=Pr("algorithm07",["typed","DenseMatrix"],(function(t){var e=t.typed,r=t.DenseMatrix;return function(t,o,n){var a=t._size,s=t._datatype,l=o._size,c=o._datatype;if(a.length!==l.length)throw new vr(a.length,l.length);if(a[0]!==l[0]||a[1]!==l[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+l+")");var h,u,d,p=a[0],f=a[1],g=0,m=n;"string"==typeof s&&s===c&&(h=s,g=e.convert(0,h),m=e.find(n,[h,h]));var y=[];for(u=0;u<p;u++)y[u]=[];var v=[],_=[],E=[],T=[];for(d=0;d<f;d++){var b=d+1;for(i(t,d,E,v,b),i(o,d,T,_,b),u=0;u<p;u++){var S=E[u]===b?v[u]:g,x=T[u]===b?_[u]:g;y[u][d]=m(S,x)}}return new r({data:y,size:[p,f],datatype:h})};function i(t,e,r,i,o){for(var n=t._values,a=t._index,s=t._ptr,l=s[e],c=s[e+1];l<c;l++){var h=a[l];r[h]=o,i[h]=n[l]}}})),Vi=Pr("algorithm12",["typed","DenseMatrix"],(function(t){var e=t.typed,r=t.DenseMatrix;return function(t,i,o,n){var a=t._values,s=t._index,l=t._ptr,c=t._size,h=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var u,d=c[0],p=c[1],f=o;"string"==typeof h&&(u=h,i=e.convert(i,u),f=e.find(o,[u,u]));for(var g=[],m=[],y=[],v=0;v<p;v++){for(var _=v+1,E=l[v],T=l[v+1],b=E;b<T;b++){var S=s[b];m[S]=a[b],y[S]=_}for(var x=0;x<d;x++)0===v&&(g[x]=[]),y[x]===_?g[x][v]=n?f(i,m[x]):f(m[x],i):g[x][v]=n?f(i,0):f(0,i)}return new r({data:g,size:[d,p],datatype:u})}})),Xi=Pr("algorithm13",["typed"],(function(t){var e=t.typed;return function(t,r,i){var o,n=t._data,a=t._size,s=t._datatype,l=r._data,c=r._size,h=r._datatype,u=[];if(a.length!==c.length)throw new vr(a.length,c.length);for(var d=0;d<a.length;d++){if(a[d]!==c[d])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+c+")");u[d]=a[d]}var p=i;"string"==typeof s&&s===h&&(o=s,p=e.find(i,[o,o]));var f=u.length>0?function t(e,r,i,o,n,a){var s=[];if(r===i.length-1)for(var l=0;l<o;l++)s[l]=e(n[l],a[l]);else for(var c=0;c<o;c++)s[c]=t(e,r+1,i,i[r+1],n[c],a[c]);return s}(p,0,u,u[0],n,l):[];return t.createDenseMatrix({data:f,size:u,datatype:o})}})),Ji={DenseMatrixDependencies:Jr,matrixDependencies:Pi,typedDependencies:gi,createLarger:Pr("larger",["typed","config","matrix","DenseMatrix"],(function(t){var e=t.typed,r=t.config,i=t.matrix,o=t.DenseMatrix,n=zi({typed:e}),a=ji({typed:e,DenseMatrix:o}),s=Vi({typed:e,DenseMatrix:o}),l=Xi({typed:e}),c=Fi({typed:e});return e("larger",{"boolean, boolean":function(t,e){return t>e},"number, number":function(t,e){return t>e&&!fr(t,e,r.epsilon)},"BigNumber, BigNumber":function(t,e){return t.gt(e)&&!Ii(t,e,r.epsilon)},"Fraction, Fraction":function(t,e){return 1===t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return n(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return n(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return l(t,e,this)},"Array, Array":function(t,e){return this(i(t),i(e)).valueOf()},"Array, Matrix":function(t,e){return this(i(t),e)},"Matrix, Array":function(t,e){return this(t,i(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(i(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(i(e),t,this,!0).valueOf()}})}))},Ki={DenseMatrixDependencies:Jr,matrixDependencies:Pi,typedDependencies:gi,createSmaller:Pr("smaller",["typed","config","matrix","DenseMatrix"],(function(t){var e=t.typed,r=t.config,i=t.matrix,o=t.DenseMatrix,n=zi({typed:e}),a=ji({typed:e,DenseMatrix:o}),s=Vi({typed:e,DenseMatrix:o}),l=Xi({typed:e}),c=Fi({typed:e});return e("smaller",{"boolean, boolean":function(t,e){return t<e},"number, number":function(t,e){return t<e&&!fr(t,e,r.epsilon)},"BigNumber, BigNumber":function(t,e){return t.lt(e)&&!Ii(t,e,r.epsilon)},"Fraction, Fraction":function(t,e){return-1===t.compare(e)},"Complex, Complex":function(t,e){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return n(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return n(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return l(t,e,this)},"Array, Array":function(t,e){return this(i(t),i(e)).valueOf()},"Array, Matrix":function(t,e){return this(i(t),e)},"Matrix, Array":function(t,e){return this(t,i(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(i(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(i(e),t,this,!0).valueOf()}})}))},Zi={FibonacciHeapDependencies:{largerDependencies:Ji,smallerDependencies:Ki,createFibonacciHeapClass:Pr("FibonacciHeap",["smaller","larger"],(function(t){var e=t.smaller,r=t.larger,i=1/Math.log((1+Math.sqrt(5))/2);function o(){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function n(t,e,r){e.left.right=e.right,e.right.left=e.left,r.degree--,r.child===e&&(r.child=e.right),0===r.degree&&(r.child=null),e.left=t,e.right=t.right,t.right=e,e.right.left=e,e.parent=null,e.mark=!1}o.prototype.type="FibonacciHeap",o.prototype.isFibonacciHeap=!0,o.prototype.insert=function(t,r){var i={key:t,value:r,degree:0};if(this._minimum){var o=this._minimum;i.left=o,i.right=o.right,o.right=i,i.right.left=i,e(t,o.key)&&(this._minimum=i)}else i.left=i,i.right=i,this._minimum=i;return this._size++,i},o.prototype.size=function(){return this._size},o.prototype.clear=function(){this._minimum=null,this._size=0},o.prototype.isEmpty=function(){return 0===this._size},o.prototype.extractMinimum=function(){var t=this._minimum;if(null===t)return t;for(var o=this._minimum,n=t.degree,s=t.child;n>0;){var l=s.right;s.left.right=s.right,s.right.left=s.left,s.left=o,s.right=o.right,o.right=s,s.right.left=s,s.parent=null,s=l,n--}return t.left.right=t.right,t.right.left=t.left,o=t===t.right?null:function(t,o){var n,s=Math.floor(Math.log(o)*i)+1,l=new Array(s),c=0,h=t;if(h)for(c++,h=h.right;h!==t;)c++,h=h.right;for(;c>0;){for(var u=h.degree,d=h.right;n=l[u];){if(r(h.key,n.key)){var p=n;n=h,h=p}a(n,h),l[u]=null,u++}l[u]=h,h=d,c--}t=null;for(var f=0;f<s;f++)(n=l[f])&&(t?(n.left.right=n.right,n.right.left=n.left,n.left=t,n.right=t.right,t.right=n,n.right.left=n,e(n.key,t.key)&&(t=n)):t=n);return t}(o=t.right,this._size),this._size--,this._minimum=o,t},o.prototype.remove=function(t){this._minimum=function(t,r,i){r.key=-1;var o=r.parent;return o&&e(r.key,o.key)&&(n(t,r,o),function t(e,r){var i=r.parent;i&&(r.mark?(n(e,r,i),t(i)):r.mark=!0)}(t,o)),e(r.key,t.key)&&(t=r),t}(this._minimum,t),this.extractMinimum()};var a=function(t,e){t.left.right=t.right,t.right.left=t.left,t.parent=e,e.child?(t.left=e.child,t.right=e.child.right,e.child.right=t,t.right.left=t):(e.child=t,t.right=t,t.left=t),e.degree++,t.mark=!1};return o}),{isClass:!0})},addScalarDependencies:Si,equalScalarDependencies:Di,createSpaClass:Pr("Spa",["addScalar","equalScalar","FibonacciHeap"],(function(t){var e=t.addScalar,r=t.equalScalar,i=t.FibonacciHeap;function o(){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new i}return o.prototype.type="Spa",o.prototype.isSpa=!0,o.prototype.set=function(t,e){if(this._values[t])this._values[t].value=e;else{var r=this._heap.insert(t,e);this._values[t]=r}},o.prototype.get=function(t){var e=this._values[t];return e?e.value:0},o.prototype.accumulate=function(t,r){var i=this._values[t];i?i.value=e(i.value,r):(i=this._heap.insert(t,r),this._values[t]=i)},o.prototype.forEach=function(t,e,i){var o=this._heap,n=this._values,a=[],s=o.extractMinimum();for(s&&a.push(s);s&&s.key<=e;)s.key>=t&&(r(s.value,0)||i(s.key,s.value,this)),(s=o.extractMinimum())&&a.push(s);for(var l=0;l<a.length;l++){var c=a[l];n[(s=o.insert(c.key,c.value)).key]=s}},o.prototype.swap=function(t,e){var r=this._values[t],i=this._values[e];if(!r&&i)r=this._heap.insert(t,i.value),this._heap.remove(i),this._values[t]=r,this._values[e]=void 0;else if(r&&!i)i=this._heap.insert(e,r.value),this._heap.remove(r),this._values[e]=i,this._values[t]=void 0;else if(r&&i){var o=r.value;r.value=i.value,i.value=o}},o}),{isClass:!0})},Qi={BigNumberDependencies:Gr,typedDependencies:gi,createBignumber:Pr("bignumber",["typed","BigNumber"],(function(t){var e=t.typed,r=t.BigNumber;return e("bignumber",{"":function(){return new r(0)},number:function(t){return new r(t+"")},string:function(t){var e=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(e){var i=e[2],o=r(e[1]),n=new r(2).pow(Number(i));if(o.gt(n.sub(1)))throw new SyntaxError('String "'.concat(t,'" is out of range'));var a=new r(2).pow(Number(i)-1);return o.gte(a)?o.sub(n):o}return new r(t)},BigNumber:function(t){return t},Fraction:function(t){return new r(t.n).div(t.d).times(t.s)},null:function(t){return new r(0)},"Array | Matrix":function(t){return xi(t,this)}})}))},$i={FractionDependencies:Qr,typedDependencies:gi,createFraction:Pr("fraction",["typed","Fraction"],(function(t){var e=t.typed,r=t.Fraction;return e("fraction",{number:function(t){if(!isFinite(t)||isNaN(t))throw new Error(t+" cannot be represented as a fraction");return new r(t)},string:function(t){return new r(t)},"number, number":function(t,e){return new r(t,e)},null:function(t){return new r(0)},BigNumber:function(t){return new r(t.toString())},Fraction:function(t){return t},Object:function(t){return new r(t)},"Array | Matrix":function(t){return xi(t,this)}})}))},to={typedDependencies:gi,createNumber:Pr("number",["typed"],(function(t){var e=(0,t.typed)("number",{"":function(){return 0},number:function(t){return t},string:function(t){if("NaN"===t)return NaN;var e,r,i=(r=(e=t).match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/))?{input:e,radix:{"0b":2,"0o":8,"0x":16}[r[1]],integerPart:r[2],fractionalPart:r[3]}:null;if(i)return function(t){for(var e=parseInt(t.integerPart,t.radix),r=0,i=0;i<t.fractionalPart.length;i++)r+=parseInt(t.fractionalPart[i],t.radix)/Math.pow(t.radix,i+1);var o=e+r;if(isNaN(o))throw new SyntaxError('String "'+t.input+'" is no valid number');return o}(i);var o=0,n=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);n&&(o=Number(n[2]),t=n[1]);var a=Number(t);if(isNaN(a))throw new SyntaxError('String "'+t+'" is no valid number');if(n){if(a>Math.pow(2,o)-1)throw new SyntaxError('String "'.concat(t,'" is out of range'));a>=Math.pow(2,o-1)&&(a-=Math.pow(2,o))}return a},BigNumber:function(t){return t.toNumber()},Fraction:function(t){return t.valueOf()},Unit:function(t){throw new Error("Second argument with valueless unit expected")},null:function(t){return 0},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":function(t){return xi(t,this)}});return e.fromJSON=function(t){return parseFloat(t.value)},e}))},eo={bignumberDependencies:Qi,fractionDependencies:$i,numberDependencies:to,createNumeric:Pr("numeric",["number","?bignumber","?fraction"],(function(t){var e=t.number,r=t.bignumber,i=t.fraction,o={string:!0,number:!0,BigNumber:!0,Fraction:!0},n={number:function(t){return e(t)},BigNumber:r?function(t){return r(t)}:Li,Fraction:i?function(t){return i(t)}:Mi};return function(t,e){var r=Ve(t);if(!(r in o))throw new TypeError("Cannot convert "+t+' of type "'+r+'"; valid input types are '+Object.keys(o).join(", "));if(!(e in n))throw new TypeError("Cannot convert "+t+' to type "'+e+'"; valid output types are '+Object.keys(n).join(", "));return e===r?t:n[e](t)}}))},ro={numericDependencies:eo,typedDependencies:gi,createDivideScalar:Pr("divideScalar",["typed","numeric"],(function(t){var e=t.typed,r=t.numeric;return e("divideScalar",{"number, number":function(t,e){return t/e},"Complex, Complex":function(t,e){return t.div(e)},"BigNumber, BigNumber":function(t,e){return t.div(e)},"Fraction, Fraction":function(t,e){return t.div(e)},"Unit, number | Fraction | BigNumber":function(t,e){var i=t.clone(),o=r(1,Ve(e));return i.value=this(null===i.value?i._normalize(o):i.value,e),i},"number | Fraction | BigNumber, Unit":function(t,e){var i=e.clone();i=i.pow(-1);var o=r(1,Ve(t));return i.value=this(t,null===e.value?e._normalize(o):e.value),i},"Unit, Unit":function(t,e){return t.divide(e)}})}))},io={typedDependencies:gi,createUnaryMinus:Pr("unaryMinus",["typed"],(function(t){return(0,t.typed)("unaryMinus",{number:Ti,Complex:function(t){return t.neg()},BigNumber:function(t){return t.neg()},Fraction:function(t){return t.neg()},Unit:function(t){var e=t.clone();return e.value=this(t.value),e},"Array | Matrix":function(t){return xi(t,this,!0)}})}))},oo=Pr("algorithm01",["typed"],(function(t){var e=t.typed;return function(t,r,i,o){var n=t._data,a=t._size,s=t._datatype,l=r._values,c=r._index,h=r._ptr,u=r._size,d=r._datatype;if(a.length!==u.length)throw new vr(a.length,u.length);if(a[0]!==u[0]||a[1]!==u[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+u+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p,f,g=a[0],m=a[1],y="string"==typeof s&&s===d?s:void 0,v=y?e.find(i,[y,y]):i,_=[];for(p=0;p<g;p++)_[p]=[];var E=[],T=[];for(f=0;f<m;f++){for(var b=f+1,S=h[f],x=h[f+1],w=S;w<x;w++)E[p=c[w]]=o?v(l[w],n[p][f]):v(n[p][f],l[w]),T[p]=b;for(p=0;p<g;p++)T[p]===b?_[p][f]=E[p]:_[p][f]=n[p][f]}return t.createDenseMatrix({data:_,size:[g,m],datatype:y})}})),no=Pr("algorithm05",["typed","equalScalar"],(function(t){var e=t.typed,r=t.equalScalar;return function(t,i,o){var n=t._values,a=t._index,s=t._ptr,l=t._size,c=t._datatype,h=i._values,u=i._index,d=i._ptr,p=i._size,f=i._datatype;if(l.length!==p.length)throw new vr(l.length,p.length);if(l[0]!==p[0]||l[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+p+")");var g,m=l[0],y=l[1],v=r,_=0,E=o;"string"==typeof c&&c===f&&(g=c,v=e.find(r,[g,g]),_=e.convert(0,g),E=e.find(o,[g,g]));var T,b,S,x,w=n&&h?[]:void 0,O=[],I=[],A=w?[]:void 0,D=w?[]:void 0,C=[],P=[];for(b=0;b<y;b++){I[b]=O.length;var L=b+1;for(S=s[b],x=s[b+1];S<x;S++)T=a[S],O.push(T),C[T]=L,A&&(A[T]=n[S]);for(S=d[b],x=d[b+1];S<x;S++)C[T=u[S]]!==L&&O.push(T),P[T]=L,D&&(D[T]=h[S]);if(w)for(S=I[b];S<O.length;){var M=C[T=O[S]],R=P[T];if(M===L||R===L){var N=E(M===L?A[T]:_,R===L?D[T]:_);v(N,_)?O.splice(S,1):(w.push(N),S++)}}}return I[y]=O.length,t.createSparseMatrix({values:w,index:O,ptr:I,size:[m,y],datatype:g})}})),ao=Pr("algorithm10",["typed","DenseMatrix"],(function(t){var e=t.typed,r=t.DenseMatrix;return function(t,i,o,n){var a=t._values,s=t._index,l=t._ptr,c=t._size,h=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var u,d=c[0],p=c[1],f=o;"string"==typeof h&&(u=h,i=e.convert(i,u),f=e.find(o,[u,u]));for(var g=[],m=[],y=[],v=0;v<p;v++){for(var _=v+1,E=l[v],T=l[v+1],b=E;b<T;b++){var S=s[b];m[S]=a[b],y[S]=_}for(var x=0;x<d;x++)0===v&&(g[x]=[]),y[x]===_?g[x][v]=n?f(i,m[x]):f(m[x],i):g[x][v]=i}return new r({data:g,size:[d,p],datatype:u})}}));function so(t,e){var r=t.size(),i=e.size();if(r.length!==i.length)throw new vr(r.length,i.length)}var lo={DenseMatrixDependencies:Jr,addScalarDependencies:Si,equalScalarDependencies:Di,matrixDependencies:Pi,typedDependencies:gi,unaryMinusDependencies:io,createSubtract:Pr("subtract",["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix"],(function(t){var e=t.typed,r=t.matrix,i=t.equalScalar,o=t.addScalar,n=t.unaryMinus,a=t.DenseMatrix,s=oo({typed:e}),l=zi({typed:e}),c=no({typed:e,equalScalar:i}),h=ao({typed:e,DenseMatrix:a}),u=Xi({typed:e}),d=Fi({typed:e});return e("subtract",{"number, number":function(t,e){return t-e},"Complex, Complex":function(t,e){return t.sub(e)},"BigNumber, BigNumber":function(t,e){return t.minus(e)},"Fraction, Fraction":function(t,e){return t.sub(e)},"Unit, Unit":function(t,e){if(null===t.value)throw new Error("Parameter x contains a unit with undefined value");if(null===e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var r=t.clone();return r.value=this(r.value,e.value),r.fixPrefix=!1,r},"SparseMatrix, SparseMatrix":function(t,e){return so(t,e),c(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return so(t,e),l(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return so(t,e),s(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return so(t,e),u(t,e,this)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return h(t,n(e),o)},"DenseMatrix, any":function(t,e){return d(t,e,this)},"any, SparseMatrix":function(t,e){return h(e,t,this,!0)},"any, DenseMatrix":function(t,e){return d(e,t,this,!0)},"Array, any":function(t,e){return d(r(t),e,this,!1).valueOf()},"any, Array":function(t,e){return d(r(e),t,this,!0).valueOf()}})}))},co={lupDependencies:{DenseMatrixDependencies:Jr,SpaDependencies:Zi,SparseMatrixDependencies:Ci,absDependencies:Yi,addScalarDependencies:Si,divideScalarDependencies:ro,equalScalarDependencies:Di,largerDependencies:Ji,matrixDependencies:Pi,multiplyScalarDependencies:Oi,subtractDependencies:lo,typedDependencies:gi,unaryMinusDependencies:io,createLup:Pr("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtract","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],(function(t){var e=t.typed,r=t.matrix,i=t.abs,o=t.addScalar,n=t.divideScalar,a=t.multiplyScalar,s=t.subtract,l=t.larger,c=t.equalScalar,h=t.unaryMinus,u=t.DenseMatrix,d=t.SparseMatrix,p=t.Spa;return e("lup",{DenseMatrix:function(t){return f(t)},SparseMatrix:function(t){return function(t){var e,r,o,s=t._size[0],u=t._size[1],f=Math.min(s,u),g=t._values,m=t._index,y=t._ptr,v=[],_=[],E=[],T=[s,f],b=[],S=[],x=[],w=[f,u],O=[],I=[];for(e=0;e<s;e++)O[e]=e,I[e]=e;var A=function(){var t=new p;r<s&&(E.push(v.length),v.push(1),_.push(r)),x.push(b.length);var u=y[r],f=y[r+1];for(o=u;o<f;o++)e=m[o],t.set(O[e],g[o]);r>0&&t.forEach(0,r-1,(function(e,r){d._forEachRow(e,v,_,E,(function(i,o){i>e&&t.accumulate(i,h(a(o,r)))}))}));var A,D,C,P,L=r,M=t.get(r),R=i(M);t.forEach(r+1,s-1,(function(t,e){var r=i(e);l(r,R)&&(L=t,R=r,M=e)})),r!==L&&(d._swapRows(r,L,T[1],v,_,E),d._swapRows(r,L,w[1],b,S,x),t.swap(r,L),D=L,C=I[A=r],P=I[D],O[C]=D,O[P]=A,I[A]=P,I[D]=C),t.forEach(0,s-1,(function(t,e){t<=r?(b.push(e),S.push(t)):(e=n(e,M),c(e,0)||(v.push(e),_.push(t)))}))};for(r=0;r<u;r++)A();return x.push(b.length),E.push(v.length),{L:new d({values:v,index:_,ptr:E,size:T}),U:new d({values:b,index:S,ptr:x,size:w}),p:O,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}(t)},Array:function(t){var e=f(r(t));return{L:e.L.valueOf(),U:e.U.valueOf(),p:e.p}}});function f(t){var e,r,h,d=t._size[0],p=t._size[1],f=Math.min(d,p),g=Xe(t._data),m=[],y=[d,f],v=[],_=[f,p],E=[];for(e=0;e<d;e++)E[e]=e;for(r=0;r<p;r++){if(r>0)for(e=0;e<d;e++){var T=Math.min(e,r),b=0;for(h=0;h<T;h++)b=o(b,a(g[e][h],g[h][r]));g[e][r]=s(g[e][r],b)}var S=r,x=0,w=0;for(e=r;e<d;e++){var O=g[e][r],I=i(O);l(I,x)&&(S=e,x=I,w=O)}if(r!==S&&(E[r]=[E[S],E[S]=E[r]][0],u._swapRows(r,S,g)),r<d)for(e=r+1;e<d;e++){var A=g[e][r];c(A,0)||(g[e][r]=n(g[e][r],w))}}for(r=0;r<p;r++)for(e=0;e<d;e++)0===r&&(e<p&&(v[e]=[]),m[e]=[]),e<r?(e<p&&(v[e][r]=g[e][r]),r<d&&(m[e][r]=0)):e!==r?(e<p&&(v[e][r]=0),r<d&&(m[e][r]=g[e][r])):(e<p&&(v[e][r]=g[e][r]),r<d&&(m[e][r]=1));var D=new u({data:m,size:y}),C=new u({data:v,size:_}),P=[];for(e=0,f=E.length;e<f;e++)P[E[e]]=e;return{L:D,U:C,p:P,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}}))},matrixDependencies:Pi,multiplyDependencies:Ui,subtractDependencies:lo,typedDependencies:gi,unaryMinusDependencies:io,createDet:Pr("det",["typed","matrix","subtract","multiply","unaryMinus","lup"],(function(t){var e=t.typed,r=t.matrix,i=t.subtract,o=t.multiply,n=t.unaryMinus,a=t.lup;return e("det",{any:function(t){return Xe(t)},"Array | Matrix":function(t){var e;switch((e=me(t)?t.size():Array.isArray(t)?(t=r(t)).size():[]).length){case 0:return Xe(t);case 1:if(1===e[0])return Xe(t.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+yr(e)+")");case 2:var s=e[0];if(s===e[1])return function(t,e,r){if(1===e)return Xe(t[0][0]);if(2===e)return i(o(t[0][0],t[1][1]),o(t[1][0],t[0][1]));for(var s=a(t),l=s.U[0][0],c=1;c<e;c++)l=o(l,s.U[c][c]);for(var h=0,u=0,d=[];;){for(;d[u];)u++;if(u>=e)break;for(var p=u,f=0;!d[s.p[p]];)d[s.p[p]]=!0,p=s.p[p],f++;f%2==0&&h++}return h%2==0?l:n(l)}(t.clone().valueOf(),s);throw new RangeError("Matrix must be square (size: "+yr(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+yr(e)+")")}}})}))},ho={BigNumberDependencies:Gr,DenseMatrixDependencies:Jr,SparseMatrixDependencies:Ci,matrixDependencies:Pi,typedDependencies:gi,createIdentity:Pr("identity",["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],(function(t){var e=t.typed,r=t.config,i=t.matrix,o=t.BigNumber,n=t.DenseMatrix,a=t.SparseMatrix;return e("identity",{"":function(){return"Matrix"===r.matrix?i([]):[]},string:function(t){return i(t)},"number | BigNumber":function(t){return l(t,t,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, string":function(t,e){return l(t,t,e)},"number | BigNumber, number | BigNumber":function(t,e){return l(t,e,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(t,e,r){return l(t,e,r)},Array:function(t){return s(t)},"Array, string":function(t,e){return s(t,e)},Matrix:function(t){return s(t.valueOf(),t.storage())},"Matrix, string":function(t,e){return s(t.valueOf(),e)}});function s(t,e){switch(t.length){case 0:return e?i(e):[];case 1:return l(t[0],t[0],e);case 2:return l(t[0],t[1],e);default:throw new Error("Vector containing two values expected")}}function l(t,e,r){var i=he(t)||he(e)?o:null;if(he(t)&&(t=t.toNumber()),he(e)&&(e=e.toNumber()),!nr(t)||t<1)throw new Error("Parameters in function identity must be positive integers");if(!nr(e)||e<1)throw new Error("Parameters in function identity must be positive integers");var s=i?new o(1):1,l=i?new i(0):0,c=[t,e];if(r){if("sparse"===r)return a.diagonal(c,s,0,l);if("dense"===r)return n.diagonal(c,s,0,l);throw new TypeError('Unknown matrix type "'.concat(r,'"'))}for(var h=Sr([],c,l),u=t<e?t:e,d=0;d<u;d++)h[d][d]=s;return h}}))},uo={absDependencies:Yi,addScalarDependencies:Si,detDependencies:co,divideScalarDependencies:ro,identityDependencies:ho,matrixDependencies:Pi,multiplyDependencies:Ui,typedDependencies:gi,unaryMinusDependencies:io,createInv:Pr("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],(function(t){var e=t.typed,r=t.matrix,i=t.divideScalar,o=t.addScalar,n=t.multiply,a=t.unaryMinus,s=t.det,l=t.identity,c=t.abs;return e("inv",{"Array | Matrix":function(t){var e=me(t)?t.size():Er(t);switch(e.length){case 1:if(1===e[0])return me(t)?r([i(1,t.valueOf()[0])]):[i(1,t[0])];throw new RangeError("Matrix must be square (size: "+yr(e)+")");case 2:var o=e[0],n=e[1];if(o===n)return me(t)?r(h(t.valueOf(),o,n),t.storage()):h(t,o,n);throw new RangeError("Matrix must be square (size: "+yr(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+yr(e)+")")}},any:function(t){return i(1,t)}});function h(t,e,r){var h,u,d,p,f;if(1===e){if(0===(p=t[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[i(1,p)]]}if(2===e){var g=s(t);if(0===g)throw Error("Cannot calculate inverse, determinant is zero");return[[i(t[1][1],g),i(a(t[0][1]),g)],[i(a(t[1][0]),g),i(t[0][0],g)]]}var m=t.concat();for(h=0;h<e;h++)m[h]=m[h].concat();for(var y=l(e).valueOf(),v=0;v<r;v++){var _=c(m[v][v]),E=v;for(h=v+1;h<e;)c(m[h][v])>_&&(_=c(m[h][v]),E=h),h++;if(0===_)throw Error("Cannot calculate inverse, determinant is zero");(h=E)!==v&&(f=m[v],m[v]=m[h],m[h]=f,f=y[v],y[v]=y[h],y[h]=f);var T=m[v],b=y[v];for(h=0;h<e;h++){var S=m[h],x=y[h];if(h!==v){if(0!==S[v]){for(d=i(a(S[v]),T[v]),u=v;u<r;u++)S[u]=o(S[u],n(d,T[u]));for(u=0;u<r;u++)x[u]=o(x[u],n(d,b[u]))}}else{for(d=T[v],u=v;u<r;u++)S[u]=i(S[u],d);for(u=0;u<r;u++)x[u]=i(x[u],d)}}}return y}}))},po={matrixDependencies:Pi,typedDependencies:gi,createTranspose:Pr("transpose",["typed","matrix"],(function(t){var e=t.typed,r=t.matrix;return e("transpose",{Array:function(t){return this(r(t)).valueOf()},Matrix:function(t){var e,r=t.size();switch(r.length){case 1:e=t.clone();break;case 2:var i=r[0],o=r[1];if(0===o)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+yr(r)+")");switch(t.storage()){case"dense":e=function(t,e,r){for(var i,o=t._data,n=[],a=0;a<r;a++){i=n[a]=[];for(var s=0;s<e;s++)i[s]=Xe(o[s][a])}return t.createDenseMatrix({data:n,size:[r,e],datatype:t._datatype})}(t,i,o);break;case"sparse":e=function(t,e,r){for(var i,o,n,a=t._values,s=t._index,l=t._ptr,c=a?[]:void 0,h=[],u=[],d=[],p=0;p<e;p++)d[p]=0;for(i=0,o=s.length;i<o;i++)d[s[i]]++;for(var f=0,g=0;g<e;g++)u.push(f),f+=d[g],d[g]=u[g];for(u.push(f),n=0;n<r;n++)for(var m=l[n],y=l[n+1],v=m;v<y;v++){var _=d[s[v]]++;h[_]=n,a&&(c[_]=Xe(a[v]))}return t.createSparseMatrix({values:c,index:h,ptr:u,size:[r,e],datatype:t._datatype})}(t,i,o)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+yr(this._size)+")")}return e},any:function(t){return Xe(t)}})}))},fo=Pr("algorithm04",["typed","equalScalar"],(function(t){var e=t.typed,r=t.equalScalar;return function(t,i,o){var n=t._values,a=t._index,s=t._ptr,l=t._size,c=t._datatype,h=i._values,u=i._index,d=i._ptr,p=i._size,f=i._datatype;if(l.length!==p.length)throw new vr(l.length,p.length);if(l[0]!==p[0]||l[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+p+")");var g,m=l[0],y=l[1],v=r,_=0,E=o;"string"==typeof c&&c===f&&(g=c,v=e.find(r,[g,g]),_=e.convert(0,g),E=e.find(o,[g,g]));var T,b,S,x,w,O=n&&h?[]:void 0,I=[],A=[],D=n&&h?[]:void 0,C=n&&h?[]:void 0,P=[],L=[];for(b=0;b<y;b++){A[b]=I.length;var M=b+1;for(x=s[b],w=s[b+1],S=x;S<w;S++)T=a[S],I.push(T),P[T]=M,D&&(D[T]=n[S]);for(x=d[b],w=d[b+1],S=x;S<w;S++)if(P[T=u[S]]===M){if(D){var R=E(D[T],h[S]);v(R,_)?P[T]=null:D[T]=R}}else I.push(T),L[T]=M,C&&(C[T]=h[S]);if(D&&C)for(S=A[b];S<I.length;)P[T=I[S]]===M?(O[S]=D[T],S++):L[T]===M?(O[S]=C[T],S++):I.splice(S,1)}return A[y]=I.length,t.createSparseMatrix({values:O,index:I,ptr:A,size:[m,y],datatype:g})}})),go={DenseMatrixDependencies:Jr,SparseMatrixDependencies:Ci,addScalarDependencies:Si,equalScalarDependencies:Di,matrixDependencies:Pi,typedDependencies:gi,createAdd:Pr("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix"],(function(t){var e=t.typed,r=t.matrix,i=t.addScalar,o=t.equalScalar,n=t.DenseMatrix,a=(t.SparseMatrix,oo({typed:e})),s=fo({typed:e,equalScalar:o}),l=ao({typed:e,DenseMatrix:n}),c=Xi({typed:e}),h=Fi({typed:e});return e("add",Ke({"DenseMatrix, DenseMatrix":function(t,e){return c(t,e,i)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,i,!1)},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,i,!0)},"SparseMatrix, SparseMatrix":function(t,e){return s(t,e,i)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"DenseMatrix, any":function(t,e){return h(t,e,i,!1)},"SparseMatrix, any":function(t,e){return l(t,e,i,!1)},"any, DenseMatrix":function(t,e){return h(e,t,i,!0)},"any, SparseMatrix":function(t,e){return l(e,t,i,!0)},"Array, any":function(t,e){return h(r(t),e,i,!1).valueOf()},"any, Array":function(t,e){return h(r(e),t,i,!0).valueOf()},"any, any":i,"any, any, ...any":function(t,e,r){for(var i=this(t,e),o=0;o<r.length;o++)i=this(i,r[o]);return i}},i.signatures))}))},mo={typedDependencies:gi,createAtan:Pr("atan",["typed"],(function(t){return(0,t.typed)("atan",{number:function(t){return Math.atan(t)},Complex:function(t){return t.atan()},BigNumber:function(t){return t.atan()},"Array | Matrix":function(t){return xi(t,this,!0)}})}))},yo={IndexDependencies:{ImmutableDenseMatrixDependencies:{DenseMatrixDependencies:Jr,smallerDependencies:Ki,createImmutableDenseMatrixClass:Pr("ImmutableDenseMatrix",["smaller","DenseMatrix"],(function(t){var e=t.smaller,r=t.DenseMatrix;function i(t,e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!fe(e))throw new Error("Invalid datatype: "+e);if(me(t)||ge(t)){var o=new r(t,e);this._data=o._data,this._size=o._size,this._datatype=o._datatype,this._min=null,this._max=null}else if(t&&ge(t.data)&&ge(t.size))this._data=t.data,this._size=t.size,this._datatype=t.datatype,this._min=void 0!==t.min?t.min:null,this._max=void 0!==t.max?t.max:null;else{if(t)throw new TypeError("Unsupported type of data ("+Ve(t)+")");this._data=[],this._size=[0],this._datatype=e,this._min=null,this._max=null}}return i.prototype=new r,i.prototype.type="ImmutableDenseMatrix",i.prototype.isImmutableDenseMatrix=!0,i.prototype.subset=function(t){switch(arguments.length){case 1:var e=r.prototype.subset.call(this,t);return me(e)?new i({data:e._data,size:e._size,datatype:e._datatype}):e;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},i.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},i.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},i.prototype.clone=function(){return new i({data:Xe(this._data),size:Xe(this._size),datatype:this._datatype})},i.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},i.fromJSON=function(t){return new i(t)},i.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},i.prototype.min=function(){if(null===this._min){var t=null;this.forEach((function(r){(null===t||e(r,t))&&(t=r)})),this._min=null!==t?t:void 0}return this._min},i.prototype.max=function(){if(null===this._max){var t=null;this.forEach((function(r){(null===t||e(t,r))&&(t=r)})),this._max=null!==t?t:void 0}return this._max},i}),{isClass:!0})},createIndexClass:Pr("Index",["ImmutableDenseMatrix"],(function(t){var e=t.ImmutableDenseMatrix;function r(t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._isScalar=!0;for(var e=0,o=arguments.length;e<o;e++){var n=arguments[e];if(Ee(n))this._dimensions.push(n),this._isScalar=!1;else if(Array.isArray(n)||me(n)){var a=i(n.valueOf());this._dimensions.push(a);var s=a.size();1===s.length&&1===s[0]||(this._isScalar=!1)}else if("number"==typeof n)this._dimensions.push(i([n]));else{if("string"!=typeof n)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._dimensions.push(n)}}}function i(t){for(var r=0,i=t.length;r<i;r++)if("number"!=typeof t[r]||!nr(t[r]))throw new TypeError("Index parameters must be positive integer numbers");return new e(t)}return r.prototype.type="Index",r.prototype.isIndex=!0,r.prototype.clone=function(){var t=new r;return t._dimensions=Xe(this._dimensions),t._isScalar=this._isScalar,t},r.create=function(t){var e=new r;return r.apply(e,t),e},r.prototype.size=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var i=this._dimensions[e];t[e]="string"==typeof i?1:i.size()[0]}return t},r.prototype.max=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var i=this._dimensions[e];t[e]="string"==typeof i?i:i.max()}return t},r.prototype.min=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var i=this._dimensions[e];t[e]="string"==typeof i?i:i.min()}return t},r.prototype.forEach=function(t){for(var e=0,r=this._dimensions.length;e<r;e++)t(this._dimensions[e],e,this)},r.prototype.dimension=function(t){return this._dimensions[t]||null},r.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},r.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},r.prototype.isScalar=function(){return this._isScalar},r.prototype.toArray=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var i=this._dimensions[e];t.push("string"==typeof i?i:i.toArray())}return t},r.prototype.valueOf=r.prototype.toArray,r.prototype.toString=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var i=this._dimensions[e];"string"==typeof i?t.push(JSON.stringify(i)):t.push(i.toString())}return"["+t.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},r.fromJSON=function(t){return r.create(t.dimensions)},r}),{isClass:!0})},matrixDependencies:Pi,rangeDependencies:{bignumberDependencies:Qi,matrixDependencies:Pi,largerDependencies:Ji,largerEqDependencies:{DenseMatrixDependencies:Jr,matrixDependencies:Pi,typedDependencies:gi,createLargerEq:Pr("largerEq",["typed","config","matrix","DenseMatrix"],(function(t){var e=t.typed,r=t.config,i=t.matrix,o=t.DenseMatrix,n=zi({typed:e}),a=ji({typed:e,DenseMatrix:o}),s=Vi({typed:e,DenseMatrix:o}),l=Xi({typed:e}),c=Fi({typed:e});return e("largerEq",{"boolean, boolean":function(t,e){return t>=e},"number, number":function(t,e){return t>=e||fr(t,e,r.epsilon)},"BigNumber, BigNumber":function(t,e){return t.gte(e)||Ii(t,e,r.epsilon)},"Fraction, Fraction":function(t,e){return-1!==t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return n(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return n(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return l(t,e,this)},"Array, Array":function(t,e){return this(i(t),i(e)).valueOf()},"Array, Matrix":function(t,e){return this(i(t),e)},"Matrix, Array":function(t,e){return this(t,i(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(i(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(i(e),t,this,!0).valueOf()}})}))},smallerDependencies:Ki,smallerEqDependencies:{DenseMatrixDependencies:Jr,matrixDependencies:Pi,typedDependencies:gi,createSmallerEq:Pr("smallerEq",["typed","config","matrix","DenseMatrix"],(function(t){var e=t.typed,r=t.config,i=t.matrix,o=t.DenseMatrix,n=zi({typed:e}),a=ji({typed:e,DenseMatrix:o}),s=Vi({typed:e,DenseMatrix:o}),l=Xi({typed:e}),c=Fi({typed:e});return e("smallerEq",{"boolean, boolean":function(t,e){return t<=e},"number, number":function(t,e){return t<=e||fr(t,e,r.epsilon)},"BigNumber, BigNumber":function(t,e){return t.lte(e)||Ii(t,e,r.epsilon)},"Fraction, Fraction":function(t,e){return 1!==t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return n(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return n(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return l(t,e,this)},"Array, Array":function(t,e){return this(i(t),i(e)).valueOf()},"Array, Matrix":function(t,e){return this(i(t),e)},"Matrix, Array":function(t,e){return this(t,i(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(i(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(i(e),t,this,!0).valueOf()}})}))},typedDependencies:gi,createRange:Pr("range",["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq"],(function(t){var e=t.typed,r=t.config,i=t.matrix,o=t.bignumber,n=t.smaller,a=t.smallerEq,s=t.larger,l=t.largerEq;return e("range",{string:h,"string, boolean":h,"number, number":function(t,e){return c(u(t,e,1))},"number, number, number":function(t,e,r){return c(u(t,e,r))},"number, number, boolean":function(t,e,r){return c(r?d(t,e,1):u(t,e,1))},"number, number, number, boolean":function(t,e,r,i){return c(i?d(t,e,r):u(t,e,r))},"BigNumber, BigNumber":function(t,e){return c(p(t,e,new(0,t.constructor)(1)))},"BigNumber, BigNumber, BigNumber":function(t,e,r){return c(p(t,e,r))},"BigNumber, BigNumber, boolean":function(t,e,r){var i=t.constructor;return c(r?f(t,e,new i(1)):p(t,e,new i(1)))},"BigNumber, BigNumber, BigNumber, boolean":function(t,e,r,i){return c(i?f(t,e,r):p(t,e,r))}});function c(t){return"Matrix"===r.matrix?i?i(t):Ri():t}function h(t,e){var i=function(t){var e=t.split(":").map((function(t){return Number(t)}));if(e.some((function(t){return isNaN(t)})))return null;switch(e.length){case 2:return{start:e[0],end:e[1],step:1};case 3:return{start:e[0],end:e[2],step:e[1]};default:return null}}(t);if(!i)throw new SyntaxError('String "'+t+'" is no valid range');return"BigNumber"===r.number?(void 0===o&&Li(),c((e?f:p)(o(i.start),o(i.end),o(i.step)))):c((e?d:u)(i.start,i.end,i.step))}function u(t,e,r){var i=[],o=t;if(r>0)for(;n(o,e);)i.push(o),o+=r;else if(r<0)for(;s(o,e);)i.push(o),o+=r;return i}function d(t,e,r){var i=[],o=t;if(r>0)for(;a(o,e);)i.push(o),o+=r;else if(r<0)for(;l(o,e);)i.push(o),o+=r;return i}function p(t,e,r){var i=o(0),a=[],l=t;if(r.gt(i))for(;n(l,e);)a.push(l),l=l.plus(r);else if(r.lt(i))for(;s(l,e);)a.push(l),l=l.plus(r);return a}function f(t,e,r){var i=o(0),n=[],s=t;if(r.gt(i))for(;a(s,e);)n.push(s),s=s.plus(r);else if(r.lt(i))for(;l(s,e);)n.push(s),s=s.plus(r);return n}}))},typedDependencies:gi,createColumn:Pr("column",["typed","Index","matrix","range"],(function(t){var e=t.typed,r=t.Index,i=t.matrix,o=t.range;return e("column",{"Matrix, number":n,"Array, number":function(t,e){return n(i(Xe(t)),e).valueOf()}});function n(t,e){if(2!==t.size().length)throw new Error("Only two dimensional matrix is supported");br(e,t.size()[1]);var i=o(0,t.size()[0]),n=new r(i,e);return t.subset(n)}}))},vo={ComplexDependencies:Yr,typedDependencies:gi,createComplex:Pr("complex",["typed","Complex"],(function(t){var e=t.typed,r=t.Complex;return e("complex",{"":function(){return r.ZERO},number:function(t){return new r(t,0)},"number, number":function(t,e){return new r(t,e)},"BigNumber, BigNumber":function(t,e){return new r(t.toNumber(),e.toNumber())},Fraction:function(t){return new r(t.valueOf(),0)},Complex:function(t){return t.clone()},string:function(t){return r(t)},null:function(t){return r(0)},Object:function(t){if("re"in t&&"im"in t)return new r(t.re,t.im);if("r"in t&&"phi"in t||"abs"in t&&"arg"in t)return new r(t);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":function(t){return xi(t,this)}})}))},_o={typedDependencies:gi,createCos:Pr("cos",["typed"],(function(t){return(0,t.typed)("cos",{number:Math.cos,Complex:function(t){return t.cos()},BigNumber:function(t){return t.cos()},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return this(t.value)},"Array | Matrix":function(t){return xi(t,this)}})}))},Eo=Pr("equal",["typed","matrix","equalScalar","DenseMatrix"],(function(t){var e=t.typed,r=t.matrix,i=t.equalScalar,o=t.DenseMatrix,n=zi({typed:e}),a=ji({typed:e,DenseMatrix:o}),s=Vi({typed:e,DenseMatrix:o}),l=Xi({typed:e}),c=Fi({typed:e});return e("equal",{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:i(t,e)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,i)},"SparseMatrix, DenseMatrix":function(t,e){return n(e,t,i,!0)},"DenseMatrix, SparseMatrix":function(t,e){return n(t,e,i,!1)},"DenseMatrix, DenseMatrix":function(t,e){return l(t,e,i)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return s(t,e,i,!1)},"DenseMatrix, any":function(t,e){return c(t,e,i,!1)},"any, SparseMatrix":function(t,e){return s(e,t,i,!0)},"any, DenseMatrix":function(t,e){return c(e,t,i,!0)},"Array, any":function(t,e){return c(r(t),e,i,!1).valueOf()},"any, Array":function(t,e){return c(r(e),t,i,!0).valueOf()}})})),To=(Pr("equal",["typed","equalScalar"],(function(t){var e=t.typed,r=t.equalScalar;return e("equal",{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:r(t,e)}})})),{DenseMatrixDependencies:Jr,equalScalarDependencies:Di,matrixDependencies:Pi,typedDependencies:gi,createEqual:Eo}),bo={matrixDependencies:Pi,typedDependencies:gi,createFlatten:Pr("flatten",["typed","matrix"],(function(t){var e=t.typed,r=t.matrix;return e("flatten",{Array:function(t){return Ar(Xe(t))},Matrix:function(t){var e=Ar(Xe(t.toArray()));return r(e)}})}))},So={typedDependencies:gi,createIm:Pr("im",["typed"],(function(t){return(0,t.typed)("im",{number:function(t){return 0},BigNumber:function(t){return t.mul(0)},Fraction:function(t){return t.mul(0)},Complex:function(t){return t.im},"Array | Matrix":function(t){return xi(t,this)}})}))};function xo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var wo={flattenDependencies:bo,matrixDependencies:Pi,sizeDependencies:Ni,typedDependencies:gi,createMatrixFromColumns:Pr("matrixFromColumns",["typed","matrix","flatten","size"],(function(t){var e=t.typed,r=t.matrix,i=t.flatten,o=t.size;return e("matrixFromColumns",{"...Array":function(t){return n(t)},"...Matrix":function(t){return r(n(t.map((function(t){return t.toArray()}))))}});function n(t){if(0===t.length)throw new TypeError("At least one column is needed to construct a matrix.");for(var e=a(t[0]),r=[],o=0;o<e;o++)r[o]=[];var n,s=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return xo(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xo(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,n=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw n}}}}(t);try{for(s.s();!(n=s.n()).done;){var l=n.value,c=a(l);if(c!==e)throw new TypeError("The vectors had different length: "+(0|e)+" ≠ "+(0|c));for(var h=i(l),u=0;u<e;u++)r[u].push(h[u])}}catch(t){s.e(t)}finally{s.f()}return r}function a(t){var e=o(t);if(1===e.length)return e[0];if(2===e.length){if(1===e[0])return e[1];if(1===e[1])return e[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}}))};function Oo(t){return 0===t}Oo.signature="number";var Io={addScalarDependencies:Si,complexDependencies:vo,conjDependencies:wi,divideScalarDependencies:ro,equalDependencies:To,identityDependencies:ho,isZeroDependencies:{typedDependencies:gi,createIsZero:Pr("isZero",["typed"],(function(t){return(0,t.typed)("isZero",{number:Oo,BigNumber:function(t){return t.isZero()},Complex:function(t){return 0===t.re&&0===t.im},Fraction:function(t){return 1===t.d&&0===t.n},Unit:function(t){return this(t.value)},"Array | Matrix":function(t){return xi(t,this)}})}))},matrixDependencies:Pi,multiplyScalarDependencies:Oi,signDependencies:{BigNumberDependencies:Gr,FractionDependencies:Qr,complexDependencies:vo,typedDependencies:gi,createSign:Pr("sign",["typed","BigNumber","Fraction","complex"],(function(t){var e=t.typed,r=t.BigNumber,i=t.complex,o=t.Fraction;return e("sign",{number:bi,Complex:function(t){return 0===t.im?i(bi(t.re)):t.sign()},BigNumber:function(t){return new r(t.cmp(0))},Fraction:function(t){return new o(t.s,1)},"Array | Matrix":function(t){return xi(t,this,!0)},Unit:function(t){return this(t.value)}})}))},sqrtDependencies:Hi,subtractDependencies:lo,typedDependencies:gi,unaryMinusDependencies:io,zerosDependencies:{BigNumberDependencies:Gr,matrixDependencies:Pi,typedDependencies:gi,createZeros:Pr("zeros",["typed","config","matrix","BigNumber"],(function(t){var e=t.typed,r=t.config,i=t.matrix,o=t.BigNumber;return e("zeros",{"":function(){return"Array"===r.matrix?n([]):n([],"default")},"...number | BigNumber | string":function(t){return"string"==typeof t[t.length-1]?n(t,t.pop()):"Array"===r.matrix?n(t):n(t,"default")},Array:n,Matrix:function(t){var e=t.storage();return n(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return n(t.valueOf(),e)}});function n(t,e){var r=function(t){var e=!1;return t.forEach((function(t,r,i){he(t)&&(e=!0,i[r]=t.toNumber())})),e}(t)?new o(0):0;if(function(t){t.forEach((function(t){if("number"!=typeof t||!nr(t)||t<0)throw new Error("Parameters in function zeros must be positive integers")}))}(t),e){var n=i(e);return t.length>0?n.resize(t,r):n}var a=[];return t.length>0?Sr(a,t,r):a}}))},createQr:Pr("qr",["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtract","complex"],(function(t){var e=t.typed,r=t.matrix,i=t.zeros,o=t.identity,n=t.isZero,a=t.equal,s=t.sign,l=t.sqrt,c=t.conj,h=t.unaryMinus,u=t.addScalar,d=t.divideScalar,p=t.multiplyScalar,f=t.subtract,g=t.complex;return le()(e("qr",{DenseMatrix:function(t){return y(t)},SparseMatrix:function(t){return function(t){throw new Error("qr not implemented for sparse matrices yet")}()},Array:function(t){var e=y(r(t));return{Q:e.Q.valueOf(),R:e.R.valueOf()}}}),{_denseQRimpl:m});function m(t){var e,r,g,m=t._size[0],y=t._size[1],v=o([m],"dense"),_=v._data,E=t.clone(),T=E._data,b=i([m],"");for(g=0;g<Math.min(y,m);++g){var S=T[g][g],x=h(a(S,0)?1:s(S)),w=c(x),O=0;for(e=g;e<m;e++)O=u(O,p(T[e][g],c(T[e][g])));var I=p(x,l(O));if(!n(I)){var A=f(S,I);for(b[g]=1,e=g+1;e<m;e++)b[e]=d(T[e][g],A);var D=h(c(d(A,I))),C=void 0;for(r=g;r<y;r++){for(C=0,e=g;e<m;e++)C=u(C,p(c(b[e]),T[e][r]));for(C=p(C,D),e=g;e<m;e++)T[e][r]=p(f(T[e][r],p(b[e],C)),w)}for(e=0;e<m;e++){for(C=0,r=g;r<m;r++)C=u(C,p(_[e][r],b[r]));for(C=p(C,D),r=g;r<m;++r)_[e][r]=d(f(_[e][r],p(C,c(b[r]))),w)}}}return{Q:v,R:E,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}}function y(t){var e=m(t),r=e.R._data;if(t._data.length>0)for(var i="Complex"===r[0][0].type?g(0):0,o=0;o<r.length;++o)for(var n=0;n<o&&n<(r[0]||[]).length;++n)r[o][n]=i;return e}}))},Ao={typedDependencies:gi,createRe:Pr("re",["typed"],(function(t){return(0,t.typed)("re",{number:function(t){return t},BigNumber:function(t){return t},Fraction:function(t){return t},Complex:function(t){return t.re},"Array | Matrix":function(t){return xi(t,this)}})}))},Do={typedDependencies:gi,createSin:Pr("sin",["typed"],(function(t){return(0,t.typed)("sin",{number:Math.sin,Complex:function(t){return t.sin()},BigNumber:function(t){return t.sin()},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return this(t.value)},"Array | Matrix":function(t){return xi(t,this,!0)}})}))};function Co(t){var e=t.DenseMatrix;return function(t,r,i){var o=t.size();if(2!==o.length)throw new RangeError("Matrix must be two dimensional (size: "+yr(o)+")");var n=o[0];if(n!==o[1])throw new RangeError("Matrix must be square (size: "+yr(o)+")");var a=[];if(me(r)){var s=r.size(),l=r._data;if(1===s.length){if(s[0]!==n)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var c=0;c<n;c++)a[c]=[l[c]];return new e({data:a,size:[n,1],datatype:r._datatype})}if(2===s.length){if(s[0]!==n||1!==s[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(ve(r)){if(i){a=[];for(var h=0;h<n;h++)a[h]=[l[h][0]];return new e({data:a,size:[n,1],datatype:r._datatype})}return r}if(_e(r)){for(var u=0;u<n;u++)a[u]=[0];for(var d=r._values,p=r._index,f=r._ptr,g=f[1],m=f[0];m<g;m++)a[p[m]][0]=d[m];return new e({data:a,size:[n,1],datatype:r._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(ge(r)){var y=Er(r);if(1===y.length){if(y[0]!==n)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var v=0;v<n;v++)a[v]=[r[v]];return new e({data:a,size:[n,1]})}if(2===y.length){if(y[0]!==n||1!==y[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var _=0;_<n;_++)a[_]=[r[_][0]];return new e({data:a,size:[n,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var Po={DenseMatrixDependencies:Jr,divideScalarDependencies:ro,equalScalarDependencies:Di,matrixDependencies:Pi,multiplyScalarDependencies:Oi,subtractDependencies:lo,typedDependencies:gi,createUsolve:Pr("usolve",["typed","matrix","divideScalar","multiplyScalar","subtract","equalScalar","DenseMatrix"],(function(t){var e=t.typed,r=t.matrix,i=t.divideScalar,o=t.multiplyScalar,n=t.subtract,a=t.equalScalar,s=t.DenseMatrix,l=Co({DenseMatrix:s});return e("usolve",{"SparseMatrix, Array | Matrix":function(t,e){return function(t,e){for(var r=(e=l(t,e,!0))._data,c=t._size[0],h=t._size[1],u=t._values,d=t._index,p=t._ptr,f=[],g=h-1;g>=0;g--){var m=r[g][0]||0;if(a(m,0))f[g]=[0];else{for(var y=0,v=[],_=[],E=p[g],T=p[g+1]-1;T>=E;T--){var b=d[T];b===g?y=u[T]:b<g&&(v.push(u[T]),_.push(b))}if(a(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var S=i(m,y),x=0,w=_.length;x<w;x++){var O=_[x];r[O]=[n(r[O][0],o(S,v[x]))]}f[g]=[S]}}return new s({data:f,size:[c,1]})}(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return c(t,e)},"Array, Array | Matrix":function(t,e){return c(r(t),e).valueOf()}});function c(t,e){for(var r=(e=l(t,e,!0))._data,c=t._size[0],h=t._size[1],u=[],d=t._data,p=h-1;p>=0;p--){var f=r[p][0]||0,g=void 0;if(a(f,0))g=0;else{var m=d[p][p];if(a(m,0))throw new Error("Linear system cannot be solved since matrix is singular");g=i(f,m);for(var y=p-1;y>=0;y--)r[y]=[n(r[y][0]||0,o(g,d[y][p]))]}u[p]=[g]}return new s({data:u,size:[c,1]})}}))},Lo=r(35),Mo=r.n(Lo);function Ro(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return No(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?No(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,n=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw n}}}}function No(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var Bo,ko=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},Fo=function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},Uo=function t(e,r){var i=le()({},Nr,r);if("function"!=typeof Object.create)throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var o,n,a=(o={isNumber:ce,isComplex:ue,isBigNumber:he,isFraction:de,isUnit:pe,isString:fe,isArray:ge,isMatrix:me,isCollection:ye,isDenseMatrix:ve,isSparseMatrix:_e,isRange:Ee,isIndex:Te,isBoolean:be,isResultSet:Se,isHelp:xe,isFunction:we,isDate:Oe,isRegExp:Ie,isObject:Ae,isNull:De,isUndefined:Ce,isAccessorNode:Pe,isArrayNode:Le,isAssignmentNode:Me,isBlockNode:Re,isConditionalNode:Ne,isConstantNode:Be,isFunctionAssignmentNode:ke,isFunctionNode:Fe,isIndexNode:Ue,isNode:He,isObjectNode:Ge,isOperatorNode:qe,isParenthesisNode:We,isRangeNode:Ye,isSymbolNode:ze,isChain:je},n=new rr.a,o.on=n.on.bind(n),o.off=n.off.bind(n),o.once=n.once.bind(n),o.emit=n.emit.bind(n),o);a.config=function(t,e){function r(r){if(r){var i=Je(t,Xe);Fr(r,"matrix",Br),Fr(r,"number",kr),function t(e,r){if(Array.isArray(r))throw new TypeError("Arrays are not supported by deepExtend");for(var i in r)if($e(r,i)&&!(i in Object.prototype)&&!(i in Function.prototype))if(r[i]&&r[i].constructor===Object)void 0===e[i]&&(e[i]={}),e[i]&&e[i].constructor===Object?t(e[i],r[i]):e[i]=r[i];else{if(Array.isArray(r[i]))throw new TypeError("Arrays are not supported by deepExtend");e[i]=r[i]}return e}(t,r);var o=Je(t,Xe),n=Je(r,Xe);return e("config",o,i,n),o}return Je(t,Xe)}return r.MATRIX_OPTIONS=Br,r.NUMBER_OPTIONS=kr,Object.keys(Nr).forEach((function(e){Object.defineProperty(r,e,{get:function(){return t[e]},enumerable:!0,configurable:!0})})),r}(i,a.emit),a.expression={transform:{},mathWithTransform:{config:a.config}};var s={},l=function(t,e,r,i){function o(e,o,a){var s;if(a.wrap&&"function"==typeof o&&(o=function(t){var e=function(){for(var e=[],i=0,o=arguments.length;i<o;i++){var n=arguments[i];e[i]=n&&n.valueOf()}return t.apply(r,e)};return t.transform&&(e.transform=t.transform),e}(o)),"function"==typeof(s=o)&&"string"==typeof s.signature&&(o=t(e,or()({},o.signature,o))),l(r[e])&&l(o))return o=a.override?t(e,o.signatures):t(r[e],o),r[e]=o,delete i[e],n(e,o),void r.emit("import",e,(function(){return o}));if(void 0===r[e]||a.override)return r[e]=o,delete i[e],n(e,o),void r.emit("import",e,(function(){return o}));if(!a.silent)throw new Error('Cannot import "'+e+'": already exists')}function n(t,e){e&&"function"==typeof e.transform?(r.expression.transform[t]=e.transform,c(t)&&(r.expression.mathWithTransform[t]=e.transform)):(delete r.expression.transform[t],c(t)&&(r.expression.mathWithTransform[t]=e))}function a(t){delete r.expression.transform[t],c(t)?r.expression.mathWithTransform[t]=r[t]:delete r.expression.mathWithTransform[t]}function s(e,o){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.fn;if(Cr(n,"."))throw new Error("Factory name should not contain a nested path. Name: "+JSON.stringify(n));var s=u(e)?r.expression.transform:r,c=n in r.expression.transform,d=$e(s,n)?s[n]:void 0,p=function(){var i={};e.dependencies.map(Mr).forEach((function(t){if(Cr(t,"."))throw new Error("Factory dependency should not contain a nested path. Name: "+JSON.stringify(t));"math"===t?i.math=r:"mathWithTransform"===t?i.mathWithTransform=r.expression.mathWithTransform:"classes"===t?i.classes=r:i[t]=r[t]}));var a=e(i);if(a&&"function"==typeof a.transform)throw new Error('Transforms cannot be attached to factory functions. Please create a separate function for it with exports.path="expression.transform"');if(void 0===d||o.override)return a;if(l(d)&&l(a))return t(d,a);if(o.silent)return d;throw new Error('Cannot import "'+n+'": already exists')};e.meta&&!1===e.meta.lazy?(s[n]=p(),d&&c?a(n):(u(e)||h(e))&&Qe(r.expression.mathWithTransform,n,(function(){return s[n]}))):(Qe(s,n,p),d&&c?a(n):(u(e)||h(e))&&Qe(r.expression.mathWithTransform,n,(function(){return s[n]}))),i[n]=e,r.emit("import",n,p)}function l(t){return"function"==typeof t&&"object"==typeof t.signatures}function c(t){return!$e(d,t)}function h(t){return!(-1!==t.fn.indexOf(".")||$e(d,t.fn)||t.meta&&t.meta.isClass)}function u(t){return void 0!==t&&void 0!==t.meta&&!0===t.meta.isTransformFunction||!1}var d={expression:!0,type:!0,docs:!0,error:!0,json:!0,chain:!0};return function(t,e){var r=arguments.length;if(1!==r&&2!==r)throw new Rr("import",r,1,2);e||(e={});var i,n={};for(var a in function t(r,i,o){if(Array.isArray(i))i.forEach((function(e){return t(r,e)}));else if("object"==typeof i)for(var n in i)$e(i,n)&&t(r,i[n],n);else if(Lr(i)||void 0!==o){var a=Lr(i)?u(i)?i.fn+".transform":i.fn:o;if($e(r,a)&&r[a]!==i&&!e.silent)throw new Error('Cannot import "'+a+'" twice');r[a]=i}else if(!e.silent)throw new TypeError("Factory, Object, or Array expected")}(n,t),n)if($e(n,a)){var l=n[a];if(Lr(l))s(l,e);else if("function"==typeof(i=l)||"number"==typeof i||"string"==typeof i||"boolean"==typeof i||null===i||pe(i)||ue(i)||he(i)||de(i)||me(i)||Array.isArray(i))o(a,l,e);else if(!e.silent)throw new TypeError("Factory, Object, or Array expected")}}}((function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return a.typed.apply(a.typed,e)}),0,a,s);return a.import=l,a.on("config",(function(){tr(s).forEach((function(t){t&&t.meta&&t.meta.recreateOnConfigChange&&l(t,{override:!0})}))})),a.create=t.bind(null,e),a.factory=Pr,a.import(tr(function(t){var e={};return function t(e,r){for(var i in e)if($e(e,i)){var o=e[i];"object"==typeof o&&null!==o?t(o,r):r[i]=o}}(t,e),e}(e))),a.ArgumentsError=Rr,a.DimensionError=vr,a.IndexError=_r,a}({multiplyDependencies:Ui,sqrtDependencies:Hi,forEachDependencies:qi,matrixDependencies:Pi,diagDependencies:Wi,invDependencies:uo,transposeDependencies:po,eigsDependencies:{absDependencies:Yi,addDependencies:go,addScalarDependencies:Si,atanDependencies:mo,bignumberDependencies:Qi,columnDependencies:yo,complexDependencies:vo,cosDependencies:_o,diagDependencies:Wi,divideScalarDependencies:ro,dotDependencies:Bi,equalDependencies:To,flattenDependencies:bo,imDependencies:So,invDependencies:uo,largerDependencies:Ji,matrixDependencies:Pi,matrixFromColumnsDependencies:wo,multiplyDependencies:Ui,multiplyScalarDependencies:Oi,numberDependencies:to,qrDependencies:Io,reDependencies:Ao,sinDependencies:Do,smallerDependencies:Ki,sqrtDependencies:Hi,subtractDependencies:lo,typedDependencies:gi,usolveDependencies:Po,usolveAllDependencies:{DenseMatrixDependencies:Jr,divideScalarDependencies:ro,equalScalarDependencies:Di,matrixDependencies:Pi,multiplyScalarDependencies:Oi,subtractDependencies:lo,typedDependencies:gi,createUsolveAll:Pr("usolveAll",["typed","matrix","divideScalar","multiplyScalar","subtract","equalScalar","DenseMatrix"],(function(t){var e=t.typed,r=t.matrix,i=t.divideScalar,o=t.multiplyScalar,n=t.subtract,a=t.equalScalar,s=t.DenseMatrix,l=Co({DenseMatrix:s});return e("usolveAll",{"SparseMatrix, Array | Matrix":function(t,e){return function(t,e){for(var r=[l(t,e,!0)._data.map((function(t){return t[0]}))],c=t._size[0],h=t._size[1],u=t._values,d=t._index,p=t._ptr,f=h-1;f>=0;f--)for(var g=r.length,m=0;m<g;m++){for(var y=r[m],v=[],_=[],E=p[f],T=0,b=p[f+1]-1;b>=E;b--){var S=d[b];S===f?T=u[b]:S<f&&(v.push(u[b]),_.push(S))}if(a(T,0))if(a(y[f],0)){if(0===m){var x=Mo()(y);x[f]=1;for(var w=0,O=_.length;w<O;w++){var I=_[w];x[I]=n(x[I],v[w])}r.push(x)}}else{if(0===m)return[];r.splice(m,1),m-=1,g-=1}else{y[f]=i(y[f],T);for(var A=0,D=_.length;A<D;A++){var C=_[A];y[C]=n(y[C],o(y[f],v[A]))}}}return r.map((function(t){return new s({data:t.map((function(t){return[t]})),size:[c,1]})}))}(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return c(t,e)},"Array, Array | Matrix":function(t,e){return c(r(t),e).map((function(t){return t.valueOf()}))}});function c(t,e){for(var r=[l(t,e,!0)._data.map((function(t){return t[0]}))],c=t._data,h=t._size[0],u=t._size[1]-1;u>=0;u--)for(var d=r.length,p=0;p<d;p++){var f=r[p];if(a(c[u][u],0))if(a(f[u],0)){if(0===p){var g=Mo()(f);g[u]=1;for(var m=u-1;m>=0;m--)g[m]=n(g[m],c[m][u]);r.push(g)}}else{if(0===p)return[];r.splice(p,1),p-=1,d-=1}else{f[u]=i(f[u],c[u][u]);for(var y=u-1;y>=0;y--)f[y]=n(f[y],o(f[u],c[y][u]))}}return r.map((function(t){return new s({data:t.map((function(t){return[t]})),size:[h,1]})}))}}))},createEigs:Pr("eigs",["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],(function(t){var e=t.config,r=t.typed,i=t.matrix,o=t.addScalar,n=t.subtract,a=t.equal,s=t.abs,l=t.atan,c=t.cos,h=t.sin,u=t.multiplyScalar,d=t.divideScalar,p=t.inv,f=t.bignumber,g=t.multiply,m=t.add,y=t.larger,v=t.column,_=t.flatten,E=t.number,T=t.complex,b=t.sqrt,S=t.diag,x=t.qr,w=t.usolve,O=t.usolveAll,I=t.im,A=t.re,D=t.smaller,C=t.matrixFromColumns,P=t.dot,L=function(t){var e=t.config,r=t.addScalar,i=t.subtract,o=t.abs,n=t.atan,a=t.cos,s=t.sin,l=t.multiplyScalar,c=t.inv,h=t.bignumber,u=t.multiply,d=t.add;function p(t,e,r,i){for(var o=t.length,n=Math.cos(e),a=Math.sin(e),s=E(o,0),l=E(o,0),c=0;c<o;c++)s[c]=n*t[c][r]-a*t[c][i],l[c]=a*t[c][r]+n*t[c][i];for(var h=0;h<o;h++)t[h][r]=s[h],t[h][i]=l[h];return t}function f(t,e,o,n){for(var c=t.length,u=a(e),d=s(e),p=E(c,h(0)),f=E(c,h(0)),g=0;g<c;g++)p[g]=i(l(u,t[g][o]),l(d,t[g][n])),f[g]=r(l(d,t[g][o]),l(u,t[g][n]));for(var m=0;m<c;m++)t[m][o]=p[m],t[m][n]=f[m];return t}function g(t,e,o,n){for(var c=t.length,p=h(a(e)),f=h(s(e)),g=l(p,p),m=l(f,f),y=E(c,h(0)),v=E(c,h(0)),_=u(h(2),p,f,t[o][n]),T=r(i(l(g,t[o][o]),_),l(m,t[n][n])),b=d(l(m,t[o][o]),_,l(g,t[n][n])),S=0;S<c;S++)y[S]=i(l(p,t[o][S]),l(f,t[n][S])),v[S]=r(l(f,t[o][S]),l(p,t[n][S]));t[o][o]=T,t[n][n]=b,t[o][n]=h(0),t[n][o]=h(0);for(var x=0;x<c;x++)x!==o&&x!==n&&(t[o][x]=y[x],t[x][o]=y[x],t[n][x]=v[x],t[x][n]=v[x]);return t}function m(t,e,r,i){for(var o=t.length,n=Math.cos(e),a=Math.sin(e),s=n*n,l=a*a,c=E(o,0),h=E(o,0),u=s*t[r][r]-2*n*a*t[r][i]+l*t[i][i],d=l*t[r][r]+2*n*a*t[r][i]+s*t[i][i],p=0;p<o;p++)c[p]=n*t[r][p]-a*t[i][p],h[p]=a*t[r][p]+n*t[i][p];t[r][r]=u,t[i][i]=d,t[r][i]=0,t[i][r]=0;for(var f=0;f<o;f++)f!==r&&f!==i&&(t[r][f]=c[f],t[f][r]=c[f],t[i][f]=h[f],t[f][i]=h[f]);return t}function y(t){for(var e=t.length,r=0,i=[0,1],o=0;o<e;o++)for(var n=o+1;n<e;n++)Math.abs(r)<Math.abs(t[o][n])&&(r=Math.abs(t[o][n]),i=[o,n]);return[i,r]}function v(t){for(var e=t.length,r=0,i=[0,1],n=0;n<e;n++)for(var a=n+1;a<e;a++)o(r)<o(t[n][a])&&(r=o(t[n][a]),i=[n,a]);return[i,r]}function _(t,e){for(var r=t.length,i=Array(r),n=Array(r),a=0;a<r;a++)n[a]=Array(r);for(var s=0;s<r;s++){for(var l=0,c=t[0],h=0;h<t.length;h++)o(t[h])<o(c)&&(c=t[l=h]);i[s]=t.splice(l,1)[0];for(var u=0;u<r;u++)n[u][s]=e[u][l],e[u].splice(l,1)}return{values:i,vectors:n}}function E(t,e){for(var r=new Array(t),i=0;i<t;i++)r[i]=e;return r}return function(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.epsilon,s=arguments.length>3?arguments[3]:void 0;if("number"===s)return function(t,r){for(var i,o=t.length,n=Math.abs(r/o),a=new Array(o),s=0;s<o;s++)a[s]=E(o,0),a[s][s]=1;for(var l,c,h,u,d=y(t);Math.abs(d[1])>=Math.abs(n);){var f=d[0][0],g=d[0][1];l=t[f][f],c=t[g][g],h=t[f][g],u=c-l,t=m(t,i=Math.abs(u)<=e.epsilon?Math.PI/4:.5*Math.atan(2*h/(c-l)),f,g),a=p(a,i,f,g),d=y(t)}for(var v=E(o,0),T=0;T<o;T++)v[T]=t[T][T];return _(Xe(v),Xe(a))}(t,a);if("BigNumber"===s)return function(t,r){for(var a,s=t.length,d=o(r/s),p=new Array(s),m=0;m<s;m++)p[m]=E(s,0),p[m][m]=1;for(var y,T,b,S,x=v(t);o(x[1])>=o(d);){var w=x[0][0],O=x[0][1];y=t[w][w],T=t[O][O],b=t[w][O],S=i(T,y),t=g(t,a=o(S)<=e.epsilon?h(-1).acos().div(4):l(.5,n(u(2,b,c(S)))),w,O),p=f(p,a,w,O),x=v(t)}for(var I=E(s,0),A=0;A<s;A++)I[A]=t[A][A];return _(Xe(I),Xe(p))}(t,a);throw TypeError("Unsupported data type: "+s)}}({config:e,addScalar:o,subtract:n,column:v,flatten:_,equal:a,abs:s,atan:l,cos:c,sin:h,multiplyScalar:u,inv:p,bignumber:f,complex:T,multiply:g,add:m}),M=function(t){var e=t.addScalar,r=t.subtract,i=t.flatten,o=t.multiply,n=t.multiplyScalar,a=t.divideScalar,s=t.sqrt,l=t.abs,c=t.bignumber,h=t.diag,u=t.inv,d=t.qr,p=t.usolve,f=t.usolveAll,g=t.equal,m=t.complex,y=t.larger,v=t.smaller,_=t.matrixFromColumns,E=t.dot;function T(t,e,i,o,n,a,s,h){var u="BigNumber"===h,d="Complex"===h,p=u?c(0):d?m(0):0,f=u?c(1):d?m(1):1;if(v(l(i),s))return[[f,p],[p,f]];if(y(l(r(n,a)),s))return[[r(n,o),r(a,o)],[i,i]];var g=r(t,n),_=r(e,n),E=r(i,n),T=r(o,n);return v(l(_),s)?[[g,f],[E,p]]:[[_,p],[T,f]]}function b(t,e){for(var r=0;r<t.length;r++){var i;(i=t[r]).push.apply(i,Mo()(Array(e-t[r].length).fill(0)))}for(var o=t.length;o<e;o++)t.push(Array(e).fill(0)),t[o][o]=1;return t}function S(t,e,r){for(var i=0;i<t.length;i++)if(r(t[i],e))return i;return-1}function x(t,e,r,i,o){for(var n,a="BigNumber"===o?c(1e3):1e3,s=0;n=w(e,r,o),n=p(t,n),!y(I(n),a);)if(++s>=5)return null;for(s=0;;){var l=p(t,n);if(v(I(O(n,[l])),i))break;if(++s>=10)return null;n=A(l)}return n}function w(t,e,r){var i="BigNumber"===r,o="Complex"===r,n=Array(t).fill(0).map((function(t){return 2*Math.random()-1}));return i&&(n=n.map((function(t){return c(t)}))),o&&(n=n.map((function(t){return m(t)}))),A(n=O(n,e),r)}function O(t,e){var i,n=Ro(e);try{for(n.s();!(i=n.n()).done;){var s=i.value;t=r(t,o(a(E(s,t),E(s,s)),s))}}catch(t){n.e(t)}finally{n.f()}return t}function I(t){return l(s(E(t,t)))}function A(t,e){var r="Complex"===e,i="BigNumber"===e?c(1):r?m(1):1;return o(a(i,I(t)),t)}return function(t,p,E,w,O){void 0===O&&(O=!0);var I=function(t,r,i,o,s){var u,d="BigNumber"===o,p="Complex"===o,f=d?c(0):p?m(0):0,_=d?c(1):p?m(1):1,E=d?c(10):2,T=n(E,E);s&&(u=Array(r).fill(_));for(var b=!1;!b;){b=!0;for(var S=0;S<r;S++){for(var x=f,w=f,O=0;O<r;O++)if(S!==O){var I=l(t[S][O]);x=e(x,I),w=e(w,I)}if(!g(x,0)&&!g(w,0)){for(var A=_,D=x,C=a(w,E),P=n(w,E);v(D,C);)D=n(D,T),A=n(A,E);for(;y(D,P);)D=a(D,T),A=a(A,E);if(v(a(e(D,w),A),n(e(x,w),.95))){b=!1;for(var L=a(1,A),M=0;M<r;M++)S!==M&&(t[S][M]=n(t[S][M],A),t[M][S]=n(t[M][S],L));s&&(u[S]=n(u[S],A))}}}}return h(u)}(t,p,0,w,O);!function(t,i,o,s,h,u){var d="BigNumber"===s,p="Complex"===s,f=d?c(0):p?m(0):0;d&&(o=c(o));for(var g=0;g<i-2;g++){for(var y=0,_=f,E=g+1;E<i;E++){var T=t[E][g];v(l(_),l(T))&&(_=T,y=E)}if(!v(l(_),o)){if(y!==g+1){var b=t[y];t[y]=t[g+1],t[g+1]=b;for(var S=0;S<i;S++){var x=t[S][y];t[S][y]=t[S][g+1],t[S][g+1]=x}if(h){var w=u[y];u[y]=u[g+1],u[g+1]=w}}for(var O=g+2;O<i;O++){var I=a(t[O][g],_);if(0!==I){for(var A=0;A<i;A++)t[O][A]=r(t[O][A],n(I,t[g+1][A]));for(var D=0;D<i;D++)t[D][g+1]=e(t[D][g+1],n(I,t[D][O]));if(h)for(var C=0;C<i;C++)u[O][C]=r(u[O][C],n(I,u[g+1][C]))}}}}}(t,p,E,w,O,I);var A,D=function(t,i,a,u,p){var f="BigNumber"===u,g="Complex"===u,y=f?c(1):g?m(1):1;f&&(a=c(a));for(var _,E,S,x,w,O,I,A,D=Xe(t),C=[],P=i,L=[],M=p?h(Array(i).fill(y)):void 0,R=p?h(Array(P).fill(y)):void 0,N=0;N<=100;){N+=1;for(var B=0;B<P;B++)D[B][B]=r(D[B][B],0);var k=d(D),F=k.Q,U=k.R;D=o(U,F);for(var H=0;H<P;H++)D[H][H]=e(D[H][H],0);if(p&&(R=o(R,F)),1===P||v(l(D[P-1][P-2]),a)){N=0,C.push(D[P-1][P-1]),p&&(L.unshift([[1]]),b(R,i),M=o(M,R),P>1&&(R=h(Array(P-1).fill(y)))),P-=1,D.pop();for(var G=0;G<P;G++)D[G].pop()}else if(2===P||v(l(D[P-2][P-3]),a)){N=0;var q=(_=D[P-2][P-2],E=D[P-2][P-1],S=D[P-1][P-2],x=D[P-1][P-1],w=e(_,x),O=r(n(_,x),n(E,S)),I=n(w,.5),A=n(s(r(n(w,w),n(4,O))),.5),[e(I,A),r(I,A)]);C.push.apply(C,Mo()(q)),p&&(L.unshift(T(D[P-2][P-2],D[P-2][P-1],D[P-1][P-2],D[P-1][P-1],q[0],q[1],a,u)),b(R,i),M=o(M,R),P>2&&(R=h(Array(P-2).fill(y)))),P-=2,D.pop(),D.pop();for(var W=0;W<P;W++)D[W].pop(),D[W].pop()}if(0===P)break}if(C.sort((function(t,e){return+r(l(t),l(e))})),N>100){var Y=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+C.join(", "));throw Y.values=C,Y.vectors=[],Y}return{values:C,C:p?o(M,function(t,e){for(var r=[],i=0;i<e;i++)r[i]=Array(e).fill(0);var o,n=0,a=Ro(t);try{for(a.s();!(o=a.n()).done;){for(var s=o.value,l=s.length,c=0;c<l;c++)for(var h=0;h<l;h++)r[n+c][n+h]=s[c][h];n+=l}}catch(t){a.e(t)}finally{a.f()}return r}(L,i)):void 0}}(t,p,E,w,O),C=D.values,P=D.C;return P=o(u(I),P),O&&(A=function(t,e,n,a,s,l){var d,p=u(n),y=o(p,t,n),v="BigNumber"===l,_="Complex"===l,E=v?c(0):_?m(0):0,T=v?c(1):_?m(1):1,b=[],w=[],O=Ro(a);try{for(O.s();!(d=O.n()).done;){var I=d.value,A=S(b,I,g);-1===A?(b.push(I),w.push(1)):w[A]+=1}}catch(U){O.e(U)}finally{O.f()}for(var D=[],C=b.length,P=Array(e).fill(E),L=h(Array(e).fill(T)),M=[],R=0;R<C;R++){var N=b[R],B=r(y,o(N,L)),k=f(B,P);for((k=k.map((function(t){return o(n,t)}))).shift();k.length<w[R];){var F=x(B,e,k,s,l);if(null==F){M.push(N);break}k.push(F)}D.push.apply(D,Mo()(k.map((function(t){return i(t)}))))}if(0!==M.length){var U=new Error("Failed to find eigenvectors for the following eigenvalues: "+M.join(", "));throw U.values=a,U.vectors=D,U}return D}(t,p,P,C,E,w),A=_.apply(void 0,Mo()(A))),{values:C,vectors:A}}}({config:e,addScalar:o,subtract:n,multiply:g,multiplyScalar:u,flatten:_,divideScalar:d,sqrt:b,abs:s,bignumber:f,diag:S,qr:x,inv:p,usolve:w,usolveAll:O,equal:a,complex:T,larger:y,smaller:D,matrixFromColumns:C,dot:P});return r("eigs",{Array:function(t){return R(i(t))},"Array, number|BigNumber":function(t,e){return R(i(t),e)},Matrix:function(t){var e=R(t),r=e.values,o=e.vectors;return{values:i(r),vectors:i(o)}},"Matrix, number|BigNumber":function(t,e){var r=R(t,e),o=r.values,n=r.vectors;return{values:i(o),vectors:i(n)}}});function R(t,r){void 0===r&&(r=e.epsilon);var i=t.size();if(2!==i.length||i[0]!==i[1])throw new RangeError("Matrix must be square (size: "+yr(i)+")");var o=t.toArray(),a=i[0];if(function(t,e,r){for(var i=0;i<e;i++)for(var o=0;o<e;o++)if(y(f(s(I(t[i][o]))),r))return!1;return!0}(o,a,r)&&(function(t,e){for(var r=0;r<e;r++)for(var i=0;i<e;i++)t[r][i]=A(t[r][i])}(o,a),function(t,e,r){for(var i=0;i<e;i++)for(var o=i;o<e;o++)if(y(f(s(n(t[i][o],t[o][i]))),r))return!1;return!0}(o,a,r))){var l=N(t,o,a);return L(o,a,r,l)}var c=N(t,o,a);return M(o,a,r,c)}function N(t,e,r){var i=t.datatype();if("number"===i||"BigNumber"===i||"Complex"===i)return i;for(var o=!1,n=!1,a=!1,s=0;s<r;s++)for(var l=0;l<r;l++){var c=e[s][l];if(ce(c)||de(c))o=!0;else if(he(c))n=!0;else{if(!ue(c))throw TypeError("Unsupported type in Matrix: "+Ve(c));a=!0}}if(a){for(var h=0;h<r;h++)for(var u=0;u<r;u++)e[h][u]=T(e[h][u]);return"Complex"}if(n){for(var d=0;d<r;d++)for(var p=0;p<r;p++)e[d][p]=f(e[d][p]);return"BigNumber"}if(o){for(var g=0;g<r;g++)for(var m=0;m<r;m++)e[g][m]=E(e[g][m]);return"number"}throw TypeError("Matrix contains unsupported types only.")}}))},sizeDependencies:Ni,matrixFromColumnsDependencies:wo,columnDependencies:yo,reshapeDependencies:{isIntegerDependencies:{typedDependencies:gi,createIsInteger:Pr("isInteger",["typed"],(function(t){return(0,t.typed)("isInteger",{number:nr,BigNumber:function(t){return t.isInt()},Fraction:function(t){return 1===t.d&&isFinite(t.n)},"Array | Matrix":function(t){return xi(t,this)}})}))},matrixDependencies:Pi,typedDependencies:gi,createReshape:Pr("reshape",["typed","isInteger","matrix"],(function(t){var e=t.typed,r=t.isInteger;return e("reshape",{"Matrix, Array":function(t,e){return t.reshape(e)},"Array, Array":function(t,e){return e.forEach((function(t){if(!r(t))throw new TypeError("Invalid size for dimension: "+t)})),xr(t,e)}})}))},countDependencies:{prodDependencies:{multiplyScalarDependencies:Oi,numericDependencies:eo,typedDependencies:gi,createProd:Pr("prod",["typed","config","multiplyScalar","numeric"],(function(t){var e=t.typed,r=t.config,i=t.multiplyScalar,o=t.numeric;return e("prod",{"Array | Matrix":n,"Array | Matrix, number | BigNumber":function(t,e){throw new Error("prod(A, dim) is not yet supported")},"...":function(t){return n(t)}});function n(t){var e;if(function t(e,r){me(e)&&(e=e.valueOf());for(var i=0,o=e.length;i<o;i++){var n=e[i];Array.isArray(n)?t(n,r):r(n)}}(t,(function(t){try{e=void 0===e?t:i(e,t)}catch(e){throw function(t,e,r){var i;return-1!==String(t).indexOf("Unexpected type")?(i=arguments.length>2?" (type: "+Ve(r)+", value: "+JSON.stringify(r)+")":" (type: "+t.data.actual+")",new TypeError("Cannot calculate "+e+", unexpected type of argument"+i)):-1!==String(t).indexOf("complex numbers")?(i=arguments.length>2?" (type: "+Ve(r)+", value: "+JSON.stringify(r)+")":"",new TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+i)):t}(e,"prod",t)}})),"string"==typeof e&&(e=o(e,r.number)),void 0===e)throw new Error("Cannot calculate prod of an empty array");return e}}))},sizeDependencies:Ni,typedDependencies:gi,createCount:Pr("count",["typed","size","prod"],(function(t){var e=t.typed,r=t.size,i=t.prod;return e("count",{string:function(t){return t.length},"Matrix | Array":function(t){return i(r(t))}})}))}},{}),Ho=Uo.multiply,Go=Uo.sqrt,qo=Uo.forEach,Wo=Uo.matrix,Yo=Uo.diag,zo=Uo.inv,jo=Uo.transpose,Vo=Uo.eigs,Xo=Uo.size,Jo=Uo.matrixFromColumns,Ko=Uo.column,Zo=Uo.reshape,Qo=Uo.count,$o=function(t,e){this.x=t,this.y=e},tn=function(t,e){this.start=t,this.end=e},en=function(){function t(){}return t.matrix=function(t,e,r){var i=r.slice(0,t*e);return Zo(i,[t,e])},t.diag=function(t){return Yo(t)},t.inv=function(t){return zo(t)},t.transpose=function(t){return jo(t)},t.multiply=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ho.apply(void 0,Fo([],ko(t),!1))},t.forEach=function(t,e){qo(t,e)},t.svd=function(t){var e,r,i=Wo(t),o=Xo(t),n=Qo(t),a=jo(i),s=Ho(a,i),l=Vo(s,1e-8),c=l.values,h=l.vectors,u=Xo(c);u=u._data[0];for(var d=new Array(n).fill(0),p=u-1;p>=0;--p){var f=u-1-p;d[f*o[1]+f]=Go(c._data[p])}r=Zo(Wo(d),o);var g=[],m=[],y=Yo(r);for(p=u-1;p>=0;p--){var v=Ko(h,p);g.push(v),m.push(Ho(1/y._data[u-1-p],i,v))}return e=Jo.apply(void 0,Fo([],ko(g),!1)),{U:Jo.apply(void 0,Fo([],ko(m),!1)),V:e,E:r}},t.backSubst=function(t,e,r,i){var o=jo(r),n=jo(e),a=Xo(o),s=Xo(n),l=zo(Yo(Yo(t))),c=Zo(l,[a._data[1],s._data[0]]);return Ho(o,c,n,i)},t.solve=function(e,r){var i=t.svd(e),o=i.E,n=i.U,a=i.V;return a=jo(a),t.backSubst(o,n,a,r)},t}(),rn=function(){function t(){}return t.approxPolyDP_=function(t,e,r,i,o,n){var a,s,l,c,h,u,d,p,f,g,m=3,y=new tn(0,0),v=new tn(0,0),_=new $o(-1e6,-1e6),E=new $o(0,0),T=new $o(0,0),b=0,S=0,x=e,w=0,O=i,I=!1,A=0,D=n.length,C=n,P=function(t){A>=D&&(D=Math.ceil(3*D/2),C.length=D),C[A++]=JSON.parse(JSON.stringify(t))},L=function(e){var r=t[e];return++e>=x&&(e=0),[r,e]},M=function(t){var e=r[t];return++t>=x&&(t=0),[e,t]},R=function(t){r[w++]=JSON.parse(JSON.stringify(t))};if(0===x)return 0;if(o*=o,O||(v.start=x,E=t[0],(_=t[x-1]).x!=E.x||_.y!=E.y?(y.start=0,y.end=x-1,P(y)):(O=!0,m=1)),O){for(v.start=0,b=0;b<m;b++){var N=void 0,B=0;for(S=(S+v.start)%x,_=(a=ko(L(S),2))[0],S=a[1],f=1;f<x;f++){var k=void 0,F=void 0;T=(s=ko(L(S),2))[0],S=s[1],(N=(k=T.x-_.x)*k+(F=T.y-_.y)*F)>B&&(B=N,v.start=f)}I=B<=o}I?R(_):(v.end=y.start=S%x,y.end=v.start=(v.start+y.start)%x,P(v),P(y))}for(;A>0;){if(y=C[--A],E=t[y.end],S=y.start,_=(l=ko(L(S),2))[0],(S=l[1])!=y.end){for(k=void 0,F=void 0,N=void 0,B=0,k=E.x-_.x,F=E.y-_.y;S!=y.end;)T=(c=ko(L(S),2))[0],S=c[1],(N=Math.abs((T.y-_.y)*k-(T.x-_.x)*F))>B&&(B=N,v.start=(S+x-1)%x);I=B*B<=o*(k*k+F*F)}else I=!0,_=t[y.start];I?R(_):(v.end=y.end,y.end=v.start,P(v),P(y))}O||R(t[x-1]),x=w,_=(h=ko(M(S=(O=i)?x-1:0),2))[0],g=S=h[1],T=(u=ko(M(S),2))[0],S=u[1];var U=Number(!O);for(b=U;b<x-U&&w>2;b++){var H;k=void 0,F=void 0,N=void 0,E=(d=ko(M(S),2))[0],S=d[1],k=E.x-_.x,F=E.y-_.y,N=Math.abs((T.x-_.x)*F-(T.y-_.y)*k),H=(T.x-_.x)*(E.x-T.x)+(T.y-_.y)*(E.y-T.y),N*N<=.5*o*(k*k+F*F)&&0!=k&&0!=F&&H>=0?(w--,r[g]=_=E,++g>=x&&(g=0),T=(p=ko(M(S),2))[0],S=p[1],b++):(r[g]=_=T,++g>=x&&(g=0),T=E)}return O||(r[g]=T),w},t.approxPolyDP=function(e,r,i){var o=e.length;if(!o)return{points:[],count:0};var n=new Array(o),a=new Array(o),s=t.approxPolyDP_(e,o,a,i,r,n);return{points:a.filter((function(t){return!!t})),count:s}},t.getOfs=function(t,e){return new $o((2*(1&t)-1)*e,((2&t)-1)*e)},t.fitEllipseNoDirect=function(e){var r,i=e,o=i.length;if(!(o<5)){var n,a={center:{x:0,y:0},size:{width:0,height:0},angle:0},s=new $o(0,0),l=new Array(5).fill(0),c=new Array(5).fill(0),h=(new Array(25).fill(0),new Array(5).fill(0)),u=new Array(12*o+o).fill(0),d=0+5*o+5*o,p=d+o,f=null,g=null,m=null,y=null,v=null,_=null,E=i;for(r=0;r<o;r++){var T=E[r];u[p+r]=T,s.x+=T.x,s.y+=T.y}s.x/=o,s.y/=o;var b=0;for(r=0;r<o;r++)(T=JSON.parse(JSON.stringify(u[p+r]))).x-=s.x,T.y-=s.y,b+=Math.abs(T.x)+Math.abs(T.y);var S=100/(b>1.19209e-7?b:1.19209e-7);for(r=0;r<o;r++){(T=JSON.parse(JSON.stringify(u[p+r]))).x-=s.x,T.y-=s.y;var x=T.x*S,w=T.y*S;u[d+r]=1e4,u[0+5*r]=-x*x,u[0+5*r+1]=-w*w,u[0+5*r+2]=-x*w,u[0+5*r+3]=x,u[0+5*r+4]=w}f=en.matrix(o,5,u);var O=en.svd(f),I=O.E,A=O.U,D=O.V;_=I,y=A,v=en.transpose(D);var C=0;if(en.forEach(en.diag(_),(function(t){h[C++]=t})),1.19209e-7*h[0]>h[4]){var P=b/(2*o)*.001;for(r=0;r<o;r++){var L=t.getOfs(r,P);(T=u[p+r]).x+=L.x,T.y+=L.y}for(r=0;r<o;r++)(T=JSON.parse(JSON.stringify(u[p+r]))).x-=s.x,T.y-=s.y,x=T.x*S,w=T.y*S,u[d+r]=1e4,u[0+5*r]=-x*x,u[0+5*r+1]=-w*w,u[0+5*r+2]=-x*w,u[0+5*r+3]=x,u[0+5*r+4]=w;f=en.matrix(o,5,u);var M=en.svd(f),R=M.E,N=M.U,B=M.V;_=R,y=N,v=en.transpose(B)}for(g=en.matrix(o,1,u.slice(d)),m=en.backSubst(_,y,v,g),C=0,en.forEach(m,(function(t){l[C++]=t})),u[0]=2*l[0],u[1]=u[2]=l[2],u[3]=2*l[1],u[d+0]=l[3],u[d+1]=l[4],f=en.matrix(2,2,u),g=en.matrix(2,1,u.slice(d)),m=en.solve(f,g),C=0,en.forEach(m,(function(t){c[C++]=t})),r=0;r<o;r++)(T=JSON.parse(JSON.stringify(u[p+r]))).x-=s.x,T.y-=s.y,x=T.x*S,w=T.y*S,u[d+r]=1,u[0+3*r]=(x-c[0])*(x-c[0]),u[0+3*r+1]=(w-c[1])*(w-c[1]),u[0+3*r+2]=(x-c[0])*(w-c[1]);if(f=en.matrix(o,3,u),g=en.matrix(o,1,u.slice(d)),m=en.solve(f,g),C=0,en.forEach(m,(function(t){l[C++]=t})),c[4]=-.5*Math.atan2(l[2],l[1]-l[0]),n=Math.abs(l[2])>1e-8?l[2]/Math.sin(-2*c[4]):l[1]-l[0],c[2]=Math.abs(l[0]+l[1]-n),c[2]>1e-8&&(c[2]=Math.sqrt(2/c[2])),c[3]=Math.abs(l[0]+l[1]+n),c[3]>1e-8&&(c[3]=Math.sqrt(2/c[3])),a.center.x=c[0]/S+s.x,a.center.y=c[1]/S+s.y,a.size.width=2*c[2]/S,a.size.height=2*c[3]/S,a.size.width>a.size.height){var k=a.size.width;a.size.width=a.size.height,a.size.height=k,a.angle=90+180*c[4]/Math.PI}return a.angle<-180&&(a.angle+=360),a.angle>360&&(a.angle-=360),a}},t.fitEllipse=function(e){return t.fitEllipseNoDirect(e)},t}(),on="TIW_H5WEB",nn="tx_h5_postmessage",an=function(){function t(){}return t.createElement=function(t){var e=document.createElement("iframe");return e.classList.add("tic_iframe_H5"),e.setAttribute("style","border: none; display: none;"),e.scrolling="no",e.setAttribute("allow","autoplay"),e.setAttribute("name",JSON.stringify({sdkAppId:t.sdkAppId,userId:t.userId,version:i.VERSION,progressBarUrl:t.progressBarUrl,isLocalMode:t.isLocalMode,domainBackup:t.domainBackup})),e},t}(),sn=function(){function t(t){this.realCallback=null,this.reloadTimer=null,this.iframeDom=null,this.imageDom=null,this.notOkTimer=null,this.evtListener=null,this.domainMap=t.domainMap||{},this.accessibleDomains=t.accessibleDomains||{},this.timer=null}return t.prototype.cancelChecker=function(){this.clearStatus(),clearTimeout(this.timer),this.timer=null},t.prototype.retryUrls=function(t,e,r,i,o,n){var a=this;if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===n&&(n=0),Array.isArray(t)){var s=function(){l(),a.retryUrls(t,e,r,i,o+1,n)},l=function(){a.timer&&(clearTimeout(a.timer),a.timer=null)};if(o>=t.length){if(!(n<i))return void r("",l,s,e);o=0,n+=1}this.timer=setTimeout((function(){s()}),e),r(t[o],l,s,e)}},t.prototype.listenMsg=function(t){if(t.data){var e=t.data.module,r=t.data.cmd,i=t.data.data;if(nn===e)switch(r){case"init":try{var o=JSON.parse(i).url;this.clearStatus(),this.realCallback(o)}catch(t){}}}},t.prototype.clearStatus=function(){this.notOkTimer&&(clearTimeout(this.notOkTimer),this.notOkTimer=null),this.reloadTimer&&(clearTimeout(this.reloadTimer),this.reloadTimer=null),this.iframeDom&&this.iframeDom.remove(),this._clearImageStatus(),window.removeEventListener("message",this.evtListener),this.evtListener=null},t.prototype._clearImageStatus=function(){this.imageDom&&(this.imageDom.src="",this.imageDom.remove(),this.imageDom.onload=null,this.imageDom.onabort=null,this.imageDom.onerror=null,this.imageDom=null)},t.prototype.setNotOkTimer=function(t,e){var r=this;void 0===e&&(e="pulling"),this.notOkTimer&&(clearTimeout(this.notOkTimer),this.notOkTimer=null),this.notOkTimer=setTimeout((function(){r.clearStatus(),r.realCallback("")}),2*t)},t.prototype.createIframe=function(){this.iframeDom&&this.iframeDom.remove(),this.iframeDom=an.createElement({sdkAppId:0,userId:"",progressBarUrl:""})},t.prototype.checkH5PPT=function(t,e,r,i){var o=this;if(!t)return this.clearStatus(),void this.realCallback("");this.setNotOkTimer(i);var n=document.createElement("script");n.onload=function(){e(),o.clearStatus(),o.realCallback(t),n.remove()},n.onerror=function(){r(),n.remove()},n.src=t,document.body.appendChild(n)},t.prototype.videoUrlCb=function(t){this.clearStatus(),this.realCallback(t)},t.prototype.checkVideo=function(t,e,r,i){if(!t)return this.clearStatus(),void this.realCallback("");this.setNotOkTimer(i);var o=new XMLHttpRequest,n=this;o.timeout=i,o.onreadystatechange=function(){2==o.readyState?(e(),o.onreadystatechange=null,o.abort(),n.videoUrlCb.bind(n)(t)):4==o.readyState&&(e(),o.onreadystatechange=null,o.abort(),o.status>=200&&o.status<300||304==o.status?n.videoUrlCb.bind(n)(t):r())},o.open("GET",t),o.send()},t.prototype.checkImage=function(t,e,r,i){var o=this;if(!t)return this.clearStatus(),void this.realCallback("");this.setNotOkTimer(i),this._clearImageStatus(),this.imageDom=new Image,this.imageDom.style.display="none",this.imageDom.onload=function(){e(),o.clearStatus(),o.realCallback(t)},this.imageDom.onabort=function(){e(),o.clearStatus(),o.realCallback("")},this.imageDom.onerror=function(){r()},this.imageDom.src=t},t.prototype.getBackupUrls=function(t){var e=this,r=[],i=oe(t);return Object.hasOwnProperty.call(this.domainMap,i)?(r.unshift(t),this.domainMap[i].forEach((function(o){var n=t.replace(i,o);Object.hasOwnProperty.call(e.accessibleDomains,o)?r.unshift(n):r.push(n)})),r):t?[t]:[]},t.prototype.run=function(t,e,r){var i=this.getBackupUrls(t);1!==i.length?(this.evtListener=this.listenMsg.bind(this),this.realCallback=r,window.addEventListener("message",this.evtListener,!1),this.retryUrls(i,e,this.checkH5PPT.bind(this))):r(i[0])},t.prototype.runVideo=function(t,e,r){var i=this.getBackupUrls(t);1!==i.length?(this.realCallback=r,this.retryUrls(i,e,this.checkVideo.bind(this))):r(i[0])},t.prototype.runImage=function(t,e,r){var i=this.getBackupUrls(t);1!==i.length?(this.realCallback=r,this.retryUrls(i,e,this.checkImage.bind(this))):r(i[0])},t}(),ln=function(){function t(){this.timeout=5e3,this.taskMap={}}return t.prototype.startTask=function(t,e){this.stopTask(t),this.taskMap[t]=setTimeout((function(){k(e)&&e(t)}),this.timeout)},t.prototype.stopTask=function(t){this.taskMap[t]&&(clearTimeout(this.taskMap[t]),delete this.taskMap[t])},t.prototype.clearAllTask=function(){for(var t in this.taskMap)this.stopTask(+t)},t}(),cn=function(t){return/\.pptx?/i.test(t)},hn=function(t){return/\.pdf/i.test(t)},un=function(){return gt()?6:8},dn=function(){return gt()?3:2},pn=function(){return un()/2},fn=function(){var t,e;return(null===(t=null===crypto||void 0===crypto?void 0:crypto.randomUUID)||void 0===t?void 0:t.call(crypto))||(e=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?r:3&r|8).toString(16)})))},gn=function(){function t(t,e){this.user=t,this.type=e.type,this.seq=e.seq,this.subType=e.subType||0}return t.prototype.isOperationExist=function(t){if("number"==typeof this.seq)return this.seq===t;if(B(this.seq))return this.seq.some((function(e){return e.seq===t}));if(N(this.seq)&&"origin"in this.seq&&"final"in this.seq){var e=this.seq;return e.origin.some((function(e){return e.seq===t}))||e.final.some((function(e){return e.seq===t}))}return!1},t.prototype.removeOperationBySeq=function(t){if("number"==typeof this.seq)return this.seq===t;if(B(this.seq)){var e=this.seq.filter((function(e){return e.seq!==t}));return this.seq=e,0===e.length}if(N(this.seq)&&"origin"in this.seq&&"final"in this.seq){var r=this.seq.origin.filter((function(e){return e.seq!==t}));this.seq.origin=r;var i=this.seq.final.filter((function(e){return e.seq!==t}));return this.seq.final=i,0===r.length&&0===i.length}return!1},t}(),mn={TEDU_BOARD_LINE_TYPE_SOLID:1,TEDU_BOARD_LINE_TYPE_DOTTED:2},yn=function(){},vn=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),_n=function(t){function e(e){var r=t.call(this)||this;return r.data=e,r.lastWidth=0,r.lastHeigth=0,r}return vn(e,t),e.prototype.calcMinMax=function(){var t=this.data.endPoint.x,e=this.data.endPoint.y,r=this.data.startPoint.x,i=this.data.startPoint.y;return t<r&&(t+=r,t-=r=t-r),e<i&&(e+=i,e-=i=e-i),e+=this.data.thin/2,t+=this.data.thin/2,{minX:r-=this.data.thin/2,minY:i-=this.data.thin/2,maxX:t=null!=t?t:r,maxY:e=null!=e?e:i}},e}(yn),En=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Tn=function(){return(Tn=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},bn=function(t){function e(e){return t.call(this,e)||this}return En(e,t),e.prototype.impactCheck=function(t,e,r,i,o){var n=this.data.thin/2,a=this.data.pointTransformer(this.data.startPoint),s=a.x,l=a.y,c=this.data.pointTransformer(this.data.endPoint),h=c.x,u=c.y,d=Math.max(r+n,6);return!(!this.data.style||!this.data.style.startArrowType||this.data.style.startArrowType===At.TEDU_BOARD_ARROW_TYPE_NONE&&this.data.style.endArrowType===At.TEDU_BOARD_ARROW_TYPE_NONE||!function(t,e,r,i,o,n,a,s){var l=a/2,c=Math.max(a,2),h=Math.max(s+l,6),u=h*h,d=i.x,p=i.y,f=o.x,g=o.y,m=c*(e/t)+200,y=c+t/e*200,v=m+l,_=y+l,E=180*Math.atan2(g/1e4*e-p/1e4*e,f/1e4*t-d/1e4*t)/Math.PI,T=(E-25)*Math.PI/180,b=(E+25)*Math.PI/180,S=E*Math.PI/180,x=(E-30)*Math.PI/180,w=(E+30)*Math.PI/180,O=m*Math.cos(T),I=y*Math.sin(T),A=m*Math.cos(b),D=y*Math.sin(b),C=v*Math.cos(x),P=_*Math.sin(x),L=v*Math.cos(w),M=_*Math.sin(w),R=c*Math.cos(S)/2,N=c*Math.sin(S)/2,B=!1,k=!1;if(n.endArrowType===At.TEDU_BOARD_ARROW_TYPE_NORMAL){var F={x:f-O,y:g-I},U={x:f,y:g},H={x:f-A,y:g-D},G=Mt(r.x,r.y,F.x,F.y,U.x,U.y),q=Mt(r.x,r.y,H.x,H.y,U.x,U.y);k=G<=u||q<=u}if(n.endArrowType===At.TEDU_BOARD_ARROW_TYPE_SOLID&&(k=Nt(F={x:f-C,y:g-P},U={x:f+R,y:g+N},H={x:f-L,y:g-M},r)),n.startArrowType===At.TEDU_BOARD_ARROW_TYPE_NORMAL){var W={x:d+O,y:p+I},Y={x:d,y:p},z={x:d+A,y:p+D};G=Mt(r.x,r.y,W.x,W.y,Y.x,Y.y),q=Mt(r.x,r.y,z.x,z.y,Y.x,Y.y),B=G<=u||q<=u}return n.startArrowType===At.TEDU_BOARD_ARROW_TYPE_SOLID&&(B=Nt(W={x:d+C,y:p+P},Y={x:d-R,y:p-N},z={x:d+L,y:p+M},r)),B||k}(i,o,{x:t,y:e},{x:s,y:l},{x:h,y:u},this.data.style,this.data.thin,r))||Mt(t,e,s,l,h,u)<=d*d},e.prototype.straightLine=function(t,e){var r=this.data.pointTransformer(this.data.startPoint),i=r.x,o=r.y,n=this.data.pointTransformer(this.data.endPoint),a=n.x,s=n.y,l=Math.floor(i/1e4*e.width),c=Math.floor(o/1e4*e.height),h=Math.floor(a/1e4*e.width),u=Math.floor(s/1e4*e.height),d=e.minLineWidth,p=this.data.color,f=this.data.style;if(t.strokeStyle=p,t.lineWidth=d,t.lineCap="round",f.lineType==mn.TEDU_BOARD_LINE_TYPE_DOTTED){var g=.01*e.width+d;t.setLineDash([g,g])}else t.setLineDash([]);if(t.beginPath(),t.moveTo(l,c),t.lineTo(h,u),t.stroke(),t.setLineDash([]),f.startArrowType!=At.TEDU_BOARD_ARROW_TYPE_NONE||f.endArrowType!=At.TEDU_BOARD_ARROW_TYPE_NONE){var m=d+.02*e.width,y=180*Math.atan2(u-c,h-l)/Math.PI,v=(y-25)*Math.PI/180,_=(y+25)*Math.PI/180,E=m*Math.cos(v),T=m*Math.sin(v),b=m*Math.cos(_),S=m*Math.sin(_);f.endArrowType==At.TEDU_BOARD_ARROW_TYPE_NORMAL?(t.beginPath(),t.moveTo(h-E,u-T),t.lineTo(h,u),t.lineTo(h-b,u-S),t.stroke()):f.endArrowType==At.TEDU_BOARD_ARROW_TYPE_SOLID&&(t.beginPath(),t.moveTo(h-E,u-T),t.lineTo(h,u),t.lineTo(h-b,u-S),t.closePath(),t.fillStyle=p,t.fill(),t.stroke()),f.startArrowType==At.TEDU_BOARD_ARROW_TYPE_NORMAL?(t.beginPath(),t.moveTo(l+E,c+T),t.lineTo(l,c),t.lineTo(l+b,c+S),t.stroke()):f.startArrowType==At.TEDU_BOARD_ARROW_TYPE_SOLID&&(t.beginPath(),t.moveTo(l+E,c+T),t.lineTo(l,c),t.lineTo(l+b,c+S),t.closePath(),t.fillStyle=p,t.fill(),t.stroke())}},e.prototype.renderByCanvas=function(t,e){t&&(t.globalCompositeOperation="source-over");var r=this.data.thin/1e4*e.height,i=Math.max(r,e.minLineWidth);if(t.save(),this.data.style)this.straightLine(t,Tn(Tn({},e),{minLineWidth:i}));else{t.strokeStyle=this.data.color,t.lineWidth=i,t.lineCap="round",t.beginPath();var o=this.data.pointTransformer(this.data.startPoint),n=o.x,a=o.y,s=this.data.pointTransformer(this.data.endPoint),l=s.x,c=s.y;n=Math.floor(n/1e4*e.width),a=Math.floor(a/1e4*e.height),l=Math.floor(l/1e4*e.width),c=Math.floor(c/1e4*e.height),t.moveTo(n,a),t.lineTo(l,c),t.stroke()}t.restore(),this.data.needToRender=!1},e.prototype.renderTo=function(t,e){this.data.needToRender&&(this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e))},e.prototype.remove=function(){},e}(_n),Sn=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),xn=function(t){function e(e){return t.call(this,e)||this}return Sn(e,t),e.prototype.impactCheck=function(t,e,r,i,o){var n=this.data.thin/2,a=(this.calcMinMax(),this.data.pointTransformer(this.data.startPoint)),s=a.x,l=a.y,c=this.data.pointTransformer(this.data.endPoint),h=c.x,u=c.y,d=this.data.pointTransformer({x:this.data.endPoint.x,y:this.data.startPoint.y}),p=d.x,f=d.y,g=this.data.pointTransformer({x:this.data.startPoint.x,y:this.data.endPoint.y}),m=g.x,y=g.y;if(!this.data.solid){var v=Mt(t,e,s,l,p,f),_=Mt(t,e,s,l,m,y),E=Mt(t,e,h,u,p,f),T=Mt(t,e,h,u,m,y),b=r+n;return Math.min(v,_,E,T)<=b*b}return!!this.data.pointImpactCheck([t,e])},e.prototype.renderByCanvas=function(t,e){t.globalCompositeOperation="source-over";var r=e.xDis,i=e.yDis,o=(window.devicePixelRatio,this.data.pointTransformer(this.data.startPoint,!1)),n=o.x,a=o.y,s=this.data.pointTransformer(this.data.endPoint,!1),l=s.x,c=s.y;n<=l?a<=c||(i=-i):a<=c?r=-r:(r=-r,i=-i),t.strokeStyle=this.data.color,t.lineWidth=e.lineWidth;var h=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}([e.startPointX,e.startPointY],2),u=h[0],d=h[1];if(r=r,i=i,t.save(),t.translate(u+r/2,d+i/2),t.rotate(this.data.deg*Math.PI/180),t.translate(-(u+r/2),-(d+i/2)),this.data.solid)t.fillStyle=this.data.color,t.fillRect(u,d,r,i);else{if(this.data.style&&this.data.style.lineType==mn.TEDU_BOARD_LINE_TYPE_DOTTED){var p=.01*t.lineWidth+t.lineWidth;t.setLineDash([p,p+4])}else t.setLineDash([]);t.strokeRect(u,d,r,i)}t.restore(),this.data.needToRender=!1},e.prototype.renderTo=function(t,e){if(this.data.needToRender){var r=this.data.pointTransformer(this.data.startPoint,!1),i=r.x,o=r.y,n=this.data.pointTransformer(this.data.endPoint,!1),a=n.x,s=n.y,l=this.data.thin/1e4*e.height;l=Math.max(l,e.minLineWidth);var c=i/1e4*e.width,h=o/1e4*e.height,u=Math.abs(i-a)/1e4*e.width,d=Math.abs(o-s)/1e4*e.height;this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,{lineWidth:l,startPointX:c,startPointY:h,xDis:u,yDis:d})}},e.prototype.remove=function(){},e}(_n),wn=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),On=function(t){function e(e){return t.call(this,e)||this}return wn(e,t),e.prototype.impactCheck=function(t,e,r,i,o){var n=this.data.thin/2;if(!this.data.pointImpactCheck([t,e]))return!1;var a=this.data.pointTransformer(this.data.startPoint),s=a.x,l=a.y,c=this.data.pointTransformer(this.data.endPoint),h=c.x,u=c.y,d=this.data.pointTransformer({x:this.data.startPoint.x,y:this.data.endPoint.y}),p=d.x,f=d.y,g=this.data.pointTransformer({x:this.data.endPoint.x,y:this.data.startPoint.y}),m=g.x,y=g.y,v=Math.abs(Math.sqrt((s-m)*(s-m)+(l-y)*(l-y)))/2+n,_=Math.abs(Math.sqrt((s-p)*(s-p)+(l-f)*(l-f)))/2+n;if(v===_&&0===v)return!1;var E=Mt(t,e,(s+p)/2,(l+f)/2,(h+m)/2,(u+y)/2),T=Mt(t,e,(s+m)/2,(l+y)/2,(h+p)/2,(u+f)/2);if(this.data.solid)return T/(v*v)+E/(_*_)<=1.1;var b=this.data.thin;return T/((v-b)*(v-b))+E/((_-b)*(_-b))>=.8&&T/(v*v)+E/(_*_)<=1.1},e.bezierEllipse=function(t,e,r,i,o,n,a,s){window.devicePixelRatio;var l=.5522848,c=i*l,h=o*l;t.save(),t.translate(e,r),t.rotate(s*Math.PI/180),t.translate(-e,-r),t.beginPath(),Math.abs(i-o)<1?t.arc(e,r,i,0,2*Math.PI):(t.moveTo(e-i,r),t.bezierCurveTo(e-i,r-h,e-c,r-o,e,r-o),t.bezierCurveTo(e+c,r-o,e+i,r-h,e+i,r),t.bezierCurveTo(e+i,r+h,e+c,r+o,e,r+o),t.bezierCurveTo(e-c,r+o,e-i,r+h,e-i,r),t.closePath()),n?(t.fillStyle=a,t.fill()):t.stroke(),t.restore()},e.prototype.renderByCanvas=function(t,r){var i;t.globalCompositeOperation="source-over";var o=this.data.thin/1e4*r.height,n=this.data.pointTransformer(this.data.startPoint,!1),a=n.x,s=n.y,l=this.data.pointTransformer(this.data.endPoint,!1),c=l.x,h=l.y,u=Math.floor((a+c)/2/1e4*r.width),d=Math.floor((s+h)/2/1e4*r.height),p=Math.abs(a-c)/2/1e4*r.width,f=Math.abs(s-h)/2/1e4*r.height;t.save(),t.strokeStyle=this.data.color,t.lineWidth=Math.max(o,r.minLineWidth),(null===(i=this.data.style)||void 0===i?void 0:i.lineType)===mn.TEDU_BOARD_LINE_TYPE_DOTTED?(t.lineCap="butt",t.setLineDash([2*o,o])):(t.lineCap="round",t.setLineDash([])),e.bezierEllipse(t,u,d,p,f,this.data.solid,this.data.color,this.data.deg),t.restore(),this.data.needToRender=!1},e.prototype.renderTo=function(t,e){this.data.needToRender&&(this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e))},e.prototype.remove=function(){},e}(_n),In=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),An=function(t){function e(e){return t.call(this,e)||this}return In(e,t),e.prototype.impactCheck=function(t,e,r,i,o){if(!this.data.pointImpactCheck([t,e]))return!1;var n=this.data.thin/2,a=this.data.pointTransformer(this.data.startPoint),s=a.x,l=a.y,c=this.data.pointTransformer(this.data.endPoint),h=c.x,u=c.y,d=this.data.pointTransformer({x:this.data.startPoint.x,y:this.data.endPoint.y}),p=d.x,f=d.y;if(this.data.solid)return Dt([t,e],[[s,l],[h,u],[p,f]]);var g=Mt(t,e,s,l,p,f),m=Mt(t,e,s,l,h,u),y=Mt(t,e,h,u,p,f),v=r+n;return Math.min(g,m,y)<=v*v},e.prototype.renderByCanvas=function(t,e){var r;t&&(t.globalCompositeOperation="source-over");var i=Math.max(e.minLineWidth,this.data.thin/1e4*e.height),o=e.width,n=e.height,a=this.data.pointTransformer(this.data.startPoint),s=a.x,l=a.y,c=this.data.pointTransformer(this.data.endPoint),h=c.x,u=c.y,d=this.data.pointTransformer({x:this.data.startPoint.x,y:this.data.endPoint.y}),p={x:s/1e4*o,y:l/1e4*n},f={x:h/1e4*o,y:u/1e4*n},g={x:d.x/1e4*o,y:d.y/1e4*n};t.save(),this.data.solid?(t.strokeStyle="transparent",t.fillStyle=this.data.color):(t.strokeStyle=this.data.color,t.fillStyle="transparent"),t.lineWidth=i,(null===(r=this.data.style)||void 0===r?void 0:r.lineType)===mn.TEDU_BOARD_LINE_TYPE_DOTTED?(t.lineCap="butt",t.setLineDash([2*i,i])):(t.lineCap="round",t.setLineDash([])),t.beginPath(),t.moveTo(p.x,p.y),t.lineTo(f.x,f.y),t.lineTo(g.x,g.y),t.closePath(),this.data.solid?t.fill():t.stroke(),t.restore(),this.data.needToRender=!1},e.prototype.renderTo=function(t,e){this.data.needToRender&&(this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e))},e.prototype.remove=function(){},e}(_n),Dn=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Cn=function(t){function e(e){return t.call(this,e)||this}return Dn(e,t),e.prototype.impactCheck=function(t,e,r,i,o){if(!this.data.pointImpactCheck([t,e]))return!1;var n=this.data.thin/2,a=this.data.pointTransformer({x:(this.data.startPoint.x+this.data.endPoint.x)/2,y:this.data.startPoint.y}),s=a.x,l=a.y,c=this.data.pointTransformer(this.data.endPoint),h=c.x,u=c.y,d=this.data.pointTransformer({x:this.data.startPoint.x,y:this.data.endPoint.y}),p=d.x,f=d.y;if(this.data.solid)return Dt([t,e],[[s,l],[h,u],[p,f]]);var g=Mt(t,e,s,l,p,f),m=Mt(t,e,s,l,h,u),y=Mt(t,e,h,u,p,f),v=r+n;return Math.min(g,m,y)<=v*v},e.prototype.renderByCanvas=function(t,e){var r;t&&(t.globalCompositeOperation="source-over");var i=Math.max(e.minLineWidth,this.data.thin/1e4*e.height),o=e.width,n=e.height,a=this.data.pointTransformer({x:(this.data.startPoint.x+this.data.endPoint.x)/2,y:this.data.startPoint.y}),s=a.x,l=a.y,c=this.data.pointTransformer(this.data.endPoint),h=c.x,u=c.y,d=this.data.pointTransformer({x:this.data.startPoint.x,y:this.data.endPoint.y}),p={x:s/1e4*o,y:l/1e4*n},f={x:h/1e4*o,y:u/1e4*n},g={x:d.x/1e4*o,y:d.y/1e4*n};t.save(),this.data.solid?(t.strokeStyle="transparent",t.fillStyle=this.data.color):(t.strokeStyle=this.data.color,t.fillStyle="transparent"),t.lineWidth=i,(null===(r=this.data.style)||void 0===r?void 0:r.lineType)===mn.TEDU_BOARD_LINE_TYPE_DOTTED?(t.lineCap="butt",t.setLineDash([2*i,i])):(t.lineCap="round",t.setLineDash([])),t.beginPath(),t.moveTo(p.x,p.y),t.lineTo(f.x,f.y),t.lineTo(g.x,g.y),t.closePath(),this.data.solid?t.fill():t.stroke(),t.restore(),this.data.needToRender=!1},e.prototype.renderTo=function(t,e){this.data.needToRender&&(this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e))},e.prototype.remove=function(){},e}(_n),Pn=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ln=function(t){function e(e){return t.call(this,e)||this}return Pn(e,t),e.prototype.impactCheck=function(t,e,r,i,o){if(!this.data.pointImpactCheck([t,e]))return!1;var n=this.data.thin/2,a=this.data.pointTransformer({x:.8*this.data.startPoint.x+.2*this.data.endPoint.x,y:this.data.startPoint.y}),s=a.x,l=a.y,c=this.data.pointTransformer({x:this.data.endPoint.x,y:this.data.startPoint.y}),h=c.x,u=c.y,d=this.data.pointTransformer({x:.2*this.data.startPoint.x+.8*this.data.endPoint.x,y:this.data.endPoint.y}),p=d.x,f=d.y,g=this.data.pointTransformer({x:this.data.startPoint.x,y:this.data.endPoint.y}),m=g.x,y=g.y;if(this.data.solid)return Dt([t,e],[[s,l],[h,u],[p,f],[m,y]]);var v=Mt(t,e,s,l,h,u),_=Mt(t,e,h,u,p,f),E=Mt(t,e,p,f,m,y),T=Mt(t,e,m,y,s,l),b=r+n;return Math.min(v,_,E,T)<=b*b},e.prototype.renderByCanvas=function(t,e){var r;t&&(t.globalCompositeOperation="source-over");var i=Math.max(e.minLineWidth,this.data.thin/1e4*e.height),o=e.width,n=e.height,a=this.data.pointTransformer({x:.8*this.data.startPoint.x+.2*this.data.endPoint.x,y:this.data.startPoint.y}),s=a.x,l=a.y,c=this.data.pointTransformer({x:this.data.endPoint.x,y:this.data.startPoint.y}),h=c.x,u=c.y,d=this.data.pointTransformer({x:.2*this.data.startPoint.x+.8*this.data.endPoint.x,y:this.data.endPoint.y}),p=d.x,f=d.y,g=this.data.pointTransformer({x:this.data.startPoint.x,y:this.data.endPoint.y}),m={x:s/1e4*o,y:l/1e4*n},y={x:h/1e4*o,y:u/1e4*n},v={x:p/1e4*o,y:f/1e4*n},_={x:g.x/1e4*o,y:g.y/1e4*n};t.save(),this.data.solid?(t.strokeStyle="transparent",t.fillStyle=this.data.color):(t.strokeStyle=this.data.color,t.fillStyle="transparent"),t.lineWidth=i,(null===(r=this.data.style)||void 0===r?void 0:r.lineType)===mn.TEDU_BOARD_LINE_TYPE_DOTTED?(t.lineCap="butt",t.setLineDash([2*i,i])):(t.lineCap="round",t.setLineDash([])),t.beginPath(),t.moveTo(m.x,m.y),t.lineTo(y.x,y.y),t.lineTo(v.x,v.y),t.lineTo(_.x,_.y),t.closePath(),this.data.solid?t.fill():t.stroke(),t.restore(),this.data.needToRender=!1},e.prototype.renderTo=function(t,e){this.data.needToRender&&(this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e))},e.prototype.remove=function(){},e}(_n),Mn=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Rn=function(t){function e(e){return t.call(this,e)||this}return Mn(e,t),e.prototype.impactCheck=function(t,e,r,i,o){if(!this.data.pointImpactCheck([t,e]))return!1;var n=[this.data.pointTransformer({x:.8*this.data.startPoint.x+this.data.endPoint.x*(1-.8),y:this.data.startPoint.y}),this.data.pointTransformer({x:this.data.endPoint.x,y:this.data.startPoint.y}),this.data.pointTransformer({x:this.data.endPoint.x,y:.8*this.data.endPoint.y+this.data.startPoint.y*(1-.8)}),this.data.pointTransformer({x:.8*this.data.endPoint.x+this.data.startPoint.x*(1-.8),y:this.data.endPoint.y}),this.data.pointTransformer({x:this.data.startPoint.x,y:this.data.endPoint.y}),this.data.pointTransformer({x:this.data.startPoint.x,y:.8*this.data.startPoint.y+this.data.endPoint.y*(1-.8)})].map((function(t){return[t.x,t.y]}));return Dt([t,e],n)},e.prototype.renderByCanvas=function(t,e){var r;t&&(t.globalCompositeOperation="source-over");var i=Math.max(e.minLineWidth,this.data.thin/1e4*e.height),o=e.width,n=e.height,a=[this.data.pointTransformer({x:.8*this.data.startPoint.x+this.data.endPoint.x*(1-.8),y:this.data.startPoint.y}),this.data.pointTransformer({x:this.data.endPoint.x,y:this.data.startPoint.y}),this.data.pointTransformer({x:.8*this.data.endPoint.x+this.data.startPoint.x*(1-.8),y:.8*this.data.startPoint.y+this.data.endPoint.y*(1-.8)}),this.data.pointTransformer({x:this.data.startPoint.x,y:.8*this.data.startPoint.y+this.data.endPoint.y*(1-.8)}),this.data.pointTransformer({x:.8*this.data.startPoint.x+this.data.endPoint.x*(1-.8),y:.8*this.data.endPoint.y+this.data.startPoint.y*(1-.8)}),this.data.pointTransformer({x:this.data.endPoint.x,y:.8*this.data.endPoint.y+this.data.startPoint.y*(1-.8)}),this.data.pointTransformer({x:.8*this.data.endPoint.x+this.data.startPoint.x*(1-.8),y:this.data.endPoint.y}),this.data.pointTransformer({x:this.data.startPoint.x,y:this.data.endPoint.y})].map((function(t){return{x:t.x/1e4*o,y:t.y/1e4*n}}));t.save(),t.strokeStyle=this.data.color,t.fillStyle="transparent",t.lineWidth=i,t.lineJoin="round",t.lineCap="butt",t.setLineDash([2*i,i]),t.beginPath(),t.moveTo(a[5].x,a[5].y),t.lineTo(a[4].x,a[4].y),t.lineTo(a[7].x,a[7].y),t.stroke(),t.beginPath(),t.moveTo(a[0].x,a[0].y),t.lineTo(a[4].x,a[4].y),t.stroke(),(null===(r=this.data.style)||void 0===r?void 0:r.lineType)===mn.TEDU_BOARD_LINE_TYPE_DOTTED?t.setLineDash([2*i,i]):t.setLineDash([]),t.beginPath(),t.moveTo(a[1].x,a[1].y),t.lineTo(a[2].x,a[2].y),t.lineTo(a[3].x,a[3].y),t.lineTo(a[0].x,a[0].y),t.lineTo(a[1].x,a[1].y),t.lineTo(a[5].x,a[5].y),t.lineTo(a[6].x,a[6].y),t.lineTo(a[7].x,a[7].y),t.lineTo(a[3].x,a[3].y),t.stroke(),t.moveTo(a[2].x,a[2].y),t.lineTo(a[6].x,a[6].y),t.stroke(),t.restore(),this.data.needToRender=!1},e.prototype.renderTo=function(t,e){this.data.needToRender&&(this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e))},e.prototype.remove=function(){},e}(_n),Nn=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Bn=function(t){function e(e){return t.call(this,e)||this}return Nn(e,t),e.prototype.impactCheck=function(t,e,r,i,o){return this.data.pointImpactCheck([t,e])},e.prototype.renderByCanvas=function(t,e){var r;t&&(t.globalCompositeOperation="source-over");var i=Math.max(e.minLineWidth,this.data.thin/1e4*e.height),o=e.width,n=e.height,a=[this.data.pointTransformer({x:this.data.startPoint.x,y:.9*this.data.startPoint.y+this.data.endPoint.y*(1-.9)},!1),this.data.pointTransformer({x:this.data.startPoint.x,y:.9*this.data.endPoint.y+this.data.startPoint.y*(1-.9)},!1),this.data.pointTransformer({x:this.data.endPoint.x,y:.9*this.data.startPoint.y+this.data.endPoint.y*(1-.9)},!1),this.data.pointTransformer({x:this.data.endPoint.x,y:.9*this.data.endPoint.y+this.data.startPoint.y*(1-.9)},!1)].map((function(t){return{x:t.x/1e4*o,y:t.y/1e4*n}})),s=this.data.pointTransformer(this.data.startPoint,!1),l=s.x,c=s.y,h=this.data.pointTransformer(this.data.endPoint,!1),u=h.x,d=h.y,p=Math.floor((l+u)/2e4*o),f=Math.floor((c+d)/2e4*n),g=Math.abs(l-u)/2e4*o,m=Math.abs(c-d)/2e4*n*.2,y=.5522848,v=g*y,_=m*y,E=(a[0].x+a[2].x)/2,T=(a[0].y+a[2].y)/2,b=(a[1].x+a[3].x)/2,S=(a[1].y+a[3].y)/2;t.save(),t.strokeStyle=this.data.color,t.fillStyle="transparent",t.lineWidth=i,t.lineCap="butt",t.lineJoin="round",t.translate(p,f),t.rotate(this.data.deg*Math.PI/180),t.translate(-p,-f),(null===(r=this.data.style)||void 0===r?void 0:r.lineType)===mn.TEDU_BOARD_LINE_TYPE_DOTTED?t.setLineDash([2*i,i]):t.setLineDash([]),t.beginPath(),t.moveTo(a[0].x,a[0].y),t.lineTo(a[1].x,a[1].y),t.stroke(),t.beginPath(),t.moveTo(a[2].x,a[2].y),t.lineTo(a[3].x,a[3].y),t.stroke(),t.beginPath(),t.moveTo(E-g,T),t.bezierCurveTo(E-g,T-_,E-v,T-m,E,T-m),t.bezierCurveTo(E+v,T-m,E+g,T-_,E+g,T),t.bezierCurveTo(E+g,T+_,E+v,T+m,E,T+m),t.bezierCurveTo(E-v,T+m,E-g,T+_,E-g,T),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(b+g,S),t.bezierCurveTo(b+g,S+_,b+v,S+m,b,S+m),t.bezierCurveTo(b-v,S+m,b-g,S+_,b-g,S),t.stroke(),t.setLineDash([2*i,i]),t.beginPath(),t.moveTo(b-g,S),t.bezierCurveTo(b-g,S-_,b-v,S-m,b,S-m),t.bezierCurveTo(b+v,S-m,b+g,S-_,b+g,S),t.stroke(),t.restore(),this.data.needToRender=!1},e.prototype.renderTo=function(t,e){this.data.needToRender&&(this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e))},e.prototype.remove=function(){},e}(_n),kn=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Fn=function(t){function e(e){return t.call(this,e)||this}return kn(e,t),e.prototype.impactCheck=function(t,e,r,i,o){return this.data.pointImpactCheck([t,e])},e.prototype.renderByCanvas=function(t,e){var r,i;t.globalCompositeOperation="source-over";var o=Math.max(e.minLineWidth,this.data.thin/1e4*e.height),n=e.width,a=e.height,s=[this.data.pointTransformer({x:(this.data.startPoint.x+this.data.endPoint.x)/2,y:this.data.startPoint.y},!1),this.data.pointTransformer({x:this.data.startPoint.x,y:.9*this.data.endPoint.y+this.data.startPoint.y*(1-.9)},!1),this.data.pointTransformer({x:this.data.endPoint.x,y:.9*this.data.endPoint.y+this.data.startPoint.y*(1-.9)},!1)].map((function(t){return{x:t.x/1e4*n,y:t.y/1e4*a}})),l=this.data.pointTransformer(this.data.startPoint,!1),c=l.x,h=l.y,u=this.data.pointTransformer(this.data.endPoint,!1),d=u.x,p=u.y,f=Math.floor((c+d)/2e4*n),g=Math.floor((h+p)/2e4*a),m=Math.abs(c-d)/2e4*n,y=Math.abs(h-p)/2e4*a*.2,v=.5522848,_=m*v,E=y*v,T=(s[1].x+s[2].x)/2,b=(s[1].y+s[2].y)/2;t.save(),t.strokeStyle=this.data.color,t.fillStyle="transparent",t.lineWidth=o,t.lineJoin="round",t.lineCap="round",t.translate(f,g),t.rotate(this.data.deg*Math.PI/180),t.translate(-f,-g),(null===(r=this.data.style)||void 0===r?void 0:r.lineType)===mn.TEDU_BOARD_LINE_TYPE_DOTTED?(t.lineCap="butt",t.setLineDash([2*o,o])):(t.lineCap="round",t.setLineDash([])),t.beginPath(),t.moveTo(s[1].x,s[1].y),t.lineTo(s[0].x,s[0].y),t.lineTo(s[2].x,s[2].y),t.stroke(),t.lineCap="butt",(null===(i=this.data.style)||void 0===i?void 0:i.lineType)===mn.TEDU_BOARD_LINE_TYPE_DOTTED?t.setLineDash([2*o,o]):t.setLineDash([]),t.beginPath(),t.moveTo(T+m,b),t.bezierCurveTo(T+m,b+E,T+_,b+y,T,b+y),t.bezierCurveTo(T-_,b+y,T-m,b+E,T-m,b),t.stroke(),t.setLineDash([2*o,o]),t.beginPath(),t.moveTo(T-m,b),t.bezierCurveTo(T-m,b-E,T-_,b-y,T,b-y),t.bezierCurveTo(T+_,b-y,T+m,b-E,T+m,b),t.stroke(),t.restore(),this.data.needToRender=!1},e.prototype.renderTo=function(t,e){this.data.needToRender&&(this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e))},e.prototype.remove=function(){},e}(_n),Un=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Hn=function(){return(Hn=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Gn=function(t){function e(e){return t.call(this,e)||this}return Un(e,t),e.prototype.impactCheck=function(t,e,r,i,o){var n=this.data.thin/2,a=Math.max((r+n)/1e4*o,6),s=this.data.pointTransformer(this.data.startPoint,!1),l=s.x,c=s.y,h=this.data.pointTransformer(this.data.endPoint,!1),u=h.x,d=h.y,p=a*a,f=Math.floor(l/1e4*i),g=Math.floor(u/1e4*i),m=Math.floor((c+d)/2e4*o),y=Math.floor(c/1e4*o),v=Math.floor(d/1e4*o),_=Math.floor((l+u)/2e4*i),E=Math.max(.01*o,this.data.thin/1e4*o),T=this.data._calcRotateXY(t,e,-this.data.deg);T.x=T.x/1e4*i,T.y=T.y/1e4*o;var b=Mt(T.x,T.y,f,m,g,m),S=Mt(T.x,T.y,_,y,_,v),x=Mt(T.x,T.y,_-E,y+E,_,y),w=Mt(T.x,T.y,_+E,y+E,_,y),O=Mt(T.x,T.y,g-E,m-E,g,m),I=Mt(T.x,T.y,g-E,m+E,g,m);return b<=p||S<=p||x<=p||w<=p||O<=p||I<=p},e.prototype.renderCoordinateSystem=function(t,e){var r=e.minLineWidth,i=this.data.color,o=this.data.style,n=Math.max(.01*e.height,r),a=r/2,s=this.data.pointTransformer(this.data.startPoint,!1),l=s.x,c=s.y,h=this.data.pointTransformer(this.data.endPoint,!1),u=h.x,d=h.y,p=Math.floor(l/1e4*e.width)-a,f=Math.floor(u/1e4*e.width),g=Math.floor((c+d)/2e4*e.height),m=Math.floor(c/1e4*e.height),y=Math.floor(d/1e4*e.height)+a,v=Math.floor((l+u)/2e4*e.width);if(t.save(),t.strokeStyle=i,t.lineWidth=r,t.lineCap="butt",t.translate(v,g),t.rotate(this.data.deg*Math.PI/180),t.translate(-v,-g),o.lineType==mn.TEDU_BOARD_LINE_TYPE_DOTTED){var _=.01*e.width+r;t.setLineDash([_,_])}else t.setLineDash([]);t.beginPath(),t.moveTo(p,g),t.lineTo(f,g),t.moveTo(v,m),t.lineTo(v,y),t.stroke(),t.setLineDash([]),t.beginPath(),t.moveTo(v-n,m+n),t.lineTo(v,m),t.lineTo(v+n,m+n),t.moveTo(f-n,g-n),t.lineTo(f,g),t.lineTo(f-n,g+n),t.stroke(),t.restore()},e.prototype.renderByCanvas=function(t,e){t.globalCompositeOperation="source-over";var r=this.data.thin/1e4*e.height,i=Math.max(r,e.minLineWidth);this.renderCoordinateSystem(t,Hn(Hn({},e),{minLineWidth:i})),this.data.needToRender=!1},e.prototype.renderTo=function(t,e){this.data.needToRender&&(this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e))},e.prototype.remove=function(){},e}(_n),qn=function(){function t(){}return t.createElement=function(t){return"line"===t.graph?new bn(t):"rect"===t.graph||"square"===t.graph?new xn(t):"circle"==t.graph||"oval"===t.graph?new On(t):"right-triangle"===t.graph?new An(t):"isosceles-triangle"===t.graph?new Cn(t):"parallelogram"===t.graph?new Ln(t):"cube"===t.graph?new Rn(t):"cylinder"===t.graph?new Bn(t):"cone"===t.graph?new Fn(t):"coordinate"===t.graph?new Gn(t):new bn(t)},t}(),Wn=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Yn=function(t){function e(e){var r=t.call(this)||this;return r.data=e,r}return Wn(e,t),e.prototype.renderByCanvas=function(t,e){if(t&&(t.globalCompositeOperation="source-over"),0!=this.data.show){t.setLineDash&&t.setLineDash([5,5]),t.lineWidth=1,t.strokeStyle=this.data.color;var r=Math.floor(this.data.startInfo.x/1e4*e.width),i=Math.floor(this.data.startInfo.y/1e4*e.height),o=(this.data.location.x-this.data.startInfo.x)/1e4*e.width,n=(this.data.location.y-this.data.startInfo.y)/1e4*e.height;t.strokeRect(r,i,o,n),t.setLineDash&&t.setLineDash([])}},e.prototype.renderTo=function(t,e){this.renderByCanvas(t,e)},e.prototype.remove=function(){},e.prototype.addToRenderQueue=function(){},e}(yn),zn=function(){return(zn=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},jn=function(){function t(){}return t.startUnReadyCommandTask=function(){var t=this;this.stopUnReadyCommandTask(),this.unReadyCommandTask=setInterval((function(){for(var e in t.unReadyCommands){var r=t.unReadyCommands[e];r.length?r[0].iframeDom.isLoaded&&(r.forEach((function(e,r){t.postMessage(e.iframeDom,e.data,e.opt)})),delete t.unReadyCommands[e]):delete t.unReadyCommands[e]}}),500)},t.stopUnReadyCommandTask=function(){clearInterval(this.unReadyCommandTask)},t.postMessage=function(t,e,r){if(void 0===r&&(r="*"),t&&t.contentWindow&&t.contentWindow.postMessage(zn(zn({},e),{sdkVersion:parseInt(i.VERSION.replace(/\./g,""))}),r),!t.isLoaded){var o=t.id;this.unReadyCommands[o]||(this.unReadyCommands[o]=[]),this.unReadyCommands[o].push({iframeDom:t,data:e,opt:r})}},t.init=function(e,r,i){t.postMessage(e,{module:"tx_board_postmessage",cmd:"init",data:i,seq:r},"*")},t.gotoNextStep=function(e,r,i){t.postMessage(e,{module:"tx_board_postmessage",cmd:"next_step_new",data:i,seq:r},"*")},t.gotoPreviousStep=function(e,r,i){t.postMessage(e,{module:"tx_board_postmessage",cmd:"prev_step_new",data:i,seq:r},"*")},t.gotoTimestampNew=function(e,r,i){t.postMessage(e,{module:"tx_board_postmessage",cmd:"goto_timestamp_new",data:{slideIndex:i.slideIndex,stepIndex:i.stepIndex,resetStep:i.resetStep,usePrevNextStepMethod:i.usePrevNextStepMethod,isPassive:i.isPassive},seq:i.isPassive?i.seq:r},"*")},t.clearIframeCache=function(e){t.postMessage(e,{module:"tx_board_postmessage",cmd:"clear_cache"},"*")},t.setFid=function(e,r){t.postMessage(e,{module:"tx_board_postmessage",cmd:"set_fid",data:r},"*")},t.pptAction=function(e,r,i){t.postMessage(e,{module:"tx_board_postmessage",cmd:"ppt_action",data:i,seq:r},"*")},t.pptMediaAction=function(e,r,i){t.postMessage(e,{module:"tx_board_postmessage",cmd:"ppt_media_action",data:i,seq:r},"*")},t.sendMouseEvent=function(e,r,i){t.postMessage(e,{module:"tx_board_postmessage",cmd:"mouse_event",data:i,seq:r},"*")},t.soundMute=function(e,r,i){t.postMessage(e,{module:"tx_board_postmessage",cmd:"sound_mute",data:{mute:i},seq:r},"*")},t.ping=function(e,r,i){t.postMessage(e,{module:"tx_board_postmessage",cmd:"ping",data:i,seq:r},"*")},t.unReadyCommands={},t.unReadyCommandTask=null,t}(),Vn=function(){function t(t,e,r){this.boardId=t||"",this.backgroundUrl="",e&&(this.backgroundUrl=e.url||""),this.backgroundColor=r||""}return t.prototype.setBoardId=function(t){this.boardId=t},t.prototype.setBackgroundUrl=function(t){this.backgroundUrl=t},t.prototype.getBoardId=function(){return this.boardId},t.prototype.getBackgroundUrl=function(){return this.backgroundUrl},t.prototype.setBackgroundColor=function(t){this.backgroundColor=t},t.prototype.getBackgroundColor=function(){return this.backgroundColor},t}(),Xn={TEDU_BOARD_FILE_FIT_MODE_NONE:0,TEDU_BOARD_FILE_FIT_MODE_CENTER_INSIDE:1,TEDU_BOARD_FILE_FIT_MODE_CENTER_COVER:2},Jn={TEDU_BOARD_TEXT_STYLE_NORMAL:0,TEDU_BOARD_TEXT_STYLE_BOLD:1,TEDU_BOARD_TEXT_STYLE_ITALIC:2,TEDU_BOARD_TEXT_STYLE_BOLD_ITALIC:3},Kn=function(){function t(t,e){this.seqUtil=t,this.action=M.PROTOCOL_ACTION.BOARD_MOVE_SCALE_ACTION,this.scale=e.scale,this.xOffset=e.xOffset||50,this.yOffset=e.yOffset||50}return t.prototype.update=function(t){Object.assign(this,t),this.scale=Math.floor(this.scale),(U(this.xOffset)||isNaN(this.xOffset))&&(this.xOffset=50),(U(this.yOffset)||isNaN(this.yOffset))&&(this.yOffset=50)},t.prototype.getReportData=function(){return(U(this.xOffset)||isNaN(this.xOffset))&&(this.xOffset=50),(U(this.yOffset)||isNaN(this.yOffset))&&(this.yOffset=50),{updateTime:Wt.getSecondTime(),xOffset:Number(this.xOffset.toFixed(4)),yOffset:Number(this.yOffset.toFixed(4)),scale:Math.floor(this.scale)}},t.prototype.getRealTimeData=function(){return(U(this.xOffset)||isNaN(this.xOffset))&&(this.xOffset=50),(U(this.yOffset)||isNaN(this.yOffset))&&(this.yOffset=50),{action:this.action,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),scale:Math.floor(this.scale),xOffset:Number(this.xOffset.toFixed(4)),yOffset:Number(this.yOffset.toFixed(4))}},t}(),Zn=function(){function t(){this.data={},this.maxSeqDragData={}}return t.prototype.addMaxSeqDragData=function(t){this.maxSeqDragData={scale:t.scale,xOffset:t.xOffset,yOffset:t.yOffset}},t.prototype.addDragData=function(t,e){this.data[t]||(this.data[t]=e)},t.prototype.getDragDataByFid=function(t){var e=[];for(var r in this.data)Ot(r)===t&&e.push({bid:r,data:this.data[r]});return e},t.prototype.getDragData=function(t){return this.data[t]},t.prototype.updateDragData=function(t,e){this.data[t].update(e)},t.prototype.getAllDragData=function(){return this.data},t.prototype.resetDragData=function(){this.data={}},t}(),Qn={TEDU_BOARD_OVAL_DRAW_MODE_FIX_START:1,TEDU_BOARD_OVAL_DRAW_MODE_FIX_CENTER:2},$n={TEDU_BOARD_IMAGE_STATUS_LOADING:1,TEDU_BOARD_IMAGE_STATUS_LOAD_DONE:2,TEDU_BOARD_IMAGE_STATUS_LOAD_ABORT:3,TEDU_BOARD_IMAGE_STATUS_LOAD_ERROR:4,TEDU_BOARD_IMAGE_STATUS_LOAD_TIMEOUT:5,TEDU_BOARD_IMAGE_STATUS_LOAD_CANCEL:6},ta=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();!function(t){t[t.DISPLAY=1]="DISPLAY",t[t.HIDE=2]="HIDE",t[t.DELETE=3]="DELETE"}(Bo||(Bo={}));var ea,ra=function(t){function e(e,r,i){void 0===i&&(i="default");var o,n=this;(n=t.call(this,e)||this).visible=!0,n.show=!0,n.lockElement=!1,n.rectArea={minX:0,minY:0,maxX:0,maxY:0},n.listener=r.listener;var a=n.settingConfig.getElementOpAuth(i);return n.disableRotate=a.disableRotate||!1,n.disableMove=a.disableMove||!1,n.disableProportionScale=a.disableProportionScale||!1,n.disableArbitraryScale=a.disableArbitraryScale||!1,n.renderOnCanvas=null===(o=r.renderOnCanvas)||void 0===o||o,n}return ta(e,t),e.prototype.setBoardSize=function(t,e){this.boardWidth=t,this.boardHeight=e,this.left=this._getPxX(this.x),this.top=this._getPxY(this.y),this._updateRectArea()},e.prototype.setPosition=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=0),0!==t||0!==e){var r=this.left+t,i=this.top+e,o=this._getNCValueX(r),n=this._getNCValueY(i),a=this._getNCValueX(t),s=this._getNCValueY(e),l=this.rectArea,c=l.minX,h=l.minY,u=l.maxX,d=l.maxY,p=pn()+dn(),f=this._getNCValueX(p),g=this._getNCValueY(p),m=c+a,y=h+s,v=u+a,_=d+s;m-f<=0?(m=0+f,this.left+=-this._getPxX(c)+p,this.x+=-c+f,a=0):v+f>=1e4?(v=1e4-f,this.left+=this._getPxX(1e4-u)-p,this.x+=1e4-u-f,a=0):(this.left=r,this.x=o),y-g<=0?(y=0+g,this.top+=-this._getPxY(h)+p,this.y+=-h+g,s=0):_+g>=1e4?(_=1e4-g,this.top+=this._getPxY(1e4-d)-p,this.y+=1e4-d-g,s=0):(this.top=i,this.y=n),this.listener.updatePosition(a,s,this.x,this.y),this._updateRectArea()}},e.prototype.setSize=function(t,e,r,i){if(void 0===r&&(r=1),void 0===i&&(i=1),0!==t||0!==e){var o=t,n=e,a=r,s=i,l=this.rectArea,c=l.minX,h=l.minY,u=l.maxX,d=l.maxY,p=c<=0||u>=1e4||h<=0||d>=1e4;return t>0&&p&&(o=0,a=1),e>0&&p&&(n=0,s=1),this.width+=this._getNCValueX(o),this.height+=this._getNCValueY(n),this.listener.updateScale(a,s),this._updateRectArea(),0===o&&0===n&&1===a&&1===s||void 0}},e.prototype.setRealSize=function(t,e){0===t&&0===e||(this.width=this._getNCValueX(t),this.height=this._getNCValueY(e),this._updateRectArea())},e.prototype.setRotate=function(t){void 0===t&&(t=0),this.deg=t,this.listener.updateRotate(t),this._updateRectArea()},e.prototype._updateRectArea=function(){this.pointArr=[];var t=this._calcRotateXY(this.x,this.y);this.pointArr.push([t.x,t.y]);var e=t.x,r=t.y;t=this._calcRotateXY(this.x+this.width,this.y),this.pointArr.push([t.x,t.y]);var i=t.x,o=t.y;t=this._calcRotateXY(this.x+this.width,this.y+this.height),this.pointArr.push([t.x,t.y]);var n=t.x,a=t.y;t=this._calcRotateXY(this.x,this.y+this.height),this.pointArr.push([t.x,t.y]);var s=t.x,l=t.y,c=this.renderOnCanvas?this._getNCValueX(this.settingConfig.canvasTranslateX):0,h=this.renderOnCanvas?this._getNCValueY(this.settingConfig.canvasTranslateY):0;this.rectArea={minX:Math.min(e,i,s,n)-c,minY:Math.min(r,o,l,a)-h,maxX:Math.max(e,i,s,n)-c,maxY:Math.max(r,o,l,a)-h}},e.prototype._calcRotateXY=function(t,e,r){void 0===r&&(r=this.deg);var i=this.boardWidth/1e4,o=this.boardHeight/1e4,n=r*(Math.PI/180),a=Math.sin(n),s=Math.cos(n),l=this.width*i,c=this.height*o,h=this.x*i+l/2,u=this.y*o+c/2,d=t*i,p=e*o,f=(d-h)*s-(p-u)*a+h,g=(d-h)*a+(p-u)*s+u;return{x:f/i,y:g/o,ox:f,oy:g}},e.prototype.getRealSize=function(){var t=this.renderOnCanvas?this.settingConfig.canvasTranslateX:0,e=this.renderOnCanvas?this.settingConfig.canvasTranslateY:0;return{left:this.left-t,top:this.top-e,width:this._getPxX(this.width),height:this._getPxY(this.height)}},e.prototype.pointImpactCheck=function(t,e){return Dt(t,e||this.pointArr)},e.prototype.impactCheck=function(t,e,r){return t>this.rectArea.minX&&e>this.rectArea.minY&&t<this.rectArea.maxX&&e<this.rectArea.maxY},e.prototype.getElementId=function(){return this.belongSeq+""},e.prototype.setBorder=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.getElementOperatorReportData=function(t){return{uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,updateTime:Wt.getTimeStamp(),updateContent:Object.assign({lockElement:this.lockElement,deg:this.deg},t||{})}},e.prototype.setElementDisplay=function(t){t===Bo.DISPLAY?(this.visible=!0,this.show=!0):t===Bo.HIDE?(this.visible=!1,this.show=!1):t===Bo.DELETE&&(this.visible=!0,this.show=!1)},e.prototype.isElementDisplay=function(){return this.visible&&this.show},e.prototype.isElementHide=function(){return!this.visible&&!this.show},e.prototype.isElementDelete=function(){return this.visible&&!this.show},e.prototype.setLockElement=function(t){this.lockElement=t},e.prototype.isLocked=function(){return!!this.lockElement},e.prototype._getPxX=function(t){return t*this.boardWidth/1e4},e.prototype._getNCValueX=function(t){return 1e4*t/this.boardWidth},e.prototype._getPxY=function(t){return t*this.boardHeight/1e4},e.prototype._getNCValueY=function(t){return 1e4*t/this.boardHeight},e}(X),ia=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),oa=function(){return(oa=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},na=function(t){function e(e){var r=t.call(this,e)||this;return r.version=i.VERSION,r._task=null,r._loopTimer=0,r._cacheData=[],r._createLoggerTask(),r._createLogger(),r}return ia(e,t),e.prototype._createLogger=function(){if(window.TIWLogger&&window.TIWLogger.TLogger&&window.TIWLogger.TLoggerConfig){var t=window.TIWLogger.TLogger,e=new(0,window.TIWLogger.TLoggerConfig);e.nativeSdkVersion=this.nativeVersion,e.webSdkVersion=this.version,e.business="tiw_sdk",e.sdkAppId=Number(this.sdkAppId),e.roomId=this.classId,e.userId=this.identifier,this._tlogger=t.getInstance("TIW_".concat(this.sdkAppId,"_").concat(this.identifier),{proxyServer:this.proxyServer}),this._tlogger.setConfig(e),clearInterval(this._task),this._reportCacheContent()}},e.prototype._createLoggerTask=function(){var t=this;this._task=setInterval((function(){t._loopTimer++,t._createLogger(),t._loopTimer>20&&clearInterval(t._task)}),500)},e.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.unshift("debug"),this._report.apply(this,t)},e.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.unshift("info"),this._report.apply(this,t)},e.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.unshift("info"),this._report.apply(this,t)},e.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.unshift("warn"),this._report.apply(this,t)},e.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.unshift("error"),this._report.apply(this,t)},e.prototype._cacheReportContent=function(t){this._cacheData.push(t)},e.prototype._reportCacheContent=function(){var t=this;this._cacheData.forEach((function(e){var r=e.method,i=e.data;try{t._tlogger&&t._tlogger[r](i)}catch(t){}}))},e.prototype._report=function(t,e,r,i,o){void 0===i&&(i={}),void 0===o&&(o=!1);try{var n={};R(i)?n.param=i:n=i;var a=oa(oa({},n),{module:e,action:r,report:o});this._tlogger?this._tlogger[t](a):this._cacheReportContent({method:t,data:a})}catch(t){}},e}(X),aa=r(180),sa=r.n(aa),la=function(){return(la=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ca=function(t){var e=t.url,r=t.headers,i=t.logger||null;t.url=L.getProxySetting(e);var o=new URL(e).hostname;o!==new URL(t.url).hostname&&(t.headers=la(la({},r),{"X-Forwarded-Host":o}));var n=window.axios.create({timeout:t.timeout||5e3}),a=function(t){var e=t.config;if(e.data)try{var r=JSON.parse(e.data);!1===r.first_time&&(r.first_time=!0,e.data=JSON.stringify(r))}catch(t){}var o=Math.floor(1e8*Math.random());if(e.url.indexOf("random=")>-1){if(e.url.match(/random=\d*/))try{e.url=e.url.replace(/random=\d*/,"random="+o)}catch(t){}}else e.url.indexOf("?")>-1?e.url+="&random=".concat(o):e.url+="?random=".concat(o);if(!e||!e.retry)return Promise.reject(t);if(e.__retryCount=e.__retryCount||0,e.__retryCount>=e.retry)return Promise.reject(t);if(e.__retryCount+=1,-1===e.url.indexOf("report_heartbeat")&&-1===e.url.indexOf("report-log")){var a=L.getHostName();L.updateAccessibleHostName();var s=L.getHostName();i&&i.reportInfo("AxiosRequest","host_switch",{code:0,param:{extraInfo:JSON.stringify({host:a+" → "+s,url:e.url.substring(0,e.url.indexOf("?"))})}},ea.ONLY_ONLINE),e.url=e.url.replace(a,s)}return new Promise((function(t){setTimeout((function(){t(null)}),e.retryDelay||1e3)})).then((function(){return n(e)}))};return n.defaults.retry=3,n.defaults.retryDelay=1e3,n.interceptors.request.use((function(t){var e=Wt.getTimeStamp();return t.startTime=e,t}),(function(t){return Promise.reject(t)})),n.interceptors.response.use((function(t){if(200==t.status)try{if(60008===t.data.ErrorCode)return a(t)}catch(e){return t}return t}),a),new Promise((function(e,r){n(t).then((function(t){e(t)}),(function(t){try{var e="";if(t.data)t.code=t.data.ErrorCode,t.message=t.data.ErrorInfo,e=JSON.stringify({code:t.code,message:t.message});else{var o={retry:0,retryDelay:0,startTime:0,timeout:0,url:""};t.config&&(o.retry=t.config.retry,o.retryDelay=t.config.retryDelay,o.startTime=t.config.startTime,o.timeout=t.config.timeout,o.url=t.config.url),e=t.response?JSON.stringify({data:t.response.data,status:t.response.status,headers:t.response.headers,config:o,message:t.message}):t.request?JSON.stringify({request:t.request,config:o,message:t.message}):JSON.stringify({message:t.message,config:o})}i&&i.reportError("AxiosRequest","requestError",{code:-1,param:{extraInfo:e}},ea.ONLY_ONLINE)}catch(t){i&&i.reportError("AxiosRequest","requestError",{code:-2,stack:t.stack,message:t.message,param:{extraInfo:JSON.stringify({stack:t.stack,message:t.message})}},ea.ONLY_ONLINE)}r(t)}))}))},ha=function(){return(ha=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ua=function(){function t(t){var e=this;this.verboseEvent=["addData","call_method","apply_video_permission","init_video_permission","layout","martix-change","resetpptiframe","get_img_exif","drawerror","setCursorIcon"],this.priorityHeightEvents=["init","verify_sdk","getBoardData","warnEvent","errorEvent"],this.uniqBid=-1,this.method="POST",this.keyLogTask=null,this.logTask=null,this.defDatas={action:"",version:i.REPORT_VERSION,action_result:0,action_info:"",userid:"",time_consume:0,sdkappid:"",device:i.PLATFORM,log_time:0,business:"ticsdk",roomid:"",boardid:"",image_url:"",boardid_list:[],to_boardId:"",color:null,file_id:"",file_title:"",isfinish:0,msgLength:20,bucket:"",cos_appid:null,extra_info:"",net_type:"unknown",userAgent:navigator.userAgent,uniqBid:this.uniqBid,reqId:""},this.uniqBid=+t,this.defDatas.uniqBid=this.uniqBid,window.Worker&&(this.reportWorker=new function(){return sa()('/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== \'undefined\' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: \'Module\' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, \'__esModule\', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === \'object\' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, \'default\', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != \'string\') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module[\'default\']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, \'a\', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = "";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n"use strict";\n\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === "function" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i["return"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nfunction getXHR() {\n    var xmlhttp = null;\n    var ActiveXObject = self.ActiveXObject;\n    if (self.XMLHttpRequest) { // code for all new browsers\n        xmlhttp = new XMLHttpRequest();\n    }\n    else if (ActiveXObject) { // code for IE5 and IE6\n        try {\n            xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");\n        }\n        catch (e) {\n            try {\n                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");\n            }\n            catch (e) { }\n        }\n    }\n    if (xmlhttp == null) {\n        console.log("Your browser does not support XMLHTTP.");\n        return;\n    }\n    return xmlhttp;\n}\nonmessage = function (e) {\n    var _a = __read(e.data, 6), method = _a[0], url = _a[1], proxyUrl = _a[2], hostname = _a[3], data = _a[4], isKeyLog = _a[5];\n    console.log(\'worker\');\n    try {\n        var xhr = getXHR();\n        xhr.open(method, proxyUrl, true);\n        xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");\n        if (proxyUrl !== url) {\n            xhr.setRequestHeader("X-Forwarded-Host", hostname);\n        }\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4) {\n                if (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304) {\n                    try {\n                        var ret = JSON.parse(xhr.responseText);\n                        postMessage([ret.error_code, isKeyLog, data]);\n                    }\n                    catch (e) {\n                        postMessage([-1, isKeyLog, data]);\n                    }\n                }\n                else {\n                    postMessage([-1, isKeyLog, data]);\n                }\n            }\n        };\n        var strData = JSON.stringify(data);\n        xhr.send(strData);\n    }\n    catch (e) {\n        postMessage([-1, isKeyLog, data]);\n    }\n};\n\n\n/***/ })\n/******/ ]);',"Worker",void 0,void 0)},this.reportWorker.onmessage=function(t){var r=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}(t.data,3),i=r[0],o=r[1],n=r[2];i&&e.retry(o,n)}),this.logQueue=[],this.keyLogQueue=[],this.startKeyLogTask(),this.startLogTask()}return t.prototype.startKeyLogTask=function(){var t=this;this.keyLogTask=setInterval((function(){t.keyLogQueue.length&&(t.send(!0,t.keyLogQueue),t.keyLogQueue=[])}),2e3)},t.prototype.startLogTask=function(){var t=this;this.logTask=setInterval((function(){t.logQueue.length&&(t.send(!1,t.logQueue),t.logQueue=[])}),5e3)},t.prototype.stopTask=function(){clearInterval(this.keyLogTask),clearInterval(this.logTask)},t.prototype.send=function(t,e){var r=this,i=t?L.ELKLOG_KEY_HOSTNAME:L.ELKLOG_WATER_HOSTNAME;this.reportWorker?this.reportWorker.postMessage([this.method,i,L.getProxySetting(i),new URL(i).hostname,e,t]):ca({method:this.method,url:i,headers:{"Content-type":"application/json"},data:e}).then((function(i){i.data.error_code&&r.retry(t,e)}),(function(){r.retry(t,e)}))},t.prototype.retry=function(t,e){var r=[];e.forEach((function(t){t.trytimes?t.trytimes++:t.trytimes=1,t.trytimes<4&&r.push(t)})),t?this.keyLogQueue=this.keyLogQueue.concat(r):this.logQueue=this.logQueue.concat(r)},t.prototype.formatLog=function(t,e){if("init"===t){var r=JSON.parse(e.extra_info);r&&r.option&&(delete r.option.event,delete r.option.logger,delete r.option.tlsData,e.extra_info=JSON.stringify(r))}var i=this.fillDatas(e);this.priorityHeightEvents.indexOf(t)>-1?this.send(!0,[i]):this.verboseEvent.indexOf(t)>-1?this.logQueue.push(i):this.keyLogQueue.push(i);var o=JSON.stringify(i);this.reportLogCallback(o)},t.prototype.fillDatas=function(t){var e,r=(e=this.defDatas,JSON.parse(JSON.stringify(e))),o=Object.keys(this.defDatas),n={};for(var a in t)o.includes(a)?["sdkappid","classid","userid"].includes(a)?r[a]=this.defDatas[a]:(r[a]=void 0!==t[a]?t[a]:this.defDatas[a],"boardid_list"===a&&(r[a]=JSON.stringify(this.defDatas[a])),"roomid"===a&&(r[a]=this.defDatas[a]+"")):n[a]=t[a];return r.device=i.PLATFORM,r.nativeVersion=i.NATIVEVERSION,r.extra_info_more=JSON.stringify(n),r},t.prototype.setSdkAppId=function(t){t&&(this.defDatas.sdkappid=t)},t.prototype.setRoomId=function(t){t&&(this.defDatas.roomid=t)},t.prototype.setUserId=function(t){t&&(this.defDatas.userid=t)},t.prototype.boardAction=function(t,e){this.report(t,e)},t.prototype.report=function(t,e){void 0===e&&(e={}),this.formatLog(t,ha(ha({action_result:0,time_consume:0},e),{action:t,log_time:Wt.getTimeStamp()}))},t.prototype.destroy=function(){this.stopTask(),this.reportWorker.terminate()},t.prototype.setReportLogCallback=function(t){this.reportLogCallback=t},t}(),da=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();!function(t){t[t.ONLY_NATIVE=0]="ONLY_NATIVE",t[t.ONLY_ONLINE=1]="ONLY_ONLINE",t[t.BOTH=2]="BOTH"}(ea||(ea={}));var pa=function(t){function e(e,r){var i=t.call(this,e)||this;return i.logLevel=ht.WARNING,L.isPrivateEnv()||(i.nativeLogger=new na(e),i.onlineLogger=new ua(e),i.onlineLogger.setReportLogCallback(r),i.onlineLogger.setSdkAppId(i.sdkAppId),i.onlineLogger.setRoomId(i.classId),i.onlineLogger.setUserId(i.identifier)),i}return da(e,t),e.prototype.setLogLevel=function(t){return this.logLevel=t,this.logLevel},e.prototype.log=function(t,e,r,i){void 0===i&&(i=!1),this.logCmd(t,e,r,"log",i)},e.prototype.info=function(t,e,r,i){void 0===i&&(i=!1),this.logCmd(t,e,r,"info",i)},e.prototype.reportInfo=function(t,e,r,i){void 0===i&&(i=ea.BOTH),i!==ea.ONLY_ONLINE&&this.logNative(t,e,r,"info"),i!==ea.ONLY_NATIVE&&this.logOnline(e,r)},e.prototype.warn=function(t,e,r,i){void 0===i&&(i=!1),this.logCmd(t,e,r,"warn",i)},e.prototype.reportWarn=function(t,e,r,i){void 0===i&&(i=ea.BOTH),i!==ea.ONLY_ONLINE&&this.logNative(t,e,r,"warn"),i!==ea.ONLY_NATIVE&&this.logOnline(e,r)},e.prototype.error=function(t,e,r,i){void 0===i&&(i=!1),this.logCmd(t,e,r,"error",i)},e.prototype.reportError=function(t,e,r,i){void 0===i&&(i=ea.BOTH),i!==ea.ONLY_ONLINE&&this.logNative(t,e,r,"error"),i!==ea.ONLY_NATIVE&&this.logOnline(e,r)},e.prototype.checkNeedLogCmd=function(t){return this.logLevel!==ht.OFF&&(this.logLevel===ht.ALL||("log"===t?ht.ALL>=this.logLevel:"info"===t?ht.INFO>=this.logLevel:"warn"===t?ht.WARNING>=this.logLevel:ht.ERROR>=this.logLevel))},e.prototype.logCmd=function(t,e,r,i,o){void 0===o&&(o=!1),this.checkNeedLogCmd(i)&&(new Date,o&&window.console[i]("TIW [".concat(t,"](").concat(e,"):"),JSON.stringify(r)))},e.prototype.logNative=function(t,e,r,i){this.nativeLogger&&this.nativeLogger[i](t,e,this.formatNativeLog(r))},e.prototype.formatNativeLog=function(t){var e=t.code,r=void 0===e?0:e,i=t.stack,o=void 0===i?"":i,n=t.message;return{code:r,stack:o,desc:void 0===n?"":n,param:t.param}},e.prototype.logOnline=function(t,e){var r;null===(r=this.onlineLogger)||void 0===r||r.report(t,this.formatOnlineLog(e))},e.prototype.formatOnlineLog=function(t){var e=t.code,r=void 0===e?0:e,i=t.stack,o=void 0===i?"":i,n=t.message,a=void 0===n?"":n,s=t.param,l=s.boardId,c=void 0===l?"":l,h=s.boardIdList,u=void 0===h?"":h,d=s.toBoardId,p=void 0===d?"":d,f=s.fileId,g=void 0===f?"":f,m=s.fileTitle,y=void 0===m?"":m,v=s.extraInfo,_=void 0===v?"":v,E=t.cost,T=void 0===E?0:E,b=t.reqId,S=void 0===b?"":b;return{action_result:r,action_info:o||a?JSON.stringify({stack:o,message:a}):"",time_consume:T,boardid:c,boardid_list:u,to_boardId:p,file_id:g,file_title:y,extra_info:_,reqId:S}},e.prototype.destroy=function(){var t;null===(t=this.onlineLogger)||void 0===t||t.destroy()},e}(X),fa=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ga=function(){return(ga=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ma=function(t){function e(e,r,i){var o,n=this;return(n=t.call(this,e,{renderOnCanvas:!1,listener:{updatePosition:function(t,e){},updateScale:function(t,e,r,i){},updateRotate:function(t){}}},"image")||this).boardId=r.boardId,n.type="imageElement",n.show=r.show,n.visible=null===(o=r.visible)||void 0===o||o,n.user=r.user,n.belongSeq=r.belongSeq,n.url=r.url,n.width=r.width||0,n.height=r.height||0,n.time=r.time||Wt.getTimeStamp(),n.x=r.x,n.y=r.y,n.focusStatus="blur",n.container=null,n.boardWidth=0,n.boardHeight=0,n.deg=r.deg||0,n.rectArea={maxX:0,maxY:0,minX:0,minY:0},n.pointArr=[],n.store=i.store,n.erasable=r.erasable,n.initChecker=null,n.renderChecker=null,n.retryTimer=null,n.timeoutTimer=null,n.exifData=r.exifData||0,n.exifDeg=0,n.lockElement=r.lockElement,n}return fa(e,t),e.prototype.getData=function(){return ga({uid:this.user,seq:this.belongSeq,deg:this.deg,x:this.x,y:this.y},this.getRealSize())},e.prototype.getImageSize=function(t,e,r,i,o,n){var a=this;if(!this.initChecker){this.boardWidth=t,this.boardHeight=e;var s=new Image;s.onload=function(r){s.onload=null;var l=0,c=0;a._setStyles(s,l,c,(function(){var r,h,u=s.naturalWidth,d=s.naturalHeight;90!==a.exifDeg&&-90!==a.exifDeg||(u=s.naturalHeight,d=s.naturalWidth),t/e>u/d?(l=u*e/d,c=e,l/=2,c/=2):(l=t,c=d*t/u,l/=2,c/=2),a.width=i||1e4*l/a.boardWidth,a.height=o||1e4*c/a.boardHeight,a.x=null!==(r=a.x)&&void 0!==r?r:5e3-a.width/2,a.y=null!==(h=a.y)&&void 0!==h?h:5e3-a.height/2,n&&n()}))};var l=this.url;this.initChecker=new sn({domainMap:this.store.getDomainMap(),accessibleDomains:this.store.getAccessibleDomains()}),this.initChecker.runImage(l,5e3,(function(t){a.initChecker=null,t?a.store.addAccessibleDomain(t):t=l,s.src=t}))}},e.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.IMAGE_ELEMENT,seq:this.seqUtil.getSeq(),belongSeq:this.belongSeq,url:this.url,time:this.time,show:this.show,visible:this.visible,x:parseFloat(this.x.toFixed(4)),y:parseFloat(this.y.toFixed(4)),width:parseFloat(this.width.toFixed(4)),height:parseFloat(this.height.toFixed(4)),deg:this.deg,erasable:this.erasable,boardId:this.boardId,exifData:this.exifData}},e.prototype.getReportData=function(){return{uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,url:this.url,time:this.time,x:parseFloat(this.x.toFixed(4)),y:parseFloat(this.y.toFixed(4)),width:parseFloat(this.width.toFixed(4)),height:parseFloat(this.height.toFixed(4)),updateTime:Wt.getTimeStamp(),hidden:Number(!this.show),visible:+this.visible,deg:this.deg,erasable:this.erasable,exifData:this.exifData,lockElement:this.lockElement}},e.prototype.renderTo=function(t,e,r){var i=this;this.container=t;var o="tic_image_element_".concat(this.belongSeq),n=t.querySelector("#".concat(o));if(n){this.left=this.x*this.boardWidth/1e4,this.top=this.y*this.boardHeight/1e4;var a=this.width*this.boardWidth/1e4,s=this.height*this.boardHeight/1e4,l=n.querySelector("img");n.style.width=a+"px",n.style.height=s+"px",n.style.transform="translateX(".concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg)"),n.style.webkitTransform="translateX(".concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg)"),90===this.exifDeg||-90===this.exifDeg?l.setAttribute("style","pointer-events: inherit; height: ".concat(a,"px; width: ").concat(s,"px; transform: translate(").concat((a-s)/2,"px, ").concat((s-a)/2,"px) rotate(").concat(this.exifDeg,"deg)")):l.setAttribute("style","pointer-events: inherit; height: ".concat(s,"px; width: ").concat(a,"px; transform: rotate(").concat(this.exifDeg,"deg)")),this.imageWrap=n}else{if(this.renderChecker)return;var c=this.url,h=document.createElement("img");h.dataset.belongSeq="".concat(this.belongSeq),h.dataset.imageElement="true",h.setAttribute("style","width:100%;height:100%;pointer-events:inherit;");var u=function(t){void 0===t&&(t=0),clearTimeout(i.timeoutTimer),i.timeoutTimer=setTimeout((function(){if(t<3){var o=h.currentSrc||h.src,n=o.match(/try=(\d)/i),a=n&&parseInt(n[1])||0,s=o;return n?s=s.replace(/try=\d/i,"try=".concat(a+1)):o.indexOf("?")>-1?s+="&try=".concat(a+1):s+="?try=".concat(a+1),h.removeAttribute("src"),h.src=s,e.reportInfo("ImageElement","load_try_image_element",{param:{extraInfo:JSON.stringify(ga(ga({},i.getReportData()),{currentSrc:s,retryTimes:a+1}))}},ea.ONLY_ONLINE),i.store.networkSniffer(s,"get",5e3),void u(t+1)}e.reportInfo("ImageElement","load_timeout_image_element",{param:{extraInfo:JSON.stringify(i.getReportData())}},ea.ONLY_ONLINE),i.store.networkSniffer(c,"get",5e3),r.fireImageElementStatusChangedEvent($n.TEDU_BOARD_IMAGE_STATUS_LOAD_TIMEOUT,{elementId:"".concat(i.belongSeq),currentBoardId:i.boardId,imgUrl:c}),h.removeAttribute("src")}),1e3*i.store.getImageTimeout()*(t+1))};h.onload=function(){clearTimeout(i.timeoutTimer),i._setStyles(h,i.width/1e4*i.boardWidth,i.height/1e4*i.boardHeight,(function(){i.imageWrap.style.visibility="visible"})),e.reportInfo("ImageElement","load_success_image_element",{param:{extraInfo:JSON.stringify(i.getReportData())}},ea.ONLY_ONLINE),r.fireImageElementStatusChangedEvent($n.TEDU_BOARD_IMAGE_STATUS_LOAD_DONE,{elementId:"".concat(i.belongSeq),currentBoardId:i.boardId,imgUrl:c})},h.onerror=function(){var t,o,n;clearTimeout(i.timeoutTimer),t=h.currentSrc||h.src,o=t.match(/try=(\d)/i),(n=o&&parseInt(o[1])||0)>2?(i.imageWrap.style.visibility="visible",e.reportInfo("ImageElement","load_error_image_element",{param:{extraInfo:JSON.stringify(ga(ga({},i.getReportData()),{currentSrc:t}))}},ea.ONLY_ONLINE),i.store.networkSniffer(t,"get",5e3),r.fireImageElementStatusChangedEvent($n.TEDU_BOARD_IMAGE_STATUS_LOAD_ERROR,{elementId:"".concat(i.belongSeq),currentBoardId:i.boardId,imgUrl:c})):i.retryTimer=setTimeout((function(){var e=t;o?e=e.replace(/try=\d/i,"try=".concat(n+1)):t.indexOf("?")>-1?e+="&try=".concat(n+1):e+="?try=".concat(n+1),h.removeAttribute("src"),h.src=e,u(n+1)}),2e3)},h.onabort=function(){clearTimeout(i.timeoutTimer),e.reportInfo("ImageElement","load_abort_image_element",{param:{extraInfo:JSON.stringify(i.getReportData())}},ea.ONLY_ONLINE),r.fireImageElementStatusChangedEvent($n.TEDU_BOARD_IMAGE_STATUS_LOAD_ABORT,{elementId:"".concat(i.belongSeq),currentBoardId:i.boardId,imgUrl:c})},(n=document.createElement("div")).dataset.belongSeq=this.belongSeq,n.dataset.imageElement=!0,n.dataset.boardId=this.boardId,n.id=o,n.setAttribute("style","visibility:hidden;position:absolute;margin:0;padding:0;width:".concat(this.width*this.boardWidth/1e4,"px;height:").concat(this.height*this.boardHeight/1e4,"px;border:1px dotted transparent;cursor:move;transform: translateX(").concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg);-webkit-transform: translateX(").concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg);pointer-events: inherit")),n.appendChild(h),t.appendChild(n),this.imageWrap=n,this.renderChecker=new sn({domainMap:this.store.getDomainMap(),accessibleDomains:this.store.getAccessibleDomains()}),this.renderChecker.runImage(c,5e3,(function(t){i.renderChecker=null,t?i.store.addAccessibleDomain(t):t=c,h.src=t,e.reportInfo("ImageElement","load_start_image_element",{param:{extraInfo:JSON.stringify(ga(ga({},i.getReportData()),{currentSrc:t}))}},ea.ONLY_ONLINE),r.fireImageElementStatusChangedEvent($n.TEDU_BOARD_IMAGE_STATUS_LOADING,{elementId:"".concat(i.belongSeq),currentBoardId:i.boardId,imgUrl:c}),u()}))}this._updateRectArea()},e.prototype._setStyles=function(t,e,r,i){var o=this;void 0===i&&(i=null);var n=function(i){void 0===i&&(i=0),o.exifDeg=i,t.style.visibility="hidden",90===i||-90===i?t.setAttribute("style","pointer-events: inherit; height: ".concat(e,"px; width: ").concat(r,"px; transform: translate(").concat((e-r)/2,"px, ").concat((r-e)/2,"px) rotate(").concat(i,"deg)")):t.setAttribute("style","pointer-events: inherit; height: ".concat(r,"px; width: ").concat(e,"px; transform: rotate(").concat(i,"deg)")),t.style.visibility="visible"},a=function(t){t?1===t?n(0):3===t?n(180):6===t?n(90):8===t&&n(-90):n(0)},s=Tt();"Chrome"===s[0]&&bt(s[1],"81")<0?0!==this.exifData?(a(this.exifData),i&&i()):ft(this.url,2e3,(function(t,e){var r=t.Orientation,n=F(r)?1:r;o.exifData=n,a(-1===n?1:n),i&&i()})):(n(0),i&&i())},e.prototype.remove=function(){clearTimeout(this.retryTimer),this.initChecker&&this.initChecker.cancelChecker(),this.initChecker=null,this.renderChecker&&this.renderChecker.cancelChecker(),this.renderChecker=null,this.imageWrap&&this.imageWrap.remove()},e.prototype.impactCheck=function(t,e,r){return t>this.rectArea.minX&&e>this.rectArea.minY&&t<this.rectArea.maxX&&e<this.rectArea.maxY},e.prototype.getBoardId=function(){return this.boardId},e.prototype.getReportDataForHistory=function(t){var e=this.getReportData();return t?e:{type:"imageElement",seq:this.seqUtil.getSeq(),content:JSON.stringify(e)}},e.prototype.setPosition=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.left+=t,this.top+=e,this.x=1e4*this.left/this.boardWidth,this.y=1e4*this.top/this.boardHeight},e}(ra),ya="TIW_H5WEB_SYNC",va="TIW_H5WEB_ACK",_a="TIW_H5WEB_DATA",Ea="TIW_H5WEB_SNAPSHOT",Ta={TEDU_BOARD_ELEMENT_IMAGE:1,TEDU_BOARD_ELEMENT_H5:2,TEDU_BOARD_ELEMENT_CUSTOM_GRAPH:3,TEDU_BOARD_ELEMENT_AUDIO:4,TEDU_BOARD_ELEMENT_GLOBAL_AUDIO:5,TEDU_BOARD_ELEMENT_MATH_BOARD:6,TEDU_BOARD_ELEMENT_MATH_GRAPH:7,TEDU_BOARD_ELEMENT_TEXT:9,TEDU_BOARD_ELEMENT_MAGIC_LINE:10,TEDU_BOARD_ELEMENT_FORMULA:11,TEDU_BOARD_ELEMENT_MATH_TOOL:12,TEDU_BOARD_ELEMENT_GEOMETRY:13,TEDU_BOARD_ELEMENT_WATERMARK:100,TEDU_BOARD_ELEMENT_GRAFFITI_LINE:801,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_LINE:802,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_RECT:803,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_OVAL:804,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ARC:805,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_RIGHT_TRIANGLE:806,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ISOSCELES_TRIANGLE:807,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_PARALLELOGRAM:808,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_CUBE:809,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_CYLINDER:810,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_CONE:811,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_HIGHLIGHTER:812,TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_COORDINATE:813},ba=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Sa=function(){return(Sa=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},xa=function(t){function e(e,r){var i=t.call(this,e,{renderOnCanvas:!1,listener:{updatePosition:function(t,e){},updateScale:function(t,e,r,i){},updateRotate:function(t){}}},"h5")||this;return i.type="element",i.subType=Ta.TEDU_BOARD_ELEMENT_H5,i.boardId=r.boardId,i.belongSeq=r.belongSeq,i.url=r.url,i.user=r.user,i.onloadDone=r.onloadDone,i.data=null,i.dataChanged=!1,i.erasable=r.erasable,i.deg=r.deg||0,i.lockElement=r.lockElement,i}return ba(e,t),e.prototype.setProperty=function(t){var e,r,i;this.show=t.show,this.visible=null===(e=t.visible)||void 0===e||e,this.seq=t.seq,this.width=t.width||1e4,this.height=t.height||1e4,this.time=t.time||Wt.getTimeStamp(),this.x=null!==(r=t.x)&&void 0!==r?r:5e3-this.width/2,this.y=null!==(i=t.y)&&void 0!==i?i:5e3-this.width/2,this.container=null,t.data&&(this.data=t.data),t.hasOwnProperty("erasable")&&(this.erasable=t.erasable),t.hasOwnProperty("deg")&&(this.deg=t.deg)},e.prototype.updateData=function(t){this.dataChanged=!0,this.data=t},e.prototype.renderTo=function(t,e){this.container=t;var r="tiw_h5web_element_".concat(this.belongSeq),i=t.querySelector("#".concat(r)),o="position:absolute;border:none !important;width:".concat(this.width*this.boardWidth/1e4,"px;height:").concat(this.height*this.boardHeight/1e4,"px;transform:").concat("translateX(".concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg)"),";-webkit-transform:").concat("translateX(".concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg)"),";");o+=e?"pointer-events:auto":"pointer-events:none",i?i.setAttribute("style",o):(this.el=document.createElement("iframe"),this.el.id=r,this.el.setAttribute("class","tiw-board-iframe-el"),this.el.setAttribute("style",o),this.el.scrolling="auto",this.el.src=this.url,this.el.dataset.bid=this.boardId,this.el.dataset.belongSeq=this.belongSeq,this.el.setAttribute("name",JSON.stringify({id:this.belongSeq})),this.el.onload=this._onloadCallback.bind(this),t.appendChild(this.el))},e.prototype._onloadCallback=function(){this.postMessage(this.data),this._updateRectArea(),this.onloadDone&&this.onloadDone(),this.onloadDone=void 0},e.prototype.remove=function(){this.el&&this.el.remove()},e.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.H5Web_ELEMENT,belongSeq:this.belongSeq,seq:this.seqUtil.getSeq(),boardId:this.boardId,url:this.url,time:this.time,show:this.show,visible:this.visible,x:parseFloat(this.x.toFixed(4)),y:parseFloat(this.y.toFixed(4)),width:parseFloat(this.width.toFixed(4)),height:parseFloat(this.height.toFixed(4)),erasable:this.erasable,deg:this.deg}},e.prototype.getReportData=function(){var t={type:this.type,property:{subType:this.subType,uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,data:this.data,url:this.url,time:this.time,x:parseFloat(this.x.toFixed(4)),y:parseFloat(this.y.toFixed(4)),width:parseFloat(this.width.toFixed(4)),height:parseFloat(this.height.toFixed(4)),updateTime:Wt.getTimeStamp(),hidden:Number(!this.show),visible:+this.visible,erasable:this.erasable,deg:this.deg,lockElement:this.lockElement}};return this.dataChanged&&(this.dataChanged=!1),t},e.prototype.postMessage=function(t){this.el.contentWindow.postMessage({module:on,cmd:_a,data:t},"*")},e.prototype.getBoardId=function(){return this.boardId},e.prototype.getData=function(){return Sa({uid:this.user,seq:this.belongSeq,deg:this.deg,x:this.x,y:this.y},this.getRealSize())},e.prototype.getReportDataForHistory=function(t){var e=this.getReportData();return t?e:{type:e.type,seq:this.seqUtil.getSeq(),content:JSON.stringify(e.property)}},e}(ra),wa=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Oa=function(){return(Oa=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ia=function(t){function e(e,r){var i,o=this;return(o=t.call(this,e,{renderOnCanvas:!1,listener:{updatePosition:function(t,e){},updateScale:function(t,e,r,i){},updateRotate:function(t){}}},"customGraph")||this).type="element",o.subType=Ta.TEDU_BOARD_ELEMENT_CUSTOM_GRAPH,o.container=null,o.width=0,o.height=0,o.realLeft=0,o.realTop=0,o.boardWidth=r.boardWidth||0,o.boardHeight=r.boardHeight||0,o.boardScale=1,o.boardId=r.boardId,o.show=r.show,o.visible=null===(i=r.visible)||void 0===i||i,o.user=r.user,o.belongSeq=r.belongSeq,o.url=r.url,o.time=r.time||Wt.getTimeStamp(),o.x=r.x||0,o.y=r.y||0,o.naturalWidth=r.naturalWidth||0,o.naturalHeight=r.naturalHeight||0,o.realWidth=o.naturalWidth,o.realHeight=o.naturalHeight,o.deg=r.deg||0,o.lockElement=r.lockElement,o.erasable=r.erasable,o.rectArea={maxX:0,maxY:0,minX:0,minY:0},o.originScaleX=r.scaleX||1,o.originScaleY=r.scaleY||1,o._calcProperty(),o}return wa(e,t),e.prototype.getData=function(){return Oa({uid:this.user,seq:this.belongSeq,deg:this.deg,x:this.x,y:this.y,naturalWidth:this.naturalWidth,naturalHeight:this.naturalHeight,scaleX:this.scaleX,scaleY:this.scaleY},this.getRealSize())},e.prototype._calcProperty=function(){this.naturalWidth&&this.naturalHeight&&this.boardWidth&&this.boardHeight?this.originScaleX&&this.originScaleY&&(this.scaleX=(this.originScaleX||1)*this.boardWidth/this.naturalWidth,this.scaleY=(this.originScaleY||1)*this.boardHeight/this.naturalHeight):(this.scaleX=1,this.scaleY=1),this.originLeft=this.boardWidth*this.x/1e4/this.boardScale,this.originTop=this.boardHeight*this.y/1e4/this.boardScale;var t=this.naturalWidth/2*(1-this.scaleX),e=this.naturalHeight/2*(1-this.scaleY);this.realLeft=this.originLeft-t,this.realTop=this.originTop-e},e.prototype.setXY=function(t,e){this.x=t,this.y=e,this.originLeft=this.boardWidth*this.x/1e4/this.boardScale,this.originTop=this.boardHeight*this.y/1e4/this.boardScale;var r=this.naturalWidth/2*(1-this.scaleX),i=this.naturalHeight/2*(1-this.scaleY);this.realLeft=this.originLeft-r,this.realTop=this.originTop-i},e.prototype.setScaleXY=function(t,e){this.originScaleX=t||1,this.originScaleY=e||1},e.prototype.setBoardSizeScale=function(t,e){this.boardWidth=t,this.boardHeight=e,this._calcProperty(),this._updateRectArea()},e.prototype.getImageSize=function(t,e,r){var i=this;this.boardWidth=t,this.boardHeight=e;var o=new Image;o.onload=function(t){o.onload=null,i.naturalWidth=o.naturalWidth,i.naturalHeight=o.naturalHeight,i.realWidth=i.naturalWidth,i.realHeight=i.naturalHeight,i._addElementCalcSize(i.width,i.height),r&&r()},o.src=this.url},e.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.CUSTOM_GRAPH_ELEMENT,seq:this.seqUtil.getSeq(),belongSeq:this.belongSeq,url:this.url,time:this.time,show:this.show,visible:this.visible,x:this.x,y:this.y,deg:this.deg,scaleX:this.scaleX*this.naturalWidth/this.boardWidth,scaleY:this.scaleY*this.naturalHeight/this.boardHeight,naturalWidth:this.naturalWidth,naturalHeight:this.naturalHeight,erasable:this.erasable}},e.prototype.getReportData=function(){return{type:this.type,property:{subType:this.subType,uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,url:this.url,time:this.time,hidden:Number(!this.show),visible:+this.visible,x:this.x,y:this.y,deg:this.deg,scaleX:this.scaleX*this.naturalWidth/this.boardWidth,scaleY:this.scaleY*this.naturalHeight/this.boardHeight,naturalWidth:this.naturalWidth,naturalHeight:this.naturalHeight,erasable:this.erasable,lockElement:this.lockElement}}},e.prototype.renderTo=function(t){this.container=t;var e="tic_custom_graph_element_".concat(this.belongSeq),r=t.querySelector("#".concat(e));if(r)this.imageWrap=r;else{var i=document.createElement("img");i.src=this.url,i.dataset.belongSeq="".concat(this.belongSeq),i.dataset.imageElement="true",i.setAttribute("style","width:100%;height:100%;"),(r=document.createElement("div")).dataset.belongSeq=this.belongSeq,r.dataset.imageElement=!0,r.dataset.boardId=this.boardId,r.id=e,r.appendChild(i),t.appendChild(r),this.imageWrap=r}this._setStyle(),this._updateRectArea()},e.prototype._setStyle=function(){this.originLeft=this.boardWidth*this.x/1e4/this.boardScale,this.originTop=this.boardHeight*this.y/1e4/this.boardScale;var t=this.naturalWidth/2*(1-this.scaleX),e=this.naturalHeight/2*(1-this.scaleY);this.realLeft=this.originLeft-t,this.realTop=this.originTop-e;var r=this.realLeft*this.boardScale+(this.boardScale-1)*this.realWidth/2,i=this.realTop*this.boardScale+(this.boardScale-1)*this.realHeight/2,o=this.scaleX*this.boardScale,n=this.scaleY*this.boardScale,a="position:absolute;margin:0;padding:0;\n    width:".concat(this.realWidth,"px;height:").concat(this.realHeight,"px;border:1px dotted transparent;cursor:move;\n    transform:translateX(").concat(r,"px) translateY(").concat(i,"px) rotate(").concat(this.deg,"deg) scale(").concat(o,",").concat(n,");\n    -webkit-transform:translateX(").concat(r,"px) translateY(").concat(i,"px) rotate(").concat(this.deg,"deg) scale(").concat(o,",").concat(n,");");this.imageWrap&&this.imageWrap.setAttribute("style",a)},e.prototype.setPosition=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=0),0!==t||0!==e){var r=this.rectArea,i=r.minX,o=r.minY,n=r.maxX,a=r.maxY,s=this._getNCValueX(t),l=this._getNCValueY(e),c=this.x+s,h=this.y+l,u=pn()+dn(),d=this._getNCValueX(u),p=this._getNCValueY(u),f=i+s,g=o+l,m=n+s,y=a+l;f-d<=0?(f=0+d,this.x+=-i+d):m+d>=1e4?(m=1e4-d,this.x+=1e4-n-d):this.x=c,g-p<=0?(g=0+p,this.y+=-o+p):y+p>=1e4?(y=1e4-p,this.y+=1e4-a-p):this.y=h,this._updateRectArea()}},e.prototype.setWidthHeight=function(t,e){this._addElementCalcSize(t,e)},e.prototype.setSize=function(t,e){0===t&&0===e||(this.scaleX=Number(((this.realWidth*this.scaleX+t/this.boardScale)/this.realWidth).toFixed(4)),this.scaleY=Number(((this.realHeight*this.scaleY+e/this.boardScale)/this.realHeight).toFixed(4)),this.originScaleX=this.scaleX*this.naturalWidth/this.boardWidth,this.originScaleY=this.scaleY*this.naturalHeight/this.boardHeight,this._updateRectArea())},e.prototype.setRealSize=function(t,e){0===t&&0===e||(this.scaleX=t,this.scaleY=e,this.originScaleX=this.scaleX*this.naturalWidth/this.boardWidth,this.originScaleY=this.scaleY*this.naturalHeight/this.boardHeight,this._updateRectArea())},e.prototype._updateRectArea=function(){var t=this.realLeft*this.boardScale+(this.boardScale-1)*this.realWidth/2,e=this.realTop*this.boardScale+(this.boardScale-1)*this.realHeight/2,r=this.scaleX*this.boardScale,i=this.scaleY*this.boardScale,o=t-this.realWidth*(r-1)/2,n=e-this.realHeight*(i-1)/2,a=this._calcRotateXY(o,n),s=a.x,l=a.y,c=t+this.realWidth+this.realWidth*(r-1)/2,h=n,u=(a=this._calcRotateXY(c,h)).x,d=a.y,p=o,f=e+this.realHeight+this.realHeight*(i-1)/2,g=(a=this._calcRotateXY(p,f)).x,m=a.y,y=c,v=f,_=(a=this._calcRotateXY(y,v)).x,E=a.y;this.rectArea={minX:Math.min(s,u,g,_),minY:Math.min(l,d,m,E),maxX:Math.max(s,u,g,_),maxY:Math.max(l,d,m,E)}},e.prototype._calcRotateXY=function(t,e){var r=this.realLeft*this.boardScale+(this.boardScale-1)*this.realWidth/2,i=this.realTop*this.boardScale+(this.boardScale-1)*this.realHeight/2,o=r+this.realWidth/2,n=i+this.realHeight/2,a=t,s=e,l=this.deg*(Math.PI/180),c=(a-o)*Math.cos(l)-(s-n)*Math.sin(l)+o,h=(a-o)*Math.sin(l)+(s-n)*Math.cos(l)+n;return{x:1e4*c/this.boardWidth,y:1e4*h/this.boardHeight,ox:c,oy:h}},e.prototype._addElementCalcSize=function(t,e){if(this.naturalWidth&&this.naturalHeight){this.width=1e4*this.naturalWidth/this.boardWidth,this.height=1e4*this.naturalHeight/this.boardHeight;var r=t/this.width,i=e/this.height;this.scaleX=Number((r/this.boardScale).toFixed(4)),this.scaleY=Number((i/this.boardScale).toFixed(4)),this.originScaleX=this.scaleX*this.naturalWidth/this.boardWidth,this.originScaleY=this.scaleY*this.naturalHeight/this.boardHeight;var o=this.naturalWidth/2*(1-this.scaleX),n=this.naturalHeight/2*(1-this.scaleY);this.realLeft=this.originLeft-o,this.realTop=this.originTop-n}else this.width=t,this.height=e},e.prototype.getRealSize=function(){var t=this.realLeft*this.boardScale+(this.boardScale-1)*this.realWidth/2,e=this.realTop*this.boardScale+(this.boardScale-1)*this.realHeight/2,r=this.scaleX*this.boardScale,i=this.scaleY*this.boardScale;return{left:t-this.realWidth*(r-1)/2,top:e-this.realHeight*(i-1)/2,width:this.realWidth*r,height:this.realHeight*i}},e.prototype.remove=function(){this.imageWrap&&this.imageWrap.remove()},e.prototype.getBoardId=function(){return this.boardId},e.prototype.impactCheck=function(t,e,r){return t>this.rectArea.minX&&e>this.rectArea.minY&&t<this.rectArea.maxX&&e<this.rectArea.maxY},e.prototype.pointImpactCheck=function(t){return this.impactCheck(t[0],t[1],0)},e.prototype.getReportDataForHistory=function(t){var e=this.getReportData();return t?e:{type:e.type,seq:this.seqUtil.getSeq(),content:JSON.stringify(e.property)}},e}(ra),Aa={TEDU_BOARD_IMAGE_FIT_MODE_CENTER:0,TEDU_BOARD_IMAGE_FIT_MODE_LEFT:4,TEDU_BOARD_IMAGE_FIT_MODE_TOP:5,TEDU_BOARD_IMAGE_FIT_MODE_RIGHT:6,TEDU_BOARD_IMAGE_FIT_MODE_BOTTOM:7};"object"==typeof window&&(window.TEduBoardImageFitMode=Aa);var Da,Ca,Pa,La,Ma=Aa;!function(t){t[t.None=0]="None",t[t.Timeout=1]="Timeout"}(Da||(Da={})),function(t){t[t.Error=1]="Error",t[t.Loading=2]="Loading",t[t.Loaded=3]="Loaded",t[t.Played=4]="Played",t[t.TimeUpdate=5]="TimeUpdate",t[t.Paused=6]="Paused",t[t.Seeked=7]="Seeked",t[t.Ended=8]="Ended",t[t.Waiting=9]="Waiting",t[t.Playing=10]="Playing",t[t.ExceptPaused=20]="ExceptPaused"}(Ca||(Ca={})),function(t){t[t.None=-1]="None",t[t.Play=0]="Play",t[t.Pause=1]="Pause",t[t.Seek=2]="Seek"}(Pa||(Pa={})),function(t){t[t.Audio=0]="Audio",t[t.Video=1]="Video"}(La||(La={}));var Ra=function(){this.progress=0,this.status=Pa.Play,this.callback=null,this.hasTry=0,this.timestamp=Wt.getTimeStamp(),this.waitingCallback=!1},Na=function(){function t(t,e){var r=this;this._element=new Audio,this._element.id="".concat(Wt.getTimeStamp()),this._element.src=t,this._element.load(),this._element.currentTime=0,this._mediaActions=[],this._listener=null,this._isLoaded=!1,this._log=e,this._audioStatus=Pa.Pause,this._canplay=!1,this._onStatusChanged(Ca.Loading),this._element.onplay=function(){r._audioStatus=Pa.Play,r._fireActionCallback(Pa.Play)},this._element.onpause=function(){r._audioStatus=Pa.Pause,r._fireActionCallback(Pa.Pause)},this._element.onseeked=function(){r._fireActionCallback(Pa.Seek)},this._element.ontimeupdate=function(){r._onStatusChanged(Ca.TimeUpdate)},this._element.onwaiting=function(){r._onStatusChanged(Ca.Waiting)},this._element.onplaying=function(){r._onStatusChanged(Ca.Playing)},this._element.onended=function(){r._onStatusChanged(Ca.Ended)},this._element.onerror=function(t){r._onStatusChanged(Ca.Error)},this._element.onloadedmetadata=function(){r._isLoaded=!0,r._onStatusChanged(Ca.Loaded),r._fireNextAction()},this._element.oncanplay=function(t){r._canplay=!0},this._element.onstalled=function(t){}}return t.prototype.play=function(t){this._pushAction(Pa.Play,0,t)},t.prototype.pause=function(t){this._pushAction(Pa.Pause,0,t)},t.prototype.seek=function(t,e){var r=this;this._pushAction(Pa.Seek,t,(function(){var i=r.currentTime();Math.abs(i-t)>=3?(r._isLoaded=!1,r._element&&r._element.load(),r.seek(t,e)):e&&e(Da.None,"")}))},t.prototype.mute=function(t){this._element&&(this._element.muted=t)},t.prototype.isLoaded=function(){return this._isLoaded},t.prototype.setVolume=function(t){t=Math.min(1,t),t=Math.max(0,t),this._element&&(this._element.volume=t)},t.prototype.getVolume=function(){return this._element?this._element.volume:0},t.prototype.destroy=function(){var t=this;this.pause((function(e,r){t._element&&(t._element.src="",t._element=null)})),this._element&&(this._element.onplay=null,this._element.onpause=null,this._element.onseeked=null,this._element.ontimeupdate=null,this._element.onwaiting=null,this._element.onplaying=null,this._element.onended=null,this._element.onerror=null,this._element.onloadedmetadata=null,this._element.src="",this._element=null),this._mediaActions=[],this._listener=null,this._isLoaded=!1},t.prototype._pushAction=function(t,e,r){var i=new Ra;i.callback=r,i.status=t,i.progress=e,this._mediaActions.push(i),1===this._mediaActions.length&&this._fireNextAction()},t.prototype._fireActionCallback=function(t){if(0!=this._mediaActions.length){var e=this._mediaActions[0];if(e.status==t&&1==e.waitingCallback)switch(this._mediaActions.splice(0,1),e.callback&&e.callback(Da.None,""),e.status){case Pa.Play:this._onStatusChanged(Ca.Played);break;case Pa.Pause:this._onStatusChanged(Ca.Paused);break;case Pa.Seek:this._onStatusChanged(Ca.Seeked)}else t==Pa.Pause&&this._onStatusChanged(Ca.ExceptPaused)}else t==Pa.Pause&&this.currentTime()!==this.duration()&&this._onStatusChanged(Ca.ExceptPaused);this._fireNextAction()},t.prototype._fireNextAction=function(){if(0!=this._mediaActions.length){var t=this._mediaActions[0];this._fireAction(t)}},t.prototype._fireAction=function(t){var e=this;if(this._isLoaded)if(t.waitingCallback=!0,t.status===this.currentStatus())this._fireActionCallback(t.status);else{switch(t.status){case Pa.Play:this._element&&this._element.play().catch((function(t){}));break;case Pa.Pause:this._element&&this._element.pause();break;case Pa.Seek:t.progress=Math.max(0,t.progress),t.progress=Math.min(t.progress,this.duration()),this._element&&this._canplay&&(this._element.currentTime=t.progress)}setTimeout((function(){0!=e._mediaActions.length&&t.timestamp==e._mediaActions[0].timestamp&&1==t.waitingCallback&&(t.hasTry<18?(t.hasTry+=1,e._fireAction(t)):(e._mediaActions.splice(0,1),t.waitingCallback=!1,t.callback(Da.Timeout,"action timeout, please refresh"),e._onStatusChanged(Ca.Error),e._fireNextAction()))}),500)}},t.prototype._onStatusChanged=function(t){this._listener&&this._listener(t,this.currentTime(),this.duration())},t.prototype.setEventChangeListener=function(t){this._listener=t},t.prototype.refresh=function(){this._isLoaded=!1,this._element&&this._element.load()},t.prototype.currentTime=function(){return this._isLoaded&&this._element?this._element.currentTime:0},t.prototype.duration=function(){return this._isLoaded&&this._element?this._element.duration:0},t.prototype.currentStatus=function(){return this._audioStatus},t.prototype.audioId=function(){return this._element?this._element.id:"0"},t}(),Ba=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ka=function(t){function e(e,r){var i=t.call(this,e,{renderOnCanvas:!1,listener:{updatePosition:function(t,e){},updateScale:function(t,e,r,i){},updateRotate:function(t){}}},"audio")||this;return i._totalTime=0,i._currentTime=0,i._initMediaParam(r),i._initDataParam(r),i._initEventListener(),i._createElement(),i._enableAudioControl(),i}return Ba(e,t),e.prototype.setEventListener=function(t){this._eventListener=t},e.prototype.setDataListener=function(t){this._dataListener=t},e.prototype.getRealTimeData=function(){var t=M.PROTOCOL_ACTION.AUDIO_ELEMENT;return this.subType==Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO&&(t=M.PROTOCOL_ACTION.GLOBAL_AUDIO_ELEMENT),{boardId:this.boardId,action:t,seq:this.seqUtil.getSeq(),belongSeq:this.belongSeq,url:this.url,time:Wt.getTimeStamp(),show:this.show,visible:this.visible,x:this.x,y:this.y,deg:this.deg,width:this.width,height:this.height,progress:this._media.currentTime(),status:this._media.currentStatus(),erasable:this.erasable,title:this.title}},e.prototype.setRealTimeData=function(t){var e;this.belongSeq=t.belongSeq,this.url=t.url,this._time=t.time,this.show=t.show,this.visible=null===(e=t.visible)||void 0===e||e,this.x=t.x,this.y=t.y,this.deg=t.deg,this.width=t.width,this.height=t.height,this._progress=t.progress,this._status=t.status,this.erasable=t.erasable,this.title=t.title},e.prototype.setReportData=function(t){var e;this.subType=t.subType,this.user=t.uid,this.boardId=t.boardId,this.belongSeq=t.belongSeq,this.url=t.url,this._time=t.time,this.show=!t.hidden,this.visible=null===(e=t.visible)||void 0===e||e,this.x=t.x,this.y=t.y,this.deg=t.deg,this.width=t.width,this.height=t.height,this._progress=t.progress,this._status=t.status,this.erasable=t.erasable,this.title=t.title},e.prototype._initMediaParam=function(t){var e=this;this._media=new Na(t.url,t.log),this._dataListener=null,this._eventListener=null,this._media.setEventChangeListener((function(t,r,i){var o=null;t==Ca.Error?o="error":t==Ca.Loading?o="loading":t==Ca.Loaded?o="loaded":t==Ca.Played?o="play":t==Ca.Paused?o="pause":t==Ca.Seeked?o="seek":t==Ca.Ended?o="end":t==Ca.Waiting?o="waiting":t==Ca.Playing?o="playing":t==Ca.ExceptPaused&&(o="exceptpause"),null!=o&&e.logger.reportInfo("Audio","audio_event_".concat(o),{param:{extraInfo:JSON.stringify({current:r,total:i,url:e.url,subType:e.subType,audio_id:e.audioId()})}},ea.ONLY_ONLINE),t==Ca.TimeUpdate?e.progressBarWrap&&e.progressBarWrap.onpointermove||e._seekUI(r,i):t==Ca.Loaded?e.isElementDisplay()&&(e._updateMedia(),e._seekUI(r,i)):t==Ca.ExceptPaused?e.play((function(t,e){})):t==Ca.Ended&&(e._progress=0,e.pause((function(t,e){}))),t!=Ca.ExceptPaused&&e._onEventListener(t,r,i)}))},e.prototype._initDataParam=function(t){var e,r,i;this._progress=-1,this._status=Pa.None,this._enableControl=!0,this._totalTime=0,this._currentTime=0,this.boardId=t.boardId,this.type="element",this.subType=t.subType||Ta.TEDU_BOARD_ELEMENT_AUDIO,this.show=null===(e=t.show)||void 0===e||e,this.visible=null===(r=t.visible)||void 0===r||r,this.user=t.user,this.belongSeq=t.belongSeq,this.width=-1,this.height=-1,this._time=0,this.x=0,this.y=0,this.url=t.url,this.deg=0,this._boardWidth=t.boardWidth,this._boardHeight=t.boardHeight,this.left=this._boardWidth*this.x/1e4,this.top=this._boardHeight*this.y/1e4,this.rectArea={maxX:0,maxY:0,minX:0,minY:0},this.scaleBasePoint=1,this.erasable=null===(i=t.erasable)||void 0===i||i,this.initEventFired=!1,this.title=t.title,this.lockElement=t.lockElement},e.prototype._initEventListener=function(){var t=this;this.event&&(this.event.on(tt.TEB_BOARD_TOOLTYPE_CHANGE,(function(e){t._enableAudioControl()})),this.event.on(tt.TEB_BOARD_AUDIOCONTROL_ENABLE_CHANGE,(function(e){t._enableControl=e,t._enableAudioControl()})),this.event.on(tt.TEB_BOARD_PERMISSION_CHANGED,(function(){t._enableAudioControl()})))},e.prototype._updateMedia=function(){var t=this._media.currentStatus(),e=this._media.currentTime();this.logger.reportInfo("Audio","update_media",{param:{extraInfo:JSON.stringify({current:e,url:this.url,status:t,audio_id:this.audioId()})}},ea.ONLY_ONLINE),this._status==Pa.Play&&(this._progress=this._progress+(Wt.getTimeStamp()-this._time)/1e3,this._progress>=this._media.duration()&&(this._status=Pa.Pause,this._progress=0),this.logger.reportInfo("Audio","update_media_fix",{param:{extraInfo:JSON.stringify({progress:this._progress,url:this.url,status:this._status,audio_id:this.audioId()})}},ea.ONLY_ONLINE),this._time=Wt.getTimeStamp()),Math.abs(this._progress-e)>1&&(this.logger.reportInfo("Audio","update_media_seek",{param:{extraInfo:JSON.stringify({progress:this._progress,current:e,url:this.url,status:this._status,audio_id:this.audioId()})}},ea.ONLY_ONLINE),this.seek(this._progress,(function(t,e){}))),this._status!=t?this._status==Pa.Play?this.play((function(t,e){})):this._status==Pa.Pause&&this.pause((function(t,e){})):this.initEventFired||this._status!=Pa.Pause||(this._onEventListener(Ca.Paused,this._progress,this._media.duration()),this.initEventFired=!0)},e.prototype.getReportData=function(){return{type:this.type,property:{subType:this.subType,uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,url:this.url,time:Wt.getTimeStamp(),hidden:!this.show,visible:+this.visible,x:this.x,y:this.y,deg:this.deg,width:this.width,height:this.height,progress:Math.floor(this._media.currentTime()),status:this._media.currentStatus(),erasable:this.erasable,title:this.title,lockElement:this.lockElement}}},e.prototype._createElement=function(){var t=this,e=this.teduToolType;this.mutedBtn=document.createElement("div"),this.mutedBtn.className="tiw-play__btn-muted tiw-pointer-event__none unmuted-btn",this.mutedBtn.onpointerdown=function(r){e.isMouseToolType()&&r.stopPropagation(),t.isLocked()?t._fireElementLockWarningEvent():t._isOperationPermissions()&&(t.mutedBtn.className.indexOf("unmuted-btn")>-1?t._onMuteClick(!0):t._onMuteClick(!1))},this.progressCircleEl=document.createElement("div"),this.progressCircleEl.className="tiw-progress__circle tiw-pointer-event__none",this.progressCircleEl.onpointerdown=function(t){t.stopPropagation()},this.progressCircleEl.onpointerdown=function(e){t.isLocked()?t._fireElementLockWarningEvent():t._isOperationPermissions()&&(t.progressCircleEl.onpointerup=function(){t.progressBarWrap.onpointermove=null},t.audioWrapEl.onpointerleave=function(){t.progressBarWrap.onpointermove=null},t.audioWrapEl.onpointerup=function(){t.progressBarWrap.onpointermove=null},t.progressBarWrap.onpointermove=function(e){var r=t.progressBarEl.clientWidth,i=0;window.TouchEvent&&e instanceof TouchEvent&&e.changedTouches?e.target===t.progressBarEl||e.target===t.progressBarWrap?i=e.changedTouches[0].pageX-t.progressBarWrap.getBoundingClientRect().left:e.target===t.progressCircleEl&&(i=e.changedTouches[0].pageX-t.progressCircleEl.getBoundingClientRect().left+t._currentTime/t._totalTime*r):e.target===t.progressBarEl||e.target===t.progressBarWrap?i=e.offsetX:e.target===t.progressCircleEl&&(i=e.offsetX+t._currentTime/t._totalTime*r);var o=(i=Math.max(i,0))*t._totalTime/r;t._seekUI(o,t._totalTime),clearTimeout(t.seekUITask),t.seekUITask=window.setTimeout((function(){t._onSeekClick(o,t._totalTime)}),200)},e.stopPropagation())},this.progressRealEl=document.createElement("div"),this.progressRealEl.className="tiw-progress__real tiw-pointer-event__none",this.progressBarEl=document.createElement("div"),this.progressBarEl.className="tiw-play__bar-progress tiw-pointer-event__none",this.progressBarEl.onpointerdown=function(r){if(e.isMouseToolType()&&r.stopPropagation(),t.isLocked())t._fireElementLockWarningEvent();else if(t._isOperationPermissions()){var i;i=window.TouchEvent&&r instanceof TouchEvent&&r.changedTouches?r.changedTouches[0].pageX-t.progressBarEl.getBoundingClientRect().left:r.offsetX;var o=t.progressBarEl.clientWidth;t._currentTime=i*t._totalTime/o,t._onSeekClick(t._currentTime,t._totalTime)}},this.progressBarWrap=document.createElement("div"),this.progressBarWrap.className="tiw-play__bar-progress-wrap tiw-pointer-event__none",this.progressBarWrap.appendChild(this.progressBarEl),this.progressBarEl.appendChild(this.progressCircleEl),this.progressBarEl.appendChild(this.progressRealEl),this.progressTimeCurrentEl=document.createElement("span"),this.progressTimeCurrentEl.className="tiw-play__time-current tiw-pointer-event__none",this.progressTimeCurrentEl.innerText="00:00",this.progressTimeSplitEl=document.createElement("span"),this.progressTimeSplitEl.className="tiw-play__time-split tiw-pointer-event__none",this.progressTimeSplitEl.innerText="/",this.progressTimeTotalEl=document.createElement("span"),this.progressTimeTotalEl.className="tiw-play__time-total tiw-pointer-event__none",this.progressTimeTotalEl.innerText="00:00",this.progressTimeEl=document.createElement("div"),this.progressTimeEl.className="tiw-play__time-progress tiw-pointer-event__none",this.progressTimeEl.appendChild(this.progressTimeCurrentEl),this.progressTimeEl.appendChild(this.progressTimeSplitEl),this.progressTimeEl.appendChild(this.progressTimeTotalEl),this.playBtn=document.createElement("div"),this.playBtn.className="tiw-play__btn tiw-pointer-event__none start-btn",this.playBtn.onpointerdown=function(r){e.isMouseToolType()&&r.stopPropagation(),t.isLocked()?t._fireElementLockWarningEvent():t._isOperationPermissions()&&(t.playBtn.className.indexOf("start-btn")>-1?t._onPlayClick():t._onPauseClick())},this.closeBtn=document.createElement("div"),this.closeBtn.className="tiw-close__btn tiw-pointer-event__none",this.closeBtn.onpointerdown=function(r){e.isMouseToolType()&&r.stopPropagation(),t.isLocked()?t._fireElementLockWarningEvent():t._isOperationPermissions()&&(t.show=!1,t.remove(),t._onDataListener(!1),t.event.fireRemoveElementEvent([String(t.belongSeq)]))},this.audioWrapEl=document.createElement("div"),this.audioWrapEl.className="tiw-audio__wrap tiw-pointer-event__none",this.audioWrapEl.appendChild(this.closeBtn),this.audioWrapEl.appendChild(this.playBtn),this.audioWrapEl.appendChild(this.progressTimeEl),this.audioWrapEl.appendChild(this.progressBarWrap),this.audioWrapEl.appendChild(this.mutedBtn),this.audioWrapEl.ontouchstart=this.audioWrapEl.onmousedown=this.audioWrapEl.onclick=function(t){e.isMouseToolType()&&t.stopPropagation()},this.audioWrapEl.onpointerup=function(t){e.isMouseToolType()&&t.stopPropagation()};var r="tic-audio-element__".concat(this.belongSeq);this.audioWrapEl.id=r},e.prototype.renderTo=function(t){var e=this;if(this.isElementDisplay()){if(this._media.isLoaded()&&this._updateMedia(),this.subType!=Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO){var r="tic-audio-element__".concat(this.belongSeq);if(!t.querySelector("#".concat(r))){if(-1==this.width||-1==this.height){this.width=5e3;var i=this.width*this._boardWidth/1e4*9/50;this.height=1e4*i/this._boardHeight,this.x=(1e4-this.width)/2,this.y=(1e4-this.height)/2}t.appendChild(this.audioWrapEl),setTimeout((function(){e._onResizeChange()}),200)}this.left=this.x*this._boardWidth/1e4,this.top=this.y*this._boardHeight/1e4,this.audioWrapEl.style.width=this.width*this._boardWidth/1e4+"px",this.audioWrapEl.style.height=this.height*this._boardHeight/1e4+"px",this.audioWrapEl.style.transform="translateX(".concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg)"),this.audioWrapEl.style.webkitTransform="translateX(".concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg)"),this._onResizeChange(),this._updateRectArea()}}else this.remove()},e.prototype.setBoardSize=function(t,e){this._boardWidth=t,this._boardHeight=e,this.boardWidth=t,this.boardHeight=e,this.left=this.boardWidth*this.x/1e4,this.top=this.boardHeight*this.y/1e4,this._updateRectArea()},e.prototype.remove=function(){this.initEventFired=!1,this.audioWrapEl&&this.audioWrapEl.remove(),this._media.currentStatus()!=Pa.Pause&&this.pause((function(t,e){}))},e.prototype.pointImpactCheck=function(t){return this.impactCheck(t[0],t[1],0)},e.prototype.play=function(t){var e=this;this.logger.reportInfo("Audio","audio_play",{param:{extraInfo:JSON.stringify({url:this.url,subType:this.subType,audio_id:this.audioId()})}},ea.ONLY_ONLINE),this._media.play((function(r,i){e.logger.reportInfo("Audio","audio_play_callback",{param:{extraInfo:JSON.stringify({code:r,desc:i,url:e.url,subType:e.subType,audio_id:e.audioId()})}},ea.ONLY_ONLINE),r==Da.None&&(e._status=Pa.Play,e._progress=e._media.currentTime(),e._time=Wt.getTimeStamp(),e._playUI()),t(r,i)}))},e.prototype._playUI=function(){this.playBtn.classList.add("pause-btn"),this.playBtn.classList.remove("start-btn")},e.prototype.pause=function(t){var e=this;this.logger.reportInfo("Audio","audio_pause",{param:{extraInfo:JSON.stringify({url:this.url,subType:this.subType,audio_id:this.audioId()})}},ea.ONLY_ONLINE),this._media.pause((function(r,i){e.logger.reportInfo("Audio","audio_pause_callback",{param:{extraInfo:JSON.stringify({code:r,desc:i,url:e.url,subType:e.subType,audio_id:e.audioId()})}},ea.ONLY_ONLINE),r==Da.None&&(e._status=Pa.Pause,e._progress=e._media.currentTime(),e._time=Wt.getTimeStamp(),e._pauseUI()),t(r,i)}))},e.prototype._pauseUI=function(){this.playBtn.classList.add("start-btn"),this.playBtn.classList.remove("pause-btn")},e.prototype.mute=function(t){this._muteUI(t),this._media.mute(t)},e.prototype._muteUI=function(t){t?(this.mutedBtn.classList.add("muted-btn"),this.mutedBtn.classList.remove("unmuted-btn")):(this.mutedBtn.classList.add("unmuted-btn"),this.mutedBtn.classList.remove("muted-btn"))},e.prototype.setVolume=function(t){this._media.setVolume(t)},e.prototype.getVolume=function(){return this._media.getVolume()},e.prototype._onPlayClick=function(){var t=this;this.play((function(e,r){e==Da.None&&t._onDataListener()}))},e.prototype._onPauseClick=function(){var t=this;this.pause((function(e,r){e==Da.None&&t._onDataListener()}))},e.prototype._onSeekClick=function(t,e){var r=this;this.seek(t,(function(t,e){t==Da.None&&r._onDataListener()}))},e.prototype._onMuteClick=function(t){this.mute(t)},e.prototype._onDataListener=function(t){if(void 0===t&&(t=!0),null!=this._dataListener){var e=this.getRealTimeData(),r=this.getReportData();this._dataListener(e,r,t)}},e.prototype._onEventListener=function(t,e,r){null!=this._eventListener&&this._eventListener(t,e,r)},e.prototype.seek=function(t,e){var r=this,i=this._media.duration()||0;this.logger.reportInfo("Audio","audio_seek",{param:{extraInfo:JSON.stringify({url:this.url,subType:this.subType,current:t,duration:i,audio_id:this.audioId()})}},ea.ONLY_ONLINE),t=Math.min(Math.max(0,t),i),this._media.seek(t,(function(i,o){r.logger.reportInfo("Audio","audio_seek_callback",{param:{extraInfo:JSON.stringify({code:i,desc:o,url:r.url,subType:r.subType,current:r._media.currentTime(),audio_id:r.audioId()})}},ea.ONLY_ONLINE),i==Da.None&&(r._progress=t,r._time=Wt.getTimeStamp(),r._seekUI(t,r._media.duration())),e(i,o)}))},e.prototype._seekUI=function(t,e){this._totalTime=e,this._currentTime=t=Math.max(0,t);var r=Math.max(0,Math.min(100,e?t/e*100:0));this.progressTimeCurrentEl.innerText===this._formatSecond(t)&&this.progressTimeTotalEl.innerText===this._formatSecond(e)||(this.progressTimeCurrentEl.innerText=this._formatSecond(t),this.progressTimeTotalEl.innerText=this._formatSecond(e),this.progressRealEl.style.width=r+"%",this.progressCircleEl.style.left=r+"%")},e.prototype._formatSecond=function(t){var e=Math.floor(t/3600),r=Math.floor(t/60%60),i=Math.floor(t%60),o="";return e&&e<10?o+="0"+e+":":e>=10&&(o+=e+":"),r<10&&(o+="0"),o+=r+":",i<10&&(o+="0"),o+i},e.prototype.getBoardId=function(){return this.boardId},e.prototype.refresh=function(){this._media.refresh()},e.prototype._enableAudioControl=function(){this._isOperationPermissions()?(this.mutedBtn.classList.remove("disable"),this.playBtn.classList.remove("disable"),this.progressBarEl.classList.remove("disable"),this.closeBtn.classList.remove("disable"),this.progressCircleEl.classList.remove("disable")):(this.mutedBtn.classList.add("disable"),this.playBtn.classList.add("disable"),this.progressBarEl.classList.add("disable"),this.closeBtn.classList.add("disable"),this.progressCircleEl.classList.add("disable"))},e.prototype._isOperationPermissions=function(){var t=this.permissionHandler.filter("Element::Update::Audio",void 0,!1);return this._enableControl&&this.teduToolType.isMouseToolType()&&t},e.prototype._onResizeChange=function(){var t=this.progressBarEl.clientHeight;this.progressCircleEl.style.width=3*t+"px",this.progressCircleEl.style.height=3*t+"px",this.progressCircleEl.style.top=-t+"px";var e=this.progressTimeEl.clientWidth/7,r=1;e<12&&(r=e/12,e=12),this.progressTimeEl.style.fontSize=e+"px",this.progressTimeEl.style.transform="scale(".concat(r,")"),this.progressTimeEl.style.webkitTransform="scale(".concat(r,")"),this.closeBtn.style.height=this.closeBtn.clientWidth+"px",this.closeBtn.style.top=this.closeBtn.clientWidth/-2+"px"},e.prototype.audioId=function(){return this._media.audioId()},e.prototype.destroy=function(){this._media.destroy()},e.prototype.getElementId=function(){return this.belongSeq+""},e.prototype.setBorder=function(){},e.prototype.getReportDataForHistory=function(t){var e=this.getReportData();return t?e:{type:e.type,seq:this.seqUtil.getSeq(),content:JSON.stringify(e.property)}},e.prototype._fireElementLockWarningEvent=function(){this.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENT_IS_LOCKED,this.getElementId())},e}(ra),Fa={TEDU_BOARD_AUDIO_STATUS_ERROR:1,TEDU_BOARD_AUDIO_STATUS_LOADING:2,TEDU_BOARD_AUDIO_STATUS_LOADED:3,TEDU_BOARD_AUDIO_STATUS_PLAYED:4,TEDU_BOARD_AUDIO_STATUS_TIMEUPDATE:5,TEDU_BOARD_AUDIO_STATUS_PAUSED:6,TEDU_BOARD_AUDIO_STATUS_SEEKED:7,TEDU_BOARD_AUDIO_STATUS_ENDED:8,TEDU_BOARD_AUDIO_STATUS_WAITING:9,TEDU_BOARD_AUDIO_STATUS_PLAYING:10},Ua={TEDU_BOARD_POSITION_LEFT_TOP:0,TEDU_BOARD_POSITION_RIGHT_TOP:1,TEDU_BOARD_POSITION_RIGHT_BOTTOM:2,TEDU_BOARD_POSITION_LEFT_BOTTOM:3},Ha=1001,Ga=1002,qa=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Wa=function(t){function e(e,r){var i=t.call(this,e,{listener:{updatePosition:function(t,e){i.location.x+=t,i.location.y+=e},updateScale:function(t,e){i.scaleX*=t,i.scaleY*=e},updateRotate:function(t){i.deg=t}}},"text")||this;return i.boardId=r.boardId,i.user=r.user,i.type="inputtext",i.seq=r.belongSeq,i.belongSeq=r.belongSeq,i.scale=1,i.color="#000000",i.typeFace="",i.textSize=0,i.fontStyle=0,i.lineHeight=1,i.time=Wt.getTimeStamp(),i.text="",i.show=r.show,i.visible=r.visible,i.textWidth=0,i.textHeight=0,i.location={x:r.x,y:r.y},i.scaleX=r.scaleX||1,i.scaleY=r.scaleY||1,i.deg=r.deg||0,i.subType=Ta.TEDU_BOARD_ELEMENT_TEXT,i.lockElement=r.lockElement,i}return qa(e,t),e.prototype.pointTransformer=function(t,e){void 0===e&&(e=!0);var r=t.x,i=t.y,o=(r-this.location.x)*this.scaleX+this.x,n=(i-this.location.y)*this.scaleY+this.y,a=this._calcRotateXY(o,n),s=a.x,l=a.y;return{x:e?s:o,y:e?l:n}},e.prototype.setBorder=function(){this.x=this.location.x,this.y=this.location.y,this.width=this.textWidth,this.height=this.textHeight,this.left=this.boardWidth*this.x/1e4,this.top=this.boardHeight*this.y/1e4,this._updateRectArea()},e.prototype.setBoardSize=function(t,e){this.boardWidth=t,this.boardHeight=e,this.left=this.boardWidth*this.x/1e4,this.top=this.boardHeight*this.y/1e4},e.prototype.getRectArea=function(){return{minX:this.location.x,minY:this.location.y,maxX:this.location.x+this.textWidth,maxY:this.location.y+this.textHeight}},e.prototype.getReportData=function(){return{uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,updateTime:Wt.getTimeStamp(),updateContent:{x:this.location.x,y:this.location.y,text_wh:"".concat(this.textWidth,",").concat(this.textHeight),scaleX:this.scaleX,scaleY:this.scaleY,deg:this.deg}}},e.prototype.getData=function(){return{uid:this.user,seq:this.belongSeq,x:this.location.x,y:this.location.y,text_wh:"".concat(this.textWidth,",").concat(this.textHeight),scaleX:this.scaleX,scaleY:this.scaleY,deg:this.deg}},e.prototype.getElementOperatorReportData=function(){return t.prototype.getElementOperatorReportData.call(this,{color:this.color,textSize:this.textSize,lineHeight:this.lineHeight})},e.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION,seq:this.seqUtil.getSeq(),moves:[this.getData()],time:Wt.getTimeStamp()}},e.prototype.impactCheck=function(t,e,r){return this.pointImpactCheck([t,e])},e.prototype.getBoardId=function(){return this.boardId},e.prototype.getReportDataForHistory=function(t){void 0===t&&(t=!0);var e={belongSeq:this.belongSeq,time:this.time,boardId:this.getBoardId(),uid:this.user,x:Math.floor(this.location.x),y:Math.floor(this.location.y),colorRGBA:Y(this.color),scale:100,updateTime:Wt.getTimeStamp(),hidden:+!this.show,visible:this.visible,typeface:this.typeFace,textSize:Math.floor(this.textSize),fontStyle:this.fontStyle,lineHeight:this.lineHeight,text:encodeURI(escape(this.text)),text_wh:"".concat(this.textWidth,",").concat(this.textHeight),scaleX:this.scaleX,scaleY:this.scaleY,deg:this.deg,lockElement:this.lockElement};return t?e:{type:"addText",content:JSON.stringify(e)}},e}(ra),Ya=[1,11,17],za=[4,5,6,7,8,13,14,15,16,18,19,20,21,22,23,24,25,26];function ja(){return za}var Va,Xa={TEDU_BOARD_TOOL_TYPE_MOUSE:0,TEDU_BOARD_TOOL_TYPE_PEN:1,TEDU_BOARD_TOOL_TYPE_ERASER:2,TEDU_BOARD_TOOL_TYPE_LASER:3,TEDU_BOARD_TOOL_TYPE_LINE:4,TEDU_BOARD_TOOL_TYPE_OVAL:5,TEDU_BOARD_TOOL_TYPE_RECT:6,TEDU_BOARD_TOOL_TYPE_OVAL_SOLID:7,TEDU_BOARD_TOOL_TYPE_RECT_SOLID:8,TEDU_BOARD_TOOL_TYPE_POINT_SELECT:9,TEDU_BOARD_TOOL_TYPE_RECT_SELECT:10,TEDU_BOARD_TOOL_TYPE_TEXT:11,TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG:12,TEDU_BOARD_TOOL_TYPE_SQUARE:13,TEDU_BOARD_TOOL_TYPE_SQUARE_SOLID:14,TEDU_BOARD_TOOL_TYPE_CIRCLE:15,TEDU_BOARD_TOOL_TYPE_CIRCLE_SOLID:16,TEDU_BOARD_TOOL_TYPE_BOARD_CUSTOM_GRAPH:17,TEDU_BOARD_TOOL_TYPE_HIGHLIGHTER:19,TEDU_BOARD_TOOL_TYPE_RIGHT_TRIANGLE:20,TEDU_BOARD_TOOL_TYPE_ISOSCELES_TRIANGLE:21,TEDU_BOARD_TOOL_TYPE_PARALLELOGRAM:22,TEDU_BOARD_TOOL_TYPE_CUBE:23,TEDU_BOARD_TOOL_TYPE_CYLINDER:24,TEDU_BOARD_TOOL_TYPE_CONE:25,TEDU_BOARD_TOOL_TYPE_COORDINATE:26},Ja=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ka=function(t){function e(e){var r=t.call(this,e)||this;return r._toolType=Xa.TEDU_BOARD_TOOL_TYPE_PEN,r.hasPermission=!1,r}return Ja(e,t),Object.defineProperty(e.prototype,"toolType",{get:function(){return this._toolType},set:function(t){Object.values(Xa).indexOf(t)>-1?this._toolType=t:this._toolType=Xa.TEDU_BOARD_TOOL_TYPE_PEN,this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"setType",data:this._toolType})}},ea.ONLY_ONLINE),this.event.fireToolTypeChanged(this._toolType)},enumerable:!1,configurable:!0}),e.prototype.isSelectToolType=function(){return this.isRectSelectToolType()||this.isPointSelectToolType()},e.prototype.isRectSelectToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_RECT_SELECT},e.prototype.isPointSelectToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_POINT_SELECT},e.prototype.isHighLighterToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_HIGHLIGHTER},e.prototype.isPenToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_PEN},e.prototype.isLaserToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_LASER},e.prototype.isMouseToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_MOUSE},e.prototype.isTextInputToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_TEXT},e.prototype.isZoomToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG},e.prototype.isEraserToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_ERASER},e.prototype.isGraphAndGraffitiToolType=function(){return ja().concat(Ya).includes(this._toolType)},e.prototype.isGraphToolType=function(){return ja().includes(this._toolType)},e.prototype.isCustomGraphToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_BOARD_CUSTOM_GRAPH},e.prototype.isGraphLineToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_LINE},e.prototype.isRectToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_RECT},e.prototype.isRectSolidToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_RECT_SOLID},e.prototype.isOvalToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_OVAL},e.prototype.isOvalSolidToolType=function(){return this._toolType===Xa.TEDU_BOARD_TOOL_TYPE_OVAL_SOLID},e.prototype.getTextTypeByGraphToolType=function(t){return{4:"line",5:"oval",6:"rect",7:"oval",8:"rect",13:"square",14:"square",15:"circle",16:"circle",18:"arc",20:"right-triangle",21:"isosceles-triangle",22:"parallelogram",23:"cube",24:"cylinder",25:"cone",26:"coordinate"}[t+""]},e.prototype.isGraphSolid=function(){var t=Xa;return[t.TEDU_BOARD_TOOL_TYPE_OVAL_SOLID,t.TEDU_BOARD_TOOL_TYPE_RECT_SOLID,t.TEDU_BOARD_TOOL_TYPE_SQUARE_SOLID,t.TEDU_BOARD_TOOL_TYPE_CIRCLE_SOLID].includes(this._toolType)},e.prototype.checkIfToolHasPermission=function(t){var e="";return this.isSelectToolType()?e="Element::Select::*":this.isHighLighterToolType()?e="Element::Add::Highlighter":this.isPenToolType()?e="Element::Add::Pen":this.isLaserToolType()?e="Element::Add::Laser":this.isTextInputToolType()?e="Element::Add::Text":this.isZoomToolType()?e="Board::Scale::*":this.isGraphToolType()?e="Element::Add::Graph":this.isCustomGraphToolType()?e="Element::Add::CustomGraph":this.isEraserToolType()&&(e="Element::Delete::*"),!e||this.permissionHandler.filter(e,[{operator:this.identifier}],t)},e}(X),Za=function(){function t(){}return t.deepProxy=function(e,r){for(var i in e){var o=e[i];o instanceof V||o instanceof nt||o instanceof pa||o instanceof Ka||!B(o)&&!N(o)||o.__proxy__||(e[i]=t.deepProxy(e[i],r))}return new C(e,{set:function(e,i,o){return!B(o)&&!N(o)||o.__proxy__?e[i]=o:e[i]=t.deepProxy(o,r),"needToRender"!==i&&(r.needToRender=!0),e.__proxy__=!0,!0}})},t}(),Qa={NONE:1,SOLID:2},$a={RULER:1,TRIANGLE:2,ISOSCELES_TRIANGLE:3,PROTRACTOR:4,COMPASSES:5},ts=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),es=function(){return(es=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},rs=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},is=null,os='\n  <div class="tiw-mathtool-angle-btn-box">\n    <button class="tiw-angle-switch__btn" data-value="30">30°</button>\n    <button class="tiw-angle-switch__btn" data-value="45">45°</button>\n    <button class="tiw-angle-switch__btn" data-value="60">60°</button>\n    <button class="tiw-angle-switch__btn" data-value="90">90°</button>\n    <button class="tiw-angle-switch__btn" data-value="120">120°</button>\n    <button class="tiw-angle-switch__btn" data-value="135">135°</button>\n    <button class="tiw-angle-switch__btn" data-value="150">150°</button>\n    <button class="tiw-angle-switch__btn" data-value="180">180°</button>\n  </div>\n',ns=function(t){function e(r,i,o,n){void 0===o&&(o=$a.PROTRACTOR);var a=t.call(this,r,{renderOnCanvas:!1,listener:{updatePosition:function(t,e){},updateScale:function(t,e,r,i){},updateRotate:function(t){}}},"mathTool")||this;return a.type="element",a.subType=Ta.TEDU_BOARD_ELEMENT_MATH_TOOL,a.toolType=$a.RULER,a.boardId="",a.size=0,a.rotateAnchor={x:0,y:0},a.resizeAnchor={x:0,y:0},a.zIndex=0,a.measureAngle=30,a.baseAngle=0,a.testAngle=-30,a.toolAngle=30,a.shadowWidth=20,a.innerTriangleEdgeLen=[],a.sizeClipper=e.SIZE_CLIPER,a.compassesLegLength=e.COMPASSES_LEG_LENGTH,a.compassesLegAngle=15,a.compassesLegAnchorOffset=e.COMPASSES_ANCHOR_OFFSET,a.compassesResizeBtnOffset=e.COMPASSES_RESIZE_BTN_OFFSET,a.compassesHeaderLength=e.COMPASSES_HEADER_LENGTH,a.scaleX=1,a.scaleY=1,a.originContainerWidth=0,a.originContainerHeight=0,a._cmValue=0,a._initOptions=null,a._pointerId=null,a._lock=!1,a._lockTime=e.LOCK_RELEASE_TIMESTAMP,a._compassDrawing=!1,a._compassMovingXY=null,a._eventName=[],a.hasInteractionPermission=!0,a.hasDeletePermission=!0,a._callback=function(){},a.pointArr=[],a.toolType=o,a.user=i.user,a.boardId=i.boardId,a.belongSeq=i.belongSeq,a.toolType===$a.COMPASSES&&i.boardWidth<i.boardHeight?(a.boardWidth=i.boardWidth/2,a.boardHeight=i.boardHeight/2):(a.boardWidth=i.boardWidth,a.boardHeight=i.boardHeight),a.lineType=i.lineType,a.brushColor=i.brushColor,i.boardHeight>i.boardWidth?(a.originContainerWidth=1440*i.boardWidth/i.boardHeight,a.originContainerHeight=1440):(a.originContainerWidth=1440,a.originContainerHeight=1440*i.boardHeight/i.boardWidth),a._initOptions=i,a.initData(i),a.createElement(),a._initTiwEvent(),a.store=n,a}return ts(e,t),Object.defineProperty(e.prototype,"_x",{get:function(){return this.x/1e4*this.boardWidth},set:function(t){this.x=t/this.boardWidth*1e4},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_y",{get:function(){return this.y/1e4*this.boardHeight},set:function(t){this.y=t/this.boardHeight*1e4},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_width",{get:function(){return this.width/1e4*this.boardWidth},set:function(t){this.width=t/this.boardWidth*1e4},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_height",{get:function(){return this.height/1e4*this.boardHeight},set:function(t){this.height=t/this.boardHeight*1e4},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_compassesLegLength",{get:function(){return this.compassesLegLength/1e4*this.boardHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_compassesLegAnchorOffset",{get:function(){return this.compassesLegAnchorOffset/1e4*this.boardWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_compassesResizeBtnOffset",{get:function(){return this.compassesResizeBtnOffset/1e4*this.boardWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_compassesHeaderLength",{get:function(){return this.compassesHeaderLength/1e4*this.boardHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lock",{get:function(){return this._lock},set:function(t){this._lock=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lockTime",{get:function(){return this._lockTime},set:function(t){this._lockTime=t},enumerable:!1,configurable:!0}),e.prototype.cm2px=function(t){return t*this.boardWidth*e.MATH_TOOL_RATIO},e.prototype.px2cm=function(t){return t/(this.boardWidth*e.MATH_TOOL_RATIO)},e.prototype.getBoardId=function(){return this.boardId},e.prototype.bindCallback=function(t){this._callback=t},e.prototype._initTiwEvent=function(){var t=this;this.event&&(this.event.on(tt.TEB_BOARD_SCALE_CHANGE,(function(){t._updateTextValue("")})),this.event.on(tt.TEB_BOARD_SCROLL_CHANGED,(function(){t._updateTextValue("")})),this.event.on(tt.TEB_BOARD_PERMISSION_CHANGED,(function(){t.updateInteractionPermission()})))},e.prototype.initData=function(t){var r,i;if(this.width=0,this.height=0,this.size=0,this.deg=t.deg||0,this.x=0,this.y=0,this.brushColor=t.brushColor||"rgba(255,0,0,1)",this.show=null===(r=t.show)||void 0===r||r,this.visible=null===(i=t.visible)||void 0===i||i,this.baseAngle=t.baseAngle||0,this.testAngle=t.testAngle||-30,this.measureAngle=Math.abs(this.testAngle-this.baseAngle),this.setScale(),this.toolType===$a.RULER)this.width=t.width||e.RULER_MIN_WIDTH,this.size=this.px2cm(this._width-2*this.shadowWidth*this.scaleX),this.height=1250,this.toolType===$a.RULER&&this.boardWidth<this.boardHeight&&(this.height=this.boardWidth/this.boardHeight*1.2*750);else if(this.toolType===$a.TRIANGLE)this.width=t.width||e.TRIANGLE_MIN_WIDTH,this.toolAngle=30,this._height=this._width*Math.tan(this.toolAngle/180*Math.PI),this._calcInnerTriangle();else if(this.toolType===$a.ISOSCELES_TRIANGLE)this.width=t.width||e.ISOSCELES_TRIANGLE_MIN_WIDTH,this.toolAngle=45,this._height=this._width*Math.tan(this.toolAngle/180*Math.PI),this._calcInnerTriangle();else if(this.toolType===$a.PROTRACTOR)this.width=t.width||e.PROTRACTOR_MIN_WIDTH,this._height=this._width/2;else if(this.toolType===$a.COMPASSES){this.compassesLegLength=t.compassesLegLength||e.COMPASSES_LEG_LENGTH/this.originContainerHeight*1e4,this.compassesLegAnchorOffset=t.compassesLegAnchorOffset||e.COMPASSES_ANCHOR_OFFSET/this.originContainerWidth*1e4,this.compassesResizeBtnOffset=t.compassesResizeBtnOffset||e.COMPASSES_RESIZE_BTN_OFFSET/this.originContainerWidth*1e4,this.compassesHeaderLength=t.compassesHeaderLength||e.COMPASSES_HEADER_LENGTH/this.originContainerHeight*1e4;var o=this._compassesLegLength,n=this._compassesLegAnchorOffset;this.width=t.width||e.COMPASSES_WIDTH/this.originContainerWidth*1e4,this._height=Math.sqrt(o*o-(this._width/2-n)*(this._width/2-n))+this._compassesHeaderLength,this.compassesLegAngle=Math.asin((this._width/2-n)/o)/Math.PI*180}this.x=t.x||Math.max((this.boardWidth-this._width)/2,0)/this.boardWidth*1e4,this.y=t.y||Math.max((this.boardHeight-this._height)/2,0)/this.boardHeight*1e4,this.zIndex=t.zIndex||e.ELEMENT_MAX_ZINDEX,e.ELEMENT_MAX_ZINDEX=this.zIndex+1},e.prototype.render=function(t){t&&(this.container=t,this.isElementDisplay()?this.showElement():this.hideElement(),this.updateInteractionPermission())},e.prototype.updateInteractionPermission=function(){this.hasInteractionPermission=this.permissionHandler.filter("Element::Update::MathTool",void 0,!1),this.hasInteractionPermission?this._el.classList.remove("tiw-mathtool-interaction_disable"):this._el.classList.add("tiw-mathtool-interaction_disable"),this.hasDeletePermission=this.permissionHandler.filter("Element::Delete::MathTool",void 0,!1),this.hasDeletePermission?this._el.classList.remove("tiw-mathtool-delete_disable"):this._el.classList.add("tiw-mathtool-delete_disable")},e.prototype.hideElement=function(){this._el.remove()},e.prototype.remove=function(){this._el.remove()},e.prototype.showElement=function(){this.container.contains(this._el)||this.container.appendChild(this._el),this._el.style.display="flex"},e.prototype.createElement=function(){this._el=document.createElement("div"),this._el.innerHTML=this.getHtml(),this.initEventType(),this.setElStyle(),this.calcRotateAnchor(),this.calcResizeAnchor(),this.setMoveHandler(),this.setRotateHandler(),this.setCloseHandler(),this.setResizeHandler(),this.setLineStyleBtnHandler(),this.setAngleMeasureHandler(),this.setAngleSwitchHandler(),this.setCompassesRotateResizehandler(),this.setAngleToggleDisplay(),this.processBtnActiveStyle(),this.setCompassesDrawArcHandler()},e.prototype.initEventType=function(){vt()?this._eventName=["pointerdown","pointermove","pointerup"]:this._eventName=gt()?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup"]},e.prototype.getEventLocation=function(t,e,r,i){void 0===r&&(r=!1),void 0===i&&(i=!0);var o,n,a={x:0,y:0,ox:0,oy:0},s=null;i&&(s=e.getBoundingClientRect());var l=this.store.getContainerScale();if(o=(t.pageX-s.left-e.ownerDocument.defaultView.pageXOffset)/l,n=(t.pageY-s.top-e.ownerDocument.defaultView.pageYOffset)/l,t.changedTouches&&!r){var c=null,h={x:-1e6,y:-1e6,ox:-1e6,oy:-1e6};if("touchstart"===t.type){if(null!==is&&1!==t.touches.length)return h;is=t.changedTouches[0].identifier,c=t.changedTouches[0]}else if("touchmove"===t.type){for(var u=0;u<t.changedTouches.length;u++)if(t.changedTouches[u].identifier===is){c=t.changedTouches[u];break}if(!c)return h}else if("touchend"===t.type||"touchcancel"===t.type){for(u=0;u<t.changedTouches.length;u++)if(t.changedTouches[u].identifier===is){c=t.changedTouches[u];break}if(!c&&0!==t.touches.length)return h;is=null}if(!c)return h;o=(c.pageX-s.left-e.ownerDocument.defaultView.pageXOffset)/l,n=(c.pageY-s.top-e.ownerDocument.defaultView.pageYOffset)/l,a.clientX=parseInt(c.clientX.toString()),a.clientY=parseInt(c.clientY.toString()),a.pageX=c.pageX,a.pageY=c.pageY}else if(r){var d=t.changedTouches[0];o=(d.pageX-s.left-e.ownerDocument.defaultView.pageXOffset)/l,n=(d.pageY-s.top-e.ownerDocument.defaultView.pageYOffset)/l,a.clientX=parseInt(d.clientX.toString()),a.clientY=parseInt(d.clientY.toString()),a.pageX=d.pageX,a.pageY=d.pageY}else o=(t.pageX-s.left-e.ownerDocument.defaultView.pageXOffset)/l,n=(t.pageY-s.top-e.ownerDocument.defaultView.pageYOffset)/l,a.clientX=parseInt(t.clientX.toString()),a.clientY=parseInt(t.clientY.toString()),a.pageX=t.pageX,a.pageY=t.pageY;return a.x=o,a.y=n,a.ox=t.pageX,a.oy=t.pageY,a},e.prototype.setLineStyleBtnHandler=function(){var t=this,e=this._el.querySelector(".tiw-style-change-btn");e&&e.addEventListener(this._eventName[0],(function(r){r.preventDefault(),r.stopPropagation();var i=function(r){r.preventDefault(),r.stopPropagation(),t.lineType===mn.TEDU_BOARD_LINE_TYPE_SOLID?t.lineType=mn.TEDU_BOARD_LINE_TYPE_DOTTED:t.lineType=mn.TEDU_BOARD_LINE_TYPE_SOLID,t._getStyleChangeBtnIcon(),e.removeEventListener(t._eventName[2],i,!0)};e.addEventListener(t._eventName[2],i,!0)}),!1)},e.prototype.checkInContainer=function(t,e){var r=e!==this._el&&this._el.contains(e);if(this.toolType===$a.RULER){var i=this.rotatePoint({x:this._x,y:this._y}),o=this.rotatePoint({x:this._x,y:this._y+this._height}),n=this.rotatePoint({x:this._x+this._width,y:this._y}),a=this.rotatePoint({x:this._x+this._width,y:this._y+this._height});return Dt([t.x,t.y],[[i.x,i.y],[o.x,o.y],[a.x,a.y],[n.x,n.y]])||r}if(this.toolType===$a.PROTRACTOR){var s=this.rotatePoint({x:this.rotateAnchor.x+1,y:this.rotateAnchor.y}),l={x:s.x-this.rotateAnchor.x,y:s.y-this.rotateAnchor.y},c={x:t.x-this.rotateAnchor.x,y:t.y-this.rotateAnchor.y};return l.x*c.y-l.y*c.x<0&&Lt(t.x,t.y,this.rotateAnchor.x,this.rotateAnchor.y)<=this._width/2||r}return this.toolType===$a.TRIANGLE||this.toolType===$a.ISOSCELES_TRIANGLE?(i=this.rotatePoint({x:this._x,y:this._y}),o=this.rotatePoint({x:this._x,y:this._y+this._height}),a=this.rotatePoint({x:this._x+this._width,y:this._y+this._height}),Dt([t.x,t.y],[[i.x,i.y],[o.x,o.y],[a.x,a.y]])||r):this.toolType===$a.COMPASSES?!!(e.classList.contains("tiw-compasses-leg")||e.classList.contains("tiw-rotate-resize-btn")||e.classList.contains("tiw-compasses-pen")||e.classList.contains("tiw-close-btn")||e.classList.contains("tiw-compasses-header")):void 0},e.prototype.setMoveHandler=function(){var t=this,r=0,i=0,o=0,n=0;vt()&&this._el.addEventListener("touchstart",(function(e){e.cancelable&&e.preventDefault();var r=document.body.getElementsByClassName("tx_board_canvas_box")[0],i=t.getEventLocation(e,r);t._callback(2,e,i)})),this._el.addEventListener(this._eventName[0],(function(a){if(t.hasInteractionPermission){var s=document.body.getElementsByClassName("tx_board_canvas_box")[0],l=t.getEventLocation(a,s);if(!t.checkInContainer(l,a.target)){t._el.style.pointerEvents="none";var c,h=document.elementFromPoint(a.pageX,a.pageY);return c="undefined"!=typeof PointerEvent&&a instanceof PointerEvent?new PointerEvent("pointerdown",a):window.TouchEvent&&a instanceof TouchEvent?new TouchEvent("touchstart",a):new MouseEvent("mousedown",a),is=null,null==h||h.dispatchEvent(c),void(t._el.style.pointerEvents="auto")}a.preventDefault(),a.stopPropagation();var u=Wt.getTimeStamp();if(!(u>t._lockTime||null!==t._pointerId)){t._lock=!0,t._lockTime=u,t._pointerId=t.getEventId(a),t._el.style.pointerEvents="auto",t._el.style.cursor="move",t.zIndex<e.ELEMENT_MAX_ZINDEX&&(++e.ELEMENT_MAX_ZINDEX,t.zIndex=e.ELEMENT_MAX_ZINDEX),t._el.style.zIndex="".concat(t.zIndex),o=t._x||0,n=t._y||0,r=l.x,i=l.y;var d=function(e){var a;if(e.preventDefault(),e.stopPropagation(),t._pointerId===t.getEventId(e))if(t._lock){var l=t.getEventLocation(e,s),c=l.x-r,h=l.y-i;c=(a=rs(t.calcValidDeltaData(c,h),2))[0],h=a[1],t._x=o+c,t._y=n+h,t.setPosition(),t._updateTextValue(""),t._callback(4)}else f()},p=function(a){var l;if(a.preventDefault(),a.stopPropagation(),t._pointerId===t.getEventId(a))if(t._pointerId=null,t._lock){t._lock=!1,t._lockTime=e.LOCK_RELEASE_TIMESTAMP,t._el.style.cursor="auto";var c=t.getEventLocation(a,s),h=c.x-r,u=c.y-i;h=(l=rs(t.calcValidDeltaData(h,u),2))[0],u=l[1],t._x=o+h,t._y=n+u,t.setPosition(),t.calcRotateAnchor(),t.calcResizeAnchor(),f(),t._callback(5)}else f()},f=function(){document.body.removeEventListener(t._eventName[1],d,!1),window.removeEventListener(t._eventName[2],p,!1)};t._callback(1),document.body.addEventListener(t._eventName[1],d,!1),window.addEventListener(t._eventName[2],p,!1)}}else t._el.style.pointerEvents="none",t._el.style.cursor="not-allowed",t.toolType===$a.COMPASSES&&t._el.querySelectorAll(".tiw-compasses-header, .tiw-compasses-leg, .tiw-compasses-pen").forEach((function(t){t.style.cursor="not-allowed"}))}),!1)},e.prototype._calcRotateDeg=function(t,e){var r=e.x-this.rotateAnchor.x,i=e.y-this.rotateAnchor.y,o=t.x-this.rotateAnchor.x,n=r*(t.y-this.rotateAnchor.y)-i*o,a=Lt(e.x,e.y,this.rotateAnchor.x,this.rotateAnchor.y),s=Lt(t.x,t.y,this.rotateAnchor.x,this.rotateAnchor.y),l=Lt(e.x,e.y,t.x,t.y),c=(Math.pow(a,2)+Math.pow(s,2)-Math.pow(l,2))/(2*a*s),h=180*Math.acos(c)/Math.PI;return n<0?-h:h},e.prototype.setRotateHandler=function(){var t=this,r=this._el.querySelector(".tiw-rotate-btn");if(r){var i=0,o=0,n=0;r.addEventListener(this._eventName[0],(function(r){r.preventDefault(),r.stopPropagation();var a=Wt.getTimeStamp();if(!(a>t._lockTime||null!==t._pointerId)){t._pointerId=t.getEventId(r),t._lock=!0,t._lockTime=a;var s=document.body.getElementsByClassName("tx_board_canvas_box")[0],l=t.getEventLocation(r,s);n=t.deg||0,i=l.x,o=l.y;var c=function(e){if(e.preventDefault(),e.stopPropagation(),t._pointerId===t.getEventId(e))if(t._lock){var r=t.getEventLocation(e,s),a=t._calcRotateDeg({x:r.x,y:r.y},{x:i,y:o});t._updateDeg((n+a+360)%360),t._callback(4)}else u()},h=function(r){if(r.preventDefault(),r.stopPropagation(),t._pointerId===t.getEventId(r))if(t._pointerId=null,t._lock){t._lock=!1,t._lockTime=e.LOCK_RELEASE_TIMESTAMP;var a=t.getEventLocation(r,s),l=t._calcRotateDeg({x:a.x,y:a.y},{x:i,y:o});t._updateDeg((n+l+360)%360),u(),t._callback(5)}else u()},u=function(){document.body.removeEventListener(t._eventName[1],c,!1),document.body.removeEventListener(t._eventName[2],h,!1)};t._callback(1),document.body.addEventListener(t._eventName[1],c,!1),document.body.addEventListener(t._eventName[2],h,!1)}}),!1)}},e.prototype.setCloseHandler=function(){var t=this,r=this._el.querySelector(".tiw-close-btn");r&&r.addEventListener(this._eventName[0],(function(i){i.preventDefault(),i.stopPropagation();var o=Wt.getTimeStamp();if(!(o>t._lockTime||null!==t._pointerId)){t._pointerId=t.getEventId(i),t._lock=!0,t._lockTime=o;var n=function(r){r.preventDefault(),r.stopPropagation(),t._pointerId===t.getEventId(r)&&(t._pointerId=null,t._lock?(t._lock=!1,t._lockTime=e.LOCK_RELEASE_TIMESTAMP,t.show=!1,t.visible=!0,t.render(t.container),t.reset(es(es({},t._initOptions),{show:!1,visible:!0})),a(),t._callback(5)):a())},a=function(){r.removeEventListener(t._eventName[2],n,!0)};r.addEventListener(t._eventName[2],n,!0)}}),!1)},e.prototype._calcSize=function(t,e){var r=this.deg/180*Math.PI,i=Math.sin(r),o=Math.cos(r),n=this.resizeAnchor.x-this.rotateAnchor.x,a=this.resizeAnchor.y-this.rotateAnchor.y,s=n*o-a*i+this.rotateAnchor.x,l=n*i+a*o+this.rotateAnchor.y,c=e.x-s,h=e.y-l,u=t.x-s,d=t.y-l,p=Math.sqrt(c*c+h*h);return(c*u+h*d)/p-p},e.prototype.setResizeHandler=function(){var t=this,r=this._el.querySelectorAll(".tiw-resize-btn");r&&r.forEach((function(r){var i=0,o=0,n=0,a=function(r,a){var s=0;if(t.toolType===$a.COMPASSES){var l=t.rotatePoint({x:i,y:o},-t.deg);s=t.rotatePoint(r,-t.deg).x-l.x}else s=t._calcSize(r,{x:i,y:o});!function(r){var i=2*t.shadowWidth*t.scaleX;t.toolType===$a.RULER?(t.size=Math.min(t.px2cm(t.boardWidth-i),Math.max(t.px2cm(e.RULER_MIN_WIDTH/1e4*t.boardWidth-i),t.px2cm(n+r-i))),t._width=t.cm2px(t.size)+i):t.toolType===$a.PROTRACTOR?(t._width=Math.min(Math.max(e.PROTRACTOR_MIN_WIDTH/1e4*t.boardWidth,n+2*r),t.boardWidth-i),t._height=t._width/2):t.toolType===$a.TRIANGLE?(t._width=Math.min(Math.max(e.TRIANGLE_MIN_WIDTH/1e4*t.boardWidth,n+r),t.boardWidth-i),t._height=t._width*Math.tan(t.toolAngle/180*Math.PI)):t.toolType===$a.ISOSCELES_TRIANGLE&&(t._width=Math.min(Math.max(e.ISOSCELES_TRIANGLE_MIN_WIDTH/1e4*t.boardWidth,n+r),t.boardWidth-i),t._height=t._width*Math.tan(t.toolAngle/180*Math.PI))}(s),t.adjustPositionWhenResize(a),t.setToolSize(a),t._updateCompassesRadius(!a)};r.addEventListener(t._eventName[0],(function(r){r.preventDefault(),r.stopPropagation();var s=Wt.getTimeStamp();if(!(s>t._lockTime||null!==t._pointerId)){t._pointerId=t.getEventId(r),t._lock=!0,t._lockTime=s;var l=document.body.getElementsByClassName("tx_board_canvas_box")[0],c=t.getEventLocation(r,l);n=t._width||0,i=c.x,o=c.y;var h=function(e){if(e.preventDefault(),e.stopPropagation(),t._pointerId===t.getEventId(e))if(t._lock){var r=t.getEventLocation(e,l);a(r,!1),t._callback(4)}else d()},u=function(r){if(r.preventDefault(),r.stopPropagation(),t._pointerId===t.getEventId(r))if(t._pointerId=null,t._lock){t._lock=!1,t._lockTime=e.LOCK_RELEASE_TIMESTAMP;var i=t.getEventLocation(r,l);a(i,!0),d(),t._callback(5)}else d()},d=function(){document.body.removeEventListener(t._eventName[1],h,!1),document.body.removeEventListener(t._eventName[2],u,!1)};t._callback(1),document.body.addEventListener(t._eventName[1],h,!1),document.body.addEventListener(t._eventName[2],u,!1)}}),!1)}))},e.prototype.setCompassesRotateResizehandler=function(){var t=this,r=this._el.querySelector(".tiw-rotate-resize-btn");if(r){var i=0,o=0,n=function(r,n){var a=t._compassesLegLength,s=180/e.COMPASSES_LEG_LENGTH,l=t.rotatePoint({x:i,y:o},-t.deg);!function(e){var r=t._compassesLegLength,i=t._compassesLegAnchorOffset;t._width=Math.min(2*(r*Math.sin(75/180*Math.PI)+i),Math.max(2*(r*Math.sin(2/180*Math.PI)+i),t._width+e)),t._height=Math.sqrt(r*r-(t._width/2-i)*(t._width/2-i))+t._compassesHeaderLength,t.compassesLegAngle=Math.asin((t._width/2-i)/r)/Math.PI*180}((t.rotatePoint({x:r.x,y:r.y},-t.deg).x-l.x)/(.5+.5*s)),t.adjustPositionWhenResize(n),t.setToolSize(n);var c=(90-t.compassesLegAngle)/180*Math.PI,h=t._compassesResizeBtnOffset,u=h*Math.sin(c),d=h*Math.cos(c),p=t.rotatePoint({x:t.rotateAnchor.x+a*Math.cos(c)*(1+s)+u,y:t.rotateAnchor.y-a*Math.sin(c)*(1-s)-d},t.deg),f=Math.sqrt(Math.pow(p.x-t.rotateAnchor.x,2)+Math.pow(p.y-t.rotateAnchor.y,2)),g=Math.sqrt(Math.pow(r.x-t.rotateAnchor.x,2)+Math.pow(r.y-t.rotateAnchor.y,2)),m={x:(r.x-t.rotateAnchor.x)/g*f+t.rotateAnchor.x,y:(r.y-t.rotateAnchor.y)/g*f+t.rotateAnchor.y},y=t._calcRotateDeg(m,p);isNaN(y)||t._updateDeg((t.deg+y+360)%360),i=p.x,o=p.y,t._updateCompassesRadius(!n)};r.addEventListener(this._eventName[0],(function(r){r.preventDefault(),r.stopPropagation();var a=document.body.getElementsByClassName("tx_board_canvas_box")[0],s=t.getEventLocation(r,a);i=s.x,o=s.y;var l=Wt.getTimeStamp();if(!(l>t._lockTime||null!==t._pointerId)){t._pointerId=t.getEventId(r),t._lock=!0,t._lockTime=l;var c=function(e){if(e.preventDefault(),e.stopPropagation(),t._pointerId===t.getEventId(e))if(t._lock){var r=t.getEventLocation(e,a);n(r,!1),t._callback(4)}else u()},h=function(r){if(r.preventDefault(),r.stopPropagation(),t._pointerId===t.getEventId(r))if(t._pointerId=null,t._lock){t._lock=!1,t._lockTime=e.LOCK_RELEASE_TIMESTAMP;var i=t.getEventLocation(r,a);n(i,!0),u(),t._callback(5)}else u()},u=function(){document.body.removeEventListener(t._eventName[1],c,!1),document.body.removeEventListener(t._eventName[2],h,!1)};t._callback(1),document.body.addEventListener(t._eventName[1],c,!1),document.body.addEventListener(t._eventName[2],h,!1)}}),!1)}},e.prototype.setAngleMeasureHandler=function(){var t=this;if(this.toolType===$a.PROTRACTOR){var r=this._el.querySelector(".baseline"),i=this._el.querySelector(".testline"),o=this._el.querySelector(".baseline-container"),n=this._el.querySelector(".testline-container"),a=function(r,i){if(r){var a=0,s=0,l=0;r.addEventListener(t._eventName[0],(function(r){r.preventDefault(),r.stopPropagation();var c=Wt.getTimeStamp();if(!(c>t._lockTime||null!==t._pointerId)){t._pointerId=t.getEventId(r),t._lock=!0,t._lockTime=c;var h=document.body.getElementsByClassName("tx_board_canvas_box")[0],u=t.getEventLocation(r,h),d=null,p=0;"baseline"===i?(d=o,l=t.baseAngle):(d=n,l=t.testAngle),a=u.x,s=u.y;var f=function(e){if(e.preventDefault(),e.stopPropagation(),t._pointerId===t.getEventId(e))if(t._lock){var r=t.getEventLocation(e,h),o=t._calcRotateDeg({x:r.x,y:r.y},{x:a,y:s});if(!(Math.abs(p-o)>=180)){var n=l+Math.round(o);p=o,t.setMeasureAngle(Math.min(0,Math.max(n,-180)),d,i),e.target.parentElement.classList.add("measure-line-moving"),t._callback(4)}}else m()},g=function(r){if(r.preventDefault(),r.stopPropagation(),t._pointerId===t.getEventId(r))if(t._pointerId=null,t._lock){t._lock=!1,t._lockTime=e.LOCK_RELEASE_TIMESTAMP;var o=t.getEventLocation(r,h),n=t._calcRotateDeg({x:o.x,y:o.y},{x:a,y:s});if(Math.abs(p-n)<180){var c=l+Math.round(n);t.setMeasureAngle(Math.min(0,Math.max(c,-180)),d,i)}m(),t._callback(5)}else m()},m=function(){o.classList.remove("measure-line-moving"),n.classList.remove("measure-line-moving"),document.body.removeEventListener(t._eventName[1],f,!1),document.body.removeEventListener(t._eventName[2],g,!1)};document.body.addEventListener(t._eventName[1],f,!1),document.body.addEventListener(t._eventName[2],g,!1)}}),!1)}};r&&a(r,"baseline"),i&&a(i,"testline")}},e.prototype.setMeasureAngle=function(t,e,r){var i=e.style.transform;e.style.transform=i.replace(/rotate\(.*?\)/i,"rotate(".concat(t,"deg)")),"baseline"===r?this.baseAngle=t:this.testAngle=t,this.measureAngle=Math.abs(this.baseAngle-this.testAngle);var o=this._el.querySelector(".draw-angle-arc"),n=this._el.querySelector(".tiw-mathtool-protractor-angle");if(n&&o){var a=this.measureAngle/180*Math.PI,s=Math.sin(-a),l=Math.cos(-a),c={x:20*l-0*s+20,y:20*s+0*l+20};o.setAttribute("d","M39 19 A20 20 0 0 0 ".concat(c.x," ").concat(c.y)),n.style.transform="rotate(".concat(Math.max(this.baseAngle,this.testAngle),"deg)")}this._updateMeasureAngle()},e.prototype._updateMeasureAngle=function(){var t=this,e=this._el.querySelector(".baseline-container");this._el.querySelector(".testline-container").style.setProperty("--angle","".concat(this.testAngle,"deg")),e.style.setProperty("--angle","".concat(this.baseAngle,"deg")),this._el.querySelectorAll(".tiw-protractor-measure-line-l").forEach((function(e){e.firstElementChild.innerText=t.measureAngle+"°"}))},e.prototype._calcInnerTriangle=function(){var t=this.toolAngle/180*Math.PI,e=this._width*(1-this.shadowWidth*this.scaleX/this._height)-this.shadowWidth*this.scaleX*(1+1/Math.sin(t)),r=e*Math.tan(t),i=e/Math.cos(t);this.innerTriangleEdgeLen=[Math.round(e),Math.round(r),Math.round(i)]},e.prototype.calcRotateAnchor=function(){this.toolType===$a.RULER?this.rotateAnchor={x:this._x,y:this._y}:this.toolType===$a.PROTRACTOR?this.rotateAnchor={x:this._x+this._width/2,y:this._y+this._height}:this.toolType===$a.TRIANGLE||this.toolType===$a.ISOSCELES_TRIANGLE?this.rotateAnchor={x:this._x,y:this._y+this._height}:this.toolType===$a.COMPASSES&&(this.rotateAnchor={x:this._x+this._compassesLegAnchorOffset,y:this._y+this._height})},e.prototype.calcResizeAnchor=function(t){void 0===t&&(t=!1);var e=null;return this.toolType===$a.RULER?e={x:this._x,y:this._y+this._height/2}:this.toolType===$a.PROTRACTOR?e={x:this._x+this._width/2,y:this._y+this._height}:this.toolType===$a.TRIANGLE||this.toolType===$a.ISOSCELES_TRIANGLE?e={x:this._x,y:this._y+this._height}:this.toolType===$a.COMPASSES&&(e={x:this._x+this._compassesLegAnchorOffset,y:this._y+this._height}),!t&&e&&(this.resizeAnchor=e),e},e.prototype.setPosition=function(t,e,r){var i;void 0===t&&(t=void 0),void 0===e&&(e=void 0),void 0===r&&(r=!1),void 0!==t&&void 0!==e&&(t=(i=rs(this.calcValidDeltaData(t,e),2))[0],e=i[1],this._x+=t,this._y+=e);var o=this._el.style.transform;this._el.style.transform=o.replace(/translate\(.*?\)/i,"translate(".concat(this._x,"px, ").concat(this._y,"px)")),r&&(this.calcResizeAnchor(),this.calcRotateAnchor())},e.prototype.setRotate=function(){var t=this._el.style.transform;this._el.style.transform=t.replace(/rotate\(.*?\)/i,"rotate(".concat(this.deg,"deg)")),this._el.style.setProperty("--rotateAngle","".concat(-this.deg,"deg"))},e.prototype.adjustPositionWhenResize=function(t){void 0===t&&(t=!1);var e=this.calcResizeAnchor(!0);if(e){var r=e.x-this.resizeAnchor.x,i=e.y-this.resizeAnchor.y;t?(this._x-=r,this._y-=i,this._compassMovingXY=null,this.setPosition()):(this._compassMovingXY={x:(this._x-r)/this.boardWidth*1e4,y:(this._y-i)/this.boardHeight*1e4},this._x-=r,this._y-=i,this.setPosition())}},e.prototype.setToolSize=function(t){var e=this;void 0===t&&(t=!1),this.toolType===$a.RULER&&this.boardWidth<this.boardHeight&&(this.height=this.boardWidth/this.boardHeight*1.2*750),this._el.style.width=this._width+"px",this._el.style.height=this._height+"px",this.setScale(),this.toolType===$a.RULER?(this.size=this.px2cm(this._width-2*this.shadowWidth*this.scaleX),this._el.querySelectorAll(".tiw-geraduation-box").forEach((function(t){t.innerHTML=e.updateLineGeraduation()}))):this.toolType===$a.PROTRACTOR?this._el.style.setProperty("--protractorWidth",this._width+"px"):this.toolType===$a.TRIANGLE||this.toolType===$a.ISOSCELES_TRIANGLE?(this._calcInnerTriangle(),this._el.style.setProperty("--triangleWidth","".concat(this._width,"px")),this._el.style.setProperty("--triangleHeight","".concat(this._height,"px")),this._el.style.setProperty("--triangleHypotenuseWidth","".concat(Math.round(Math.sqrt(this._width*this._width+this._height*this._height)),"px")),this._el.style.setProperty("--innerTriangleWidth","".concat(this.innerTriangleEdgeLen[0],"px")),this._el.style.setProperty("--innerTriangleHeight","".concat(this.innerTriangleEdgeLen[1],"px")),this._el.style.setProperty("--innerTriangleHypotenuseWidth","".concat(this.innerTriangleEdgeLen[2],"px")),this._el.querySelectorAll(".tiw-geraduation-box").forEach((function(t,r){t.innerHTML=e.updateLineGeraduation(e.px2cm(e.innerTriangleEdgeLen[r])+e.sizeClipper[r],t.classList.contains("tiw-ruler-vertical"))}))):this.toolType===$a.COMPASSES&&(this._el.style.setProperty("--compassesLegAngle","".concat(this.compassesLegAngle,"deg")),this._el.style.setProperty("--compassesLegAnchorOffset","".concat(this._compassesLegAnchorOffset,"px"))),t&&(this.calcResizeAnchor(),this.calcRotateAnchor())},e.prototype.setScale=function(){var t;this.scaleX=this.boardWidth/this.originContainerWidth,this.scaleY=this.boardHeight/this.originContainerHeight;var r=rs([.015,12,24],3),i=r[0],o=r[1],n=r[2];this.boardWidth<this.boardHeight&&(i=(t=rs([.01,24,36],3))[0],o=t[1],n=t[2]),this.shadowWidth=i*Math.min(this.originContainerHeight,this.originContainerWidth),this._el&&(this._el.style.setProperty("--scaleX","".concat(this.scaleX)),this._el.style.setProperty("--scaleY","".concat(this.scaleY)),this._el.style.setProperty("--unitLen","".concat(this.cm2px(1),"px")),this._el.style.setProperty("--shadowWidth","".concat(this.shadowWidth,"px")),this._el.style.setProperty("--calibrationScale","".concat(e.CALIBRATION_SIZE*Math.min(this.boardHeight,this.boardWidth)/o)),this._el.style.setProperty("--calibrationSize","".concat(e.CALIBRATION_SIZE*Math.min(this.boardHeight,this.boardWidth),"px")),this._el.style.setProperty("--buttonScale","".concat(e.BUTTON_SIZE*Math.min(this.boardHeight,this.boardWidth)/n)))},e.prototype.rotatePoint=function(t,e){var r=t.x,i=t.y;void 0===e&&(e=this.deg);var o=e/180*Math.PI,n=Math.sin(o),a=Math.cos(o),s=r-this.rotateAnchor.x,l=i-this.rotateAnchor.y;return{x:s*a-l*n+this.rotateAnchor.x,y:s*n+l*a+this.rotateAnchor.y}},e.prototype.getCollisionArea=function(){var t=this.rotatePoint({x:this._x,y:this._y}),e=this.rotatePoint({x:this._x+this._width,y:this._y}),r=this.rotatePoint({x:this._x,y:this._y+this._height}),i=this.rotatePoint({x:this._x+this._width,y:this._y+this._height});switch(this.toolType){case $a.RULER:return[[t.x,t.y,e.x,e.y,-Math.PI/2],[r.x,r.y,i.x,i.y,Math.PI/2]];case $a.TRIANGLE:case $a.ISOSCELES_TRIANGLE:return[[t.x,t.y,r.x,r.y,Math.PI/2],[r.x,r.y,i.x,i.y,Math.PI/2],[t.x,t.y,i.x,i.y,-Math.PI/2]];default:return[]}},e.prototype.getHtml=function(){var t="";switch(this.toolType){case $a.RULER:t=this.getRuler();break;case $a.TRIANGLE:case $a.ISOSCELES_TRIANGLE:t=this.getTriangleRuler();break;case $a.PROTRACTOR:t=this.getProtractor();break;case $a.COMPASSES:t=this.getCompasses()}return t},e.prototype.getCompasses=function(){return'\n      <div class="tiw-scale-container">\n        <div class="tiw-compasses-header">\n          <div class="tiw-btn__icon tiw-interaction__btn tiw-close-btn"></div>\n        </div>\n        <div class="tiw-compasses-body">\n          <div class="tiw-compasses-body__left">\n            <div class="tiw-btn__icon tiw-compasses-leg tiw-interaction__btn"></div>\n          </div>\n          <div class="tiw-compasses-body__right">\n            <div class="tiw-btn__icon tiw-compasses-leg tiw-interaction__btn"></div>\n            <div class="tiw-btn__icon tiw-compasses-pen tiw-interaction__btn">\n              <svg style="pointer-events:none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 168" width="50" height="168" class="design-iconfont"><defs><filter x="-7.5%" y="-12.5%" width="115%" height="125%" filterUnits="objectBoundingBox" id="be2anvlpf__71njm78afb"><feOffset dy="-3" in="SourceAlpha" result="shadowOffsetInner1"/><feComposite in="shadowOffsetInner1" in2="SourceAlpha" operator="arithmetic" k2="-1" k3="1" result="shadowInnerInner1"/><feColorMatrix values="0 0 0 0 0.239215686 0 0 0 0 0.290196078 0 0 0 0 0.4 0 0 0 0.08 0" in="shadowInnerInner1" result="shadowMatrixInner1"/><feOffset dy="2" in="SourceAlpha" result="shadowOffsetInner2"/><feComposite in="shadowOffsetInner2" in2="SourceAlpha" operator="arithmetic" k2="-1" k3="1" result="shadowInnerInner2"/><feColorMatrix values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.2 0" in="shadowInnerInner2" result="shadowMatrixInner2"/><feMerge><feMergeNode in="shadowMatrixInner1"/><feMergeNode in="shadowMatrixInner2"/></feMerge></filter><filter x="-2.1%" y="-.7%" width="104.2%" height="101.4%" filterUnits="objectBoundingBox" id="be2anvlpf__7117o75o1d"><feOffset dy="2" in="SourceAlpha" result="shadowOffsetInner1"/><feComposite in="shadowOffsetInner1" in2="SourceAlpha" operator="arithmetic" k2="-1" k3="1" result="shadowInnerInner1"/><feColorMatrix values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.19 0" in="shadowInnerInner1"/></filter><path d="M16,0 C21.5228475,-1.01453063e-15 26,4.4771525 26,10 L26,12 L26,12 L6,12 L6,10 C6,4.4771525 10.4771525,1.01453063e-15 16,0 Z" id="be2anvlpf__bw7yndwtna"/><path d="M26,12 L26.2249383,12.0041385 C29.4344251,12.1224282 32,14.7616031 32,18 L32,18 L31.9995603,42.5744401 C32.1435418,48.2840871 34.5824374,51.9313451 38.6581569,54.9936085 C44.339078,59.3813973 48,66.2631716 48,74 C48,81.733197 44.3425139,88.6121423 38.6630177,93.0013599 C34.4623477,96.1578975 32,99.9378986 32,105.960182 L32,105.960182 L32,119.012002 C32,128.508957 27.7816637,137.51528 20.4859008,143.595083 L20.4859008,143.595083 L8,154 L2.72848411e-12,154 L2.72848411e-12,18 C2.72848411e-12,14.6862915 2.6862915,12 6,12 L6,12 L26,12 Z" id="be2anvlpf__0ol57t2anc"/></defs><g fill="none" fill-rule="evenodd"><g transform="translate(1 1)"><use fill-opacity=".88" fill="#C3CDDB" xlink:href="#be2anvlpf__bw7yndwtna"/><use fill="#000" filter="url(#be2anvlpf__71njm78afb)" xlink:href="#be2anvlpf__bw7yndwtna"/></g><g transform="translate(1 1)"><use fill-opacity=".88" fill="#DAE0EB" xlink:href="#be2anvlpf__0ol57t2anc"/><use fill="#000" filter="url(#be2anvlpf__7117o75o1d)" xlink:href="#be2anvlpf__0ol57t2anc"/></g><path d="M12,20 C13.1045695,20 14,20.8954305 14,22 L14,38 C14,39.1045695 13.1045695,40 12,40 C10.8954305,40 10,39.1045695 10,38 L10,22 C10,20.8954305 10.8954305,20 12,20 Z M20,20 C21.1045695,20 22,20.8954305 22,22 L22,38 C22,39.1045695 21.1045695,40 20,40 C18.8954305,40 18,39.1045695 18,38 L18,22 C18,20.8954305 18.8954305,20 20,20 Z" fill-opacity=".6" fill="#C2CCD8" transform="translate(1 1)"/><path d="M16,-0.5 C18.8994949,-0.5 21.5244949,0.675252532 23.4246212,2.5753788 C25.3247475,4.47550506 26.5,7.10050506 26.5,10 L26.5,10 L26.5,11.5332268 C28.0979647,11.6951165 29.494722,12.3692068 30.5371788,13.3732748 C31.7092726,14.5022058 32.4350305,16.0494315 32.4958602,17.7659943 L32.4958602,17.7659943 L32.4995593,42.5680611 C32.6407456,48.0990269 35.0112485,51.6281262 38.9637928,54.5978981 C44.7629899,59.07704 48.5,66.1021343 48.5,74 C48.5,81.8941605 44.7665122,88.91638 38.9633851,93.401084 C34.9857942,96.3899919 32.6093952,99.9530529 32.5038071,105.553169 L32.5038071,105.553169 L32.5,119.012002 C32.5,128.488136 28.3647495,137.483299 21.1872219,143.65644 L21.1872219,143.65644 L8.40791585,154.31089 L4.07588766,163.841352 C3.84631548,164.346411 3.47973668,164.761073 3.03185437,165.04947 C2.58397205,165.337867 2.05478623,165.5 1.5,165.5 C0.982587653,165.5 0.511090974,165.303486 0.155985321,164.981104 C-0.208522417,164.650186 -0.450092024,164.186503 -0.493132378,163.666606 L-0.493132378,163.666606 L-0.5,18 C-0.5,16.2491745 0.192239057,14.6600375 1.31791982,13.4913182 C2.35369226,12.4159447 3.7564756,11.6966347 5.32461179,11.5346896 L5.32461179,11.5346896 L5.50003734,9.97169592 C5.50765837,7.08342445 6.68143728,4.46932032 8.5753788,2.5753788 C10.4755051,0.675252532 13.1005051,-0.5 16,-0.5 Z" stroke-opacity=".6" stroke="var(--compassesPenStrokeColor)" transform="translate(1 1)"/><path d="M17,0 C23.0751322,0 28,4.92486775 28,11 L28,11 L28,12.071 L28.2188128,12.1058196 C31.3424651,12.6544783 33.7523372,15.2745289 33.9825371,18.5126698 L33.9825371,18.5126698 L33.9956923,18.7566666 L34,19.0000179 L33.9992425,43.5492308 C34.126418,48.5924273 36.0916992,52.0631691 40.2694287,55.2021877 C46.3599673,59.906354 50,67.1535639 50,75 C50,82.8434959 46.3628165,90.0874567 40.2637525,94.8008082 C36.0651294,97.9558077 34.0999419,101.459546 34.0037634,106.562378 L34.0037634,106.562378 L34,106.960182 L34,120.012002 C34,129.627916 29.8056996,138.763542 22.5131879,145.035617 L22.5131879,145.035617 L22.1260852,145.363304 L9.815,155.622 L5.53107089,165.048253 C5.01922724,166.174309 3.92861021,166.918492 2.70507654,166.993707 L2.70507654,166.993707 L2.5,167 C1.20871927,167 0.133485608,166.017208 0.0079943474,164.691939 L0.0079943474,164.691939 L0,164.5 L0,143 L1,143 L1,164.5 L1.00686658,164.64446 C1.07955132,165.405112 1.72030388,166 2.5,166 C3.41350071,166 4.24269513,165.466071 4.62070442,164.63445 L4.62070442,164.63445 L9,155 L21.4859008,144.595083 L21.8670406,144.272404 C28.9283771,138.199118 33,129.342343 33,120.012002 L33,120.012002 L33,106.960182 L33.0038071,106.553028 C33.1128228,100.766402 35.5578175,97.086158 39.6630177,94.0013599 C45.3425139,89.6121423 49,82.733197 49,75 C49,67.2631716 45.339078,60.3813973 39.6581569,55.9936085 C35.5824374,52.9313451 33.1435418,49.2840871 32.9995603,43.5744401 L32.9995603,43.5744401 L33,19 L32.9958615,18.7750617 C32.8803227,15.6402141 30.3597859,13.1196773 27.2249383,13.0041385 L27.2249383,13.0041385 L27,13 L27,11 C27,5.4771525 22.5228475,1 17,1 C11.4771525,1 7,5.4771525 7,11 L7,11 L7,13 L6.77506174,13.0041385 C3.56557489,13.1224282 1,15.7616031 1,19 L1,19 L1,22 L0,22 L0,19 C0,15.6364512 2.37666054,12.8145863 5.57067968,12.1483652 L5.8117393,12.1024656 L6,12.073 L6,11 C6,5.02129842 10.7697636,0.15663482 16.7115925,0.00370740462 L16.7115925,0.00370740462 Z" fill-opacity=".6" fill="var(--compassesPenPartialStrokeColor)" fill-rule="nonzero"/><path d="M0,154 L0,163.5 C1.01453063e-16,164.328427 0.671572875,165 1.5,165 C2.41350071,165 3.24269513,164.466071 3.62070442,163.63445 L8,154 L8,154 L0,154 Z" fill="var(--brushColor)" transform="translate(1 1)"/></g></svg> \n            </div>\n            <div class="tiw-btn__icon tiw-interaction__btn tiw-rotate-resize-btn"></div>\n          </div>\n        </div>\n      </div>\n      <div class="tiw-compasses-text__radius tiw-mathtool-hide"></div>\n    '},e.prototype.getRuler=function(){var t=this.generateGeraduationBox(!1,!1),e=this.generateGeraduationBox(!1,!0);return t+this.getButtonBox()+e},e.prototype.getTriangleRuler=function(){return this.getShadowContainer()+this.generateGeraduationBox(!1,!0,!1,"triangle-bottom",this.px2cm(this.innerTriangleEdgeLen[0])+this.sizeClipper[0])+this.generateGeraduationBox(!0,!1,!1,"",this.px2cm(this.innerTriangleEdgeLen[1])+this.sizeClipper[1])+this.generateGeraduationBox(!1,!1,!0,"",this.px2cm(this.innerTriangleEdgeLen[2])+this.sizeClipper[2])+this.getButtonBox()},e.prototype.getProtractor=function(){var t=this.generateGeraduationBox(),e=this.getButtonBox();return t+this.getAngleLineBox()+this.getAnchorBox()+this.getRotateMsgBox()+e},e.prototype.getAngleLineBox=function(){var t='<ul class="tiw-protractor-measure-line">';return t+='<li class="tiw-protractor-measure-line-l baseline-container" style="--angle:'.concat(this.baseAngle,'deg"><div class="baseline">').concat(this.measureAngle,"°</div></li>"),(t+='<li class="tiw-protractor-measure-line-l testline-container" style="--angle:'.concat(this.testAngle,'deg"><div class="testline">').concat(this.measureAngle,"°</div></li>"))+"</ul>"},e.prototype.getAnchorBox=function(){return'<div class="tiw-mathtool-protractor-anchor"></div>'},e.prototype.getRotateMsgBox=function(){return'<div class="tiw-mathtool-protractor-angle">\n      <svg xmlns="http://www.w3.org/2000/svg" width="40" height="20">\n        <path class="draw-angle-arc" d="M39 19 A20 20 0 0 0 37.32 10" stroke="green" stroke-width="1" fill="transparent"/>\n      </svg>\n    </div>'},e.prototype.getButtonBox=function(){var t="";return this.toolType===$a.RULER?t+='<div class="tiw-ruler-btn-box">\n      <div class="tiw-btn__icon tiw-interaction__btn tiw-close-btn"></div>\n      <div class="tiw-btn__icon tiw-interaction__btn tiw-style-change-btn"></div>\n      <div class="tiw-btn__icon tiw-angle__icon">'.concat(os,'</div>\n      <div class="tiw-mathtool-value__cm-angle tiw-mathtool-hide"></div>\n      <div class="tiw-btn__icon tiw-interaction__btn tiw-rotate-btn"></div>\n      <div class="tiw-btn__icon tiw-interaction__btn tiw-resize-btn"></div>\n    </div>'):this.toolType===$a.TRIANGLE||this.toolType===$a.ISOSCELES_TRIANGLE?t+='<div class="tiw-triangle-btn-box">\n                <div class="tiw-btn__icon tiw-interaction__btn tiw-close-btn"></div>\n                <div class="tiw-btn__icon tiw-interaction__btn tiw-style-change-btn"></div>\n                <div class="tiw-btn__icon tiw-interaction__btn tiw-resize-btn"></div>\n                <div class="tiw-btn__icon tiw-interaction__btn tiw-rotate-btn"></div>\n                <div class="tiw-btn__icon tiw-angle__icon">'.concat(os,'</div>\n              </div>\n            <div class="tiw-mathtool-value__cm-angle tiw-mathtool-hide"></div>\n      '):this.toolType===$a.PROTRACTOR&&(t+='<div class="tiw-protractor-btn-box">\n        <div class="tiw-btn__icon tiw-interaction__btn tiw-rotate-btn"></div>\n        <div class="tiw-btn__icon tiw-interaction__btn tiw-close-btn"></div>\n        <div class="tiw-btn__icon tiw-interaction__btn tiw-resize-btn"></div>\n      </div>'),t},e.prototype.getShadowContainer=function(){return'\n      <div class="tiw-mathtool-triangle-shadow-container"></div>\n      <div class="tiw-mathtool-triangle-inner-shadow-container"></div>\n    '},e.prototype.generateGeraduationBox=function(t,e,r,i,o){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===r&&(r=!1),void 0===i&&(i=""),void 0===o&&(o=this.size);var n="";switch(this.toolType){case $a.RULER:n=this.generateLineGeraduation(t,e);break;case $a.PROTRACTOR:n=this.generateProtractorGeraduation();break;case $a.TRIANGLE:case $a.ISOSCELES_TRIANGLE:n=this.generateLineGeraduation(t,e,r,i,o)}return n},e.prototype.generateLineGeraduation=function(t,e,r,i,o){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===r&&(r=!1),void 0===i&&(i=""),void 0===o&&(o=this.size);var n="";return n+='<ul class="tiw-geraduation-box'.concat(e?" tiw-ruler-reverse":"").concat(t?" tiw-ruler-vertical":"").concat(r?" tiw-ruler-hypotenuse":""," ").concat(i,'">'),(n+=this.updateLineGeraduation(o,t))+"</ul>"},e.prototype.updateLineGeraduation=function(t,e){void 0===t&&(t=this.size),void 0===e&&(e=!1);for(var r="",i=9,o=0;o<=t;o++){r+='<li class="tiw-ruler-calibration tiw-ruler-cm" data-value="'.concat(e&&0===o?"":o,'"></li>'),o===Math.floor(t)&&(i=Math.floor((t-Math.floor(t))/.1));for(var n=0;n<i;n++)r+='<li class="tiw-ruler-calibration tiw-ruler-mm'.concat(4===n?" tiw-ruler-5mm":"",'"></li>')}return r},e.prototype.generateProtractorGeraduation=function(){var t="";t+='<div class="tiw-mathtool-protractor-outer-container"><ul class="tiw-protractor-line-container">';for(var e=0;e<=180;e++)t+=e%10==0?'<li class="tiw-protractor-line tiw-protractor-line-2l" style="transform: rotate('.concat(e,'deg)" data-value="').concat(e,'"></li>'):e%5==0?'<li class="tiw-protractor-line tiw-protractor-line-l" style="transform: rotate('.concat(e,'deg)" data-value="').concat(e,'"></li>'):'<li class="tiw-protractor-line" style="transform: rotate('.concat(e,'deg)"></li>');for(t+="</ul></div>",t+='<div class="tiw-mathtool-protractor-inner-container"><ul class="tiw-protractor-line-inner-container">',e=0;e<=180;e+=10)t+='<li class="tiw-protractor-line tiw-protractor-line-2l" style="transform: rotate('.concat(e,'deg)" data-value="').concat(180-e,'"></li>');return t+"</ul></div>"},e.prototype.setRealCmValue=function(t){this._cmValue=t,this._updateTextValue(t+"cm")},e.prototype._updateDeg=function(t){this.deg=t,this.setRotate(),this._updateTextValue("∠ "+this.deg.toFixed(1)+"°")},e.prototype._getStyleChangeBtnIcon=function(){this.setLineType(this.lineType)},e.prototype._getAngleBtnIcon=function(){},e.prototype.setBoardSize=function(t,r){if(t!==this.boardWidth||r!==this.boardHeight){var i=t/r!=this.boardWidth/this.boardHeight;if(this.toolType===$a.COMPASSES&&t<r?(this.boardWidth=t/2,this.boardHeight=r/2):(this.boardWidth=t,this.boardHeight=r),i&&(this.boardHeight>this.boardWidth?(this.originContainerWidth=1440*this.boardWidth/this.boardHeight,this.originContainerHeight=1440):(this.originContainerWidth=1440,this.originContainerHeight=1440*this.boardHeight/this.boardWidth),this.compassesLegLength=e.COMPASSES_LEG_LENGTH/this.originContainerHeight*1e4,this.compassesLegAnchorOffset=e.COMPASSES_ANCHOR_OFFSET/this.originContainerWidth*1e4,this.compassesResizeBtnOffset=e.COMPASSES_RESIZE_BTN_OFFSET/this.originContainerWidth*1e4,this.compassesHeaderLength=e.COMPASSES_HEADER_LENGTH/this.originContainerHeight*1e4),this.toolType===$a.COMPASSES){var o=this._compassesLegLength,n=this._compassesLegAnchorOffset;this._height=Math.sqrt(o*o-(this._width/2-n)*(this._width/2-n))+this._compassesHeaderLength,this.compassesLegAngle=Math.asin((this._width/2-n)/o)/Math.PI*180}else this.toolType===$a.TRIANGLE?(this._width=Math.min(Math.max(e.TRIANGLE_MIN_WIDTH/1e4*this.boardWidth,0),this.boardWidth-0),this._height=this._width*Math.tan(this.toolAngle/180*Math.PI)):this.toolType===$a.ISOSCELES_TRIANGLE?(this._width=Math.min(Math.max(e.ISOSCELES_TRIANGLE_MIN_WIDTH/1e4*this.boardWidth,0),this.boardWidth-0),this._height=this._width*Math.tan(this.toolAngle/180*Math.PI)):this.toolType===$a.PROTRACTOR&&(this._width=Math.min(Math.max(e.PROTRACTOR_MIN_WIDTH/1e4*this.boardWidth,0),this.boardWidth-0),this._height=this._width/2);this.setPosition(),this.setToolSize(!0)}},e.prototype.setAngleSwitchHandler=function(){var t=this,e=this._el.querySelector(".tiw-mathtool-angle-btn-box");e&&e.addEventListener(this._eventName[0],(function(r){r.preventDefault(),r.stopPropagation();var i=function(r){var o;r.preventDefault(),r.stopPropagation();var n=r.target;if(n.classList.contains("tiw-angle-switch__btn")){var a=n.dataset.value||0;t._updateDeg(Number(a).valueOf()),t._callback(4);var s=t._el.querySelector(".tiw-mathtool-angle-btn-box");s&&(s.style.display="none",null===(o=s.parentElement)||void 0===o||o.classList.remove("tiw-mathtool-btn__active"))}e.removeEventListener(t._eventName[2],i,!0)};e.addEventListener(t._eventName[2],i,!0)}),!1)},e.prototype.getContainer=function(){return this._el},e.prototype._updateTextValue=function(t){var e=this._el.querySelector(".tiw-mathtool-value__cm-angle");e&&(t?(e.classList.remove("tiw-mathtool-hide"),e.textContent=t):e.classList.add("tiw-mathtool-hide"))},e.prototype.reset=function(t){this.initData(t),this.resetPointerId(),this.setElStyle(),this.resetMeasureLine(),this.resetLineGeraduation(),this.calcResizeAnchor(),this.calcRotateAnchor(),this._updateTextValue("")},e.prototype.resetMeasureLine=function(){if(this.toolType===$a.PROTRACTOR){var t=this._el.querySelector(".draw-angle-arc"),e=this._el.querySelector(".tiw-mathtool-protractor-angle");if(e&&t){var r=this.measureAngle/180*Math.PI,i=Math.sin(-r),o=Math.cos(-r),n={x:20*o-0*i+20,y:20*i+0*o+20};t.setAttribute("d","M39 19 A20 20 0 0 0 ".concat(n.x," ").concat(n.y)),e.style.transform="rotate(".concat(Math.max(this.baseAngle,this.testAngle),"deg)")}this._updateMeasureAngle()}},e.prototype.resetLineGeraduation=function(){var t=this;this.toolType===$a.RULER?this._el.querySelectorAll(".tiw-geraduation-box").forEach((function(e){e.innerHTML=t.updateLineGeraduation()})):this.toolType!==$a.TRIANGLE&&this.toolType!==$a.ISOSCELES_TRIANGLE||this._el.querySelectorAll(".tiw-geraduation-box").forEach((function(e,r){e.innerHTML=t.updateLineGeraduation(t.px2cm(t.innerTriangleEdgeLen[r])+t.sizeClipper[r],e.classList.contains("tiw-ruler-vertical"))}))},e.prototype.setElStyle=function(){this.setScale(),this.toolType===$a.RULER?(this._el.classList.add("tiw-ruler-container"),this._el.style.transformOrigin="0 0"):this.toolType===$a.PROTRACTOR?(this._el.classList.add("tiw-protractor-container"),this._el.style.setProperty("--protractorWidth","".concat(this._width,"px")),this._el.style.setProperty("--borderWidth","20px"),this._el.style.setProperty("--bgColor","rgba(0, 0, 0, 0.1)"),this._el.style.setProperty("--calibrationColor","#E5E5E5"),this._el.style.transformOrigin="50% 100%"):this.toolType===$a.TRIANGLE||this.toolType===$a.ISOSCELES_TRIANGLE?(this._el.classList.add("tiw-triangle-container"),this.toolType===$a.ISOSCELES_TRIANGLE&&this._el.classList.add("tiw-isosceles-triangle-container"),this._el.style.setProperty("--triangleWidth","".concat(this._width,"px")),this._el.style.setProperty("--triangleHeight","".concat(this._height,"px")),this._el.style.setProperty("--triangleHypotenuseWidth","".concat(Math.round(Math.sqrt(this._width*this._width+this._height*this._height)),"px")),this._el.style.setProperty("--innerTriangleWidth","".concat(this.innerTriangleEdgeLen[0],"px")),this._el.style.setProperty("--innerTriangleHeight","".concat(this.innerTriangleEdgeLen[1],"px")),this._el.style.setProperty("--innerTriangleHypotenuseWidth","".concat(this.innerTriangleEdgeLen[2],"px")),this._el.style.setProperty("--triangleAngle","".concat(this.toolAngle,"deg")),this._el.style.transformOrigin="0 100%"):this.toolType===$a.COMPASSES&&(this._el.classList.add("tiw-compasses-container"),this._el.style.setProperty("--compassesLegAngle","".concat(this.compassesLegAngle,"deg")),this._el.style.setProperty("--compassesLegAnchorOffset","".concat(this._compassesLegAnchorOffset,"px")),this._el.style.setProperty("--brushColor","".concat(this.brushColor)),this._el.querySelector(".tiw-compasses-pen svg").style.setProperty("--brushColor","".concat(this.brushColor))),this._el.style.setProperty("--calibrationColor","rgba(0, 0, 0, 0.5)"),this._el.style.setProperty("--rotateAngle","".concat(-this.deg,"deg")),this._el.style.width=this._width+"px",this._el.style.height=this._height+"px",this._el.style.pointerEvents="auto",this._el.style.position="absolute",this._el.style.transform="translate(".concat(this._x,"px, ").concat(this._y,"px) rotate(").concat(this.deg,"deg)"),this._el.style.cursor="auto",this._el.style.zIndex="".concat(this.zIndex),this._getStyleChangeBtnIcon()},e.prototype.dispatchEvent=function(t){this.container.dispatchEvent(t)},e.prototype.setLineType=function(t){this.lineType=t;var e=this._el.querySelector(".tiw-style-change-btn");e&&(this.lineType===mn.TEDU_BOARD_LINE_TYPE_SOLID?(e.classList.add("tiw-line-style-solid"),e.classList.remove("tiw-line-style-dotted")):(e.classList.remove("tiw-line-style-solid"),e.classList.add("tiw-line-style-dotted")))},e.prototype.calcValidDeltaData=function(t,e){return this.toolType===$a.RULER?(this.rotateAnchor.x+t>this.boardWidth-20?t=this.boardWidth-this.rotateAnchor.x-20:this.rotateAnchor.x+t<0&&(t=-this.rotateAnchor.x),this.rotateAnchor.y+e>this.boardHeight-20?e=this.boardHeight-this.rotateAnchor.y-20:this.rotateAnchor.y+e<0&&(e=-this.rotateAnchor.y)):this.toolType!==$a.PROTRACTOR&&this.toolType!==$a.TRIANGLE&&this.toolType!==$a.ISOSCELES_TRIANGLE||(this.rotateAnchor.x+t>this.boardWidth-20?t=this.boardWidth-this.rotateAnchor.x-20:this.rotateAnchor.x+t<0&&(t=-this.rotateAnchor.x),this.rotateAnchor.y+e>this.boardHeight?e=this.boardHeight-this.rotateAnchor.y:this.rotateAnchor.y+e<20&&(e=20-this.rotateAnchor.y)),[t,e]},e.prototype.setAngleToggleDisplay=function(){var t=this._el.querySelector(".tiw-angle__icon");if(t){var e=t.querySelector(".tiw-mathtool-angle-btn-box");if(e){var r="on".concat(this._eventName[0]);t[r]=function(r){e.style.display="flex",t.classList.add("tiw-mathtool-btn__active")},document.body.addEventListener(this._eventName[0],(function(r){var i=r.target||r.changedTouches[0].target;i.classList.contains("tiw-mathtool-angle-btn-box")||i.classList.contains("tiw-angle-switch__btn")||(e.style.display="none",t.classList.remove("tiw-mathtool-btn__active"))}),!0)}}},e.prototype.processBtnActiveStyle=function(){var t=this,e=this._el.querySelectorAll(".".concat("tiw-interaction__btn")),r="tiw-mathtool-btn__active",i=!1;document.body.addEventListener(this._eventName[2],(function(){i=!1,t.isElementDisplay()&&t._el.querySelectorAll(".".concat("tiw-interaction__btn",".").concat(r)).forEach((function(e){e.classList.remove(r),t._processCompassesBtnStyle(e,r,2)}))}),!0),e.forEach((function(e){if("ontouchstart"in window)e.ontouchstart=function(){e.classList.add(r),t._processCompassesBtnStyle(e,r,1)},e.ontouchend=function(){e.classList.remove(r),t._processCompassesBtnStyle(e,r,2)};else{var o="on".concat(t._eventName[0]),n="on".concat(t._eventName[2]);e[o]=function(){i=!0,e.classList.add(r),t._processCompassesBtnStyle(e,r,1)},e[n]=function(){i=!1,e.classList.remove(r),t._processCompassesBtnStyle(e,r,2)},e.onmouseenter=function(){i||(e.classList.add(r),t._processCompassesBtnStyle(e,r,1))},e.onmouseleave=function(){i||(e.classList.remove(r),t._processCompassesBtnStyle(e,r,2))}}}))},e.prototype._processCompassesBtnStyle=function(t,e,r){if(this.toolType===$a.COMPASSES)if(t.classList.contains("tiw-compasses-pen"))t.parentNode.classList.remove(e),t.classList.remove("tiw-partial-draw");else{var i=t.parentNode,o=i.querySelector(".tiw-compasses-pen");1===r?(i.classList.add(e),null==o||o.classList.add("tiw-partial-draw"),null==o||o.classList.add(e)):(i.classList.remove(e),null==o||o.classList.remove("tiw-partial-draw"),null==o||o.classList.remove(e))}},e.prototype.setCompassesDrawArcHandler=function(){var t=this,r=this._el.querySelector(".tiw-compasses-pen");if(r){var i=0,o=0,n=0,a={x:0,y:0},s={x:0,y:0},l=0;r.addEventListener(this._eventName[0],(function(r){if(t.hasInteractionPermission){r.preventDefault(),r.stopPropagation();var c=Wt.getTimeStamp();if(!(c>t._lockTime||null!==t._pointerId)){t._pointerId=t.getEventId(r),t._lock=!0,t._lockTime=c;var h=document.body.getElementsByClassName("tx_board_canvas_box")[0],u=t.getEventLocation(r,h);n=t.deg||0,i=u.x,o=u.y,a={x:i,y:o},s=t.rotatePoint({x:t._x+t._width-t._compassesLegAnchorOffset,y:t._y+t._height}),l=0,t._compassDrawing=!0,t._callback(3,{x:t.rotateAnchor.x,y:t.rotateAnchor.y},{x:s.x,y:s.y},l,!0,"down");var d=function(e){if(e.preventDefault(),e.stopPropagation(),t._pointerId===t.getEventId(e))if(t._lock){var r=t.getEventLocation(e,h),c=t._calcRotateDeg({x:r.x,y:r.y},{x:i,y:o});t._updateDeg((n+c+360)%360);var u=t._calcRotateDeg({x:r.x,y:r.y},{x:a.x,y:a.y});l+=u,t._callback(3,{x:t.rotateAnchor.x,y:t.rotateAnchor.y},{x:s.x,y:s.y},l,l<0,"move"),a={x:r.x,y:r.y},t._updateCompassesRadius(!0),t._callback(4)}else f()},p=function(r){if(r.preventDefault(),r.stopPropagation(),t._pointerId===t.getEventId(r))if(t._pointerId=null,t._lock){t._lock=!1,t._lockTime=e.LOCK_RELEASE_TIMESTAMP;var c=t.getEventLocation(r,h),u=t._calcRotateDeg({x:c.x,y:c.y},{x:i,y:o});t._updateDeg((n+u+360)%360);var d=t._calcRotateDeg({x:c.x,y:c.y},{x:a.x,y:a.y});l+=d,t._callback(3,{x:t.rotateAnchor.x,y:t.rotateAnchor.y},{x:s.x,y:s.y},l,l<0,"up"),a={x:c.x,y:c.y},t._updateCompassesRadius(!1),f(),t._callback(5)}else f()},f=function(){t._compassDrawing=!1,document.body.removeEventListener(t._eventName[1],d,!1),document.body.removeEventListener(t._eventName[2],p,!1)};document.body.addEventListener(t._eventName[1],d,!1),document.body.addEventListener(t._eventName[2],p,!1)}}else t.toolType===$a.COMPASSES&&t._el.querySelectorAll(".tiw-compasses-header, .tiw-compasses-leg, .tiw-compasses-pen").forEach((function(t){t.style.cursor="not-allowed"}))}),!1)}},e.prototype._updateCompassesRadius=function(t){var e;if(t){var r=this.px2cm(this._width-2*this._compassesLegAnchorOffset),i=this._el.querySelector(".tiw-compasses-text__radius");i&&(i.dataset.radius="r=".concat(r.toFixed(1),"cm"),i.classList.remove("tiw-mathtool-hide"),i.style.width="".concat(this._width-2*this._compassesLegAnchorOffset,"px"))}else null===(e=this._el.querySelector(".tiw-compasses-text__radius"))||void 0===e||e.classList.add("tiw-mathtool-hide")},e.prototype.updateBrushColor=function(t){this.brushColor=t,this._el.style.setProperty("--brushColor","".concat(this.brushColor)),this.toolType===$a.COMPASSES&&this._el.querySelector(".tiw-compasses-pen svg").style.setProperty("--brushColor","".concat(this.brushColor))},e.prototype.updatePointerEventsAndCursor=function(t,e){void 0===e&&(e=""),t&&(this._el.style.pointerEvents=t),e&&(this._el.style.cursor=e,this.toolType===$a.COMPASSES&&this._el.querySelectorAll(".tiw-compasses-header, .tiw-compasses-leg, .tiw-compasses-pen").forEach((function(t){t.style.cursor=e})))},e.prototype.resetPointerId=function(){this._pointerId=null},e.prototype.getEventId=function(t){return"undefined"!=typeof PointerEvent&&t instanceof PointerEvent?t.pointerId:window.TouchEvent&&t instanceof TouchEvent?t.changedTouches[0].identifier:0},e.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.MATH_TOOL_ACTION,seq:this.seqUtil.getSeq(),belongSeq:this.belongSeq,x:this._compassMovingXY?this._compassMovingXY.x:this.x,y:this._compassMovingXY?this._compassMovingXY.y:this.y,width:this.width,height:this.height,deg:this.deg,show:this.show,visible:this.visible,toolType:this.toolType,zIndex:this.zIndex,baseAngle:this.baseAngle,testAngle:this.testAngle,compassesLegLength:this.compassesLegLength,compassesLegAnchorOffset:this.compassesLegAnchorOffset,compassesResizeBtnOffset:this.compassesResizeBtnOffset,compassesHeaderLength:this.compassesHeaderLength,lockTime:this._lockTime,lock:this._lock,brushColor:this.brushColor,compassDrawing:this._compassDrawing}},e.prototype.getReportData=function(){return{type:this.type,property:{subType:this.subType,belongSeq:this.belongSeq,boardId:this.boardId,uid:this.user,updateTime:Wt.getTimeStamp(),x:this.x,y:this.y,width:this.width,height:this.height,deg:this.deg,hidden:Number(!this.show),visible:+this.visible,toolType:this.toolType,zIndex:this.zIndex,baseAngle:this.baseAngle,testAngle:this.testAngle,compassesLegLength:this.compassesLegLength,compassesLegAnchorOffset:this.compassesLegAnchorOffset,compassesResizeBtnOffset:this.compassesResizeBtnOffset,compassesHeaderLength:this.compassesHeaderLength}}},e.prototype.setBoardScale=function(t){this._el.style.setProperty("--boardScale",t/100+"")},e.prototype.getReportDataForHistory=function(t){var e=this.getReportData();return t?e:{type:e.type,seq:this.seqUtil.getSeq(),content:JSON.stringify(e.property)}},e.MATH_TOOL_RATIO=.04,e.RULER_MIN_WIDTH=2500,e.TRIANGLE_MIN_WIDTH=3333,e.ISOSCELES_TRIANGLE_MIN_WIDTH=3333,e.PROTRACTOR_MIN_WIDTH=4e3,e.COMPASSES_WIDTH=90,e.COMPASSES_HEIGHT=480,e.COMPASSES_LEG_LENGTH=260,e.COMPASSES_HEADER_LENGTH=108,e.COMPASSES_ANCHOR_OFFSET=36,e.COMPASSES_RESIZE_BTN_OFFSET=46,e.LOCK_RELEASE_TIMESTAMP=4102415999e3,e.ELEMENT_MAX_ZINDEX=0,e.CALIBRATION_SIZE=.015,e.BUTTON_SIZE=.042,e.SIZE_CLIPER=[-1,-1,-1],e}(ra),as=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ss=function(t){function e(e,r,i){var o,n,a=this;return(a=t.call(this,e,{listener:{updatePosition:function(t,e,r,i){var o=Math.abs(a.endPoint.x-a.startPoint.x),n=Math.abs(a.endPoint.y-a.startPoint.y),s=a.startPoint.x<=a.endPoint.x?a.startPoint:a.endPoint,l=s===a.startPoint?a.endPoint:a.startPoint,c=a.startPoint.y<=a.endPoint.y?a.startPoint:a.endPoint,h=c===a.startPoint?a.endPoint:a.startPoint;s.x=r,l.x=r+o,c.y=i,h.y=i+n},updateScale:function(t,e){var r=a.rectArea,i=r.minX,o=r.minY,n=r.maxX,s=r.maxY;if(!(t>1&&(i<=0||n>=1e4)||e>1&&(o<=0||s>=1e4))){var l=a.settingConfig.getBoardRatioRate(a.boardId),c=a.thin;c=!a.solid||"rect"!==a.graph&&"square"!==a.graph&&"oval"!==a.graph&&"circle"!==a.graph&&"right-triangle"!==a.graph&&"isosceles-triangle"!==a.graph&&"parallelogram"!==a.graph&&"coordinate"!==a.graph?a.thin:0,a.scaleX*=t,a.scaleY*=e,a.width=Math.abs(a.endPoint.x-a.startPoint.x)*a.scaleX+c/l,a.height=Math.abs(a.endPoint.y-a.startPoint.y)*a.scaleY+c}},updateRotate:function(t){a.deg=t}}},"graph")||this).user=r,a.type="graph",a.graph=i.graph,a.show=null===(o=i.show)||void 0===o||o,a.visible=null===(n=i.visible)||void 0===n||n,a.status="begin",a.select=!1,a.color=i.color,a.thin=i.thin,a.style=i.style||{},a.time=Wt.getTimeStamp(),a.solid=i.solid||a.style.fillType===Qa.SOLID||!1,a.startPoint=i.beginPoint,a.belongSeq=i.beginPoint.seq,a.endPoint=i.endPoint,a.ID="".concat(i.beginPoint.seq),a.needToRender=!0,a.isMoving=!1,a.isFinish=!0,a.boardId=i.boardId,a.scaleX=i.scaleX||1,a.scaleY=i.scaleY||1,a.deg=i.deg||0,a.lockElement=i.lockElement,a.setBorder(),a}return as(e,t),e.prototype.setBorder=function(){var t=this.settingConfig.getBoardRatioRate(this.boardId),e=this.thin;e=!this.solid||"rect"!==this.graph&&"square"!==this.graph&&"oval"!==this.graph&&"circle"!==this.graph&&"right-triangle"!==this.graph&&"isosceles-triangle"!==this.graph&&"parallelogram"!==this.graph&&"coordinate"!==this.graph?this.thin:0,e=Number(e),this.x=Math.min(this.startPoint.x,this.endPoint.x)-e/t/2,this.y=Math.min(this.startPoint.y,this.endPoint.y)-e/2,this.width=Math.abs(this.endPoint.x-this.startPoint.x)*this.scaleX+e/t,this.height=Math.abs(this.endPoint.y-this.startPoint.y)*this.scaleY+e,this.left=this.boardWidth*this.x/1e4,this.top=this.boardHeight*this.y/1e4,this._updateRectArea()},e.prototype.pointTransformer=function(t,e){void 0===e&&(e=!0);var r=t.x,i=t.y,o=Math.min(this.startPoint.x,this.endPoint.x),n=Math.min(this.startPoint.y,this.endPoint.y),a=(r-o)*this.scaleX+o,s=(i-n)*this.scaleY+n,l=this._calcRotateXY(a,s),c=l.x,h=l.y;return{x:e?c:a,y:e?h:s}},e.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION,seq:this.seqUtil.getSeq(),moves:[this.getData()],time:Wt.getTimeStamp()}},e.prototype.getReportData=function(){return{uid:this.user,boardId:this.boardId,belongSeq:this.startPoint.seq,updateTime:Wt.getTimeStamp(),updateContent:{beginPoint:this.startPoint,endPoint:this.endPoint,scaleX:this.scaleX,scaleY:this.scaleY,deg:this.deg}}},e.prototype.getElementOperatorReportData=function(){return t.prototype.getElementOperatorReportData.call(this,{thin:this.thin,color:this.color,style:this.style})},e.prototype.getData=function(){return{uid:this.user,seq:this.startPoint.seq,x:this.startPoint.x,y:this.startPoint.y,scaleX:this.scaleX,scaleY:this.scaleY,deg:this.deg}},e.prototype.getBoardId=function(){return this.boardId},e.createElement=function(t,r,i){var o=new e(t,r,i);return Za.deepProxy(o,o)},e.prototype.getCmSize=function(){var t=this.startPoint.x,e=this.startPoint.y,r=this.endPoint.x,i=this.endPoint.y;return(Math.sqrt(Math.pow((r-t)*this.boardWidth/1e4,2)+Math.pow((i-e)*this.boardHeight/1e4,2))/(this.boardWidth*ns.MATH_TOOL_RATIO)).toFixed(1)},e.prototype.getReportDataForHistory=function(t){void 0===t&&(t=!0);var e={line:M.PROTOCOL_ACTION.GRAPH_LINE_ACTION,oval:M.PROTOCOL_ACTION.GRAPH_CIRCLE_ACTION,circle:M.PROTOCOL_ACTION.GRAPH_CIRCLE_ACTION,rect:M.PROTOCOL_ACTION.GRAPH_RECT_ACTION,square:M.PROTOCOL_ACTION.GRAPH_RECT_ACTION,"right-triangle":M.PROTOCOL_ACTION.GRAPH_RIGHT_TRIANGLE_ACTION,"isosceles-triangle":M.PROTOCOL_ACTION.GRAPH_ISOSCELES_TRIANGLE_ACTION,parallelogram:M.PROTOCOL_ACTION.GRAPH_PARALLELOPGRAM_ACTION,cube:M.PROTOCOL_ACTION.GRAPH_CUBE_ACTION,cylinder:M.PROTOCOL_ACTION.GRAPH_CYLINDER_ACTION,cone:M.PROTOCOL_ACTION.GRAPH_CONE_ACTION,coordinate:M.PROTOCOL_ACTION.GRAPH_COORDINATE_ACTION},r={type:{line:"addPatternLine",oval:"addPatternCircle",circle:"addPatternCircle",rect:"addPatternRectangle",square:"addPatternRectangle","right-triangle":"addPattern","isosceles-triangle":"addPattern",parallelogram:"addPattern",cube:"addPattern",cylinder:"addPattern",cone:"addPattern",coordinate:"addPattern"}[this.graph],seq:this.seqUtil.getSeq(),content:{boardId:this.getBoardId(),uid:this.user,color:this.color,colorRGBA:Y(this.color),scale:100,width:this.thin,time:this.time,updateTime:Wt.getTimeStamp(),hidden:+!this.show,visible:+this.visible,beginPoint:{x:this.startPoint.x,y:this.startPoint.y,seq:this.startPoint.seq},endPoint:{x:this.endPoint.x,y:this.endPoint.y,seq:this.endPoint.seq},subType:this.graph,style:this.style,fillRect:0,deg:this.deg,scaleX:this.scaleX,scaleY:this.scaleY,lockElement:this.lockElement}},i=this.solid?1:0;return 11===e[this.graph]&&(r.content.fillRect=i),12===e[this.graph]&&(r.content.fillRect=i),t?[r]:{type:r.type,seq:r.seq,content:JSON.stringify(r.content)}},e}(ra),ls=function(t){var e;this.touchId=t.touchId||M.MOUSE_TOUCH_ID,this.user=t.user,this.type="raser",this.seq=t.seq,this.action=t.action,this.color=t.color,this.radius=t.radius,this.timestamp=t.timestamp,this.location={x:t.x,y:t.y},this.toolType=null!==(e=t.toolType)&&void 0!==e?e:3,this.title=t.title||"",this.style=t.style||{},this.ignore=t.ignore||!1},cs=function(t){this.type="select",this.user=t.user,this.seq=Math.floor(100*Math.random()),this.show=!1,this.color=t.color||"red",this.startInfo={x:t.startx,y:t.starty},this.location={x:t.x,y:t.y},this.ID="".concat(this.seq),this.succeedSelect=!1},hs={LINE:0,GRAPH:1,TEXT:2,IMAGE:3,ELEMENT:4},us=function(){function t(){this.renderMap=new Map,this.renderQueue=[]}return t.prototype.getRenderQueue=function(){return this.renderQueue},t.prototype.addToRenderQueue=function(t){this.renderQueue=this.renderQueue.filter((function(e){return e.ID!==t.ID})),this.renderQueue.push(t)},t.prototype.popFromRenderQueue=function(){return this.renderQueue.shift()},t.prototype.addToRenderMap=function(t,e){this.renderMap.set(t,e)},t.prototype.getRender=function(t){return this.renderMap.get(t)},t.prototype.removerFromRenderMap=function(t){return this.renderMap.delete(t)},t}(),ds=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ps=function(t,e,r,i){this.maxX=null!=r?r:t,this.maxY=null!=i?i:e,this.minX=t,this.minY=e},fs=function(t){function e(e,r,i,o){void 0===o&&(o="v1");var n=t.call(this,e,{listener:{updatePosition:function(t,e,r,i){var o=r-n.border.minX,a=i-n.border.minY;n.border.maxX+=o,n.border.minX+=o,n.border.maxY+=a,n.border.minY+=a,n.getPoints().forEach((function(t){t.x+=o,t.y+=a}))},updateScale:function(t,e){n.scaleX*=t,n.scaleY*=e},updateRotate:function(t){n.deg=t}}},"line")||this;return n.lines=[],n.fullPoints=[],n.needFormat=!1,n.seq=i.belongSeq,n.type="line",n.user=r,n.ID="".concat(i.belongSeq),n.boardId=i.boardId,n.lockElement=i.lockElement||!1,n.belongSeq=i.belongSeq,n.originBelongSeq=i.originBelongSeq||i.belongSeq,n.show=i.show,n.visible=i.visible,n.select=!1,n.color=i.color,n.time=i.time||Wt.getTimeStamp(),n.thin=i.thin,n.lineTransparent=i.lineTransparent,n.writing=i.writing,n.startSeq=i.belongSeq,n.endSeq=0,n.drawIndex=0,n.style=i.style,n.highlighter=i.highlighter||!1,n.fitCurve=[],i.border?n.border=JSON.parse(JSON.stringify(i.border)):n.border=new ps(i.x,i.y),n.needToRender=!0,n.isMoving=!1,n.scaleX=i.scaleX||1,n.scaleY=i.scaleY||1,n.deg=i.deg||0,n.x=n.border.minX,n.y=n.border.minY,n.width=(n.border.maxX-n.border.minX)*n.scaleX,n.height=(n.border.maxY-n.border.minY)*n.scaleY,n.version=o,"v1"===n.version?n.lines=[{action:i.action,x:i.x,y:i.y,w:i.w,belongSeq:i.belongSeq,seq:i.seq,timestamp:i.timestamp,originSeq:i.originSeq,originBelongSeq:i.originBelongSeq}]:"v2"===n.version&&(n.fullPoints=[{middle:!1,action:i.action,x:i.x,y:i.y,w:i.w,belongSeq:i.belongSeq,seq:i.seq,timestamp:i.timestamp,originBelongSeq:i.originBelongSeq,originSeq:i.originSeq}]),n}return ds(e,t),e.prototype.setBorder=function(t,e,r,i){void 0===r&&(r=!0),void 0===i&&(i=!0),r&&(t+this.thin>this.border.maxX&&(this.border.maxX=t+this.thin),t-this.thin<this.border.minX&&(this.border.minX=t-this.thin),e+this.thin>this.border.maxY&&(this.border.maxY=e+this.thin),e-this.thin<this.border.minY&&(this.border.minY=e-this.thin)),this.width=(this.border.maxX-this.border.minX)*this.scaleX,this.height=(this.border.maxY-this.border.minY)*this.scaleY,this.x=this.border.minX,this.y=this.border.minY,this.left=this.boardWidth*this.x/1e4,this.top=this.boardHeight*this.y/1e4,i&&this._updateRectArea()},e.prototype.sort=function(t){if(void 0===t&&(t=!1),t)this.lines.sort((function(t,e){return t.seq-e.seq})),this.fullPoints.sort((function(t,e){return t.seq-e.seq}));else{for(var e=this.lines.pop(),r=!1,i=this.lines.length-1;i>=0;i--)if(this.lines[i].seq<e.seq){this.lines.splice(i+1,0,e),r=!0;break}r||this.lines.unshift(e);var o=this.fullPoints.pop();for(r=!1,i=this.fullPoints.length-1;i>=0;i--)if(this.fullPoints[i].seq<o.seq){this.fullPoints.splice(i+1,0,o),r=!0;break}r||this.fullPoints.unshift(o)}},e.prototype.pointTransformer=function(t){var e=t.x,r=t.y,i=(e-this.x)*this.scaleX+this.x,o=(r-this.y)*this.scaleY+this.y,n=this._calcRotateXY(i,o),a=n.x,s=n.y;return Object.assign({},t,{x:a,y:s})},e.prototype.impactCheck=function(t,e,r){var i=this,o=this.thin/2;if(!this.pointImpactCheckV2(r,[t,e],{boardWidth:this.boardWidth,boardHeight:this.boardHeight}))return!1;var n=!1,a=this.getPoints().map((function(t){return i.pointTransformer(t)}));if(1===a.length){var s=a[0];Mt(t,e,s.x,s.y,s.x,s.y)<=(r+o)*(r+o)&&(n=!0)}else for(var l=1;l<a.length;l++){var c=a[l-1],h=a[l];if(Mt(t,e,c.x,c.y,h.x,h.y)<=(r+o)*(r+o)){n=!0;break}}return!!n},e.prototype.addPoint=function(t){"v1"===this.version?this.lines.push(t):"v2"===this.version&&this.fullPoints.push(t)},e.prototype.getPoints=function(){return"v1"===this.version?this.lines:"v2"===this.version?this.fullPoints:[]},e.prototype.getImpactPoints=function(t,e,r){var i=this,o=[],n=this.thin/2;if(this.pointImpactCheck([t,e])){var a=this.getPoints().map((function(t){return i.pointTransformer(t)}));if(1===a.length){var s=a[0];Mt(t,e,s.x,s.y,s.x,s.y)<=(r+n)*(r+n)&&o.push(s)}else for(var l=1;l<a.length;l++){var c=a[l-1],h=a[l];Mt(t,e,c.x,c.y,h.x,h.y)<=(r+n)*(r+n)&&(Mt(t,e,c.x,c.y,c.x,c.y)<Mt(t,e,h.x,h.y,h.x,h.y)?-1===o.indexOf(c)&&o.push(c):-1===o.indexOf(h)&&o.push(h))}}return o},e.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION,seq:this.seqUtil.getSeq(),moves:[this.getData()],time:Wt.getTimeStamp()}},e.prototype.getReportData=function(){var t=[],e=this.getPoints().map((function(e){var r={seq:e.seq,x:e.x,y:e.y};return e.middle||t.push(r),r}));return{uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,updateTime:Wt.getTimeStamp(),updateContent:{points:t,fullPoints:e,scaleX:this.scaleX,scaleY:this.scaleY,deg:this.deg}}},e.prototype.getElementOperatorReportData=function(){return t.prototype.getElementOperatorReportData.call(this,{thin:this.thin,color:this.color,style:this.style})},e.prototype.getData=function(){return{uid:this.user,seq:this.seq,x:this.getPoints()[0].x,y:this.getPoints()[0].y,scaleX:this.scaleX,scaleY:this.scaleY,deg:this.deg}},e.prototype.getPointBySeq=function(t){for(var e,r=0;r<this.getPoints().length;r++){var i=this.getPoints()[r];if(i.seq===t){e=i;break}}return e},e.prototype.getRangePointsBySeq=function(t,e){for(var r=[],i=0;i<this.getPoints().length;i++){var o=this.getPoints()[i];o.seq>=t&&o.seq<=e&&r.push(o)}return r},e.prototype.pointImpactCheckV2=function(t,e,r){var i=t/r.boardWidth*1e4,o=t/r.boardHeight*1e4,n=[];return this.pointArr.forEach((function(t,e){var r=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}(t,2),a=r[0],s=r[1];0===e?n.push([a-i,s-o]):1===e?n.push([a+i,s-o]):2===e?n.push([a+i,s+o]):3===e&&n.push([a-i,s+o])})),this.pointImpactCheck(e,n)},e.prototype.getPointsTransformer=function(){var t=this,e=[];return this.getPoints().forEach((function(r){e.push(t.pointTransformer(r))})),e},e.prototype.setNeedFormat=function(){this.needFormat=!0},e.prototype.getNeedFormat=function(){return this.needFormat},e.prototype.formatHistoryPoints=function(){var t=this;if(this.needFormat){this.sort(!0);var e="v1"===this.version?this.lines:this.fullPoints,r=e.length;return e.forEach((function(e,i){var o=M.PROTOCOL_ACTION.LINE_MOVE_ACTION;0===i?(o=M.PROTOCOL_ACTION.LINE_START_ACTION,e.originBelongSeq=t.belongSeq):i===r-1&&(o=M.PROTOCOL_ACTION.LINE_END_ACTION,t.endSeq=e.seq),e.action=o,e.w=e.w||Number(t.thin),e.belongSeq=t.belongSeq,e.originSeq=e.seq,e.middle=!!e.middle,t.setBorder(e.x,e.y,!0,!1)})),this._updateRectArea(),this.needFormat=!1,!0}return!1},e.prototype.setLines=function(t){"v1"===this.version?this.lines=t:"v2"===this.version&&(this.fullPoints=t)},e.prototype.getBoardId=function(){return this.boardId},e.createElement=function(t,r,i,o,n){void 0===n&&(n=!1);var a=new e(t,r,i,o);return n?a:Za.deepProxy(a,a)},e.prototype.getReportDataForHistory=function(t){void 0===t&&(t=!0);var e=[],r=[];this.fullPoints.forEach((function(t){var i={seq:t.seq,x:t.x,y:t.y,w:t.w,timestamp:Wt.getTimeStamp(),originSeq:t.seq,middle:!!t.middle};t.middle||e.push(i),r.push(i)}));var i={belongSeq:this.belongSeq,boardId:this.boardId,uid:this.user,colorRGBA:Y(this.color),scale:100,width:this.thin,writing:this.writing?1:0,lineTransparent:this.lineTransparent,time:this.time,updateTime:Wt.getTimeStamp(),seq:this.seq,hidden:+!this.show,visible:+this.visible,points:e,fullPoints:r,highlighter:this.highlighter,version:this.version,deg:this.deg,scaleX:this.scaleX,scaleY:this.scaleY,lockElement:this.lockElement};return t?i:{type:"addLine",seq:this.seqUtil.getSeq(),content:JSON.stringify(i)}},e}(ra),gs=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ms=function(t){function e(e){var r=t.call(this)||this;return r.data=e,r.lastBorder=JSON.parse(JSON.stringify(e.border)),r.lastWidth=0,r.lastHeigth=0,r.lastDrawIndex=0,r.lastPath="",r}return gs(e,t),e.prototype.renderByCanvas=function(t,r){t&&(t.globalCompositeOperation="source-over");var i=this.data,o=i.getPoints();if(0!=o.length&&t){var n=o.map((function(t){return i.pointTransformer(t)})),a=1e4/r.width,s=1e4/r.height;if(i.lineTransparent?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="source-over",i.writing){var l=function(e){var o=Math.max(i.thin/s,r.minLineWidth);t.lineWidth=o,t.lineCap="round",t.strokeStyle=i.color,t.fillStyle=i.color,t.setLineDash([]),t.beginPath(),t.arc(e.x/a,e.y/s,t.lineWidth/2,0,2*Math.PI,!0),t.fill(),t.closePath()};if(t.save(),t.lineJoin="round",1==n.length)return l(n[0]),void t.restore();if(2==n.length){if(n[0].x==n[1].x&&n[0].y==n[1].y)return l(n[0]),void t.restore();if(n[1].action==M.PROTOCOL_ACTION.LINE_MOVE_ACTION)return void t.restore();if(n[1].action==M.PROTOCOL_ACTION.LINE_END_ACTION)return e.lineOptimization(t,{newx:n[1].x,newy:n[1].y,oldx:n[0].x,oldy:n[0].y,cpx:(n[0].x+n[1].x)/2,cpy:(n[0].y+n[1].y)/2,prew:n[0].w,curw:n[1].w,thin:i.thin,lineTransparent:i.lineTransparent,hasOptimizeStart:!1,hasOptimizeEnd:!1,divisorWidth:a,divisorHeight:s,color:i.color,minLineWidth:r.minLineWidth},i.version),void t.restore()}else if(3==n.length&&n[2].action==M.PROTOCOL_ACTION.LINE_END_ACTION&&n[0].action==M.PROTOCOL_ACTION.LINE_START_ACTION)return e.lineOptimization(t,{newx:n[2].x,newy:n[2].y,oldx:n[0].x,oldy:n[0].y,cpx:n[1].x,cpy:n[1].y,prew:n[0].w,curw:n[2].w,thin:i.thin,lineTransparent:i.lineTransparent,hasOptimizeStart:!1,hasOptimizeEnd:!1,divisorWidth:a,divisorHeight:s,color:i.color,minLineWidth:r.minLineWidth},i.version),void t.restore();var c=!1,h=!0,u=i.thin,d=i.color,p=n[0].x,f=n[0].y;"v1"===i.version&&n[0].action!==M.PROTOCOL_ACTION.LINE_START_ACTION&&(p=(n[0].x+n[1].x)/2,f=(n[0].y+n[1].y)/2);for(var g=1;g<n.length-1;){var m=n[g],y=m.x,v=m.y,_=(I=n[g+1]).x,E=I.y,T=I.w,b=m.w;n[g-1].action==M.PROTOCOL_ACTION.LINE_START_ACTION?(h=!1,c=!0):c=I.action!=M.PROTOCOL_ACTION.LINE_END_ACTION;var S=e.lineOptimization(t,{newx:_,newy:E,oldx:p,oldy:f,cpx:y,cpy:v,curw:T,prew:b,thin:u,lineTransparent:i.lineTransparent,hasOptimizeStart:h,hasOptimizeEnd:c,divisorWidth:a,divisorHeight:s,color:d,minLineWidth:r.minLineWidth},i.version);p=S.oldx,f=S.oldy,_=S.newx,E=S.newy,y>=0&&v>=0&&!h&&(h=!0),"v2"===i.version?g+=2:g++}t.stroke(),t.restore()}else{var x=Math.max(i.thin/s,r.minLineWidth);t.save(),t.lineWidth=x,t.lineCap="round",t.strokeStyle=i.color,t.fillStyle=i.color,t.lineJoin="round",t.setLineDash([]),t.beginPath();var w=n.map((function(t){return{action:t.action,w:t.w,x:t.x/a,y:t.y/s,seq:t.seq}}));if(1==w.length)return w[0].action==M.PROTOCOL_ACTION.LINE_START_ACTION&&(t.arc(w[0].x,w[0].y,t.lineWidth/2,0,2*Math.PI,!0),t.fill(),t.closePath()),void t.restore();if(2==w.length){if(w[0].x==w[1].x&&w[0].y==w[1].y)return t.arc(w[0].x,w[0].y,t.lineWidth/2,0,2*Math.PI,!0),t.fill(),t.closePath(),void t.restore();if(1==w[0].action&&3==w[1].action)return t.moveTo(w[0].x,w[0].y),t.lineTo(w[1].x,w[1].y),t.stroke(),void t.restore();if(2==w[1].action)return void t.restore()}for("v1"===i.version&&n[0].action!==M.PROTOCOL_ACTION.LINE_START_ACTION&&(w[0].x=(w[0].x+w[1].x)/2,w[0].y=(w[0].y+w[1].y)/2),t.moveTo(w[0].x,w[0].y),g=1;g<w.length-1;){var O=w[g],I=w[g+1],A=null,D=null;"v2"===i.version?(A=I.x,D=I.y,g+=2):(A=(O.x+I.x)/2,D=(O.y+I.y)/2,g++),t.quadraticCurveTo(O.x,O.y,A,D)}t.stroke(),t.restore()}}},e.drawByCanvasRealTime=function(t,e){var r=e.newx,i=e.newy,o=e.oldx,n=e.oldy,a=e.cpx,s=e.lineTransparent,l=e.cpy,c=e.endx,h=e.endy,u=e.color,d=e.thin,p=e.width,f=e.height,g=e.minLineWidth,m=e.isOver,y=void 0!==m&&m,v=e.isDot,_=void 0!==v&&v,E=e.isNeedDraw,T=void 0===E||E;if(t&&(t.globalCompositeOperation="source-over"),T){var b=1e4/f,S=1e4/p,x=Math.max(d/b,g);t.globalCompositeOperation=s?"destination-out":"source-over",t.save(),t.strokeStyle=u,t.lineWidth=x,t.lineCap="round",t.lineJoin="round",t.setLineDash([]),_?(t.fillStyle=u,t.beginPath(),t.arc(r/S,i/b,x/2,0,2*Math.PI,!0),t.fill(),t.closePath()):(t.beginPath(),t.moveTo(o/S,n/b),a&&c&&t.quadraticCurveTo(a/S,l/b,c/S,h/b),y&&t.quadraticCurveTo(a/S,l/b,r/S,i/b),t.stroke()),t.restore()}},e.lineOptimization=function(t,e,r){var i=e.newx,o=e.newy,n=e.oldx,a=e.oldy,s=e.cpx,l=e.cpy,c=e.curw,h=e.prew,u=e.thin,d=e.lineTransparent,p=e.hasOptimizeEnd,f=e.divisorWidth,g=e.divisorHeight,m=e.color,y=e.minLineWidth;void 0===r&&(r="v2"),t.globalCompositeOperation=d?"destination-out":"source-over",t.strokeStyle=m,t.lineCap="round",t.lineJoin="round",t.setLineDash([]);var v="v2"!==r&&p?(s+i)/2:i,_="v2"!==r&&p?(l+o)/2:o;if(n===i&&a===o){var E=Math.max(u/g,y);t.lineWidth=E,t.lineCap="round",t.strokeStyle=m,t.fillStyle=m,t.beginPath(),t.arc(n/f,a/g,t.lineWidth/2,0,2*Math.PI,!0),t.fill(),t.closePath()}else for(var T=n,b=a,S=1;S<=15;S++){var x=S/15,w=1-x,O=w*w*n+2*x*w*s+x*x*v,I=w*w*a+2*x*w*l+x*x*_,A=w*w*h+x*w*(c+h)+x*x*c;"v1"!==r||p||(A=h-h*x),t.beginPath(),t.lineWidth=Math.max(A/g,y),t.moveTo(T/f,b/g),t.lineTo(O/f,I/g),t.stroke(),T=O,b=I}return{oldx:n=v,oldy:a=_,newx:i,newy:o}},e.prototype.renderTo=function(t,e){this.lastWidth=e.width,this.lastHeigth=e.height,this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e)},e.prototype.remove=function(){},e}(yn),ys=function(){function t(t,e,r){void 0===r&&(r={}),this.uid=e,this.nickname=r.nickname||"",this.seqUtil=t}return t.prototype.getReportData=function(){return{uid:this.uid,nickname:this.nickname,updateTime:Wt.getTimeStamp()}},t.prototype.getRealtimeData=function(){return{action:M.PROTOCOL_ACTION.USERINFO_EVENT_ACTION,seq:this.seqUtil.getSeq(),uid:this.uid,nickname:this.nickname,updateTime:Wt.getTimeStamp()}},t}(),vs=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function a(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},_s=function(t,e){var r,i,o,n,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},Es=function(){function t(t,e,r){this.loggerModuleName="PptIFrameWPS",this.boardInstanceKey=r,this.instanceId=Math.ceil(1e8*Math.random()),this.instance=null,this.pptApp=null,this.currentSlide=(t.fileInfo.currentPageIndex||0)+1,this.currentStep=t.fileInfo.currentPageStep||0,this.totalSlide=0,this.slideStepCount={},this.courseUrl="",this.transcodeContainer=e,this.slideStepChangeCallback=t.slideStepChangeCallback||null,this.slideMediaChangedCallback=t.slideMediaChangedCallback||null,this.slideMediaStatusChangedCallback=t.slideMediaStatusChangedCallback||null,this.triggerPlayEventCallback=t.triggerPlayEventCallback||null,this.isPassive=!1,this.fid=t.fid,this.logger=t.logger,this.originUrl="",this.delayFirstGotoStepTask=null,this.onReady=t.onReady,this.onPreview=t.onPreview,this.clickTimer=null,this.reportLog("new-instance"),this._genNode(t,this.transcodeContainer)}return t.prototype._setData=function(t){this.instance.iframe.setAttribute("name",JSON.stringify({sdkAppId:t.sdkAppId,userId:t.userId,version:"",progressBarUrl:t.progressBarUrl}))},t.prototype._loadPPT=function(t){return vs(this,void 0,void 0,(function(){var e,r,i,o,n,a;return _s(this,(function(s){switch(s.label){case 0:return[4,t.Application.ActivePresentation];case 1:return[4,(e=s.sent()).ResetReaderInfo()];case 2:return s.sent(),[4,e.Slides.Count];case 3:return r=s.sent(),[4,e.PageSetup];case 4:return[4,(i=s.sent()).SlideHeight];case 5:return o=s.sent(),[4,i.SlideWidth];case 6:return n=s.sent(),[4,i.SlideRatio];case 7:return a=s.sent(),[2,{slides:r,width:n,height:o,ratio:a}]}}))}))},t.prototype._playPPT=function(t,e){return vs(this,void 0,void 0,(function(){var r,i=this;return _s(this,(function(o){switch(o.label){case 0:return[4,this.pptApp.ActivePresentation.ResetReaderInfo()];case 1:return o.sent(),[4,this.gotoSlide(t,!0)];case 2:return o.sent(),[4,this.pptApp.ActivePresentation.SlideShowSettings.Run()];case 3:return o.sent(),[4,this.hideMenu()];case 4:return o.sent(),r=e,this.delayFirstGotoStepTask=setTimeout((function(){return vs(i,void 0,void 0,(function(){return _s(this,(function(t){switch(t.label){case 0:return[4,this.pptApp.ActivePresentation.ResetReaderInfo()];case 1:return t.sent(),[4,this.gotoStep(r,!0)];case 2:return t.sent(),[2]}}))}))}),1200),this.reportLog("play",{slideIndex:t,stepIndex:e}),[2]}}))}))},t.prototype._loadPDF=function(t){return vs(this,void 0,void 0,(function(){var e,r,i,o,n;return _s(this,(function(a){switch(a.label){case 0:return[4,t.Application.ActivePDF];case 1:return[4,(e=a.sent()).PagesCount];case 2:return r=a.sent(),[4,e.CurrentPage];case 3:return i=a.sent(),[4,e.GetPageWidth(i)];case 4:return o=a.sent(),[4,e.GetPageHeight(i)];case 5:return n=a.sent(),[2,{slides:r,width:o,height:n}]}}))}))},t.prototype._playPDF=function(t){return vs(this,void 0,void 0,(function(){return _s(this,(function(e){switch(e.label){case 0:return[4,this.gotoSlide(t,!0)];case 1:return e.sent(),[4,this.pptApp.ActivePDF.StartPlay()];case 2:return e.sent(),0,this.reportLog("play",{slideIndex:t,step:0}),[2]}}))}))},t.prototype._initEvent=function(){return vs(this,void 0,void 0,(function(){var t,e,r,i,o,n,a,s=this;return _s(this,(function(l){switch(l.label){case 0:return[4,this.instance.ready()];case 1:return l.sent(),this.reportLog("ready"),this.pptApp=this.instance.Application,cn(this.originUrl)?[4,this._loadPPT(this.instance)]:[3,3];case 2:t=l.sent(),l.label=3;case 3:return hn(this.originUrl)?[4,this._loadPDF(this.instance)]:[3,5];case 4:t=l.sent(),l.label=5;case 5:return r=(e=t).slides,i=e.width,o=e.height,n=e.ratio,a=void 0===n?1:n,this.totalSlide=r,k(this.onReady)&&this.onReady({fid:this.fid,count:this.totalSlide,width:i,height:o,ratio:a,title:"",slideStepData:""}),k(this.onPreview)?[4,this.destroy()]:[3,7];case 6:return l.sent(),this.onPreview({fid:this.fid,count:this.totalSlide,width:i,height:o,ratio:a,title:"",slideStepData:""}),[3,8];case 7:this._bindListener(),this.play(),Ts.clearSyncTask(this.boardInstanceKey),Ts.boardInstanceTaskMap[this.boardInstanceKey].syncTask=window.setInterval((function(){return vs(s,void 0,void 0,(function(){var t,e,r,i,o;return _s(this,(function(n){switch(n.label){case 0:return t=[0,0],cn(this.originUrl)?[4,Promise.all([this.pptApp.ActivePresentation.SlideShowWindow.View.Slide.SlideIndex,this.pptApp.ActivePresentation.SlideShowWindow.View.GetClickIndex()])]:[3,2];case 1:t=n.sent(),n.label=2;case 2:return hn(this.originUrl)?[4,this.pptApp.ActivePDF.CurrentPage]:[3,4];case 3:e=n.sent(),t=[e,0],n.label=4;case 4:return r=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}(t,2),i=r[0],o=r[1],i===this.currentSlide&&o===this.currentStep||(this.reportLog("autoSyncTask"),this.syncData({slideIndex:this.currentSlide-1,stepIndex:this.currentStep,isPassive:!0,fid:this.fid},!0)),[2]}}))}))}),5e3),l.label=8;case 8:return[2]}}))}))},t.prototype._bindListener=function(){cn(this.originUrl)&&this._bindPPTListener(),hn(this.originUrl)&&this._bindPDFListener()},t.prototype._bindPPTListener=function(){var t=this;this.pptApp.Sub.SlideShowOnNext=function(e){return vs(t,void 0,void 0,(function(){return _s(this,(function(t){switch(t.label){case 0:return clearTimeout(this.clickTimer),[4,this.pptApp.ActivePresentation.SlideShowWindow.View.GetClickIndex()];case 1:return t.sent(),this.currentSlide=e.Data.slideIndex+1,this.currentStep=e.Data.animateIndex+1,this.isPassive||this.slideStepChangeCallback&&this.slideStepChangeCallback({slideIndex:this.currentSlide-1,stepIndex:this.currentStep,fid:this.fid}),this.isPassive=!1,this.reportLog("SlideShowOnNext"),[2]}}))}))},this.pptApp.Sub.SlideShowOnPrevious=function(e){return vs(t,void 0,void 0,(function(){return _s(this,(function(t){switch(t.label){case 0:return[4,this.pptApp.ActivePresentation.SlideShowWindow.View.GetClickIndex()];case 1:return t.sent(),clearTimeout(this.clickTimer),this.currentSlide=e.Data.slideIndex+1,this.currentStep=e.Data.animateIndex+1,this.isPassive||this.slideStepChangeCallback&&this.slideStepChangeCallback({slideIndex:this.currentSlide-1,stepIndex:this.currentStep,fid:this.fid}),this.isPassive=!1,this.reportLog("SlideShowOnPrevious"),[2]}}))}))},this.pptApp.Sub.SlideSelectionChanged=function(e){return vs(t,void 0,void 0,(function(){var t;return _s(this,(function(r){switch(r.label){case 0:return clearTimeout(this.clickTimer),this.currentSlide=e,t=this,[4,this.pptApp.ActivePresentation.SlideShowWindow.View.GetClickIndex()];case 1:return t.currentStep=r.sent(),this.isPassive||this.slideStepChangeCallback&&this.slideStepChangeCallback({slideIndex:this.currentSlide-1,stepIndex:this.currentStep,fid:this.fid}),this.isPassive=!1,this.reportLog("SlideSelectionChanged"),[2]}}))}))},this.pptApp.Sub.SlideMediaChanged=function(e){var r=e.Data,i=r.mediaPlayInfo,o=i.id,n=i.currentTime,a=i.isMediaPlay,s=i.isFullScreen;r.mediaPlayInfo&&!t.isPassive&&t.slideMediaChangedCallback&&t.slideMediaChangedCallback({id:o,currentTime:n,isMediaPlay:a,isFullScreen:s||!1}),t.slideMediaStatusChangedCallback&&t.slideMediaStatusChangedCallback({id:o,isMediaPlay:a,currentTime:n}),t.reportLog("SlideMediaChanged")},this.pptApp.Sub.TriggerPlayEvent=function(e){return vs(t,void 0,void 0,(function(){var t,r,i,o;return _s(this,(function(n){return t=e.Data,r=t.targetShapeId,i=t.slideCategory,o=t.steps,this.isPassive||this.triggerPlayEventCallback&&this.triggerPlayEventCallback({targetShapeId:r,slideCategory:i,steps:o}),this.reportLog("TriggerPlayEvent"),[2]}))}))}},t.prototype._bindPDFListener=function(){var t=this;this.pptApp.Sub.CurrentPageChange=function(e){return vs(t,void 0,void 0,(function(){return _s(this,(function(t){return this.currentSlide=e+1,this.isPassive||this.slideStepChangeCallback&&this.slideStepChangeCallback({slideIndex:this.currentSlide-1,stepIndex:this.currentStep,fid:this.fid}),this.isPassive=!1,[2]}))}))},this.pptApp.Sub.StartPlay=function(e){return vs(t,void 0,void 0,(function(){return _s(this,(function(t){switch(t.label){case 0:return[4,this.pptApp.ActivePDF];case 1:return t.sent().ZoomToFit=-1,[2]}}))}))}},t.prototype._bindDOCListener=function(){var t=this;this.pptApp.Sub.CurrentPageChange=function(e){return vs(t,void 0,void 0,(function(){return _s(this,(function(t){return[2]}))}))},this.pptApp.Sub.WindowScrollChange=function(e){return vs(t,void 0,void 0,(function(){return _s(this,(function(t){return[2]}))}))}},t.prototype._removeListener=function(){this.pptApp&&this.pptApp.Sub&&(this.pptApp.Sub.SlideShowBegin=null,this.pptApp.Sub.SlideShowOnNext=null,this.pptApp.Sub.SlideShowOnPrevious=null,this.pptApp.Sub.SlideSelectionChanged=null,this.pptApp.Sub.SlideMediaChanged=null,this.pptApp.Sub.SlidePlayerChange=null)},t.prototype.setVisible=function(t){void 0===t&&(t=!0),this.transcodeContainer.style.display=t?"block":"none",this.transcodeContainer.style.pointerEvents=t?"":"none",this.instance&&this.instance.iframe&&(this.instance.iframe.style.display=t?"":"none",this.instance.iframe.style.pointerEvent=t?"":"none")},t.prototype.checkUrlExist=function(t){var e=this.originUrl&&this.originUrl===t;return this.originUrl=t,e},t.prototype.formatUrl=function(t){var e="ci-process=doc-preview&dstType=html&weboffice_url=1";return-1===t.url.indexOf("?")?t.url+="?for_tiw=1&".concat(e):t.url+="&".concat(e),t.url},t.prototype.getCosUrl=function(t){return ca({logger:this.logger,url:t,method:"get"})},t.prototype._genNode=function(t,e){return vs(this,void 0,void 0,(function(){var r,i,o=this;return _s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),this.reportLog("_genNode"),this.checkUrlExist(t.url)?[2]:Ts.recordUrls[t.url]?(this.courseUrl=Ts.recordUrls[t.url],[3,3]):[3,1];case 1:return[4,this.getCosUrl(this.formatUrl(t))];case 2:r=n.sent(),i=r.data.PreviewUrl,this.courseUrl=i+"&viewMode=play",Ts.recordUrls[t.url]=this.courseUrl,n.label=3;case 3:return this.reportLog("COSDocPreviewSDK"),this.instance=window.COSDocPreviewSDK.config({mount:e,url:this.courseUrl,mode:"simple",commonOptions:{isShowTopArea:!1,isShowHeader:!1,isIframeViewFullscreen:!0},pptOptions:{isShowBottomStatusBar:!1},commandBars:[{cmbId:"PlayComponentToolbar",attributes:{visible:!1,enable:!1}},{cmbId:"WPPMobileMarkButton",attributes:{visible:!1,enable:!1}},{cmbId:"WPPPcCommentButton",attributes:{visible:!1,enable:!1}},{cmbId:"WPPMobileCommentButton",attributes:{visible:!1,enable:!1}},{cmbId:"HeaderLeft",attributes:{visible:!1,enable:!1}},{cmbId:"HeaderRight",attributes:{visible:!1,enable:!1}},{cmbId:"WPPMobileComponentToolbar",attributes:{visible:!1,enable:!1}},{cmbId:"WPPMobileThumbnailContainer",attributes:{visible:!1,enable:!1}}]}),this.instance.on("fileOpen",(function(){o.reportLog("fileOpen"),o._setData(t),o._initEvent()})),this.instance.on("error",(function(t){o.reportLog("error")})),[3,5];case 4:return n.sent(),[3,5];case 5:return[2]}}))}))},t.prototype.openThumbail=function(){return vs(this,void 0,void 0,(function(){return _s(this,(function(t){switch(t.label){case 0:return this.isPassive=!1,this.pptApp?[4,this.pptApp.ActivePresentation.SlideShowSettings.OpenMiniThumbail()]:[2];case 1:return t.sent(),[2]}}))}))},t.prototype.gotoSlide=function(t,e){return void 0===e&&(e=!1),vs(this,void 0,void 0,(function(){return _s(this,(function(r){switch(r.label){case 0:return this.isPassive=e,this.pptApp?cn(this.originUrl)?[4,this.pptApp.ActivePresentation.SlideShowWindow.View.GotoSlide(t)]:[3,2]:[2];case 1:r.sent(),r.label=2;case 2:return hn(this.originUrl)?[4,this.pptApp.ActivePDF.JumpToPage(t)]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},t.prototype.gotoStep=function(t,e){return void 0===e&&(e=!1),vs(this,void 0,void 0,(function(){var r=this;return _s(this,(function(i){switch(i.label){case 0:return this.isPassive=e,this.pptApp?(clearTimeout(this.clickTimer),this.clickTimer=setTimeout((function(){return vs(r,void 0,void 0,(function(){return _s(this,(function(r){return this.currentStep=t-1,e||this.slideStepChangeCallback&&this.slideStepChangeCallback({slideIndex:this.currentSlide-1,stepIndex:this.currentStep,fid:this.fid}),this.isPassive=!1,[2]}))}))}),3e3),[4,this.pptApp.ActivePresentation.SlideShowWindow.View.GotoClick(t)]):[2];case 1:return i.sent(),[2]}}))}))},t.prototype.gotoNextStep=function(t){return void 0===t&&(t=!1),vs(this,void 0,void 0,(function(){return _s(this,(function(e){switch(e.label){case 0:return this.isPassive=t,this.pptApp?cn(this.originUrl)?[4,this.pptApp.ActivePresentation.SlideShowWindow.View.GotoNextClick()]:[3,2]:[2];case 1:e.sent(),e.label=2;case 2:return hn(this.originUrl)&&this.gotoSlide(this.currentSlide+1),[2]}}))}))},t.prototype.gotoPreviousStep=function(t){return void 0===t&&(t=!1),vs(this,void 0,void 0,(function(){return _s(this,(function(e){switch(e.label){case 0:return this.isPassive=t,this.pptApp?cn(this.originUrl)?[4,this.pptApp.ActivePresentation.SlideShowWindow.View.GotoPreClick()]:[3,2]:[2];case 1:e.sent(),e.label=2;case 2:return hn(this.originUrl)&&this.gotoSlide(this.currentSlide-1),[2]}}))}))},t.prototype.gotoSlideStep=function(t,e,r){return void 0===r&&(r=!1),vs(this,void 0,void 0,(function(){return _s(this,(function(i){switch(i.label){case 0:return[4,this.gotoSlide(t,r)];case 1:return i.sent(),[4,this.gotoStep(e,r)];case 2:return i.sent(),[2]}}))}))},t.prototype.playTriggerAnim=function(t,e,r,i){return void 0===e&&(e="slides"),void 0===r&&(r=-1),void 0===i&&(i=!1),vs(this,void 0,void 0,(function(){return _s(this,(function(o){switch(o.label){case 0:return this.isPassive=i,[4,this.pptApp.ActivePresentation.PlayTriggerAnim(t,e,r-1)];case 1:return o.sent(),[4,this.pptApp.ActivePresentation.PlayTriggerAnim(t,e)];case 2:return o.sent(),this.isPassive=!1,[2]}}))}))},t.prototype.setMediaObject=function(t,e){return void 0===e&&(e=!1),vs(this,void 0,void 0,(function(){return _s(this,(function(e){switch(e.label){case 0:return[4,this.pptApp.ActivePresentation.SlideShowWindow.View.SetMediaObj(t)];case 1:return e.sent(),[2]}}))}))},t.prototype.changeAllMediaStatus=function(t){return void 0===t&&(t=!0),vs(this,void 0,void 0,(function(){var e,r,i,o,n;return _s(this,(function(a){switch(a.label){case 0:return[4,this.pptApp.ActivePresentation.SlideShowWindow.View.Slide.SlideID];case 1:e=a.sent(),r=1,a.label=2;case 2:if(!(r<10))return[3,9];a.label=3;case 3:return a.trys.push([3,7,,8]),[4,this.pptApp.ActivePresentation.SlideShowWindow.View.Slide.Shapes.Item(r)];case 4:return(i=a.sent())?[4,i.Id]:[3,9];case 5:return o=a.sent(),n="".concat(e,"_").concat(o),[4,this.pptApp.ActivePresentation.SlideShowWindow.View.SetMediaObj({id:n,isMediaPlay:t,isFullScreen:!1})];case 6:return a.sent(),this.slideMediaChangedCallback&&this.slideMediaChangedCallback({id:n,isMediaPlay:t,isFullScreen:!1}),this.slideMediaStatusChangedCallback&&this.slideMediaStatusChangedCallback({id:n,isMediaPlay:t}),this.reportLog("SlideMediaChanged"),[3,8];case 7:return a.sent(),[3,9];case 8:return r++,[3,2];case 9:return[2]}}))}))},t.prototype.syncData=function(t,e){var r=t.slideIndex,i=t.stepIndex,o=t.isPassive,n=t.fid;return void 0===e&&(e=!1),vs(this,void 0,void 0,(function(){var t;return _s(this,(function(a){switch(a.label){case 0:return this.fid!==n?[2]:this.pptApp?(clearTimeout(this.delayFirstGotoStepTask),t=!1,this.isPassive=o,r+=1,this.isPassive||r!==this.currentSlide||i!==this.currentStep||e?(this.reportLog("syncData",{receive:{slideIndex:r,stepIndex:i}}),cn(this.originUrl)?r!==this.currentSlide||e?[4,this.gotoSlide(r,o)]:[3,2]:[3,8]):[3,10]):(this.currentSlide=r+1,this.currentStep=i,[2]);case 1:a.sent(),t=!0,a.label=2;case 2:return i!==this.currentStep||e?t||i!==this.currentStep+1?[3,4]:[4,this.pptApp.ActivePresentation.SlideShowWindow.View.GotoNextClick()]:[3,8];case 3:return a.sent(),[3,8];case 4:return t||i!==this.currentStep-1?[3,6]:[4,this.pptApp.ActivePresentation.SlideShowWindow.View.GotoPreClick()];case 5:return a.sent(),[3,8];case 6:return[4,this.pptApp.ActivePresentation.SlideShowWindow.View.GotoClick(i+1)];case 7:a.sent(),a.label=8;case 8:return hn(this.originUrl)&&(r!==this.currentSlide||e)?[4,this.gotoSlide(r,o)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[2]}}))}))},t.prototype.play=function(){return vs(this,void 0,void 0,(function(){var t=this;return _s(this,(function(e){return this.pptApp?(r=this.currentSlide,i=this.currentStep+1,vs(t,void 0,void 0,(function(){return _s(this,(function(t){switch(t.label){case 0:return cn(this.originUrl)?[4,this._playPPT(r,i)]:[3,2];case 1:t.sent(),t.label=2;case 2:return hn(this.originUrl)?[4,this._playPDF(r)]:[3,4];case 3:t.sent(),t.label=4;case 4:return[2]}}))})),[2]):[2];var r,i}))}))},t.prototype.hideMenu=function(){return vs(this,void 0,void 0,(function(){var t,e,r;return _s(this,(function(i){switch(i.label){case 0:return t=this.pptApp.Enum.PpToolType.pcPlayHoverLink,e=this.pptApp.Enum.PpToolType.pcImageHoverTip,r=this.pptApp.Enum.PpToolType.pcPlayingMenu,[4,this.pptApp.ActivePresentation.SlideShowWindow.View.SetToolVisible(t,!1)];case 1:return i.sent(),[4,this.pptApp.ActivePresentation.SlideShowWindow.View.SetToolVisible(e,!1)];case 2:return i.sent(),[4,this.pptApp.ActivePresentation.SlideShowWindow.View.SetToolVisible(r,!1)];case 3:return i.sent(),[2]}}))}))},t.prototype.resetInfo=function(){return vs(this,void 0,void 0,(function(){return _s(this,(function(t){switch(t.label){case 0:return this.pptApp?[4,this.pptApp.ActivePresentation.ResetReaderInfo()]:[2];case 1:return t.sent(),[2]}}))}))},t.prototype.resize=function(){if(this.instance){var t=this.instance.iframe.style.width,e=this.instance.iframe.style.height,r=this.transcodeContainer.clientWidth+"px",i=this.transcodeContainer.clientHeight+"px";t===r&&e===i||this.instance.iframe.setAttribute("style","height:".concat(i,";width:").concat(r))}},t.prototype.destroy=function(){return vs(this,void 0,void 0,(function(){return _s(this,(function(t){switch(t.label){case 0:return clearTimeout(this.delayFirstGotoStepTask),Ts.clearSyncTask(this.boardInstanceKey),this.reportLog("destroy-before"),this.instance?(this.originUrl="",this.courseUrl="",[4,this.instance.destroy()]):[2];case 1:return t.sent(),this.pptApp=null,this.instance=null,this.reportLog("destroy-after"),[2]}}))}))},t.prototype.reportLog=function(t,e){void 0===e&&(e={}),this.logger.reportInfo(this.loggerModuleName,this.loggerModuleName+"-"+t,{param:{fileId:this.fid,extraInfo:JSON.stringify(Object.assign({instanceId:this.instanceId,currentSlide:this.currentSlide,currentStep:this.currentStep,isPassive:this.isPassive},e))}},ea.ONLY_ONLINE)},t}(),Ts=function(){function t(){}return t.createElement=function(e,r,i){return t.boardInstanceTaskMap[i]||(t.boardInstanceTaskMap[i]={syncTask:0}),t.clearSyncTask(i),new Es(e,r,i)},t.getInstance=function(e,r,i){return t.instance||(t.instance=t.createElement(e,r,i)),t.instance},t.destroy=function(){return vs(this,void 0,void 0,(function(){return _s(this,(function(e){switch(e.label){case 0:if(!t.instance)return[3,5];e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,t.instance.destroy()];case 2:case 3:return e.sent(),[3,5];case 4:return t.instance=null,[7];case 5:return[2,Promise.resolve()]}}))}))},t.clearSyncTask=function(e){var r=t.boardInstanceTaskMap[e].syncTask;clearInterval(r)},t.boardInstanceTaskMap={},t.recordUrls={},t.instance=null,t}(),bs=Ts,Ss=new(function(){function t(){this.localCursorLayer={border:{color:"#FF0000",width:"1px",style:"dashed"},operator:{color:"#FFFFFF",backgroundColor:"#1B242D"},anchor:{color:"#FF0000"},rotate:{color:"#FF0000",backgroundImage:L.cursorLayerImages.rotateImgSrc},getBorder:function(){var t=this.border,e=t.color,r=t.width,i=t.style;return{border:"".concat(r," ").concat(i," ").concat(e)}},getAnchor:function(){return this.anchor},getRotate:function(){return this.rotate}},this.remoteCursorLayer={border:{color:"#FF0000",width:"1px",style:"dashed"},operator:{color:"#FFFFFF",backgroundColor:"#1B242D"},anchor:{scale:"0.8",color:"#FF0000"},rotate:{color:"#FF0000",backgroundImage:L.cursorLayerImages.rotateImgSrc},getBorder:function(){var t=this.border,e=t.color,r=t.width,i=t.style;return{border:"".concat(r," ").concat(i," ").concat(e)}},getAnchor:function(){return this.anchor},getRotate:function(){return this.rotate}},this.select={border:{color:"#FF0000"}},this.textComponent={border:{color:"#FF0000"}},this.cursorSize=[-1/0,1/0],this.mathBoardElementStyle={point:{color:"#ff0000",selectedColor:"#ff00ff"},line:{color:"#000000",selectedColor:"#ff00ff"},circle:{color:"#2196F3",selectedColor:"#ff00ff"},angle:{color:"#0000ff",selectedColor:"#ff00ff"}}}return t.prototype.setSelectBoxColor=function(t){var e=t.color;this.localCursorLayer.border.color=e,this.localCursorLayer.anchor.color=e,this.localCursorLayer.rotate.color=e,this.remoteCursorLayer.border.color=e,this.remoteCursorLayer.anchor.color=e,this.remoteCursorLayer.rotate.color=e,this.select.border.color=e,this.textComponent.border.color=e},t.prototype.setSelectAnchorColor=function(t){var e=t.color;this.remoteCursorLayer.anchor.color=e,this.localCursorLayer.anchor.color=e},t.prototype.setCursorSize=function(t){t.sort(),this.cursorSize=t},t.prototype.setMathBoardElementStyle=function(t){for(var e in t){var r=t[e],i=this.mathBoardElementStyle[e];if(i)for(var o in i)r[o]&&(i[o]=r[o])}},t}()),xs={NONE:0,AUTO:1,RECTANGLE:2,POLYGON:3,CIRCLE:4,ELLIPSE:5},ws=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Os=function(t,e,r,i){this.maxX=null!=r?r:t,this.maxY=null!=i?i:e,this.minX=t,this.minY=e},Is=function(t){function e(e,r,i){var o,n=this;return(n=t.call(this,e,{listener:{updatePosition:function(t,e,r,i){var o=r-n.border.minX,a=i-n.border.minY;n.border.maxX+=o,n.border.minX+=o,n.border.maxY+=a,n.border.minY+=a,"ellipse"===n.fitMode?(n.fitCurve[0].center.x+=o,n.fitCurve[0].center.y+=a):n.fitCurve.forEach((function(t){t.x+=o,t.y+=a}))},updateScale:function(t,e){n.scaleX*=t,n.scaleY*=e},updateRotate:function(t){n.deg=t}}},"magicLine")||this).type="element",n.subType=Ta.TEDU_BOARD_ELEMENT_MAGIC_LINE,n.user=r,n.ID="".concat(i.belongSeq),n.boardId=i.boardId,n.belongSeq=i.belongSeq,n.show=i.show,n.visible=null===(o=i.visible)||void 0===o||o,n.select=!1,n.color=i.color,n.time=i.time||Wt.getTimeStamp(),n.thin=i.thin,n.fitCurve=i.fitCurve||[],n.fitMode=i.fitMode||"polygon",n.isClosed=i.isClosed||!1,i.border?n.border=JSON.parse(JSON.stringify(i.border)):n.border=new Os(i.x,i.y),n.needToRender=!0,n.isMoving=!1,n.scaleX=i.scaleX||1,n.scaleY=i.scaleY||1,n.deg=i.deg||0,n.x=n.border.minX,n.y=n.border.minY,n.width=(n.border.maxX-n.border.minX)*n.scaleX,n.height=(n.border.maxY-n.border.minY)*n.scaleY,n.lockElement=i.lockElement,n}return ws(e,t),e.prototype.setBorder=function(t,e,r){void 0===r&&(r=!0),r&&(t+this.thin>this.border.maxX&&(this.border.maxX=t+this.thin),t-this.thin<this.border.minX&&(this.border.minX=t-this.thin),e+this.thin>this.border.maxY&&(this.border.maxY=e+this.thin),e-this.thin<this.border.minY&&(this.border.minY=e-this.thin)),this.width=(this.border.maxX-this.border.minX)*this.scaleX,this.height=(this.border.maxY-this.border.minY)*this.scaleY,this.x=this.border.minX,this.y=this.border.minY,this.left=this.boardWidth*this.x/1e4,this.top=this.boardHeight*this.y/1e4,this._updateRectArea()},e.prototype.pointTransformer=function(t){var e=t.x,r=t.y,i=(e-this.x)*this.scaleX+this.x,o=(r-this.y)*this.scaleY+this.y,n=this._calcRotateXY(i,o),a=n.x,s=n.y;return{action:t.action,w:t.w,x:a,y:s}},e.prototype.impactCheck=function(t,e,r){return this.pointImpactCheck([t,e])},e.prototype.setFitBorder=function(t){var e=this;if(void 0===t&&(t=!1),this.border={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},"ellipse"===this.fitMode){var r=this.fitCurve[0];t&&(this.deg=r.angle),this.border={minX:r.center.x-r.size.width/2,minY:r.center.y-r.size.height/2,maxX:r.center.x+r.size.width/2,maxY:r.center.y+r.size.height/2},this.x=this.border.minX-this.thin/2,this.y=this.border.minY-this.thin/2,this.width=r.size.width*this.scaleX+this.thin,this.height=r.size.height*this.scaleY+this.thin,this.left=this.boardWidth*this.x/1e4,this.top=this.boardHeight*this.y/1e4,this._updateRectArea()}else this.fitCurve.forEach((function(t){e.setBorder(t.x,t.y)}))},e.prototype.renormalizationPoints=function(t){var e=this,r=[];return t.forEach((function(t){r.push({x:t.x/1e4*e.boardWidth,y:t.y/1e4*e.boardHeight})})),r},e.prototype.normalizationPoints=function(t,e){void 0===e&&(e="polygon");var r=this.boardWidth/1e4,i=this.boardHeight/1e4;if("polygon"===e){var o=[];return t.forEach((function(t){o.push({x:t.x/r,y:t.y/i})})),o}var n=t,a=n.size,s=a.width,l=a.height,c=n.center,h=c.x,u=c.y;return n.size={width:s/r,height:l/i},n.center={x:h/r,y:u/i},n},e.prototype.fitRect=function(t){if(t.length<=2)return t;var e=1/0,r=1/0,i=-1/0,o=-1/0;return this.isClosed=!0,t.forEach((function(t){e=Math.min(e,t.x),r=Math.min(r,t.y),i=Math.max(i,t.x),o=Math.max(o,t.y)})),[{x:e,y:r},{x:i,y:r},{x:i,y:o},{x:e,y:o}]},e.prototype.fitCircle=function(t){var e=t,r=Math.min(e.size.width,e.size.height);return e.size={width:r,height:r},e},e.prototype.rotate=function(t,e){var r=Math.cos(e),i=Math.sin(e);return{x:t.x*r-t.y*i,y:t.x*i+t.y*r}},e.prototype.checkIsClosed=function(t){if(t.length<=1)return!1;var e=t[0],r=t[t.length-1];return Math.sqrt((e.x-r.x)*(e.x-r.x)+(e.y-r.y)*(e.y-r.y))<=40},e.prototype.calcProjection=function(t,e){var r=Math.sqrt(e.x*e.x+e.y*e.y),i=(t.x*e.x+t.y*e.y)/(r*r),o=e.x/i,n=e.y/i;return Math.sqrt(o*o+n*n)},e.prototype.checkIsClockwisePoints=function(t){for(var e=0,r=0;r<t.length-1;r++)e+=-.5*(t[r+1].x-t[r].x)*(t[r+1].y+t[r].y);return e<0?1:-1},e.prototype.fitRandomRect=function(t){if(4!==t.length)return t;var e=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}(t,4),r=e[0],i=e[1],o=e[2],n=e[3],a={x:i.x-r.x,y:i.y-r.y},s={x:o.x-n.x,y:o.y-n.y},l=this.calcProjection(a,s),c=Math.sqrt(s.x*s.x+s.y*s.y),h=Math.abs(c-l),u={x:o.x-i.x,y:o.y-i.y},d={x:r.x-n.x,y:r.y-n.y},p=this.calcProjection(u,d),f=Math.sqrt(d.x*d.x+d.y*d.y),g=Math.abs(f-p);if(h<=40&&g<=40){var m=Math.sqrt((r.x-o.x)*(r.x-o.x)+(r.y-o.y)*(r.y-o.y)),y=Math.sqrt((i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y));if(Math.abs(m-y)<20){var v=Math.abs(r.x-i.x),_=Math.abs(r.y-i.y);v>_?_<40&&(i.y=r.y):v<40&&(i.x=r.x),a={x:i.x-r.x,y:i.y-r.y};var E=Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)),T=Math.sqrt((r.x-i.x)*(r.x-i.x)+(r.y-i.y)*(r.y-i.y)),b={x:(i.x-r.x)/T,y:(i.y-r.y)/T},S=this.rotate(b,-Number(this.checkIsClockwisePoints([r,i,o,n]))*Math.PI/2);o={x:(n={x:r.x+S.x*E,y:r.y+S.y*E}).x+a.x,y:n.y+a.y}}else Math.abs(r.y-i.y)<Math.abs(r.y-n.y)?Math.abs(r.y-i.y)<40&&(i.y=r.y):Math.abs(r.y-n.y)<40&&(n.y=r.y),a={x:i.x-r.x,y:i.y-r.y},o={x:n.x+a.x,y:n.y+a.y}}return[r,i,o,n]},e.prototype.fitRandomCircle=function(t){var e=t;if(Math.abs(e.size.width-e.size.height)<40){var r=Math.min(e.size.width,e.size.height);e.size={width:r,height:r}}return e},e.prototype.pointReducer=function(t){if(t.length<=2)return t;for(var e=t.slice(0,2),r=2;r<t.length;r++){var i=t[r],o=e[e.length-2],n=e[e.length-1],a=(i.x-o.x)*(i.x-o.x)+(i.y-o.y)*(i.y-o.y);((s=(i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y))+(l=(o.x-n.x)*(o.x-n.x)+(o.y-n.y)*(o.y-n.y))-a)/(2*Math.sqrt(s)*Math.sqrt(l))+1<.02&&e.pop(),e.push(i)}if(this.checkIsClosed(e)){this.isClosed=!0;var s,l,c=e[e.length-2];i=e[e.length-1],o=e[0],n=e[1],a=(i.x-o.x)*(i.x-o.x)+(i.y-o.y)*(i.y-o.y),((s=(i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y))+(l=(o.x-n.x)*(o.x-n.x)+(o.y-n.y)*(o.y-n.y))-a)/(2*Math.sqrt(s)*Math.sqrt(l))+1<.02&&e.shift();var h=(a+(s=(i.x-c.x)*(i.x-c.x)+(i.y-c.y)*(i.y-c.y))-(l=(o.x-c.x)*(o.x-c.x)+(o.y-c.y)*(o.y-c.y)))/(2*Math.sqrt(a)*Math.sqrt(s));(h>.98||h+1<.02)&&e.pop();var u=e[0],d=e[e.length-1];(u.x-d.x)*(u.x-d.x)+(u.y-d.y)*(u.y-d.y)<=1600&&e.pop(),e=this.fitRandomRect(e)}else this.isClosed=!1;return e},e.prototype.genFitCurve=function(t,e){var r=this.renormalizationPoints(t),i=rn.approxPolyDP(r,2,!1),o=i.points;if(i.count,e===xs.AUTO){var n=this.pointReducer(o);if(this.isClosed||n.length<=2)if(n.length<=6)this.fitCurve=this.normalizationPoints(n,"polygon"),this.fitMode="polygon";else{var a=rn.fitEllipse(r);this.fitCurve=[this.normalizationPoints(this.fitRandomCircle(a),"ellipse")],this.fitMode="ellipse"}else this.fitCurve=t.map((function(t){return{x:t.x,y:t.y}})),this.fitMode="none"}else e===xs.POLYGON?(this.fitCurve=this.normalizationPoints(this.pointReducer(o),"polygon"),this.fitMode="polygon"):e===xs.RECTANGLE?(this.fitCurve=this.normalizationPoints(this.fitRect(o),"polygon"),this.fitMode="polygon"):e===xs.ELLIPSE?(a=rn.fitEllipse(r),this.fitCurve=[this.normalizationPoints(a,"ellipse")],this.fitMode="ellipse"):e===xs.CIRCLE&&(a=rn.fitEllipse(r),this.fitCurve=[this.normalizationPoints(this.fitCircle(a),"ellipse")],this.fitMode="ellipse");this.setFitBorder(!0)},e.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.MAGIC_LINE_ELEMENT,belongSeq:this.belongSeq,seq:+this.belongSeq,x:this.x,y:this.y,thin:this.thin,color:this.color,fitCurve:this.fitCurve,fitMode:this.fitMode,timestamp:this.time,boardId:this.boardId,show:this.show,visible:this.visible,deg:this.deg,scaleX:this.scaleX,scaleY:this.scaleY,isClosed:this.isClosed}},e.prototype.getReportData=function(){return{type:this.type,property:{subType:this.subType,belongSeq:this.belongSeq,boardId:this.boardId,uid:this.user,colorRGBA:this.color,thin:this.thin,time:this.time,updateTime:Wt.getTimeStamp(),seq:+this.belongSeq,hidden:Number(!this.show),visible:+this.visible,fitCurve:this.fitCurve,fitMode:this.fitMode,isClosed:this.isClosed,scaleX:this.scaleX,scaleY:this.scaleY,deg:this.deg,lockElement:this.lockElement}}},e.prototype.getData=function(){return{uid:this.user,seq:this.belongSeq,x:this.x,y:this.y,scaleX:this.scaleX,scaleY:this.scaleY,deg:this.deg}},e.prototype.getBoardId=function(){return this.boardId},e.prototype.getElementOperatorReportData=function(){return{uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,updateTime:Wt.getTimeStamp(),updateContent:{thin:this.thin,color:this.color}}},e.prototype.getReportDataForHistory=function(t){var e=this.getReportData();return t?e:{type:e.type,seq:this.seqUtil.getSeq(),content:JSON.stringify(e.property)}},e.createElement=function(t,r,i){var o=new e(t,r,i);return Za.deepProxy(o,o)},e}(ra),As=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ds=function(t){function e(e){var r=t.call(this)||this;return r.data=e,r.lastBorder=JSON.parse(JSON.stringify(e.border)),r.lastWidth=0,r.lastHeigth=0,r.lastDrawIndex=0,r.lastPath="",r}return As(e,t),e.prototype.renderByCanvas=function(t,e){var r=this;if(t&&(t.globalCompositeOperation="source-over"),0!=this.data.fitCurve.length&&t){var i=this.data.fitCurve,o=1e4/e.width,n=1e4/e.height,a=Math.max(this.data.thin/n,e.minLineWidth);if(t.save(),t.lineWidth=a,t.lineCap="round",t.strokeStyle=this.data.color,t.fillStyle=this.data.color,t.setLineDash([]),"ellipse"===this.data.fitMode){var s=i[0],l=this.data.pointTransformer(s.center),c=l.x,h=l.y,u=s.size.width*this.data.scaleX/o,d=s.size.height*this.data.scaleY/n;c/=o,h/=n,On.bezierEllipse(t,c,h,u/2,d/2,!1,this.data.color,this.data.deg)}else{var p=i.map((function(t){return r.data.pointTransformer(t)})),f=1e4/e.width,g=1e4/e.height,m=p.map((function(t){return{action:t.action,w:t.w,x:Math.floor(t.x/f),y:Math.floor(t.y/g)}})),y=Math.max(this.data.thin/g,e.minLineWidth);if(t.lineWidth=y,t.lineCap="round",t.strokeStyle=this.data.color,t.fillStyle=this.data.color,"polygon"===this.data.fitMode){t.beginPath(),t.moveTo(m[0].x,m[0].y);for(var v=1;v<m.length;v++)t.lineTo(m[v].x,m[v].y);this.data.isClosed&&t.closePath(),t.stroke()}else{t.lineJoin="round",t.beginPath(),t.moveTo(m[0].x,m[0].y);for(var _=1;_<m.length-1;_+=2){var E,T,b=m[_],S=m[_+1];E=S.x,T=S.y,t.quadraticCurveTo(b.x,b.y,E,T)}t.stroke()}}t.restore(),this.data.needToRender=!1}},e.prototype.renderTo=function(t,e){this.data.needToRender&&(this.lastWidth=e.width,this.lastHeigth=e.height,this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e))},e.prototype.remove=function(){},e}(yn),Cs=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},Ps=function(){function t(){}return t.hsv_to_rgb=function(t,e,r){var i,o,n,a,s,l,c=Math.floor(6*t),h=6*t-c,u=r*(1-e),d=r*(1-h*e),p=r*(1-(1-h)*e),f=0,g=0,m=0;return 0==c?(f=(i=Cs([r,p,u],3))[0],g=i[1],m=i[2]):1==c?(f=(o=Cs([d,r,u],3))[0],g=o[1],m=o[2]):2==c?(f=(n=Cs([u,r,p],3))[0],g=n[1],m=n[2]):3==c?(f=(a=Cs([u,d,r],3))[0],g=a[1],m=a[2]):4==c?(f=(s=Cs([p,u,r],3))[0],g=s[1],m=s[2]):5==c&&(f=(l=Cs([r,u,d],3))[0],g=l[1],m=l[2]),"#".concat(Math.floor(256*f).toString(16)).concat(Math.floor(256*g).toString(16)).concat(Math.floor(256*m).toString(16))},t.rand=function(t){return(t=(9301*t+49297)%233280)/233280},t.genColor=function(){return t.colorSeed+=t.GOLDEN_RATIO_CONJUGATE,t.colorSeed%=1,t.hsv_to_rgb(t.colorSeed,.5,.95)},t.GOLDEN_RATIO_CONJUGATE=.618033988749895,t.colorSeed=Math.random(),t}(),Ls=function(){return(Ls=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ms=function(){function t(t,e){var r,i,o,n;this.type="expression",this.seqUtil=t,this.type=e.type||"expression",this.user=e.user,this.boardId=e.boardId,this.seq=e.seq,this.belongSeq=e.belongSeq||e.seq,this.jxgId=e.jxgId||null,this.jxgBelongSeq=e.jxgBelongSeq||null,this.id=e.id||this.genGraphId(e.seq),this.label=null!==(r=e.label)&&void 0!==r?r:"",this.withLabel=null===(i=e.withLabel)||void 0===i||i,this.showLabel=null===(o=e.showLabel)||void 0===o||o,this.isHighlighted=e.isHighlighted||!1,this.isSelected=e.isSelected||!1,this.color=e.color||Ps.genColor(),this.hightlightedColor=e.hightlightedColor||"#ffaa00",this.selectedColor=e.selectedColor||"#ff00ff",this.show=null===(n=e.show)||void 0===n||n,this.currentSeq=e.seq,this.maxSeq=this.currentSeq}return t.prototype.getElementId=function(){return this.belongSeq+""},t.prototype.genGraphId=function(t){return"".concat(t||this.seqUtil.getSeq())},t.prototype.updateSetting=function(t){this.currentSeq=this.seqUtil.getSeq(),this.maxSeq=this.currentSeq,Object.assign(this,t)},t.prototype.constructReportData=function(t){return Ls({uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,subType:Ga,jxgId:this.jxgId,parentBelongSeq:this.jxgBelongSeq,id:this.id,type:this.type,label:this.label,withLabel:this.withLabel,showLabel:this.showLabel,isHighlighted:this.isHighlighted,isSelected:this.isSelected,color:this.color,hightlightedColor:this.hightlightedColor,selectedColor:this.selectedColor,hidden:Number(!this.show)},t)},t.prototype.constructRealtimeData=function(t){return Ls({action:M.PROTOCOL_ACTION.JSXGRAPH_GRAPH_ELEMENT,seq:this.currentSeq,belongSeq:this.belongSeq,jxgId:this.jxgId,jxgBelongSeq:this.jxgBelongSeq,id:this.id,type:this.type,label:this.label,withLabel:this.withLabel,showLabel:this.showLabel,isHighlighted:this.isHighlighted,isSelected:this.isSelected,color:this.color,hightlightedColor:this.hightlightedColor,selectedColor:this.selectedColor,show:this.show},t)},t.prototype.getReportData=function(){return{uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,subType:Ga,jxgId:this.jxgId,parentBelongSeq:this.jxgBelongSeq,id:this.id,type:this.type,label:this.label,withLabel:this.withLabel,showLabel:this.showLabel,isHighlighted:this.isHighlighted,isSelected:this.isSelected,color:this.color,hightlightedColor:this.hightlightedColor,selectedColor:this.selectedColor,hidden:Number(!this.show)}},t.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.JSXGRAPH_GRAPH_ELEMENT,seq:this.currentSeq,belongSeq:this.belongSeq,jxgId:this.jxgId,jxgBelongSeq:this.jxgBelongSeq,id:this.id,type:this.type,label:this.label,withLabel:this.withLabel,showLabel:this.showLabel,isHighlighted:this.isHighlighted,isSelected:this.isSelected,color:this.color,hightlightedColor:this.hightlightedColor,selectedColor:this.selectedColor,show:this.show}},t.prototype.getReportDataForHistory=function(t){var e=this.getReportData();return t?e:{type:"layer",seq:this.seqUtil.getSeq(),content:JSON.stringify(e)}},t}(),Rs=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ns=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.firstArrow=!1,i.lastArrow=!1,i.dash=0,i.type="line",i.startPoint=r.startPoint,i.endPoint=r.endPoint,i.label=r.label,i.straightFirst=r.straightFirst,i.straightLast=r.straightLast,i.firstArrow=r.firstArrow||!1,i.lastArrow=r.lastArrow||!1,i.dash=r.dash||0,i}return Rs(e,t),e.prototype.getReportData=function(){return this.constructReportData({startPoint:this.startPoint,endPoint:this.endPoint,straightFirst:this.straightFirst,straightLast:this.straightLast,firstArrow:this.firstArrow,lastArrow:this.lastArrow,dash:this.dash})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({startPoint:this.startPoint,endPoint:this.endPoint,straightFirst:this.straightFirst,straightLast:this.straightLast,firstArrow:this.firstArrow,lastArrow:this.lastArrow,dash:this.dash})},e}(Ms),Bs=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ks=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="point",i.x=r.x,i.y=r.y,i.label=r.label,i}return Bs(e,t),e.prototype.getReportData=function(){return this.constructReportData({x:this.x,y:this.y})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({x:this.x,y:this.y})},e}(Ms),Fs=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Us=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="angle",i.vertexA=r.vertexA,i.vertexB=r.vertexB,i.vertexC=r.vertexC,i.label=r.label,i}return Fs(e,t),e.prototype.getReportData=function(){return this.constructReportData({vertexA:this.vertexA,vertexB:this.vertexB,vertexC:this.vertexC})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({vertexA:this.vertexA,vertexB:this.vertexB,vertexC:this.vertexC})},e}(Ms),Hs=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Gs=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="circle",i.centerPoint=r.centerPoint,i.radius=r.radius,i.label=r.label,i.circlePoint=r.circlePoint,i}return Hs(e,t),e.prototype.getReportData=function(){return this.constructReportData({centerPoint:this.centerPoint,radius:this.radius,circlePoint:this.circlePoint})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({centerPoint:this.centerPoint,radius:this.radius,circlePoint:this.circlePoint})},e}(Ms),qs=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ws=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="expression",i.expression=r.expression,i.label=r.label||i.expression,i}return qs(e,t),e.prototype.getReportData=function(){return this.constructReportData({expression:this.expression})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({expression:this.expression})},e}(Ms),Ys=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),zs=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="polygon",i.vertices=r.vertices,i.label=r.label,i}return Ys(e,t),e.prototype.getReportData=function(){return this.constructReportData({vertices:this.vertices})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({vertices:this.vertices})},e}(Ms),js=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Vs=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="circularcone",i.centerPoint=r.centerPoint,i.xAxisPoint=r.xAxisPoint,i.zAxisPoint=r.zAxisPoint,i.radius=r.radius,i.high=r.high,i.mirrorPoint=r.mirrorPoint,i.leftEdge=r.leftEdge,i.rightEdge=r.rightEdge,i.upperHalfCircle=r.upperHalfCircle,i.lowerHalfCircle=r.lowerHalfCircle,i}return js(e,t),e.prototype.getReportData=function(){return this.constructReportData({centerPoint:this.centerPoint,xAxisPoint:this.xAxisPoint,zAxisPoint:this.zAxisPoint,radius:this.radius,high:this.high,mirrorPoint:this.mirrorPoint,leftEdge:this.leftEdge,rightEdge:this.rightEdge,upperHalfCircle:this.upperHalfCircle,lowerHalfCircle:this.lowerHalfCircle})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({centerPoint:this.centerPoint,xAxisPoint:this.xAxisPoint,zAxisPoint:this.zAxisPoint,radius:this.radius,high:this.high,mirrorPoint:this.mirrorPoint,leftEdge:this.leftEdge,rightEdge:this.rightEdge,upperHalfCircle:this.upperHalfCircle,lowerHalfCircle:this.lowerHalfCircle})},e}(Ms),Xs=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Js=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="glider",i.label=r.label,i.relyElement=r.relyElement,i.x=r.x,i.y=r.y,i}return Xs(e,t),e.prototype.getReportData=function(){return this.constructReportData({relyElement:this.relyElement,x:this.x,y:this.y})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({relyElement:this.relyElement,x:this.x,y:this.y})},e}(Ms),Ks=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Zs=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="mirrorpoint",i.originPoint=r.originPoint,i.mirrorAnchor=r.mirrorAnchor,i.label=r.label,i}return Ks(e,t),e.prototype.getReportData=function(){return this.constructReportData({originPoint:this.originPoint,mirrorAnchor:this.mirrorAnchor})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({originPoint:this.originPoint,mirrorAnchor:this.mirrorAnchor})},e}(Ms),Qs=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),$s=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.dash=0,i.type="curve",i.x=r.x,i.y=r.y,i.a=r.a,i.b=r.b,i.dash=r.dash||0,i.label=r.label,i.fmtX=i.formatData(i.x),i.fmtY=i.formatData(i.y),i.fmtA=i.formatData(i.a),i.fmtB=i.formatData(i.b),i}return Qs(e,t),e.prototype.formatData=function(t){return R(t)?new Function(t):new Function("return "+t+";")},e.prototype.getReportData=function(){return this.constructReportData({x:this.x,y:this.y,a:this.a,b:this.b,dash:this.dash})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({x:this.x,y:this.y,a:this.a,b:this.b,dash:this.dash})},e}(Ms),tl=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),el=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="parallelpoint",i.pointA=r.pointA,i.pointB=r.pointB,i.pointC=r.pointC,i.label=r.label,i}return tl(e,t),e.prototype.getReportData=function(){return this.constructReportData({pointA:this.pointA,pointB:this.pointB,pointC:this.pointC})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({pointA:this.pointA,pointB:this.pointB,pointC:this.pointC})},e}(Ms),rl=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),il=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="cylinder",i.centerPoint=r.centerPoint,i.xAxisPoint=r.xAxisPoint,i.zAxisPoint=r.zAxisPoint,i.topParallelPoint=r.topParallelPoint,i.topMirrorPoint=r.topMirrorPoint,i.bottomMirrorPoint=r.bottomMirrorPoint,i.radius=r.radius,i.high=r.high,i.topUpperHalfCircle=r.topUpperHalfCircle,i.topLowerHalfCircle=r.topLowerHalfCircle,i.bottomUpperHalfCircle=r.bottomUpperHalfCircle,i.bottomLowerHalfCircle=r.bottomLowerHalfCircle,i.leftEdge=r.leftEdge,i.rightEdge=r.rightEdge,i.label=r.label,i}return rl(e,t),e.prototype.getReportData=function(){return this.constructReportData({centerPoint:this.centerPoint,xAxisPoint:this.xAxisPoint,zAxisPoint:this.zAxisPoint,topParallelPoint:this.topParallelPoint,topMirrorPoint:this.topMirrorPoint,bottomMirrorPoint:this.bottomMirrorPoint,radius:this.radius,high:this.high,topUpperHalfCircle:this.topUpperHalfCircle,topLowerHalfCircle:this.topLowerHalfCircle,bottomUpperHalfCircle:this.bottomUpperHalfCircle,bottomLowerHalfCircle:this.bottomLowerHalfCircle,leftEdge:this.leftEdge,rightEdge:this.rightEdge})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({centerPoint:this.centerPoint,xAxisPoint:this.xAxisPoint,zAxisPoint:this.zAxisPoint,topParallelPoint:this.topParallelPoint,topMirrorPoint:this.topMirrorPoint,bottomMirrorPoint:this.bottomMirrorPoint,radius:this.radius,high:this.high,topUpperHalfCircle:this.topUpperHalfCircle,topLowerHalfCircle:this.topLowerHalfCircle,bottomUpperHalfCircle:this.bottomUpperHalfCircle,bottomLowerHalfCircle:this.bottomLowerHalfCircle,leftEdge:this.leftEdge,rightEdge:this.rightEdge})},e}(Ms),ol=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),nl=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="cube",i.vertexA=r.vertexA,i.vertexB=r.vertexB,i.vertexC=r.vertexC,i.vertexD=r.vertexD,i.vertexA1=r.vertexA1,i.vertexB1=r.vertexB1,i.vertexC1=r.vertexC1,i.vertexD1=r.vertexD1,i.edgeAB=r.edgeAB,i.edgeBC=r.edgeBC,i.edgeCD=r.edgeCD,i.edgeDA=r.edgeDA,i.edgeA1B1=r.edgeA1B1,i.edgeB1C1=r.edgeB1C1,i.edgeC1D1=r.edgeC1D1,i.edgeD1A1=r.edgeD1A1,i.edgeAA1=r.edgeAA1,i.edgeBB1=r.edgeBB1,i.edgeCC1=r.edgeCC1,i.edgeDD1=r.edgeDD1,i.label=r.label,i}return ol(e,t),e.prototype.getReportData=function(){return this.constructReportData({vertexA:this.vertexA,vertexB:this.vertexB,vertexC:this.vertexC,vertexD:this.vertexD,vertexA1:this.vertexA1,vertexB1:this.vertexB1,vertexC1:this.vertexC1,vertexD1:this.vertexD1,edgeAB:this.edgeAB,edgeBC:this.edgeBC,edgeCD:this.edgeCD,edgeDA:this.edgeDA,edgeA1B1:this.edgeA1B1,edgeB1C1:this.edgeB1C1,edgeC1D1:this.edgeC1D1,edgeD1A1:this.edgeD1A1,edgeAA1:this.edgeAA1,edgeBB1:this.edgeBB1,edgeCC1:this.edgeCC1,edgeDD1:this.edgeDD1})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({vertexA:this.vertexA,vertexB:this.vertexB,vertexC:this.vertexC,vertexD:this.vertexD,vertexA1:this.vertexA1,vertexB1:this.vertexB1,vertexC1:this.vertexC1,vertexD1:this.vertexD1,edgeAB:this.edgeAB,edgeBC:this.edgeBC,edgeCD:this.edgeCD,edgeDA:this.edgeDA,edgeA1B1:this.edgeA1B1,edgeB1C1:this.edgeB1C1,edgeC1D1:this.edgeC1D1,edgeD1A1:this.edgeD1A1,edgeAA1:this.edgeAA1,edgeBB1:this.edgeBB1,edgeCC1:this.edgeCC1,edgeDD1:this.edgeDD1})},e}(Ms),al=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),sl=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="ellipse",i.f1=r.f1,i.f2=r.f2,i.ellipsePoint=r.ellipsePoint,i.label=r.label,i}return al(e,t),e.prototype.getReportData=function(){return this.constructReportData({f1:this.f1,f2:this.f2,ellipsePoint:this.ellipsePoint})},e.prototype.getRealTimeData=function(){return this.constructRealtimeData({f1:this.f1,f2:this.f2,ellipsePoint:this.ellipsePoint})},e}(Ms),ll=function(){function t(){}return t.createElement=function(t,e){var r=e.type;return"line"===r?new Ns(t,e):"point"===r?new ks(t,e):"circle"===r?new Gs(t,e):"angle"===r?new Us(t,e):"polygon"===r?new zs(t,e):"glider"===r?new Js(t,e):"mirrorpoint"===r?new Zs(t,e):"circularcone"===r?new Vs(t,e):"curve"===r?new $s(t,e):"parallelpoint"===r?new el(t,e):"cylinder"===r?new il(t,e):"cube"===r?new nl(t,e):"ellipse"===r?new sl(t,e):"expression"===r?new Ws(t,e):null},t}(),cl=function(){function t(){this.pointPrefix="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this.linePrefix="l",this.circlePrefix="c",this.graphPrefix="g",this.functionPrefix="f",this.anglePrefix=["alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega"].map((function(t){return"&".concat(t,";")})),this.vectorPrefix="v",this.ellipsePrefix="e",this.pointCount=0,this.lineCount=0,this.circleCount=0,this.polygonCount=0,this.functionCount=0,this.angleCount=0,this.vectorCount=0,this.ellipseCount=0}return t.prototype.getElementLabel=function(t){return"point"===t?this.getPointLabel():"line"===t?this.getLineLabel():"circle"===t?this.getCircleLabel():"polygon"===t?this.getPolygonLabel():"angle"===t?this.getAngleLabel():"vector"===t?this.getVectorLabel():"ellipse"===t?this.getEllipseLabel():this.getFunctionLabel()},t.prototype.updateElementCount=function(t,e){return"point"===t?this.updatePointCount(e):"line"===t?this.updateLineCount(e):"circle"===t?this.updateCircleCount(e):"polygon"===t?this.updatePolygonCount(e):"angle"===t?this.updateAngleCount(e):"vector"===t?this.updateVectorCount(e):"ellipse"===t?this.updateEllipseCount(e):this.updateFunctionCount(e)},t.prototype.getPointLabel=function(){var t=this.pointCount%26,e=(this.pointCount-t)/26,r=this.pointPrefix.charAt(t);return e>0&&(r+="_"+e),++this.pointCount,r},t.prototype.getLineLabel=function(){var t=this.linePrefix+"_{"+this.lineCount+"}";return++this.lineCount,t},t.prototype.getCircleLabel=function(){var t=this.circlePrefix+"_{"+this.circleCount+"}";return++this.circleCount,t},t.prototype.getPolygonLabel=function(){var t=this.graphPrefix+"_{"+this.polygonCount+"}";return++this.polygonCount,t},t.prototype.getFunctionLabel=function(){var t=this.functionPrefix+"_{"+this.functionCount+"}(x)";return++this.functionCount,t},t.prototype.getAngleLabel=function(){var t=this.angleCount%25,e=(this.angleCount-t)/25,r=this.anglePrefix[t];return e>0&&(r+="_"+e),++this.angleCount,r},t.prototype.getVectorLabel=function(){var t=this.vectorPrefix+"_{"+this.vectorCount+"}";return++this.vectorCount,t},t.prototype.getEllipseLabel=function(){var t=this.ellipsePrefix+"_{"+this.ellipseCount+"}";return++this.ellipseCount,t},t.prototype.updatePointCount=function(t){var e=t.split("_"),r=this.pointCount;r=1===e.length?e[0].charCodeAt(0)-65:26*Number(e[1])+e[0].charCodeAt(0)-65,this.pointCount=Math.max(this.pointCount,r+1)},t.prototype.updateLineCount=function(t){var e=t.match(/^l_\{(\d+)\}$/),r=this.lineCount;e&&(r=Number(e[1])),this.lineCount=Math.max(this.lineCount,r+1)},t.prototype.updateCircleCount=function(t){var e=t.match(/^c_\{(\d+)\}$/),r=this.circleCount;e&&(r=Number(e[1])),this.circleCount=Math.max(this.circleCount,r+1)},t.prototype.updatePolygonCount=function(t){var e=t.match(/^g_\{(\d+)\}$/),r=this.polygonCount;e&&(r=Number(e[1])),this.polygonCount=Math.max(this.polygonCount,r+1)},t.prototype.updateFunctionCount=function(t){var e=t.match(/^f_\{(\d+)\}\(x\)$/),r=this.functionCount;e&&(r=Number(e[1])),this.functionCount=Math.max(this.functionCount,r+1)},t.prototype.updateAngleCount=function(t){var e=t.split("_"),r=this.angleCount;r=1===e.length?this.anglePrefix.indexOf(e[0]):25*Number(e[1])+this.anglePrefix.indexOf(e[0]),this.angleCount=Math.max(this.angleCount,r+1)},t.prototype.updateVectorCount=function(t){var e=t.match(/^v_\{(\d+)\}$/),r=this.vectorCount;e&&(r=Number(e[1])),this.vectorCount=Math.max(this.vectorCount,r+1)},t.prototype.updateEllipseCount=function(t){var e=t.match(/^e_\{(\d+)\}$/),r=this.ellipseCount;e&&(r=Number(e[1])),this.ellipseCount=Math.max(this.ellipseCount,r+1)},t}(),hl={NONE:0,POINT:1,LINE:2,LINE_SEGMENT:3,RAY:4,CIRCLE:5,ANGLE:6,POLYGON:7,VECTOR:8,ELLIPSE:9,CUBE:101,CYLINDER:102,CIRCULAR_CONE:103},ul=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),dl=function(){return(dl=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},pl=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function a(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},fl=function(t,e){var r,i,o,n,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},gl=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},ml=function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},yl=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vl=function(t){function e(e,r,i){var o,n,a,s=this;return(s=t.call(this,e,{listener:{updatePosition:function(t,e){},updateScale:function(t,e){s.boardSizeChange=!0},updateRotate:function(t){s.deg=t}}},"mathBoard")||this).type="element",s.subType=Ta.TEDU_BOARD_ELEMENT_MATH_BOARD,s.boundingboxChangeTimer=null,s.boardSizeChange=!1,s.selectedGraphIds={},s.boardId=r.boardId,s.show=r.show,s.visible=r.visible,s.user=r.user,s.belongSeq=r.belongSeq,s.width=r.width,s.height=r.height,s.time=r.time||Wt.getTimeStamp(),s.x=r.x||5e3-s.width/2,s.y=r.y||5e3-s.height/2,s.focusStatus="blur",s.container=null,s.boardWidth=r.boardWidth||0,s.boardHeight=r.boardHeight||0,s.deg=r.deg||0,s.axisColor=r.axisColor||"#AEAEAE",s.lockElement=r.lockElement,s.rectArea={maxX:0,maxY:0,minX:0,minY:0},s.pointArr=[],s.store=i.store,s.ID="".concat(r.belongSeq),s.erasable=r.erasable,s.jxgInstance=null,r.boardAttr?s.jxgBoardAttr=dl(dl({},r.boardAttr),{id:s.ID}):s.jxgBoardAttr={id:s.ID,boundingbox:r.boundingbox||[-5,5,5,-5],keepaspectratio:!1,axis:null===(o=r.axis)||void 0===o||o,defaultAxes:{y:{strokeColor:s.axisColor,ticks:{drawLabels:!0,strokeColor:s.axisColor,label:{strokeColor:s.axisColor}}},x:{strokeColor:s.axisColor,ticks:{drawLabels:!0,strokeColor:s.axisColor,label:{strokeColor:s.axisColor}}}},showNavigation:null===(n=r.showNavigation)||void 0===n||n,grid:null===(a=r.grid)||void 0===a||a,zoom:{enabled:r.enableZoom||!1,needShift:!0},pan:{enabled:r.enablePan||!1,needShift:!0},selection:{enabled:!1,needShift:!1},showCopyright:!1},s.graphs={},s.boundingboxChangeTimer=null,s.needToSync=!1,s.actionFromButton=!1,s.currentSeq=r.belongSeq,s.maxSeq=s.currentSeq,s.graphCounter=new cl,s}return ul(e,t),e.prototype.updateBoard=function(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=0),r<this.maxSeq||(this.maxSeq=r,this.jxgBoardAttr=t,this.jxgInstance&&(this.needToSync=!e,this.jxgInstance.setBoundingBox(this.jxgBoardAttr.boundingbox,this.jxgBoardAttr.keepaspectratio)))},e.prototype.updateGraph=function(t,e,r){return void 0===e&&(e=!1),void 0===r&&(r=this.seqUtil.getSeq()),pl(this,void 0,void 0,(function(){var i,o,n,a;return fl(this,(function(s){switch(s.label){case 0:return t?(i=t.id,e&&this.graphs[i]&&r<this.graphs[i].maxSeq?[2,!1]:(t.maxSeq=r,t.jxgId=this.jxgBoardAttr.id,t.jxgBelongSeq=this.belongSeq,this.graphs[i]||(this.graphs[i]=t),this.jxgInstance?[4,this.addGraphToSketch(i,t)]:[3,2])):[2,!1];case 1:return(a=s.sent())?(this.graphCounter.updateElementCount(t.type,t.label),(o=this.jxgInstance.objects[i])&&this.initGraphEvent(o),[2,!0]):(this.removeGraph(i),delete this.graphs[i],[2,!1]);case 2:return"expression"!==t.type?[2,!0]:(n=t.expression.replace(/[\[\{]/gi,"(").replace(/[\]\}]/gi,")").replace(/(\d)\s*([a-z\(])/gi,(function(t,e,r){return e+" * "+r})),[4,this.checkExprIsValidUseOfflineSketch(n,i)]);case 3:return(a=s.sent())||delete this.graphs[i],[2,a];case 4:return[2]}}))}))},e.prototype.removeGraph=function(t){var e=this.graphs[t];e?(e.updateSetting({show:!1}),this.removeGraphFromSketch(t),this.onSketchGraphStatusChanged(t)):this.removeGraphFromSketch(t)},e.prototype.removeGraphFromSketch=function(t,e){void 0===e&&(e=this.jxgInstance);try{return e.removeObject(e.select(t)),!0}catch(t){return!1}},e.prototype.checkExprIsValidUseOfflineSketch=function(t,r){return pl(this,void 0,void 0,(function(){var i,o;return fl(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.loadLib()];case 1:return n.sent(),i=window.TIW_MATH_GRAPH,e.offlineBoard||(o=i.JSXGraph.initRenderer(null,{width:0,height:0},!1,"no"),e.offlineBoard=new i.Board("",o,"",[0,0],0,0,1,1,0,0,{document:!1})),e.offlineBoard.jc.snippet(t,!0,"x",!1),[2,!0];case 2:return n.sent(),this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:r,message:"expression parse error"}),[2,!1];case 3:return[2]}}))}))},e.prototype.addGraphToSketch=function(t,e){return pl(this,void 0,void 0,(function(){var r,i;return fl(this,(function(o){switch(o.label){case 0:return[4,this.loadLib()];case 1:if(o.sent(),(r=this.jxgInstance).suspendUpdate(),!r.objects.hasOwnProperty(t))try{this.addGraphToSketchBaseOnType(t,e,r)}catch(t){return[2,!1]}return i=this.updateGraphOfSketch(t,e,r),r.unsuspendUpdate(),[2,i]}}))}))},e.prototype.addGraphToSketchBaseOnType=function(t,e,r){var i=window.TIW_MATH_GRAPH,o=this.initOptions(t,e);if("expression"===e.type)this._addFunctionGraph(t,e,r,o,i);else if("point"===e.type)this._addPointGraph(t,e,r,o,i);else if("line"===e.type)this._addLineGraph(t,e,r,o,i);else if("circle"===e.type)this._addCircleGraph(t,e,r,o,i);else if("angle"===e.type)this._addAngleGraph(t,e,r,o,i);else if("polygon"===e.type)this._addPolygonGraph(t,e,r,o,i);else if("glider"===e.type)this._addGliderGraph(t,e,r,o,i);else if("mirrorpoint"===e.type)this._addMirrorPointGraph(t,e,r,o,i);else if("curve"===e.type)this._addCurveGraph(t,e,r,o,i);else if("circularcone"===e.type)this._addCircularConeGraph(t,e,r,o,i);else if("parallelpoint"===e.type)this._addParallelPointGraph(t,e,r,o,i);else if("cylinder"===e.type)this._addCylinderGraph(t,e,r,o,i);else if("cube"===e.type)this._addCubeGraph(t,e,r,o,i);else{if("ellipse"!==e.type)throw"no match type";this._addEllipseGraph(t,e,r,o,i)}},e.prototype._addFunctionGraph=function(t,e,r,i,o){try{var n=e.expression.replace(/[\[\{]/gi,"(").replace(/[\]\}]/gi,")").replace(/(\d)\s*([a-z\(])/gi,(function(t,e,r){return e+" * "+r})),a=r.jc.snippet(n,!0,"x",!1);r.create("functiongraph",[a,function(){return new o.Coords(o.COORDS_BY_SCREEN,[0,0],r).usrCoords[1]},function(){return new o.Coords(o.COORDS_BY_SCREEN,[r.canvasWidth,0],r).usrCoords[1]}],i)}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"expression parse error"}),e}},e.prototype._addPointGraph=function(t,e,r,i,o){try{r.create("point",[e.x,e.y],i)}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add point error"}),e}},e.prototype._addLineGraph=function(t,e,r,i,o){try{var n=[r.select(e.startPoint),r.select(e.endPoint)],a=r.create("line",n,dl(dl({},i),{firstArrow:e.firstArrow,lastArrow:e.lastArrow,dash:e.dash}));a.setStraight(e.straightFirst,e.straightLast),a.setLabelRelativeCoords([0,-20])}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add line error"}),e}},e.prototype._addCircleGraph=function(t,e,r,i,o){try{var n=null;e.radius&&(n=[r.select(e.centerPoint),e.radius]),e.circlePoint&&(n=[r.select(e.centerPoint),r.select(e.circlePoint)]),r.create("circle",n,i)}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add circle error"}),e}},e.prototype._addAngleGraph=function(t,e,r,i,o){try{var n=[r.select(e.vertexA),r.select(e.vertexB),r.select(e.vertexC)];r.create("angle",n,i)}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add angle error"}),e}},e.prototype._addPolygonGraph=function(t,e,r,i,o){try{var n=e.vertices.map((function(t){return r.select(t)}));r.create("circle",n,i)}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add polygon error"}),e}},e.prototype._addGliderGraph=function(t,e,r,i,o){try{var n=r.select(e.relyElement);r.create("glider",[e.x,e.y,n],i)}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add glider error"}),e}},e.prototype._addMirrorPointGraph=function(t,e,r,i,o){try{var n=r.select(e.originPoint),a=r.select(e.mirrorAnchor);r.create("mirrorpoint",[n,a],i)}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add mirror point error"}),e}},e.prototype._addCurveGraph=function(t,e,r,i,o){try{var n=e.fmtX.call(r),a=e.fmtY.call(r),s=e.fmtA.call(r),l=e.fmtB.call(r);r.create("curve",[n,a,s,l],dl(dl({},i),{dash:e.dash}))}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add mirror point error"}),e}},e.prototype._addCircularConeGraph=function(t,e,r,i,o){var n,a,s,l=this;try{var c=r.select(e.centerPoint),h=r.select(e.xAxisPoint),u=r.select(e.zAxisPoint),d=e.boardId,p=this.jxgBoardAttr.id,f=this.belongSeq,g=function(t){return r.select(t)!==t},m=function(t,e,r,i){return ll.createElement(l.seqUtil,dl({type:"line",jxgId:p,jxgBelongSeq:f,boardId:d,show:!0,straightFirst:!1,straightLast:!1,seq:Number(t),startPoint:e,endPoint:r,dash:i},Ss.mathBoardElementStyle.line))},y=function(t,e,r,i,o,n){return ll.createElement(l.seqUtil,dl({type:"curve",jxgId:p,jxgBelongSeq:f,boardId:d,show:!0,seq:Number(t),x:e,y:r,a:i,b:o,dash:n},Ss.mathBoardElementStyle.line))},v="\n        const center = this.select('".concat(e.centerPoint,"');\n        const x = this.select('").concat(e.xAxisPoint,"');\n        const e = 0.96;\n        return function(t) {\n          const a = x.Dist(center);\n          const cost = (x.X() - center.X()) / a\n          const sint = (x.Y() - center.Y()) / a\n          const _x = (a * (1 - e * e)) / (1 - e * Math.cos(t)) * Math.cos(t) \n          const _y = (a * (1 - e * e)) / (1 - e * Math.cos(t)) * Math.sin(t)\n          return _x * cost - _y * sint + center.X() - 0.96 * a * cost;\n        }\n      "),_="\n        const center = this.select('".concat(e.centerPoint,"');\n        const x = this.select('").concat(e.xAxisPoint,"');\n        const e = 0.96;\n        return function(t) {\n          const a = x.Dist(center);\n          const cost = (x.X() - center.X()) / a\n          const sint = (x.Y() - center.Y()) / a\n          const _x = (a * (1 - e * e)) / (1 - e * Math.cos(t)) * Math.cos(t)\n          const _y = (a * (1 - e * e)) / (1 - e * Math.cos(t)) * Math.sin(t)\n          return _x * sint + _y * cost + center.Y() - 0.96 * a * sint;\n        }\n      "),E=m(e.radius,e.centerPoint,e.xAxisPoint,2),T=m(e.high,e.centerPoint,e.zAxisPoint,2),b=(n=e.mirrorPoint,a=e.xAxisPoint,s=e.centerPoint,ll.createElement(l.seqUtil,{type:"mirrorpoint",jxgId:p,jxgBelongSeq:f,boardId:d,show:!1,seq:Number(n),originPoint:a,mirrorAnchor:s})),S=m(e.rightEdge,e.mirrorPoint,e.zAxisPoint,0),x=m(e.leftEdge,e.xAxisPoint,e.zAxisPoint,0),w=y(e.upperHalfCircle,v,_,0,Math.PI,2),O=y(e.lowerHalfCircle,v,_,Math.PI,2*Math.PI,0),I=g(b.id)?r.select(b.id):r.create("mirrorpoint",[h,c],dl(dl({},this.initOptions(b.id,b)),{visible:!1})),A=g(E.id)?r.select(E.id):r.create("line",[c,h],dl(dl({},this.initOptions(E.id,E)),{straightFirst:E.straightFirst,straightLast:E.straightLast,dash:E.dash})),D=g(T.id)?r.select(T.id):r.create("line",[c,u],dl(dl({},this.initOptions(T.id,T)),{straightFirst:T.straightFirst,straightLast:T.straightLast,dash:T.dash})),C=g(S.id)?r.select(S.id):r.create("line",[I,u],dl(dl({},this.initOptions(S.id,S)),{straightFirst:S.straightFirst,straightLast:S.straightLast,dash:S.dash})),P=g(x.id)?r.select(x.id):r.create("line",[h,u],dl(dl({},this.initOptions(x.id,x)),{straightFirst:x.straightFirst,straightLast:x.straightLast,dash:x.dash})),L=g(w.id)?r.select(w.id):r.create("curve",[w.fmtX.call(r),w.fmtY.call(r),w.fmtA.call(r),w.fmtB.call(r)],dl(dl({},this.initOptions(w.id,w)),{dash:w.dash})),M=g(O.id)?r.select(O.id):r.create("curve",[O.fmtX.call(r),O.fmtY.call(r),O.fmtA.call(r),O.fmtB.call(r)],dl(dl({},this.initOptions(O.id,O)),{dash:O.dash}));e.show?(A.show(),D.show(),C.show(),P.show(),L.show(),M.show()):(A.hide(),D.hide(),C.hide(),P.hide(),L.hide(),M.hide());var R=[h,u,I,A,D,C,P,L,M];R.forEach((function(t){return t.addParents(ml([c],gl(R.filter((function(e){return e.id!==t.id}))),!1))})),c.addParents(R),r.create("group",[c,h,u],{id:t}).setTranslationPoints([c])}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add circular cone error"}),e}},e.prototype._addParallelPointGraph=function(t,e,r,i,o){try{var n=r.select(e.pointA),a=r.select(e.pointB),s=r.select(e.pointC);r.create("parallelpoint",[n,a,s],i)}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add parallel point error"}),e}},e.prototype._addCylinderGraph=function(t,e,r,i,o){var n,a,s,l,c=this;try{var h=r.select(e.centerPoint),u=r.select(e.xAxisPoint),d=r.select(e.zAxisPoint),p=e.boardId,f=this.jxgBoardAttr.id,g=this.belongSeq,m=function(t){return r.select(t)!==t},y=function(t,e,r){return ll.createElement(c.seqUtil,{type:"mirrorpoint",jxgId:f,jxgBelongSeq:g,boardId:p,show:!1,seq:Number(t),originPoint:e,mirrorAnchor:r})},v=function(t,e,r,i){return ll.createElement(c.seqUtil,dl({type:"line",jxgId:f,jxgBelongSeq:g,boardId:p,show:!0,straightFirst:!1,straightLast:!1,seq:Number(t),startPoint:e,endPoint:r,dash:i},Ss.mathBoardElementStyle.line))},_=function(t,e,r,i,o,n){return ll.createElement(c.seqUtil,dl({type:"curve",jxgId:f,jxgBelongSeq:g,boardId:p,show:!0,seq:Number(t),x:e,y:r,a:i,b:o,dash:n},Ss.mathBoardElementStyle.line))},E=function(t,e){return"\n          const center = this.select('".concat(t,"');\n          const x = this.select('").concat(e,"');\n          const e = 0.96;\n          return function(t) {\n            const a = x.Dist(center);\n            const cost = (x.X() - center.X()) / a\n            const sint = (x.Y() - center.Y()) / a\n            const _x = (a * (1 - e * e)) / (1 - e * Math.cos(t)) * Math.cos(t) \n            const _y = (a * (1 - e * e)) / (1 - e * Math.cos(t)) * Math.sin(t)\n            return _x * cost - _y * sint + center.X() - 0.96 * a * cost;\n          }\n        ")},T=function(t,e){return"\n          const center = this.select('".concat(t,"');\n          const x = this.select('").concat(e,"');\n          const e = 0.96;\n          return function(t) {\n            const a = x.Dist(center);\n            const cost = (x.X() - center.X()) / a\n            const sint = (x.Y() - center.Y()) / a\n            const _x = (a * (1 - e * e)) / (1 - e * Math.cos(t)) * Math.cos(t)\n            const _y = (a * (1 - e * e)) / (1 - e * Math.cos(t)) * Math.sin(t)\n            return _x * sint + _y * cost + center.Y() - 0.96 * a * sint;\n          }\n        ")},b=E(e.zAxisPoint,e.topParallelPoint),S=T(e.zAxisPoint,e.topParallelPoint),x=E(e.centerPoint,e.xAxisPoint),w=T(e.centerPoint,e.xAxisPoint),O=v(e.radius,e.centerPoint,e.xAxisPoint,2),I=v(e.high,e.centerPoint,e.zAxisPoint,2),A=y(e.bottomMirrorPoint,e.xAxisPoint,e.centerPoint),D=(n=e.topParallelPoint,a=e.centerPoint,s=e.xAxisPoint,l=e.zAxisPoint,ll.createElement(c.seqUtil,{type:"parallelpoint",jxgId:f,jxgBelongSeq:g,boardId:p,show:!1,seq:Number(n),pointA:a,pointB:s,pointC:l})),C=y(e.topMirrorPoint,e.topParallelPoint,e.zAxisPoint),P=v(e.rightEdge,e.topMirrorPoint,e.bottomMirrorPoint,0),L=v(e.leftEdge,e.topParallelPoint,e.xAxisPoint,0),M=_(e.topUpperHalfCircle,b,S,0,Math.PI,0),R=_(e.topLowerHalfCircle,b,S,Math.PI,2*Math.PI,0),N=_(e.bottomUpperHalfCircle,x,w,0,Math.PI,2),B=_(e.bottomLowerHalfCircle,x,w,Math.PI,2*Math.PI,0),k=m(A.id)?r.select(A.id):r.create("mirrorpoint",[u,h],dl(dl({},this.initOptions(A.id,A)),{visible:!1})),F=m(D.id)?r.select(D.id):r.create("parallelpoint",[h,u,d],dl(dl({},this.initOptions(D.id,D)),{visible:!1})),U=m(C.id)?r.select(C.id):r.create("mirrorpoint",[F,d],dl(dl({},this.initOptions(C.id,C)),{visible:!1})),H=m(O.id)?r.select(O.id):r.create("line",[h,u],dl(dl({},this.initOptions(O.id,O)),{straightFirst:O.straightFirst,straightLast:O.straightLast,dash:O.dash})),G=m(I.id)?r.select(I.id):r.create("line",[h,d],dl(dl({},this.initOptions(I.id,I)),{straightFirst:I.straightFirst,straightLast:I.straightLast,dash:I.dash})),q=m(P.id)?r.select(P.id):r.create("line",[k,U],dl(dl({},this.initOptions(P.id,P)),{straightFirst:P.straightFirst,straightLast:P.straightLast,dash:P.dash})),W=m(L.id)?r.select(L.id):r.create("line",[u,F],dl(dl({},this.initOptions(L.id,L)),{straightFirst:L.straightFirst,straightLast:L.straightLast,dash:L.dash})),Y=m(M.id)?r.select(M.id):r.create("curve",[M.fmtX.call(r),M.fmtY.call(r),M.fmtA.call(r),M.fmtB.call(r)],dl(dl({},this.initOptions(M.id,M)),{dash:M.dash})),z=m(R.id)?r.select(R.id):r.create("curve",[R.fmtX.call(r),R.fmtY.call(r),R.fmtA.call(r),R.fmtB.call(r)],dl(dl({},this.initOptions(R.id,R)),{dash:R.dash})),j=m(N.id)?r.select(N.id):r.create("curve",[N.fmtX.call(r),N.fmtY.call(r),N.fmtA.call(r),N.fmtB.call(r)],dl(dl({},this.initOptions(N.id,N)),{dash:N.dash})),V=m(B.id)?r.select(B.id):r.create("curve",[B.fmtX.call(r),B.fmtY.call(r),B.fmtA.call(r),B.fmtB.call(r)],dl(dl({},this.initOptions(B.id,B)),{dash:B.dash}));e.show?(H.show(),G.show(),q.show(),W.show(),Y.show(),z.show(),j.show(),V.show()):(H.hide(),G.hide(),q.hide(),W.hide(),Y.hide(),z.hide(),j.hide(),V.hide());var X=[u,d,k,F,U,H,G,q,W,Y,z,j,V];X.forEach((function(t){return t.addParents(ml([h],gl(X.filter((function(e){return e.id!==t.id}))),!1))})),h.addParents(X),r.create("group",[h,u,d],{id:t}).setTranslationPoints([h])}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add cylinder error"}),e}},e.prototype._addCubeGraph=function(t,e,r,i,o){var n=this;try{var a=r.select(e.vertexA),s=r.select(e.vertexB),l=r.select(e.vertexC),c=r.select(e.vertexA1),h=e.boardId,u=this.jxgBoardAttr.id,d=this.belongSeq,p=function(t,e,r,i){return ll.createElement(n.seqUtil,{type:"parallelpoint",jxgId:u,jxgBelongSeq:d,boardId:h,show:!1,seq:Number(t),pointA:e,pointB:r,pointC:i})},f=function(t,e,r,i){return ll.createElement(n.seqUtil,dl({type:"line",jxgId:u,jxgBelongSeq:d,boardId:h,show:!0,straightFirst:!1,straightLast:!1,seq:Number(t),startPoint:e,endPoint:r,dash:i},Ss.mathBoardElementStyle.line))},g=function(t){return r.select(t)!==t},m=p(e.vertexD,e.vertexB,e.vertexA,e.vertexC),y=p(e.vertexB1,e.vertexA,e.vertexB,e.vertexA1),v=p(e.vertexD1,e.vertexA,e.vertexD,e.vertexA1),_=p(e.vertexC1,e.vertexA1,e.vertexB1,e.vertexD1),E=f(e.edgeAB,e.vertexA,e.vertexB,0),T=f(e.edgeBC,e.vertexB,e.vertexC,0),b=f(e.edgeCD,e.vertexC,e.vertexD,2),S=f(e.edgeDA,e.vertexD,e.vertexA,2),x=f(e.edgeA1B1,e.vertexA1,e.vertexB1,0),w=f(e.edgeB1C1,e.vertexB1,e.vertexC1,0),O=f(e.edgeC1D1,e.vertexC1,e.vertexD1,0),I=f(e.edgeD1A1,e.vertexD1,e.vertexA1,0),A=f(e.edgeAA1,e.vertexA,e.vertexA1,0),D=f(e.edgeBB1,e.vertexB,e.vertexB1,0),C=f(e.edgeCC1,e.vertexC,e.vertexC1,0),P=f(e.edgeDD1,e.vertexD,e.vertexD1,2),L=g(m.id)?r.select(m.id):r.create("parallelpoint",[s,a,l],dl(dl({},this.initOptions(m.id,m)),{visible:!1})),M=g(y.id)?r.select(y.id):r.create("parallelpoint",[a,s,c],dl(dl({},this.initOptions(y.id,y)),{visible:!1})),R=g(v.id)?r.select(v.id):r.create("parallelpoint",[a,L,c],dl(dl({},this.initOptions(v.id,v)),{visible:!1})),N=g(_.id)?r.select(_.id):r.create("parallelpoint",[c,M,R],dl(dl({},this.initOptions(_.id,_)),{visible:!1})),B=g(E.id)?r.select(E.id):r.create("line",[a,s],dl(dl({},this.initOptions(E.id,E)),{straightFirst:E.straightFirst,straightLast:E.straightLast,dash:E.dash})),k=g(T.id)?r.select(T.id):r.create("line",[s,l],dl(dl({},this.initOptions(T.id,T)),{straightFirst:T.straightFirst,straightLast:T.straightLast,dash:T.dash})),F=g(b.id)?r.select(b.id):r.create("line",[l,L],dl(dl({},this.initOptions(b.id,b)),{straightFirst:b.straightFirst,straightLast:b.straightLast,dash:b.dash})),U=g(S.id)?r.select(S.id):r.create("line",[L,a],dl(dl({},this.initOptions(S.id,S)),{straightFirst:S.straightFirst,straightLast:S.straightLast,dash:S.dash})),H=g(x.id)?r.select(x.id):r.create("line",[c,M],dl(dl({},this.initOptions(x.id,x)),{straightFirst:x.straightFirst,straightLast:x.straightLast,dash:x.dash})),G=g(w.id)?r.select(w.id):r.create("line",[M,N],dl(dl({},this.initOptions(w.id,w)),{straightFirst:w.straightFirst,straightLast:w.straightLast,dash:w.dash})),q=g(O.id)?r.select(O.id):r.create("line",[N,R],dl(dl({},this.initOptions(O.id,O)),{straightFirst:O.straightFirst,straightLast:O.straightLast,dash:O.dash})),W=g(I.id)?r.select(I.id):r.create("line",[R,c],dl(dl({},this.initOptions(I.id,I)),{straightFirst:I.straightFirst,straightLast:I.straightLast,dash:I.dash})),Y=g(A.id)?r.select(A.id):r.create("line",[a,c],dl(dl({},this.initOptions(A.id,A)),{straightFirst:A.straightFirst,straightLast:A.straightLast,dash:A.dash})),z=g(D.id)?r.select(D.id):r.create("line",[s,M],dl(dl({},this.initOptions(D.id,D)),{straightFirst:D.straightFirst,straightLast:D.straightLast,dash:D.dash})),j=g(C.id)?r.select(C.id):r.create("line",[l,N],dl(dl({},this.initOptions(C.id,C)),{straightFirst:C.straightFirst,straightLast:C.straightLast,dash:C.dash})),V=g(P.id)?r.select(P.id):r.create("line",[L,R],dl(dl({},this.initOptions(P.id,P)),{straightFirst:P.straightFirst,straightLast:P.straightLast,dash:P.dash}));e.show?(B.show(),k.show(),F.show(),U.show(),H.show(),G.show(),q.show(),W.show(),Y.show(),z.show(),j.show(),V.show()):(B.hide(),k.hide(),F.hide(),U.hide(),H.hide(),G.hide(),q.hide(),W.hide(),Y.hide(),z.hide(),j.hide(),V.hide());var X=[s,l,c,L,M,R,N,B,k,F,U,H,G,q,W,Y,z,j,V];X.forEach((function(t){return t.addParents(ml([a],gl(X.filter((function(e){return e.id!==t.id}))),!1))})),a.addParents(X),r.create("group",[a,s,l,c],{id:t}).setTranslationPoints([a])}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add cube error"}),e}},e.prototype._addEllipseGraph=function(t,e,r,i,o){try{var n=r.select(e.f1),a=r.select(e.f2),s=r.select(e.ellipsePoint);r.create("ellipse",[n,a,s],i)}catch(e){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:t,message:"add ellipse error"}),e}},e.prototype.initOptions=function(t,e){return{id:t,label:{highlight:!1,strokeColor:e.color},highlight:!1,strokeColor:e.color,withLabel:!0,name:"",customType:e.type,selectable:!0,graphColor:"",showLabel:!1,isHighlighted:!1,isSelected:!1,expression:"",highlightedColor:e.hightlightedColor,selectedColor:e.selectedColor}},e.prototype.updateGraphOfSketch=function(t,e,r){if(void 0===r&&(r=this.jxgInstance),r.objects.hasOwnProperty(t)){var i=r.objects[t],o=this._updateBasicAttrs(i,t,e),n=o.graphObj,a=o.graphAttr;try{"expression"===i.getAttribute("customType")?this._updateFunctionGraph(r,i,e,t,n,a):"point"===i.elType?this._updatePointGraph(r,i,e,t,n,a):"glider"===i.elType?this._updateGliderGraph(r,i,e,t,n,a):i.setAttribute(a),this.graphs[t].updateSetting(n)}catch(t){return!1}return!0}return!!r.groups.hasOwnProperty(t)&&(e.hasOwnProperty("show")&&this.graphs[t].updateSetting({show:e.show}),!0)},e.prototype._updateBasicAttrs=function(t,e,r){var i,o,n,a={},s={};if(r.hasOwnProperty("show")&&(s.visible=r.show,a.show=r.show),r.hasOwnProperty("label")){var l=r.label;s.withLabel=!0,s.name=function(){return"angle"===this.elType?l+"("+(this.Value()/Math.PI*180).toFixed(1)+"°)":l},s.showLabel=""!==l,a.withLabel=!0,a.name=l,a.showLabel=""!==l}r.hasOwnProperty("color")&&(s.graphColor=r.color,a.color=r.color),r.hasOwnProperty("isHighlighted")&&(s.isHighlighted=r.isHighlighted,a.isHighlighted=r.isHighlighted),r.hasOwnProperty("isSelected")&&(r.isSelected&&(this.selectedGraphIds[e]=1),s.isSelected=r.isSelected,a.isSelected=r.isSelected);var c=null!==(i=r.color)&&void 0!==i?i:t.getAttribute("graphColor");return(null!==(o=r.isSelected)&&void 0!==o?o:t.getAttribute("isSelected"))?c=t.visProp.selectedcolor:(null!==(n=r.isHighlighted)&&void 0!==n?n:t.getAttribute("isHighlighted"))&&(c=t.visProp.highlightedcolor),s.strokeColor=c,"point"===t.elType&&(s.fillColor=c),t.label&&(s.label={strokeColor:c}),a.strokeColor=c,{graphAttr:s,graphObj:a}},e.prototype._updateFunctionGraph=function(t,e,r,i,o,n){if(e.setAttribute(n),r.hasOwnProperty("expression")&&e.getAttribute("expression")!==r.expression){e.setAttribute({expression:r.expression}),o.expression=r.expression;try{var a=r.expression.replace(/[\[\{]/gi,"(").replace(/[\]\}]/gi,")").replace(/(\d)\s*([a-z\(])/gi,(function(t,e,r){return e+" * "+r}));e.Y=t.jc.snippet(a,!0,"x",!1),e.updateCurve(),t.update()}catch(t){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:i,message:"expression parse error"}),t}}},e.prototype._updatePointGraph=function(t,e,r,i,o,n){var a=this.graphs[i],s=a.x,l=a.y,c=r.x,h=r.y;if(e.setAttribute(n),c!==s||h!==l)try{e.moveTo([c,h]),o.x=c,o.y=h,t.update()}catch(t){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:i,message:"update point error"}),t}},e.prototype._updateGliderGraph=function(t,e,r,i,o,n){var a=this.graphs[i],s=a.x,l=a.y,c=r.x,h=r.y;if(e.setAttribute(n),c!==s||h!==l)try{e.moveTo([c,h]),o.x=c,o.y=h,t.update()}catch(t){throw this.store.event.fireMathGraphEvent({code:-1,boardId:this.ID,graphId:i,message:"update glider error"}),t}},e.prototype.onSketchGraphStatusChanged=function(t){var e=this;if(this.needToSync)if(R(t)){var r=this.graphs[t];r&&(this.store.addRealtimeData(r.getRealTimeData()),this.store.report.reportLayerElement(r.getReportData()))}else t.forEach((function(t){var r=e.graphs[t];r&&(e.store.addRealtimeData(r.getRealTimeData()),e.store.report.reportLayerElement(r.getReportData()))}))},e.prototype.onSketchGraphSelected=function(t,e){var r,i,o,n,a=this,s=this.jxgInstance.select(t);if(s){var l=function(t,e){var r,i;if(t.ancestors){var o=Object.keys(t.ancestors).concat(t.parents).filter((function(t,e,r){return r.indexOf(t)===e}));try{for(var n=yl(o),s=n.next();!s.done;s=n.next()){var c=s.value,h=a.jxgInstance.select(c);"point"===h.elType||"glider"===h.elType?e[c]={x:h.X(),y:h.Y()}:l(h,e)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}}},c=function(t,e){e?a.selectedGraphIds[t]=1:a.selectedGraphIds[t]&&delete a.selectedGraphIds[t]};this.jxgInstance.suspendUpdate();var h=e&&!s.getAttribute("isSelected"),u={},d={};for(var p in"point"===s.elType||"glider"===s.elType?(d.x=s.X(),d.y=s.Y()):"expression"===s.getAttribute("customType")||l(s,u),this.updateGraphOfSketch(t,{isSelected:h,x:d.x,y:d.y},this.jxgInstance),this.onSketchGraphStatusChanged(t),c(t,h),u){var f=u[p];this.updateGraphOfSketch(p,{isSelected:!1,x:f.x,y:f.y},this.jxgInstance),this.onSketchGraphStatusChanged(p),c(p,!1)}if(s.groups)try{for(var g=yl(s.groups),m=g.next();!m.done;m=g.next()){var y=m.value,v=this.jxgInstance.groups[y];if(v)try{for(var _=(o=void 0,yl(v.parents)),E=_.next();!E.done;E=_.next()){var T=E.value;T===t||u[T]||this.jxgInstance.select(T)!==T&&(this.updateGraphOfSketch(T,{x:this.jxgInstance.select(T).X(),y:this.jxgInstance.select(T).Y()},this.jxgInstance),this.onSketchGraphStatusChanged(T),c(T,!1))}}catch(t){o={error:t}}finally{try{E&&!E.done&&(n=_.return)&&n.call(_)}finally{if(o)throw o.error}}}}catch(t){r={error:t}}finally{try{m&&!m.done&&(i=g.return)&&i.call(g)}finally{if(r)throw r.error}}this.jxgInstance.unsuspendUpdate()}},e.prototype.initGraphEvent=function(t){var e=this,r=[0,0];t.on("down",(function(t){e.needToSync=!0,r=e.jxgInstance.getMousePosition(t)})),t.on("up",(function(i){e.needToSync=!0;var o=e.jxgInstance.getMousePosition(i),n=e.jxgInstance.getAllObjectsUnderMouse(i).filter((function(t){return"axis"!==t.elType&&"text"!==t.elType}));if(n.length){var a=t.id;if(!n.map((function(t){return t.id})).includes(a))return;e.onSketchGraphSelected(a,e.checkIsClick(r,o)&&e.store.getMathGraphType()===hl.NONE)}e.needToSync=!1}))},e.prototype.onBoundingBoxChange=function(){var t=this;this.jxgBoardAttr.boundingbox=this.jxgInstance.getBoundingBox(),clearTimeout(this.boundingboxChangeTimer),this.boundingboxChangeTimer=setTimeout((function(){(t.needToSync||t.actionFromButton)&&(t.currentSeq=t.seqUtil.getSeq(),t.maxSeq=t.currentSeq,t.store.addRealtimeData(t.getRealTimeData()),t.store.report.reportLayerElement(t.getReportData()),t.actionFromButton=!1)}),200)},e.prototype.moveUp=function(){this.jxgInstance.clickDownArrow()},e.prototype.moveDown=function(){this.jxgInstance.clickUpArrow()},e.prototype.moveLeft=function(){this.jxgInstance.clickRightArrow()},e.prototype.moveRight=function(){this.jxgInstance.clickLeftArrow()},e.prototype.resetZoom=function(){this.jxgInstance.zoom100()},e.prototype.zoomIn=function(){this.jxgInstance.zoomIn()},e.prototype.zoomOut=function(){this.jxgInstance.zoomOut()},e.prototype.checkIsClick=function(t,e){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i<=1},e.prototype.createBoard=function(t,e){return void 0===e&&(e={}),pl(this,void 0,void 0,(function(){var r,i=this;return fl(this,(function(o){switch(o.label){case 0:return[4,this.loadLib()];case 1:return o.sent(),r=[0,0],this.jxgInstance=window.TIW_MATH_GRAPH.JSXGraph.initBoard(t,dl(dl({},this.jxgBoardAttr),e)),this.jxgInstance.on("boundingbox",(function(){i.onBoundingBoxChange()})),this.jxgInstance.on("down",(function(t){t.stopPropagation(),t.preventDefault(),i.maxSeq=i.seqUtil.getSeq(),i.needToSync=!0,r=i.jxgInstance.getMousePosition(t)})),this.jxgInstance.on("up",(function(t){t.stopPropagation(),t.preventDefault();var e=i.jxgInstance.getMousePosition(t),o=i.jxgInstance.containerObj.querySelector(".JXG_navigation").contains(t.target),n=i.jxgInstance.getAllObjectsUnderMouse(t);if(n=n.filter((function(t){return"axis"!==t.elType&&"text"!==t.elType})),!o&&i.checkIsClick(e,r)){var a=i.jxgInstance.getUsrCoordsOfMouse(t);i.store.event.fireAddMathGraphEvent({coords:a,mathGraphs:n.map((function(t){return{id:t.id,type:t.getAttribute("customType")}})),mathBoardId:i.ID,boardId:i.boardId})}i.needToSync=!1})),this.jxgInstance.reducedUpdate=!0,this.jxgBoardAttr.showNavigation&&this.addNavigationBar(),[2]}}))}))},e.prototype.addNavigationBar=function(){var t=this,e=this.jxgInstance.containerObj.querySelector(".JXG_navigation");if(e.querySelectorAll(".JXG_navigation_button").length){for(var r=escape(this.axisColor),i=["data:image/svg+xml,%3Csvg t='1623122481738' fill='".concat(r,"' class='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='7130' width='14' height='14'%3E%3Cpath d='M810.666667 480v64H213.333333v-64z' p-id='7131'%3E%3C/path%3E%3C/svg%3E"),"data:image/svg+xml,%3Csvg t='1623123193421' fill='".concat(r,"' class='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='8558' width='14' height='14'%3E%3Cpath d='M562.368 797.397333l-1.216 0.149334 5.333333-0.64-2.773333 0.32 2.965333-0.362667-0.213333 0.042667 0.277333-0.042667 1.130667-0.192 0.256-0.042667 1.472-0.170666 3.114667-0.469334-0.64 0.106667 1.344-0.234667 3.541333-0.576-1.472 0.256 0.789333-0.106666 1.770667-0.32 0.405333-0.085334 1.066667-0.192 0.64-0.085333 2.709333-0.512 1.706667-0.362667-1.344 0.298667 3.157333-0.64 2.88-0.576 1.152-0.277333-0.874666 0.213333 1.749333-0.405333 0.170667-0.064 0.341333-0.064 0.682667-0.106667 0.704-0.192 2.368-0.533333 2.901333-0.704-2.965333 0.704 3.413333-0.810667 1.152-0.298667-1.109333 0.277334 1.130666-0.277334 1.493334-0.362666 1.557333-0.426667 1.386667-0.384h0.149333l0.64-0.192 0.96-0.298667 1.621333-0.426666 1.216-0.362667 0.384-0.106667 1.856-0.512 0.490667-0.192 1.856-0.554666 0.554667-0.128 1.28-0.426667 1.621333-0.490667 0.213333-0.064 2.986667-0.96 2.944-1.002666 2.773333-0.96 0.597334-0.213334 2.645333-0.96 1.472-0.576-0.704 0.277334 1.152-0.426667 1.877333-0.704 1.408-0.533333 0.874667-0.341334 1.685333-0.64 1.472-0.618666 1.792-0.746667 0.213334-0.085333 1.578666-0.661334 0.405334-0.170666 3.050666-1.301334 1.322667-0.576 1.962667-0.874666 0.96-0.426667 0.362666-0.170667 0.042667-0.021333 2.090667-0.96 0.213333-0.106667 1.92-0.874666 2.858667-1.408 0.426666-0.213334 2.453334-1.194666 1.386666-0.704 2.325334-1.216 0.512-0.234667 2.389333-1.28 0.853333-0.448 2.048-1.130667 1.194667-0.64 1.130667-0.618666 2.816-1.6-2.816 1.578666 2.922666-1.642666 2.005334-1.194667-2.048 1.194667 2.368-1.365334 0.810666-0.448c1.706667-1.002667 3.370667-2.026667 5.034667-3.050666l-1.984 1.173333 4.266667-2.602667 2.816-1.792 4.16-2.752 1.216-0.810666 2.133333-1.472 1.493333-1.045334 1.066667-0.725333 0.405333-0.298667 0.917334-0.661333 1.173333-0.810667 2.496-1.813333 0.426667-0.341333 0.149333-0.106667 1.770667-1.322667 0.277333-0.213333 0.170667-0.106667 2.432-1.856 0.277333-0.234666 1.386667-1.088 3.328-2.624 4.906666-4.053334 2.389334-1.984 1.344-1.216 0.469333-0.405333 0.384-0.341333 0.149333-0.085334c2.901333-2.56 5.76-5.162667 8.597334-7.829333l3.925333-3.797333 3.84-3.861334 1.792-1.856 1.792-1.856 2.112-2.24v-0.021333l2.154667-2.346667 1.152-1.28 0.682666-0.746666 0.32-0.362667 0.448-0.533333 1.578667-1.792 1.685333-1.941334 0.256-0.298666 1.536-1.834667 0.384-0.426667 0.448-0.533333 1.898667-2.346667-0.554667 0.704 0.704-0.874666 1.408-1.706667 2.069334-2.602667 0.021333-0.085333 0.768-0.981333 0.704-0.853334-1.493333 1.92c2.474667-3.157333 4.906667-6.4 7.253333-9.642666l1.194667-1.706667 0.661333-0.896 1.834667-2.645333-0.938667 1.301333 4.608-6.741333a298.24 298.24 0 0 0 9.386667-15.253334l0.981333-1.813333-0.021333 0.064a70.4 70.4 0 0 0 1.066666-1.856l-0.554666 0.896 1.664-2.901333a297.216 297.216 0 0 0 15.189333-32.341334l1.770667-4.522666a296.256 296.256 0 0 0 9.173333-28.522667l1.408-5.418667a296.362667 296.362667 0 0 0 8.533333-61.653333l0.149334-10.090667-0.064-6.656a297.557333 297.557333 0 0 0-13.205334-81.557333h66.453334c7.082667 28.245333 10.816 57.792 10.816 88.213333 0 197.632-158.357333 358.272-355.114667 361.941334l-6.869333 0.064-6.890667-0.064a360.789333 360.789333 0 0 1-246.784-103.68v82.730666h-64v-208h186.005333v64H273.066667v0.810667h46.464c47.914667 59.434667 116.714667 92.629333 208.469333 100.181333l4.096-0.042666 4.181333-0.085334 4.928-0.213333 1.173334-0.064-1.066667 0.042667 1.109333-0.064 1.216-0.042667 1.386667-0.085333 1.109333-0.064-0.832 0.042666 1.386667-0.064c4.842667-0.32 9.664-0.768 14.442667-1.322666l0.704-0.085334 0.490666-0.085333 0.426667-0.042667-0.298667 0.042667 0.362667-0.021333-0.469333 0.042666z m-19.221333 1.642667l-0.704 0.042667-0.042667 0.021333 0.746667-0.064z m2.176-0.106667l-0.277334 0.021334-1.898666 0.085333 2.176-0.106667z m3.925333-0.277333l-2.56 0.213333-0.533333 0.021334 3.093333-0.213334z m12.864-1.216l-0.256 0.021333-0.234667 0.021334 0.490667-0.042667z m0.362667-0.064h-0.128l-0.234667 0.064 0.256-0.042667h0.106667z m4.373333-0.533333l-0.106667 0.021333h-0.064l0.170667-0.021333z m1.109333-0.170667h-0.085333l-0.512 0.085333 0.597333-0.085333z m3.050667-0.426667l-2.88 0.384-0.170667 0.042667 3.050667-0.426667z m2.666667-0.405333l-0.256 0.021333-0.704 0.128 0.96-0.149333z m6.144-1.024l-0.298667 0.021333-0.661333 0.128-0.405334 0.064-1.344 0.256 1.749334-0.32 0.96-0.149333z m27.498666-6.336l-1.045333 0.277333-0.917333 0.277334 1.962666-0.554667z m3.797334-1.066667l-1.621334 0.448-0.341333 0.085334 1.962667-0.533334z m5.333333-1.664l-0.917333 0.298667-1.045334 0.341333 1.962667-0.64z m15.530667-5.333333l-0.746667 0.256-0.448 0.149333 1.194667-0.405333z m1.962666-0.789333l-0.832 0.341333-0.874666 0.32 1.706666-0.64z m24.576-10.773334l-0.768 0.384-0.106666 0.064 0.874666-0.426666z m13.290667-6.954666l-0.896 0.469333-0.832 0.469333 1.728-0.938666zM275.626667 340.992l-0.405334 0.64 0.106667-0.149333 0.298667-0.490667z m43.754666-53.482667l-2.752 2.709334 2.773334-2.709334z m90.922667-60.373333l-0.810667 0.341333 0.277334-0.149333 0.533333-0.213333z m87.850667-22.272l-1.386667 0.149333-0.512 0.021334 1.898667-0.170667z m0.554666-0.064l-0.554666 0.064 0.490666-0.064h0.064z m0.32-0.021333l-0.384 0.021333-0.106666 0.042667-0.384 0.021333-1.984 0.192h0.085333-0.213333 0.128l-0.192 0.021333-1.066667 0.128-4.608 0.512 3.114667-0.362666-6.890667 0.853333-6.826667 1.002667-3.136 0.512 1.258667-0.213334-2.816 0.490667-1.045333 0.170667-1.749334 0.32-5.290666 1.045333-6.250667 1.344-1.6 0.362667-4.821333 1.152a295.786667 295.786667 0 0 0-7.978667 2.133333l0.832-0.256-1.792 0.512-2.56 0.746667-0.149333 0.042666-3.050667 0.917334-0.554667 0.149333-0.682666 0.213333-2.986667 0.938667-5.013333 1.685333a295.722667 295.722667 0 0 0-17.365334 6.549334l-1.216 0.469333 0.810667-0.32-0.832 0.32-0.362667 0.170667-1.578666 0.661333-0.704 0.32 0.426666-0.170667-1.984 0.853334h-0.021333l-1.408 0.64-2.304 1.024-0.149333 0.064-0.32 0.149333-2.133334 0.981333-3.050666 1.450667-0.085334 0.021333-2.837333 1.386667-0.896 0.448-1.578667 0.789333-0.128 0.064-1.109333 0.554667-1.941333 1.024-1.258667 0.64-1.066667 0.576-0.853333 0.448-0.512 0.256-0.704 0.384-0.149333 0.085333-0.682667 0.384-0.149333 0.085334a297.493333 297.493333 0 0 0-13.376 7.744l-0.448 0.277333-0.042667 0.021333-1.877333 1.173334-2.346667 1.493333-2.816 1.834667-0.490667 0.32-0.192 0.106666-2.517333 1.706667-0.149333 0.085333-2.090667 1.429334-1.557333 1.066666 1.066666-0.725333-4.522666 3.2-0.021334 0.021333-0.362666 0.256-1.962667 1.429334-2.325333 1.728-0.256 0.192-0.554667 0.426666-1.685333 1.258667 1.685333-1.258667-4.693333 3.626667a299.434667 299.434667 0 0 0-6.442667 5.205333l-1.130667 0.96-2.133333 1.813334-0.682667 0.554666-6.186666 5.504a299.84 299.84 0 0 0-18.88 18.816l-5.824 6.528-2.901334 3.413334-0.426666 0.490666-1.92 2.346667-1.941334 2.368-1.088 1.365333-1.173333 1.493334-1.813333 2.346666-1.344 1.770667-0.149334 0.213333-0.277333 0.32-1.216 1.664-0.341333 0.448-2.005334 2.773334-0.981333 1.344-0.832 1.152 0.064-0.064-0.533333 0.789333-1.344 1.92-0.896 1.28-0.832 1.237333-0.085334 0.149334-0.234666 0.32-1.237334 1.856-0.298666 0.490666-1.365334 2.090667-0.853333 1.322667-0.149333 0.234666-3.648 5.909334-4.437334 7.594666-4.224 7.722667c-0.725333 1.386667-1.450667 2.773333-2.154666 4.202667l-0.384 0.704-0.042667 0.128-1.109333 2.197333 1.109333-2.218667-2.709333 5.546667a296.533333 296.533333 0 0 0-2.986667 6.485333l-0.426667 0.981334-0.192 0.384-0.256 0.597333a296.085333 296.085333 0 0 0-20.416 67.413333l-0.981333 5.888a297.962667 297.962667 0 0 0-3.562667 46.272c0 30.549333 4.608 60.053333 13.141334 87.808H175.488a362.794667 362.794667 0 0 1-10.730667-87.808c0-24.32 2.389333-48.064 6.954667-71.018666 33.002667-165.930667 179.413333-290.986667 355.050667-290.986667 93.504 0 178.752 35.456 242.986666 93.674667V128.512h64v208h-185.984v-64h56.426667c-43.456-38.4-99.754667-61.013333-169.877333-68.181333l-8.810667-0.810667-5.056 0.064-5.184 0.149333-2.624 0.106667h-0.384l-0.469333 0.042667h0.170666l0.298667-0.042667h0.576H512.277333l-0.192 0.021333h-0.128l-0.384 0.021334h-0.085333l-0.128 0.021333h-0.128l-0.234667 0.021333-0.981333 0.064 0.512-0.042666h0.469333l0.277334-0.042667h0.512l-1.258667 0.042667-1.194667 0.085333-3.157333 0.170667 3.84-0.213334-0.618667 0.021334-3.285333 0.213333-0.981333 0.042667-2.133334 0.192-1.408 0.085333-1.237333 0.106667h0.149333l1.088-0.106667 0.64-0.021333-1.728 0.106666-0.362666 0.064-1.109334 0.085334z m6.826667-0.533334l-2.816 0.213334 2.090667-0.192 0.725333-0.021334z m5.184-0.32l-1.642667 0.085334 1.322667-0.085334h0.32z m0.277333 0l0.128-0.042666h0.64l0.106667-0.042667h0.64-0.64l-0.746667 0.042667-0.405333 0.042666h0.277333z m51.904 593.344l-0.021333 0.021334h-0.085333 0.106666l0.405334-0.064-0.362667 0.064h-0.042667z m29.141334-5.034666l-0.554667 0.128-0.170667 0.021333 0.725334-0.149333z' p-id='8559'%3E%3C/path%3E%3C/svg%3E"),"data:image/svg+xml,%3Csvg t='1623122422011' fill='".concat(r,"' class='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='6881' width='14' height='14'%3E%3Cpath d='M544 213.333333v266.666667H810.666667v64H544V810.666667h-64V544H213.333333v-64h266.666667V213.333333z' p-id='6882'%3E%3C/path%3E%3C/svg%3E"),"data:image/svg+xml,%3Csvg t='1623122609343' fill='".concat(r,"' class='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='7909' width='14' height='14'%3E%3Cpath d='M641.28 278.613333l-45.226667-45.226666-278.634666 278.762666 278.613333 278.485334 45.248-45.269334-233.365333-233.237333z' p-id='7910'%3E%3C/path%3E%3C/svg%3E"),"data:image/svg+xml,%3Csvg t='1623121846385' fill='".concat(r,"' class='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='6578' width='14' height='14'%3E%3Cpath d='M500.8 604.779L267.307 371.392l-45.227 45.27 278.741 278.613L779.307 416.66l-45.248-45.248z' p-id='6579'%3E%3C/path%3E%3C/svg%3E"),"data:image/svg+xml,%3Csvg t='1623122664182' fill='".concat(r,"' class='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='8140' width='14' height='14'%3E%3Cpath d='M500.8 461.909333L267.306667 695.296l-45.226667-45.269333 278.741333-278.613334L779.306667 650.026667l-45.248 45.226666z' p-id='8141'%3E%3C/path%3E%3C/svg%3E"),"data:image/svg+xml,%3Csvg t='1623122553546' fill='".concat(r,"' class='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='7329' width='14' height='14'%3E%3Cpath d='M593.450667 512.128L360.064 278.613333l45.290667-45.226666 278.613333 278.762666L405.333333 790.613333l-45.226666-45.269333z' p-id='7330'%3E%3C/path%3E%3C/svg%3E"),"data:image/svg+xml,%3Csvg t='1623124661557' fill='".concat(r,"' class='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='8745' width='14' height='14'%3E%3Cpath d='M341.013333 394.666667l27.754667 393.450666h271.829333l27.733334-393.450666h64.106666L704.426667 792.618667a64 64 0 0 1-63.829334 59.498666H368.768a64 64 0 0 1-63.829333-59.52L276.885333 394.666667h64.128z m139.306667 19.818666v298.666667h-64v-298.666667h64z m117.013333 0v298.666667h-64v-298.666667h64zM181.333333 288h640v64h-640v-64z m453.482667-106.666667v64h-256v-64h256z' p-id='8746'%3E%3C/path%3E%3C/svg%3E")],o=document.createDocumentFragment(),n=0;n<i.length;n++){var a=new Image,s=document.createElement("span");a.src=i[n],a.style.verticalAlign="middle",s.classList.add("JXG_navigation_button"),s.style.paddingLeft="4px",s.style.paddingRight="4px",s.style.paddingBottom="3px",s.style.verticalAlign="middle",s.textContent="",s.onclick=0==n?function(){t.actionFromButton=!0,t.zoomOut()}:1==n?function(){t.actionFromButton=!0,t.resetZoom()}:2==n?function(){t.actionFromButton=!0,t.zoomIn()}:3==n?function(){t.actionFromButton=!0,t.moveLeft()}:4==n?function(){t.actionFromButton=!0,t.moveDown()}:5==n?function(){t.actionFromButton=!0,t.moveUp()}:6==n?function(){t.actionFromButton=!0,t.moveRight()}:function(){var e,r;t.needToSync=!0;var i=Object.keys(t.selectedGraphIds);if(i.length){var o={},n=t.jxgInstance.objectsList,a=t.jxgInstance.groups;i.forEach((function(t){var e,r;o[t]=1;try{for(var i=(e=void 0,yl(n)),s=i.next();!s.done;s=i.next()){var l=s.value;(l.ancestors[t]||l.parents.includes(t))&&(o[l.id]=1)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}for(var c in a){var h=a[c];h.parents.includes(t)&&(o[h.id]=1)}})),t.jxgInstance.suspendUpdate();var s=Object.keys(o);try{for(var l=(e=void 0,yl(s)),c=l.next();!c.done;c=l.next()){var h=c.value;t.removeGraph(h)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}t.jxgInstance.unsuspendUpdate()}t.selectedGraphIds={},t.needToSync=!1},s.appendChild(a),o.appendChild(s)}e.innerHTML="",e.append(o)}},e.prototype.hasGraph=function(t,e,r,i){if(void 0===i&&(i=""),"point"===t){for(var o in this.graphs)if("point"===(n=this.graphs[o]).type&&n.x===e&&n.y===r)return!0}else if("line"===t){for(var o in this.graphs)if("line"===(n=this.graphs[o]).type&&(n.startPoint===e&&n.endPoint===r||n.startPoint===r&&n.endPoint===e))return!0}else if("line-segment"===t){for(var o in this.graphs)if("line"===(n=this.graphs[o]).type&&(n.startPoint===e&&n.endPoint===r||n.startPoint===r&&n.endPoint===e)&&!n.straightFirst&&!n.straightLast)return!0}else if("ray"===t){for(var o in this.graphs)if("line"===(n=this.graphs[o]).type&&n.startPoint===e&&n.endPoint===r&&n.straightFirst&&!n.straightLast)return!0}else if("circle"===t){for(var o in this.graphs)if("circle"===(n=this.graphs[o]).type&&n.centerPoint===e&&n.circlePoint===r)return!0}else if("angle"===t){for(var o in this.graphs)if("angle"===(n=this.graphs[o]).type&&n.vertexA===e&&n.vertexB===r&&n.vertexC===i)return!0}else if("vector"===t){for(var o in this.graphs)if("line"===(n=this.graphs[o]).type&&n.startPoint===e&&n.endPoint===r&&!n.straightFirst&&!n.straightLast)return!0}else if("ellipse"===t)for(var o in this.graphs){var n;if("ellipse"===(n=this.graphs[o]).type&&(n.f1===e&&n.f2===r||n.f1===r&&n.f2===e))return!0}return!1},e.prototype.removeBoard=function(){return pl(this,void 0,void 0,(function(){return fl(this,(function(t){switch(t.label){case 0:return[4,this.loadLib()];case 1:return t.sent(),this.jxgInstance&&(window.TIW_MATH_GRAPH.JSXGraph.freeBoard(this.jxgInstance),this.jxgWrap&&this.jxgWrap.remove(),this.jxgInstance=null,this.jxgWrap=null),[2]}}))}))},e.prototype.renderTo=function(t,e){return pl(this,void 0,void 0,(function(){var r,i,o,n,a,s,l,c;return fl(this,(function(h){switch(h.label){case 0:return 0===this.boardWidth||0===this.boardHeight?[2]:(this.container=t,r="tic_mathgraph_element_".concat(this.belongSeq),(i=t.querySelector("#".concat(r)))?(this.left=this.x*this.boardWidth/1e4,this.top=this.y*this.boardHeight/1e4,i.style.pointerEvents="".concat(e?"auto":"none"),i.style.transform="translateX(".concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg)"),i.style.webkitTransform="translateX(".concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg)"),this.jxgInstance&&this.jxgInstance.resizeContainer(this.width*this.boardWidth/1e4,this.height*this.boardHeight/1e4,!this.boardSizeChange,!this.boardSizeChange),this.boardSizeChange&&this.jxgInstance&&this.jxgInstance.update(),this.boardSizeChange=!1,this.jxgWrap=i,[3,3]):[3,1]);case 1:return(i=document.createElement("div")).dataset.belongSeq=this.belongSeq,i.id=r,i.setAttribute("style","position:absolute;margin:0;padding:0;pointer-events:".concat(e?"auto":"none",";width:").concat(this.width*this.boardWidth/1e4,"px;height:").concat(this.height*this.boardHeight/1e4,"px;border:1px solid ").concat(this.axisColor,";transform: translateX(").concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg);-webkit-transform: translateX(").concat(this.left,"px) translateY(").concat(this.top,"px) rotate(").concat(this.deg,"deg);")),t.appendChild(i),this.jxgWrap=i,[4,this.createBoard(r)];case 2:h.sent(),(o=Object.keys(this.graphs)).sort((function(t,e){return Number(t)-Number(e)})),this.jxgInstance.suspendUpdate();try{for(n=yl(o),a=n.next();!a.done;a=n.next())s=a.value,this.updateGraph(this.graphs[s])}catch(t){l={error:t}}finally{try{a&&!a.done&&(c=n.return)&&c.call(n)}finally{if(l)throw l.error}}this.jxgInstance.unsuspendUpdate(),h.label=3;case 3:return this._updateRectArea(),[2]}}))}))},e.prototype.setBoardSize=function(t,e){t===this.boardWidth&&e===this.boardHeight||(this.boardSizeChange=!0),this.boardWidth=t,this.boardHeight=e,this.left=this.boardWidth*this.x/1e4,this.top=this.boardHeight*this.y/1e4},e.prototype.getReportData=function(){return{uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,subType:Ha,parentBelongSeq:0,time:this.time,hidden:Number(!this.show),visible:+this.visible,x:parseFloat(this.x.toFixed(4)),y:parseFloat(this.y.toFixed(4)),width:parseFloat(this.width.toFixed(4)),height:parseFloat(this.height.toFixed(4)),deg:this.deg,erasable:this.erasable,boardAttr:this.jxgBoardAttr,axisColor:this.axisColor,updateTime:Wt.getTimeStamp(),lockElement:this.lockElement}},e.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.JSXGRAPH_BOARD_ELEMENT,seq:this.currentSeq,belongSeq:this.belongSeq,time:this.time,show:this.show,visible:this.visible,x:parseFloat(this.x.toFixed(4)),y:parseFloat(this.y.toFixed(4)),width:parseFloat(this.width.toFixed(4)),height:parseFloat(this.height.toFixed(4)),deg:this.deg,erasable:this.erasable,axisColor:this.axisColor,boardAttr:this.jxgBoardAttr}},e.prototype.getData=function(){return dl({uid:this.user,seq:this.belongSeq,deg:this.deg,x:this.x,y:this.y},this.getRealSize())},e.prototype.setRealSize=function(t,e){if(0!==t||0!==e){this.width=1e4*t/this.boardWidth,this.height=1e4*e/this.boardHeight;var r=24e4/this.boardWidth,i=24e4/this.boardHeight;this.width=Math.max(r,this.width),this.height=Math.max(i,this.height),this.boardSizeChange=!0,this._updateRectArea()}},e.prototype._updateRectArea=function(){this.pointArr=[];var t=this._calcRotateXY(this.x,this.y);this.pointArr.push([t.x,t.y]);var e=t.x,r=t.y;t=this._calcRotateXY(this.x+this.width,this.y),this.pointArr.push([t.x,t.y]);var i=t.x,o=t.y;t=this._calcRotateXY(this.x+this.width,this.y+this.height),this.pointArr.push([t.x,t.y]);var n=t.x,a=t.y;t=this._calcRotateXY(this.x,this.y+this.height),this.pointArr.push([t.x,t.y]);var s=t.x,l=t.y;this.rectArea={minX:Math.min(e,i,s,n),minY:Math.min(r,o,l,a),maxX:Math.max(e,i,s,n),maxY:Math.max(r,o,l,a)}},e.prototype._calcRotateXY=function(t,e){var r=this.width*this.boardWidth/1e4,i=this.height*this.boardHeight/1e4,o=this.x*this.boardWidth/1e4+r/2,n=this.y*this.boardHeight/1e4+i/2,a=t*this.boardWidth/1e4,s=e*this.boardHeight/1e4,l=this.deg*(Math.PI/180),c=(a-o)*Math.cos(l)-(s-n)*Math.sin(l)+o,h=(a-o)*Math.sin(l)+(s-n)*Math.cos(l)+n;return{x:1e4*c/this.boardWidth,y:1e4*h/this.boardHeight,ox:c,oy:h}},e.prototype.getRealSize=function(){return{left:this.left,top:this.top,width:this.width*this.boardWidth/1e4,height:this.height*this.boardHeight/1e4}},e.prototype.remove=function(){return pl(this,void 0,void 0,(function(){return fl(this,(function(t){switch(t.label){case 0:return[4,this.removeBoard()];case 1:return t.sent(),[2]}}))}))},e.prototype.pointImpactCheck=function(t){return Dt(t,this.pointArr)},e.prototype.impactCheck=function(t,e,r){return t>this.rectArea.minX&&e>this.rectArea.minY&&t<this.rectArea.maxX&&e<this.rectArea.maxY},e.prototype.getBoardId=function(){return this.boardId},e.prototype.loadLib=function(){if(!window.TIW_MATH_GRAPH)return new Promise((function(t){K(L.mathGraphURL,(function(){t("")}))}))},e.prototype.getReportDataForHistory=function(t){var e=this.getReportData();return t?e:{type:"layer",seq:this.seqUtil.getSeq(),content:JSON.stringify(e)}},e.graphId=0,e.offlineBoard=null,e}(ra);!function(t){t[t.Local=0]="Local",t[t.Realtime=1]="Realtime",t[t.History=2]="History"}(Va||(Va={}));var _l=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),El=function(){return(El=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Tl=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function a(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},bl=function(t,e){var r,i,o,n,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},Sl=function(t){function e(r,i,o){var n=t.call(this,r,{renderOnCanvas:!1,listener:{updatePosition:function(t,e){},updateScale:function(t,e){n.scaleX*=t,n.scaleY*=e},updateRotate:function(t){n.deg=t}}},"formula")||this;if(n.type="element",n.subType=Ta.TEDU_BOARD_ELEMENT_FORMULA,n._textSize=e.Default_FontSize,n.firstLoadTask=0,n.boardId=i.boardId,n.show=i.show,n.visible=i.visible,n.user=i.user,n.belongSeq=i.belongSeq,n.expression=i.expression,n.width=i.width||0,n.height=i.height||0,n.time=i.time||Wt.getTimeStamp(),n.x=i.x,n.y=i.y,n.focusStatus="blur",n.container=null,n.boardWidth=0,n.boardHeight=0,n.deg=i.deg||0,n.rectArea={maxX:0,maxY:0,minX:0,minY:0},n.pointArr=[],n.erasable=i.erasable,n.naturalWidth=i.naturalWidth||0,n.naturalHeight=i.naturalHeight||0,n.baseWidth=i.baseWidth||0,n.baseHeight=i.baseHeight||0,n.deg=i.deg||0,n.scaleX=i.scaleX||1,n.scaleY=i.scaleY||1,o===Va.Local){var a=n.textSize/e.Default_FontSize;n.scaleX*=a,n.scaleY*=a,n.textSize=i.textSize}else n._textSize=i.textSize;return n.color=i.color||"#000000",n.lockElement=i.lockElement,n}return _l(e,t),e.prototype.getFormulaSize=function(t,r,i,o){var n,a;return Tl(this,void 0,void 0,(function(){var s,l,c,h,u,d;return bl(this,(function(p){return this.loadLib()?(s=window.MathJax.tex2svg(this.expression,{em:12,ex:8,display:!0}))&&s.querySelector("merror")?(this.fireIllegalFormula(),[2]):((l=document.getElementById("tiw-formula-prerender"))?(l.innerHTML="",l.appendChild(s)):((l=document.createElement("div")).id="tiw-formula-prerender",l.appendChild(s),document.body.appendChild(l)),c=s.querySelector("svg"),h=s.querySelector("mjx-assistive-mml"),u=[Math.max(c.clientWidth,h.clientWidth||0),Math.max(c.clientHeight,h.clientHeight||0)],i/=100,this.boardWidth=t,this.boardHeight=r,this.naturalWidth=u[0],this.naturalHeight=u[1],this.baseWidth=1e4*u[0]/t/i,this.baseHeight=1e4*u[1]/r/i,d=this.textSize/e.Default_FontSize,this.width=this.baseWidth*d,this.height=this.baseHeight*d,this.x=null!==(n=this.x)&&void 0!==n?n:5e3-this.width/2,this.y=null!==(a=this.y)&&void 0!==a?a:5e3-this.height/2,this.left=this.boardWidth*this.x/1e4,this.top=this.boardHeight*this.y/1e4,this._updateRectArea(),o&&o(!0),[2]):(this.fireFormulaLibNotLoaded(),[2])}))}))},e.prototype.getData=function(){return El({uid:this.user,seq:this.belongSeq,deg:this.deg,x:this.x,y:this.y,scaleX:this.scaleX,scaleY:this.scaleY},this.getRealSize())},e.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.FORMULA_ELEMENT,seq:this.seqUtil.getSeq(),belongSeq:this.belongSeq,expression:this.expression,time:this.time,show:this.show,visible:this.visible,x:this.x,y:this.y,width:this.width,height:this.height,deg:this.deg,scaleX:this.scaleX,scaleY:this.scaleY,erasable:this.erasable,boardId:this.boardId,naturalWidth:this.naturalWidth,naturalHeight:this.naturalHeight,baseWidth:this.baseWidth,baseHeight:this.baseHeight,color:this.color,textSize:this.textSize}},e.prototype.getReportData=function(){return{type:this.type,property:{subType:this.subType,uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,expression:this.expression,time:this.time,x:this.x,y:this.y,width:this.width,height:this.height,updateTime:Wt.getTimeStamp(),hidden:Number(!this.show),visible:+this.visible,erasable:this.erasable,deg:this.deg,scaleX:this.scaleX,scaleY:this.scaleY,naturalWidth:this.naturalWidth,naturalHeight:this.naturalHeight,baseWidth:this.baseWidth,baseHeight:this.baseHeight,color:this.color,textSize:this.textSize,lockElement:this.lockElement}}},e.prototype.renderTo=function(t){return Tl(this,void 0,void 0,(function(){var r,i,o,n,a,s,l,c,h,u,d,p,f;return bl(this,(function(g){if(this.container=t,r="tic_formula_element_".concat(this.belongSeq),i=t.querySelector("#".concat(r)),this.textSize,e.Default_FontSize,o=this.left+(this.width*this.boardWidth/1e4-this.naturalWidth)/2,n=this.top+(this.height*this.boardHeight/1e4-this.naturalHeight)/2,a=this.baseWidth*this.boardWidth/1e4,s=this.baseHeight*this.boardHeight/1e4,l=a/this.naturalWidth,c=s/this.naturalHeight,h=this.scaleX*l,u=this.scaleY*c,i)i.style.transform="translate(".concat(o,"px, ").concat(n,"px) rotate(").concat(this.deg,"deg) scale(").concat(h,", ").concat(u,")"),i.style.webkitTransform="translate(".concat(o,"px, ").concat(n,"px) rotate(").concat(this.deg,"deg) scale(").concat(h,", ").concat(u,")"),(p=i.querySelector("svg")).style.color=this.color,this.formulaWrap=i;else{if(!this.loadLib())return[2];d=window.MathJax.tex2svg(this.expression,{em:12,ex:8,display:!0}),(p=d.querySelector("svg")).style.color=this.color,p&&(p.classList.contains("tic_element__formula--svg")||p.classList.add("tic_element__formula--svg")),(f=d.querySelector("mjx-assistive-mml"))&&(f.style.visibility="hidden"),(i=document.createElement("div")).id=r,i.dataset.belongSeq=this.belongSeq,i.dataset.boardId=this.boardId,i.className="tic_element__formula",i.setAttribute("style","position:absolute;margin:0;padding:0;width:".concat(this.naturalWidth,"px;height:").concat(this.naturalHeight,"px;border:none;cursor:move;transform: translate(").concat(o,"px, ").concat(n,"px) rotate(").concat(this.deg,"deg) scale(").concat(h,", ").concat(u,");-webkit-transform: translateX(").concat(o,"px, ").concat(n,"px) rotate(").concat(this.deg,"deg) scale(").concat(h,", ").concat(u,");")),clearTimeout(this.firstLoadTask),this.firstLoadTask=window.setTimeout((function(){i.appendChild(d),t.appendChild(i)}),150),this.formulaWrap=i}return i.style.color=this.color,[2]}))}))},e.prototype.remove=function(){this.formulaWrap&&this.formulaWrap.remove()},e.prototype.impactCheck=function(t,e,r){return t>this.rectArea.minX&&e>this.rectArea.minY&&t<this.rectArea.maxX&&e<this.rectArea.maxY},e.prototype.getBoardId=function(){return this.boardId},e.prototype.loadLib=function(){return window.MathJaxLoaded},e.prototype.getElementOperatorReportData=function(){return t.prototype.getElementOperatorReportData.call(this,{textSize:this.textSize,color:this.color,scaleX:this.scaleX,scaleY:this.scaleY,width:this.width,height:this.height})},e.prototype.setBorder=function(){this.baseWidth&&this.baseHeight&&(this.width=this.baseWidth*this.scaleX,this.height=this.baseHeight*this.scaleY)},e.prototype.fireIllegalFormula=function(){var t="illegal expression:"+this.expression;this.logger.reportInfo(this.loggerModuleName,"add_formula_element",{code:-1,message:"illegal expression",param:{extraInfo:t}},ea.ONLY_ONLINE),this.event.fireWarningEvent($.TEDU_BOARD_WARNING_ILLEGAL_FORMULA_EXPRESSION,t)},e.prototype.fireFormulaLibNotLoaded=function(){var t="formula lib not loaded, expression:"+this.expression;this.logger.reportInfo(this.loggerModuleName,"add_formula_element",{code:-1,message:"formula lib not loaded",param:{extraInfo:t}},ea.ONLY_ONLINE),this.event.fireWarningEvent($.TEDU_BOARD_WARNING_FORMULA_LIB_NOT_LOADED,t)},Object.defineProperty(e.prototype,"textSize",{get:function(){return this._textSize},set:function(t){var e=t/this._textSize;this._textSize=t,this.scaleX*=e,this.scaleY*=e},enumerable:!1,configurable:!0}),e.prototype.getReportDataForHistory=function(t){var e=this.getReportData();return t?e:{type:e.type,seq:this.seqUtil.getSeq(),content:JSON.stringify(e.property)}},e.Default_FontSize=16,e}(ra),xl=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},wl=function(){function t(t){this.id=t,this.boardIds=new Map,this.userIds=new Map,this.currentBoardId="",this.title="",this.updateTime=Date.now(),this.currentPage=0,this.currentStep=0}return t.prototype.addBoard=function(t){this.boardIds.set(t,!0),this.updateTimestamp()},t.prototype.removeBoard=function(t){this.boardIds.delete(t),this.updateTimestamp()},t.prototype.checkBoardExisted=function(t){return this.boardIds.has(t)},t.prototype.updateBoards=function(t){var e,r;try{for(var i=xl(t),o=i.next();!o.done;o=i.next()){var n=o.value;this.addBoard(n)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}this.updateTimestamp()},t.prototype.addUser=function(t){this.userIds.set(t,!0),this.updateTimestamp()},t.prototype.removeUser=function(t){this.userIds.delete(t),this.updateTimestamp()},t.prototype.checkUserExisted=function(t){return this.userIds.has(t)},t.prototype.updateUsers=function(t){var e,r;try{for(var i=xl(t),o=i.next();!o.done;o=i.next()){var n=o.value;this.addUser(n)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}this.updateTimestamp()},t.prototype.setCurrentBoard=function(t){this.currentBoardId=t,this.updateTimestamp()},t.prototype.setTitle=function(t){this.title=t,this.updateTimestamp()},t.prototype.setCurrentPage=function(t){this.currentPage=t,this.updateTimestamp()},t.prototype.setCurrentStep=function(t){this.currentStep=t,this.updateTimestamp()},t.prototype.getCurrentBoard=function(){return this.currentBoardId},t.prototype.getBoards=function(){return this.boardIds},t.prototype.getUsers=function(){return this.userIds},t.prototype.getTitle=function(){return this.title},t.prototype.getBoardSize=function(){return this.boardIds.size},t.prototype.getUserSize=function(){return this.userIds.size},t.prototype.hasBoard=function(t){return this.boardIds.has(t)},t.prototype.hasUser=function(t){return this.userIds.has(t)},t.prototype.updateTimestamp=function(){this.updateTime=Date.now()},t.prototype.getUpdateTimestamp=function(){return this.updateTime},t.prototype.getData=function(){var t=[],e=[];return this.boardIds.forEach((function(e,r){t.push(r)})),this.userIds.forEach((function(t,r){e.push(r)})),{discussionGroupId:this.id,boardIds:t,userIds:e,title:this.title,currentBoardId:this.currentBoardId,currentPage:this.currentPage,currentStep:this.currentStep}},t.EMPTY_GROUP_ID="",t}(),Ol=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Il=function(){function t(t){this.groupMap=new Map,this.seqUtil=t}return t.prototype.addGroup=function(t,e,r,i,o){void 0===i&&(i=""),void 0===o&&(o="");var n=new wl(t||"group_".concat(this.seqUtil.getSeq())),a="";o&&e.includes(o)?a=o:e.length&&(a=e[0]),a!==n.getCurrentBoard()&&(n.setCurrentPage(0),n.setCurrentStep(0)),n.updateBoards(e),n.updateUsers(r),n.setCurrentBoard(a),n.setTitle(i),this.groupMap.set(n.id,n)},t.prototype.updateGroup=function(t,e){var r=e.boards,i=e.users,o=e.currentBoardId,n=e.title;if(t){var a=this.groupMap.get(t);a?(r&&a.updateBoards(r),i&&a.updateUsers(i),o&&a.setCurrentBoard(o),n&&a.setTitle(n)):this.addGroup(t,r||[],i||[],n||"",o||"")}},t.prototype.deleteGroup=function(t){this.groupMap.delete(t)},t.prototype.reset=function(){this.groupMap.clear()},t.prototype.getGroupIdByUserId=function(t){var e=[];return this.groupMap.forEach((function(r,i){r.checkUserExisted(t)&&e.push(i)})),e},t.prototype.getGroupInfoByGroupId=function(t){return this.groupMap.get(t)||null},t.prototype.checkIfUserInGroup=function(t,e){var r;return t?(null===(r=this.getGroupInfoByGroupId(t))||void 0===r?void 0:r.checkUserExisted(e))||!1:0===this.getGroupIdByUserId(e).length},t.prototype.checkIfBoardInGroup=function(t,e){var r;return(null===(r=this.getGroupInfoByGroupId(t))||void 0===r?void 0:r.checkBoardExisted(e))||!1},t.prototype.checkIfUserInAnyGroup=function(t,e){var r,i,o=!1;if(t.length)try{for(var n=Ol(t),a=n.next();!a.done;a=n.next()){var s=a.value;o=o||this.checkIfUserInGroup(s,e)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}else o=this.checkIfUserInGroup(wl.EMPTY_GROUP_ID,e);return o},t.prototype.checkIfBoardInAnyGroup=function(t,e){var r,i,o=!1;if(t.length)try{for(var n=Ol(t),a=n.next();!a.done;a=n.next()){var s=a.value;o=o||this.checkIfBoardInGroup(s,e)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}return o},t.prototype.getAllGroupId=function(){var t=[];return this.groupMap.forEach((function(e,r){t.push(r)})),t},t.prototype.setGroupTitle=function(t,e){var r;null===(r=this.groupMap.get(t))||void 0===r||r.setTitle(e)},t.prototype.hasGroup=function(t){return this.groupMap.has(t)},t.prototype.checkIfUserInSameGroup=function(t){var e=t.length;if(1===e)return!0;for(var r=this.getGroupIdByUserId(t[0]),i=!1,o=1;o<e;o++)i=i||this.checkIfUserInAnyGroup(r,t[o]);return i},t.prototype.clear=function(){this.groupMap.clear()},t}(),Al={SET_ENABLE:0,UPDATE:1,DELETE:2,RESET:3,ERROR:4},Dl={BOARDER_COLOR:1,BOARDER_WIDTH:2,BOARDER_LINE_TYPE:3,EL_DELETE:4,CHANGE_POSITION:5,CHANGE_TEXT_SIZE:6,CONTENT:8,OPACITY:9,ROTATION_ANGLE:10},Cl={WHITEBOARD:1,H5_COURSEWARE:2,IMAGE_COURSEWARE:3,VIDEO_FILE:4,H5_FILE:5,IMAGES_FILE:6},Pl=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ll=function(t){function e(e,r,i){var o,n,a=this;return(a=t.call(this,e,{listener:{updatePosition:function(t,e,r,i){var o=r+a.width/a.scaleX/2-a.center.x,n=i+a.height/a.scaleY/2-a.center.y;a.center.x+=o,a.center.y+=n,a.startPoint.x+=o,a.startPoint.y+=n},updateScale:function(t,e){a.scaleX*=t,a.scaleY*=e;var r=a._calcMinMax(),i=r.minX,o=r.minY,n=r.maxX,s=r.maxY;a.width=(n-i)*a.scaleX,a.height=(s-o)*a.scaleY},updateRotate:function(t){a.deg=t}}},"arc")||this).user=r,a.type="element",a.subType=Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ARC,a.show=i.show,a.visible=null===(o=i.visible)||void 0===o||o,a.select=!1,a.color=i.color,a.thin=i.thin,a.style=i.style||{},a.time=Wt.getTimeStamp(),a.belongSeq=i.belongSeq,a.ID="".concat(a.belongSeq),a.center=i.center||{x:0,y:0},a.startPoint=i.startPoint||{x:0,y:0},a.radian=i.radian||0,a.clockwise=null===(n=i.clockwise)||void 0===n||n,a.needToRender=!0,a.boardId=i.boardId,a.scaleX=i.scaleX||1,a.scaleY=i.scaleY||1,a.deg=i.deg||0,a.lockElement=i.lockElement,a}return Pl(e,t),e.prototype._rotate=function(t,e,r){var i=Math.sin(e),o=Math.cos(e),n=t.x-r.x,a=t.y-r.y;return{x:n*o-a*i+r.x,y:n*i+a*o+r.y}},e.prototype.setBorder=function(){var t=this._calcMinMax(),e=t.minX,r=t.minY,i=t.maxX,o=t.maxY;this.x=e,this.y=r,this.width=(i-e)*this.scaleX,this.height=(o-r)*this.scaleY,this.left=this.boardWidth*this.x/1e4,this.top=this.boardHeight*this.y/1e4,this._updateRectArea()},e.prototype.setBoardSize=function(t,e){this.boardWidth=t,this.boardHeight=e,this.setBorder()},e.prototype._calcMinMax=function(){var t=1/0,e=-1/0,r=1/0,i=-1/0,o=1/180*Math.PI,n={x:this.center.x/1e4*this.boardWidth,y:this.center.y/1e4*this.boardHeight},a={x:this.startPoint.x/1e4*this.boardWidth,y:this.startPoint.y/1e4*this.boardHeight};if(this.clockwise)for(var s=0;s>=this.radian;s-=o){var l=this._rotate(a,s,n);t=Math.min(t,l.x),e=Math.max(e,l.x),r=Math.min(r,l.y),i=Math.max(i,l.y)}else for(s=0;s<=this.radian;s+=o)l=this._rotate(a,s,n),t=Math.min(t,l.x),e=Math.max(e,l.x),r=Math.min(r,l.y),i=Math.max(i,l.y);return{minX:t/this.boardWidth*1e4,minY:r/this.boardHeight*1e4,maxX:e/this.boardWidth*1e4,maxY:i/this.boardHeight*1e4}},e.prototype.pointTransformer=function(t,e){void 0===e&&(e=!0);var r=t.x,i=t.y,o=this.x,n=this.y,a=(r-o)*this.scaleX+o,s=(i-n)*this.scaleY+n,l=this._calcRotateXY(a,s),c=l.x,h=l.y;return{x:e?c:a,y:e?h:s}},e.prototype.getRealTimeData=function(){return this.getData()},e.prototype.getReportData=function(){return{type:this.type,property:{subType:this.subType,belongSeq:this.belongSeq,boardId:this.boardId,uid:this.user,color:this.color,thin:this.thin,time:this.time,updateTime:Wt.getTimeStamp(),seq:this.belongSeq,hidden:Number(!this.show),style:this.style,center:this.center,startPoint:this.startPoint,radian:this.radian,clockwise:this.clockwise,scaleX:this.scaleX,scaleY:this.scaleY,deg:this.deg,lockElement:this.lockElement}}},e.prototype.getElementOperatorReportData=function(){return t.prototype.getElementOperatorReportData.call(this,{thin:this.thin,color:this.color,style:this.style})},e.prototype.getData=function(){return{uid:this.user,seq:this.belongSeq,x:this.center.x,y:this.center.y,scaleX:this.scaleX,scaleY:this.scaleY,deg:this.deg}},e.prototype.getBoardId=function(){return this.boardId},e.createElement=function(t,r,i){var o=new e(t,r,i);return Za.deepProxy(o,o)},e.prototype.getReportDataForHistory=function(t){var e=this.getReportData();return t?e:{type:e.type,seq:this.seqUtil.getSeq(),content:JSON.stringify(e.property)}},e}(ra),Ml=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Rl=function(t){function e(e){var r=t.call(this)||this;return r.data=e,r}return Ml(e,t),e.prototype._calcRotateDeg=function(t,e,r){var i=e.x-r.x,o=e.y-r.y,n=t.x-r.x,a=i*(t.y-r.y)-o*n,s=Lt(e.x,e.y,r.x,r.y),l=Lt(t.x,t.y,r.x,r.y),c=Lt(e.x,e.y,t.x,t.y),h=(Math.pow(s,2)+Math.pow(l,2)-Math.pow(c,2))/(2*s*l),u=180*Math.acos(h)/Math.PI;return a<0?-u:u},e.prototype._rotate=function(t,e,r){var i=Math.sin(e),o=Math.cos(e),n=t.x-r.x,a=t.y-r.y;return{x:n*o-a*i+r.x,y:n*i+a*o+r.y}},e.prototype.impactCheck=function(t,e,r,i,o){var n=this.data.pointTransformer(this.data.center),a=this.data.pointTransformer(this.data.startPoint),s=this.data.radian,l=Math.max(r/1e4*i,6),c=1/180*Math.PI,h={x:n.x/1e4*i,y:n.y/1e4*o},u={x:a.x/1e4*i,y:a.y/1e4*o},d={x:t/1e4*i,y:e/1e4*o};if(this.data.clockwise)for(var p=0;p>=s;p-=c){var f=this._rotate(u,p,h);if(Lt(f.x,f.y,d.x,d.y)<l)return!0}else for(p=0;p<=s;p+=c)if(f=this._rotate(u,p,h),Lt(f.x,f.y,d.x,d.y)<l)return!0;return!1},e.prototype.renderByCanvas=function(t,e){t.globalCompositeOperation="source-over";var r=this.data.thin/1e4*e.height,i=Math.max(r,e.minLineWidth),o=this.data.style;if(o)if(o.lineType==mn.TEDU_BOARD_LINE_TYPE_DOTTED){var n=.01*e.width+i;t.setLineDash&&t.setLineDash([n,n])}else t.lineCap="round",t.setLineDash([]);else t.lineCap="round",t.setLineDash([]);var a=this.data.pointTransformer(this.data.center),s=a.x,l=a.y,c=this.data.pointTransformer(this.data.startPoint),h=c.x,u=c.y;s=Math.floor(s/1e4*e.width),l=Math.floor(l/1e4*e.height),h=Math.floor(h/1e4*e.width),u=Math.floor(u/1e4*e.height);var d=Lt(s,l,h,u),p=this._calcRotateDeg({x:h,y:u},{x:s+1,y:l},{x:s,y:l})/180*Math.PI,f=p+this.data.radian;t.save(),t.strokeStyle=this.data.color,t.lineWidth=i,t.lineCap="round",t.beginPath(),t.moveTo(h,u),t.arc(s,l,d,p,f,this.data.clockwise),t.stroke(),t.restore(),this.data.needToRender=!1},e.prototype.renderTo=function(t,e){this.data.needToRender&&(this.data.boardWidth===e.width&&this.data.boardHeight===e.height||this.data.setBoardSize(e.width,e.height),this.renderByCanvas(t,e))},e.createElement=function(t){return new e(t)},e.prototype.remove=function(){},e}(yn),Nl={Image:"-100",Text:"-101",TextFix:"-102"};function Bl(t,e,r,i){var o=Gl.getBoardRecordId(r),n=t.get(o)||[],a=[],s=e.get(o)||0;n.forEach((function(t,e){t.removeOperationBySeq(i)&&a.push(e)})),a.reverse(),a.forEach((function(t){if(n.splice(t,1),t+1>s);else{var r=Math.max(0,(e.get(o)||0)-1);e.set(o,r)}}))}function kl(t,e,r){var i=Gl.getBoardRecordId(e);return(t.get(i)||[]).some((function(t){return t.isOperationExist(r)}))}function Fl(t,e){var r=new Map,i=new Map;return t.forEach((function(t,e){var i=t.map((function(t){return new gn(t.user,{type:t.type,seq:JSON.parse(JSON.stringify(t.seq)),subType:t.subType})}));r.set(e,i)})),e.forEach((function(t,e){i.set(e,t)})),[r,i]}var Ul,Hl=function(){return(Hl=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Gl=function(){function t(){this.globalBackgroundColor=W(M.COLOR.WHITE),this.userInfoMap=new Map,this.fileMap=new Map,this.elementMap=new Map,this.userElementMap=new Map,this.boardElementMap=new Map,this.fileBoardMap=new Map,this.operationDataMap=new Map,this.operationIndexMap=new Map,this.boardBackgroundMap=new Map,this.globalBackgroundImage={url:"",mode:Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,type:M.BACKGROUND_TYPE.IMAGE}}return t.prototype.removeOperations=function(e){var r=t.getBoardRecordId(e);this.operationDataMap.delete(r),this.operationIndexMap.delete(r)},t.prototype.removeOperation=function(e,r){for(var i=t.getBoardRecordId(e),o=this.operationDataMap.get(i)||[],n=this.operationIndexMap.get(i)||0,a=-1,s=0;s<n;s++)if(o[s].seq===r){a=s;break}a>-1&&(o.splice(a,1),this.operationIndexMap.set(i,n-1))},t.prototype.insertOperation=function(e,r){var i=t.getBoardRecordId(e),o=this.operationIndexMap.get(i)||0,n=this.operationDataMap.get(i)||[];o<n.length&&n.splice(o),n[o]=r,this.operationDataMap.set(i,n),this.operationIndexMap.set(i,o+1)},t.prototype.resetOperation=function(e){var r=t.getBoardRecordId(e),i=this.operationIndexMap.get(r)||0,o=(this.operationDataMap.get(r)||[]).slice(0,i);this.operationDataMap.set(r,o)},t.prototype.undoOperation=function(e){var r=t.getBoardRecordId(e),i=this.operationIndexMap.get(r)||0;this.operationIndexMap.set(r,Math.max(i-1,0))},t.prototype.canUndo=function(t){return this.getOperationIndex(t)>0},t.prototype.redoOperation=function(e){var r=t.getBoardRecordId(e),i=this.operationIndexMap.get(r)||0,o=this.operationDataMap.get(r)||[];this.operationIndexMap.set(r,Math.min(i+1,o.length))},t.prototype.canRedo=function(t){return this.getOperationIndex(t)<this.getOperations(t).length},t.prototype.getOperations=function(e){var r=t.getBoardRecordId(e);return this.operationDataMap.get(r)||[]},t.prototype.getOperation=function(t,e){void 0===e&&(e=-1);var r=this.getOperationIndex(t);return this.getOperations(t)[r+e]},t.prototype.getOperationIndex=function(e){var r=t.getBoardRecordId(e);return this.operationIndexMap.get(r)||0},t.prototype.isOperationExistTextElement=function(e,r){for(var i=t.getBoardRecordId(e),o=this.operationDataMap.get(i)||[],n=this.operationIndexMap.get(i)||0,a=0;a<n;a++)if(o[a].seq===r)return!0;return!1},t.prototype.isOperationExistInAllOperations=function(t,e){return kl(this.operationDataMap,t,e)},t.prototype.removeOperationBySeq=function(t,e){Bl(this.operationDataMap,this.operationIndexMap,t,e)},t.prototype.addElement=function(e,r,i,o,n){void 0===o&&(o=null),void 0===n&&(n=!1);var a=t.getUserBoardRecordId(e,r),s=t.getBoardRecordId(e),l=t.getElementRecordId(i);if(this.initData(e,r),this.elementMap.has(l))this.elementMap.set(l,{userId:r,boardId:e,element:i});else{this.elementMap.set(l,{userId:r,boardId:e,element:i});var c=this.boardElementMap.get(s)||[],h=this.userElementMap.get(a)||[],u=o?c.indexOf(o.ID):-1;if(u>-1?c.splice(u,0,l):c.push(l),h.push(l),!n){var d=c.length;d>1&&c[d-1]<c[d-2]&&c.sort((function(t,e){return t>e?1:-1}));var p=h.length;p>1&&c[p-1]<c[p-2]&&h.sort((function(t,e){return t>e?1:-1}))}this.boardElementMap.set(s,c),this.userElementMap.set(a,h)}},t.prototype.replaceElement=function(e,r){var i=this.elementMap.get(t.getElementRecordId(e));i&&(i.element=r)},t.prototype.removeElement=function(e){var r=t.getElementRecordId(e),i=this.elementMap.get(r);if(i){var o=i.boardId,n=i.userId,a=i.element,s=t.getUserBoardRecordId(o,n),l=t.getBoardRecordId(o),c=this.boardElementMap.get(l),h=this.userElementMap.get(s);return c&&this.boardElementMap.set(l,c.filter((function(t){return t!==r}))),h&&this.userElementMap.set(s,h.filter((function(t){return t!==r}))),this.elementMap.delete(r),a}},t.prototype.removeElementsByFilter=function(e,r,i){var o=this,n=t.getUserBoardRecordId(e,r),a=t.getBoardRecordId(e),s=this.boardElementMap.get(a),l=this.userElementMap.get(n);s&&this.boardElementMap.set(a,s.filter(i)),l&&this.userElementMap.set(n,l.filter(i)),this.elementMap.forEach((function(t,e){i(e)||o.elementMap.delete(e)}))},t.prototype.removeElementsByUserId=function(e,r){var i=this,o=t.getUserBoardRecordId(e,r),n=t.getBoardRecordId(e),a=this.userElementMap.get(o),s=new Set(a),l=this.boardElementMap.get(n);l&&this.boardElementMap.set(n,l.filter((function(t){return!s.has(t)}))),this.userElementMap.set(o,[]),null==a||a.forEach((function(t){return i.elementMap.delete(t)}))},t.prototype.removeElementsByBoardId=function(e,r){var i=this,o=t.getBoardRecordId(e),n=this.boardElementMap.get(o);if(n){var a=[].concat(n),s=[Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO,Ta.TEDU_BOARD_ELEMENT_WATERMARK];a.forEach((function(r){var o=i.elementMap.get(r);if(o&&!s.includes(o.element.subType)){var n=o.userId,a=t.getUserBoardRecordId(e,n),l=i.userElementMap.get(a)||[];l.splice(l.indexOf(r),1),i.elementMap.delete(r);var c=i.boardElementMap.get(e)||[];c.splice(c.indexOf(r),1)}}))}},t.prototype.removeAllElement=function(){this.elementMap=new Map,this.userElementMap=new Map,this.boardElementMap=new Map},t.prototype.reset=function(){this.elementMap=new Map,this.userElementMap=new Map,this.boardElementMap=new Map,this.operationDataMap=new Map,this.operationIndexMap=new Map,this.boardBackgroundMap=new Map},t.prototype.getElementByElementId=function(e){if(Object.values(Nl).includes(e+""))return this.getWatermarkElementIdByConstant(e);var r=this.elementMap.get(t.getElementRecordId(e));return r&&r.element},t.prototype.getElementsByBoardId=function(e){var r=this,i=t.getBoardRecordId(e),o=this.boardElementMap.get(i);return(null==o?void 0:o.map((function(t){return r.getElementByElementId(t)})))||[]},t.prototype.getUserElementsByBoardId=function(t){var e=this,r=new RegExp("@".concat(t,"$"),"i"),i=new Map;return this.userElementMap.forEach((function(o,n){if(r.test(n)){var a=n.replace("@".concat(t),"");i.set(a,e.getElementsByUserId(t,a))}})),i},t.prototype.getAllElements=function(){var t=new Map;return this.elementMap.forEach((function(e,r){t.set(r,e.element)})),t},t.prototype.getElementsByUserId=function(e,r){var i=this,o=t.getUserBoardRecordId(e,r),n=this.userElementMap.get(o);return(null==n?void 0:n.map((function(t){return i.getElementByElementId(t)})))||[]},t.prototype.getLatestElementByUserId=function(t,e){var r=this.getElementsByUserId(t,e);if(r)return r[r.length-1]},t.prototype.getBackgroundPicture=function(e,r){var i=t.getBoardRecordId(e),o=this.boardBackgroundMap.get(i);if(o){var n=Object.assign({},o.picture),a=Ot(e);if(r&&a===M.COMMON_GROUP&&!n.url){var s=this.getGlobalBackgroundImage();s.url&&(n.url=s.url,n.mode=s.mode,n.type=s.type)}return n}return{url:"",mode:Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,type:M.BACKGROUND_TYPE.IMAGE,angle:0,user:"",show:!0}},t.prototype.setBackgroundPicture=function(e,r){var i=t.getBoardRecordId(e),o=this.boardBackgroundMap.get(i);o&&Object.assign(o.picture,r)},t.prototype.setBackgroundPictureAngle=function(e,r){var i=t.getBoardRecordId(e),o=this.boardBackgroundMap.get(i);o&&Object.assign(o.picture,{angle:r})},t.prototype.getBackgroundColor=function(e){var r=t.getBoardRecordId(e),i=this.boardBackgroundMap.get(r);return i&&i.color},t.prototype.setBackgroundColor=function(e,r){var i=t.getBoardRecordId(e),o=this.boardBackgroundMap.get(i);o&&(o.color=r)},t.prototype.getBackground=function(t){return{color:this.getBackgroundColor(t)||this.getGlobalBackgroundColor(),picture:this.getBackgroundPicture(t,!0)}},t.prototype.removeBackground=function(e){var r=t.getBoardRecordId(e);this.boardBackgroundMap.delete(r)},t.prototype.setGlobalBackgroundColor=function(t){void 0===t&&(t=M.COLOR.WHITE),this.globalBackgroundColor=W(t)},t.prototype.getGlobalBackgroundColor=function(){return this.globalBackgroundColor},t.prototype.setGlobalBackgroundImage=function(t,e,r){this.globalBackgroundImage={url:t,type:r,mode:e}},t.prototype.getGlobalBackgroundImage=function(){return this.globalBackgroundImage},t.prototype.initBoardElementData=function(t){this.boardElementMap.has(t)||this.boardElementMap.set(t,[])},t.prototype.initUserElementData=function(t){this.userElementMap.has(t)||this.userElementMap.set(t,[])},t.prototype.initOperation=function(t){this.operationDataMap.has(t)||(this.operationDataMap.set(t,[]),this.operationIndexMap.set(t,0))},t.prototype.initBoardBackground=function(t,e){this.boardBackgroundMap.has(t)||this.boardBackgroundMap.set(t,{color:e.bgColor,picture:{url:e.bgPicture.url||"",user:e.boardId===M.COMMON_DEFAULT_BOARD?e.userId:It(e.boardId),show:!0,angle:0,mode:e.bgPicture.mode||Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,type:e.bgPicture.type||M.BACKGROUND_TYPE.IMAGE}})},t.prototype.initData=function(e,r,i){void 0===i&&(i=null);var o=t.getUserBoardRecordId(e,r),n=t.getBoardRecordId(e);this.initBoardElementData(n),this.initUserElementData(o),this.initOperation(n),i&&this.initBoardBackground(n,Hl({boardId:e,userId:r,bgColor:this.globalBackgroundColor,bgPicture:""},i))},t.prototype.isBoardExist=function(t){return this.boardElementMap.has(t)},t.prototype.isElementExist=function(e){var r=t.getElementRecordId(e);return this.elementMap.has(r)},t.prototype.getWatermarkElements=function(){for(var t=this.getElementsByBoardId(M.COMMON_DEFAULT_BOARD),e=null,r=null,i=null,o=0,n=t.length;o<n;o++){var a=t[o];if(a.subType===Ta.TEDU_BOARD_ELEMENT_WATERMARK&&a.show&&(a.watermarkType===Nl.Image?e=a:a.watermarkType===Nl.Text?r=a:a.watermarkType===Nl.TextFix&&(i=a),e&&r&&i))break}return{imageWatermarkElement:e,textWatermarkElement:r,fixTextWatermarkElement:i}},t.prototype.getWatermarkElementIdByConstant=function(t){var e=this.getWatermarkElements();return t===Nl.Image?e.imageWatermarkElement:t===Nl.Text?e.textWatermarkElement:t===Nl.TextFix?e.fixTextWatermarkElement:null},t.prototype.getOperationDataAndIndexMap=function(){return{dataMap:this.operationDataMap,indexMap:this.operationIndexMap}},t.prototype.setOperationDataAndIndexMap=function(t,e){this.operationDataMap=t,this.operationIndexMap=e},t.getUserBoardRecordId=function(t,e){return"".concat(e,"@").concat(t)},t.getBoardRecordId=function(t){return"".concat(t)},t.getElementRecordId=function(t){return"".concat("string"==typeof t||"number"==typeof t?t:t.belongSeq||t.seq)},t}(),ql=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Wl=function(){return(Wl=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Yl=function(t){function e(e,r){var i=t.call(this,e)||this;return i.request=r,i}return ql(e,t),e.prototype.setPreCallback=function(t){this.preCallback=t},e.prototype.setCallback=function(t){this.callback=t},e.prototype.reportMsg=function(t,e,r){var i=this;this.preCallback&&this.preCallback(t),this.request.reportMsg(t,(function(r){e&&e(r),i.callback&&i.callback(t,null)}),(function(e){r&&r(e),i.callback&&i.callback(t,e)}))},e.prototype.constructReportMsg=function(t,e,r){return void 0===r&&(r={}),"setRatio"===e||"setBoardContentFitMode"===e?{type:e,seq:t,content:r}:{type:e,seq:t,content:Wl({updateTime:Wt.getTimeStamp()},r)}},e.prototype.constructReportLogData=function(t,e){var r={},i=e.timeConsume,o=void 0===i?0:i,n=e.boardId,a=void 0===n?"":n,s=e.boardIdList,l=void 0===s?"":s,c=e.toBoardId,h=void 0===c?"":c,u=e.fileId,d=void 0===u?"":u,p=e.fileTitle,f=void 0===p?"":p,g=e.content,m=void 0===g?{}:g;return t.ErrorCode||t.error_code?(r.code=t.ErrorCode||t.error_code||-1,r.message=t.ErrorInfo||t.error_msg||""):(r.code=0,r.message=""),r.reqId=t.reqId||"",r.cost=o,r.param={boardId:a,boardIdList:l,toBoardId:h,fileId:d,fileTitle:f,extraInfo:JSON.stringify(m)},r},e.prototype.reportMsgWithLog=function(t){var e,r,i=this,o=Wt.getTimeStamp();r=B(t.content)?t.content.map((function(t){return i.constructReportMsg(t.seq||i.seqUtil.getSeq(),t.type,t.content)})):[this.constructReportMsg(this.seqUtil.getSeq(),t.type,t.content)];var n=(null===(e=t.formatter)||void 0===e?void 0:e.contentFormatter)||function(t){return t},a=t.reportContent||{};this.reportMsg(r,(function(e){i.logger.reportInfo("Report",t.type,i.constructReportLogData(e,{timeConsume:Wt.getTimeDiff(o),content:n(t.content),boardId:a.boardId,boardIdList:a.boardIdList,toBoardId:a.toBoardId}),ea.ONLY_ONLINE),t.onSuccess&&t.onSuccess(e)}),(function(e){i.logger.reportError("Report",t.type,i.constructReportLogData({ErrorCode:-9999,ErrorInfo:e&&e.message},{timeConsume:Wt.getTimeDiff(o),content:n(t.content),boardId:a.boardId,boardIdList:a.boardIdList,toBoardId:a.toBoardId}),ea.ONLY_ONLINE),t.onError&&t.onError(e)}))},e.prototype.reportCreateBoards=function(t,e){var r,i=this;return(r=B(e)?e:[e]).length?new Promise((function(e,o){i.reportMsgWithLog({type:"createBoards",content:{fid:Ot(r[0]),createBoards:r},reportContent:{boardId:t,boardIdList:JSON.stringify(r)},onSuccess:function(t){t.error_code?o(t.error_msg||t.result):e(t)},onError:function(t){o(t)}})})):Promise.resolve()},e.prototype.reportDeleteBoard=function(t,e){t.length&&this.reportMsgWithLog({type:"deleteBoards",content:{deleteBoards:t,toBoardId:e},reportContent:{boardIdList:JSON.stringify(t),toBoardId:e}})},e.prototype.reportSetBoardBgColor=function(t,e){this.reportMsgWithLog({type:"setBoardBG",content:{boardId:t,colorRGBA:e},reportContent:{boardId:t}})},e.prototype.reportClear=function(t){this.reportMsgWithLog({type:"clean",content:{boardId:t},reportContent:{boardId:t}})},e.prototype.reportClearDraws=function(t){var e;e=t instanceof Array?t.join(","):t,this.reportMsgWithLog({type:"cleanDraws",content:{boardId:t},reportContent:{boardId:e}})},e.prototype.reportImage=function(t,e,r,i,o){void 0===r&&(r=Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER),void 0===i&&(i=M.BACKGROUND_TYPE.IMAGE),void 0===o&&(o=0),this.reportMsgWithLog({type:"image",content:{fid:Ot(t),boardId:t,url:e,type:i,mode:r,angle:o},reportContent:{boardId:t}})},e.prototype.reportImages=function(t){for(var e=0,r=Math.ceil(t.length/100);e<r;e++){var i=t.slice(100*e,100*(e+1));this.reportMsgWithLog({type:"images",content:i})}},e.prototype.reportSwitchBoard=function(t){var e=t.boardId,r=t.fid,i=t.url,o=t.type,n=t.page,a=t.step,s=t.ratio,l=t.scale;this.reportMsgWithLog({type:"switchBoard",content:{boardId:e,fid:r,url:i,type:o,page:n,step:a,ratio:s,scale:l},reportContent:{boardId:e}})},e.prototype.reportGlobalBg=function(t,e){this.reportMsgWithLog({type:"setGlobalBG",content:{colorRGBA:t,picture:e}})},e.prototype.reportAddLine=function(t){this.reportMsgWithLog({type:"addLine",content:t,reportContent:{boardId:t.boardId}})},e.prototype.reportAddText=function(t){this.reportMsgWithLog({type:"addText",content:t,reportContent:{boardId:t.boardId}})},e.prototype.reportDisplayLine=function(t){this.reportMsgWithLog({type:"displayLine",content:t,reportContent:{boardId:t.boardId}})},e.prototype.reportGraphData=function(t){this.reportMsgWithLog({type:"addGraphData",content:t,formatter:{contentFormatter:function(t){return t.map((function(t){return{type:t.type,boardId:t.content.boardId,color:t.content.colorRGBA}}))}}})},e.prototype.reportAddFile=function(t){var e=this;return new Promise((function(r,o){var n=t.fid,a=t.title,s=t.downloadURL,l=t.pageCount,c=t.currentPageIndex,h=t.currentPageStep,u=t.uid,d=t.timestamp,p=t.platform,f=void 0===p?i.PLATFORM:p,g=t.type,m=void 0===g?M.FILE_TYPE.IMG:g,y=t.ratio,v=t.scale,_=void 0===v?0:v,E=t.isTranscodeFile,T=t.status,b=t.progress,S=t.isUpdateScale,x=void 0===S?0:S,w=t.pptMediaPlaybackStatus,O=t.boardSequenceList,I=t.h5FileEnableDraw;e.reportMsgWithLog({type:"addFile",content:{fid:n,title:a,downloadURL:s,pageCount:l,currentPageIndex:c,currentPageStep:h,uid:u,timestamp:d,platform:f,type:m,ratio:y,scale:Math.floor(_),isTranscodeFile:E,status:T,progress:b,isUpdateScale:x,pptMediaPlaybackStatus:w,boardSequenceList:O,h5FileEnableDraw:!!I},reportContent:{fileId:n,fileTitle:a},onSuccess:function(t){t.error_code?o(t.error_msg||t.result):r(t)},onError:function(t){o(t)}})}))},e.prototype.reportDeleteFile=function(t){this.reportMsgWithLog({type:"deleteFile",content:{fid:t},reportContent:{fileId:t}})},e.prototype.reportDrag=function(t){this.reportMsgWithLog({type:"drag",content:t})},e.prototype.reportSetBoardRatio=function(t){this.reportMsgWithLog({type:"setRatio",content:t})},e.prototype.reportSetBoardContentFitMode=function(t){this.reportMsgWithLog({type:"setBoardContentFitMode",content:t})},e.prototype.reportImageElement=function(t){var e=[];B(t)?t.forEach((function(t){e.push({type:"imageElement",content:t})})):e.push({type:"imageElement",content:t}),this.reportMsgWithLog({type:"imageElement",content:e})},e.prototype.reportLayerElement=function(t){var e=[];B(t)?t.forEach((function(t){e.push({type:"layer",content:t})})):e.push({type:"layer",content:t}),this.reportMsgWithLog({type:"layer",content:e})},e.prototype.reportElement=function(t){var e=[];B(t)?t.forEach((function(t){e.push({type:t.type,content:t.property})})):e.push({type:t.type,content:t.property}),this.reportMsgWithLog({type:"reportElement",content:e})},e.prototype.reportUpdateContent=function(t){var e=[];B(t)?t.forEach((function(t){e.push({type:"updateContent",content:t})})):e.push({type:"updateContent",content:t}),this.reportMsgWithLog({type:"updateContent",content:e})},e.prototype.reportAddUserContent=function(t,e,r){var i=[];B(t)?t.forEach((function(t){i.push({type:"addUserContent",content:t})})):i.push({type:"addUserContent",content:t}),this.reportMsgWithLog({type:"addUserContent",content:i,onSuccess:e,onError:r})},e.prototype.reportCleanAll=function(){this.reportMsgWithLog({type:"cleanAll",content:{}})},e.prototype.reportAddSnapshotMark=function(t){this.reportMsgWithLog({type:"addSnapshotMark",content:{boardId:t.boardId},reportContent:t})},e.prototype.reportSetBoardRemark=function(t,e){this.reportMsgWithLog({type:"setBoardRemark",content:{boardId:t,remark:e},reportContent:{boardId:t}})},e.prototype.reportSetDiscussionGroup=function(t){this.reportMsgWithLog({type:"setDiscussionGroup",content:t.map((function(t){return{type:"setDiscussionGroup",content:t}})),formatter:{contentFormatter:function(t){return t.map((function(t){return t.content}))}}})},e.prototype.reportEnableDiscussionGroup=function(t){this.reportMsgWithLog({type:"enableDiscussionGroup",content:t})},e.prototype.reportResetDiscussionGroup=function(){this.reportMsgWithLog({type:"resetDiscussionGroup",content:{}})},e.prototype.reportDeleteDiscussionGroup=function(t){this.reportMsgWithLog({type:"deleteDiscussionGroup",content:{discussionGroupId:t}})},e.prototype.reportSplitLine=function(t){this.reportMsgWithLog({type:"splitLine",content:t})},e}(X),zl={TEDU_BOARD_UPLOAD_STATUS_SUCCEED:1,TEDU_BOARD_UPLOAD_STATUS_FAILED:2},jl=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Vl=function(){return(Vl=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Xl=function(t){function e(e,r,i){var o=t.call(this,e)||this;return o.cosInstance=null,o.options=Vl(Vl({appid:null,bucket:null},r),{region:"ap-shanghai",path:"/TIC/"}),o.request=i,o.userDataKeyMap={},o.fidKeyMap={},o.bucketCosMap={},o}return jl(e,t),e.prototype.uploadImgFile=function(t){var e,r=this,i=Wt.getTimeStamp(),o=null,n="",a="";if(e=t.data,"[object File]"==Object.prototype.toString.call(e))o=t.data,n=t.data.name,a=t.userData;else{var s=t.data;n=t.name,a=t.userData;for(var l=s.split(","),c=window.atob(l[1]),h=l[0].match(/:(.*?);/)[1],u=new Uint8Array(c.length),d=0;d<c.length;d++)u[d]=c.charCodeAt(d);o=new Blob([u],{type:h})}return this.uploadCosImageFile({body:o,fileName:n,userData:a}).then((function(t){r.event.fireUploadFileStatusChangedEvent(zl.TEDU_BOARD_UPLOAD_STATUS_SUCCEED,{code:0,errorMsg:"",userData:a});var e;return e="board-sdk-1259648581"===t.Bucket?"https://board-sdk.qcloudtiw.com/".concat(t.Key):"https://".concat(t.Bucket,".file.myqcloud.com/").concat(t.Key),Promise.resolve({fileName:n,fileUrl:e,userData:a})}),(function(t){return r.event.fireUploadFileStatusChangedEvent(zl.TEDU_BOARD_UPLOAD_STATUS_FAILED,{code:t.statusCode?t.statusCode:-3,errorMsg:JSON.stringify(t.error),userData:a}),Promise.reject(t)})).catch((function(t){r.logger.error("FileCos","cos_upload_file",t,!0),r.logger.reportError("FileCos","cos_upload_file",{code:2,stack:t.stack,message:t.message,cost:Wt.getTimeStamp()-i,param:{bucket:r.options.bucket,cos_appid:r.options.appid,region:r.options.region,userData:a}})}))},e.prototype.uploadCosImageFile=function(t){var e=this,r=t.body,i=t.fileName,o=t.userData;return this.upload({path:this.options.path+this.sdkAppId+"/"+Wt.getTimeStamp()+"/"+i,body:r,userData:o,onProgress:function(t){e.event.fireUploadFileProgressEvent(Vl({userData:o},t))}})},e.prototype.upload=function(t){var e=this;return new Promise((function(r,i){var o=(t.bucket||e.options.bucket)+"-"+(t.appid||e.options.appid);if(e.bucketCosMap[o])e.cosInstance=e.bucketCosMap[o];else{if(!window.COS)return void i({error:"not found COS library"});e.cosInstance=new window.COS({getAuthorization:function(t,r){return function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function a(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))}(e,void 0,void 0,(function(){var e,i,o;return function(t,e){var r,i,o,n,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}(this,(function(n){switch(n.label){case 0:e=t.Bucket.substr(0,t.Bucket.lastIndexOf("-")),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.request.getCosAuthData(e)];case 2:return(i=n.sent())&&i.data&&0==i.data.error_code?(o=i.data,r({TmpSecretId:o.tmp_secret_id,TmpSecretKey:o.tmp_secret_key,XCosSecurityToken:o.session_token,ExpiredTime:o.expired_time})):r({TmpSecretId:"error",TmpSecretKey:"error",XCosSecurityToken:"error",ExpiredTime:-1}),[3,4];case 3:return n.sent(),r({TmpSecretId:"error",TmpSecretKey:"error",XCosSecurityToken:"error",ExpiredTime:-1}),[3,4];case 4:return[2]}}))}))}}),e.bucketCosMap[o]=e.cosInstance}e.cosInstance.sliceUploadFile({Bucket:o,Region:t.region||e.options.region,Key:t.path,Body:t.body,onTaskReady:function(e){k(t.onTaskReady)&&t.onTaskReady(e)},onHashProgress:function(e){k(t.onHashProgress)&&t.onHashProgress(e)},onProgress:function(e){k(t.onProgress)&&t.onProgress(e)}},(function(n,a){a&&200===a.statusCode?(r(a),e.logger.reportInfo("FileCos","cos_upload_file",{param:{extraInfo:JSON.stringify({bucket:o,userData:t.userData,data:a})}})):(i(n),e.logger.reportError("FileCos","cos_upload_file",{code:1,message:JSON.stringify(n),param:{extraInfo:JSON.stringify({bucket:o,userData:t.userData})}}))}))}))},e}(X),Jl=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Kl=function(t){function e(e,r){var i=t.call(this,e)||this;i.defaultTimeout=3e4,i.maxRetry=10;var o=r.newEnterId,n=void 0===o?0:o,a=r.request;return i.$request=a,i.newEnterId=Number(n)||0,i.maxTimeout=10*i.defaultTimeout,i.timeout=i.defaultTimeout,i.status=!0,i.sto=null,i.retryCount=0,i.LastReportTime=0,i.visible=!0,i._heartbeatLifecycle="live",i}return Jl(e,t),e.prototype.beat=function(t){var e=this;clearTimeout(this.sto);var r={LastReportTime:this.LastReportTime,HeartbeatVersion:"2.0",RoomId:this.classId,HeartbeatList:[{BusinessType:"whiteboard",Submodule:"",CustomData:{Event:t}}],ClientVersion:i.VERSION,NewEnterId:this.newEnterId,UserAgent:navigator?navigator.userAgent:"",BackgroundState:this.visible?0:1};if("destroy"===this._heartbeatLifecycle)return Promise.reject();var o,n=Wt.getTimeStamp(),a=this.$request.heartbeat(r);return o=a,"[object Promise]"!=Object.prototype.toString.call(o)?Promise.reject():a.then((function(t){if(t.data.Response&&!t.data.Response.Error){if(e.retryCount=0,e.LastReportTime=t.data.Response.ReportTime,e.timeout=1e3*t.data.Response.IntervalTime,e.trigger(),t.data.Response.ServerTime){var r=Wt.getTimeStamp(),i=Math.floor((r-n)/2);Wt.adjustLocalTime(t.data.Response.ServerTime,i)}}else 0===t.data.error_code?(e.retryCount=0,e.timeout=e.defaultTimeout,e.trigger()):(e.retryCount++,e.timeout=Math.min(Math.ceil(e.retryCount/10)*e.defaultTimeout,e.maxTimeout),e.trigger(),e.reportElk(n,t.data))})).catch((function(t){e.retryCount++,e.timeout=Math.min(Math.ceil(e.retryCount/10)*e.defaultTimeout,e.maxTimeout),e.trigger(),e.reportElk(n,t)}))},e.prototype.trigger=function(){var t=this;clearTimeout(this.sto),this.sto=setTimeout((function(){t.beat(null).catch((function(){}))}),this.timeout||this.defaultTimeout)},e.prototype.setVisible=function(t){this.visible=t;var e=[{name:t?"visible":"unvisible",timestamp:Wt.getSecondTime()}];this.beat(e).catch((function(){}))},e.prototype.start=function(){var t=[{name:"init",timestamp:Wt.getSecondTime()}];this.beat(t).catch((function(){}))},e.prototype.pause=function(){this.status=!1,clearTimeout(this.sto)},e.prototype.resume=function(){this.status=!0,this.beat(null).catch((function(){}))},e.prototype.destroy=function(){var t=this,e=[{name:"uninit",timestamp:Wt.getSecondTime()}];this.beat(e).then((function(){t._heartbeatLifecycle="destroy",clearTimeout(t.sto)})).catch((function(){t._heartbeatLifecycle="destroy",clearTimeout(t.sto)}))},e.prototype.reportElk=function(t,e){this.logger.reportInfo("Heartbeat","heartbeat_error",{cost:Wt.getTimeStamp()-t,param:{extraInfo:JSON.stringify({retryCount:this.retryCount,error:e})}})},e}(X),Zl=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ql=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),$l=function(){return($l=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},tc=function(t){function e(e,r){var i=t.call(this,e)||this;if(i.permissions=!1,i.reportEnable=!1,i.option=r,i.isTest=i.option.isTest||!1,!i.sdkAppId)throw new Error("not found sdkAppId");if(!i.identifier)throw new Error("not found userId");if(!i.userSig)throw new Error("not found userSig");return i}return Ql(e,t),e.prototype.setPermissions=function(t){void 0===t&&(t=!1),this.permissions=t},e.prototype.setReportEnable=function(t){void 0===t&&(t=!1),this.reportEnable=t},e.prototype.reportMsg=function(t,e,r){this.option.classId&&this.permissions&&this.reportEnable&&this.post({cmd:"open_conf_svc",sub_cmd:"report_board_data",conf_id:this.classId,board_data_list:t},e,r)},e.prototype.getBoardData=function(t,e,r){void 0===t&&(t=!0),this.option.enableLocalMode?e({board_data_list:[],error_code:0,error_msg:"",is_finish:!0,seq:this.seqUtil.getSeq()},{config:{data:JSON.stringify({first_time:!0})}}):this.post({first_time:t,cmd:"open_conf_svc",sub_cmd:"get_board_data_bulk",seq:this.seqUtil.getSeq(),conf_id:this.classId,version:3},e,r)},e.prototype.getSingleBoardData=function(t,e,r){this.post({cmd:"open_conf_svc",sub_cmd:"get_board",seq:this.seqUtil.getSeq(),conf_id:this.classId,board_id:t,version:1},e,r)},e.prototype.getLineData=function(t,e,r){var i=this,o=Wt.getTimeStamp(),n={cmd:"open_conf_svc",sub_cmd:"get_line",conf_id:this.classId,boardId:t.boardId,owner:t.owner,seq:t.seq};this.post(n,(function(t){i.logger.reportInfo("Request","getLineData",{code:0,cost:Wt.getTimeDiff(o),param:{extraInfo:JSON.stringify(t)}},ea.ONLY_ONLINE),e&&e(t)}),(function(t){i.logger.reportError("Request","getLineData",{code:-1,cost:Wt.getTimeDiff(o),param:{extraInfo:JSON.stringify(t)}},ea.ONLY_ONLINE),r&&r(t)}))},e.prototype.getFileInfo=function(t,e,r){var i=this,o=Wt.getTimeStamp(),n={cmd:"open_conf_svc",sub_cmd:"get_file",conf_id:this.classId,fid:t.fid};this.post(n,(function(r){i.logger.reportInfo("Request","getFileInfo",{code:0,cost:Wt.getTimeDiff(o),param:{fileId:t.fid,extraInfo:JSON.stringify(r)}},ea.ONLY_ONLINE),e&&e(r)}),(function(e){i.logger.reportError("Request","getFileInfo",{code:0,cost:Wt.getTimeDiff(o),param:{fileId:t.fid,extraInfo:JSON.stringify(e)}},ea.ONLY_ONLINE),r&&r(e)}))},e.prototype.getDocTotalPage=function(t){return ca({logger:this.logger,url:t,method:"get",responseType:"blob"})},e.prototype.getCosAuthData=function(t){var e="".concat(this._getCosServerUrl(),"?SdkAppId=").concat(this.sdkAppId,"&Identifier=").concat(this.identifier,"&UserSig=").concat(this.userSig,"&random=").concat(Math.floor(1e8*Math.random()));return ca({logger:this.logger,url:e,method:"post",headers:{"X-Tiw-Req-ID":fn()},data:{cmd:"open_cos_svc",sub_cmd:"get_cos_token_for_bucket",bucket:t,duration:300,version:2}})},e.prototype.applyPermissions=function(){if(this.option.enableLocalMode)return new Promise((function(t){t({data:{cos_appid:0,cos_bucket:"",error_code:0,error_msg:"",file_message:{appid:0,bucket:"",region:""},level:10,server_time:Wt.getTimeStamp()}})}));if(L.isPrivateEnv())return this._privateEnvVerifySDK();var t="".concat(this._getWhiteListServerUrl(),"&usersig=").concat(this.userSig,"&identifier=").concat(this.identifier,"&contenttype=json&random=").concat(Math.floor(1e8*Math.random()));return ca({logger:this.logger,url:t,method:"post",headers:{"X-Tiw-Req-ID":fn()},data:{cmd:"open_conf_svc",sub_cmd:"verify_sdk",sdkappid:+this.sdkAppId,version:1}})},e.prototype._privateEnvVerifySDK=function(){var t=this,e=this._getWhiteBoardServerUrl()+"&usersig="+this.userSig+"&identifier="+this.identifier;return new Promise((function(r,i){ca({logger:t.logger,url:e,method:"post",data:{cmd:"open_conf_svc",sub_cmd:"license",conf_id:t.classId}}).then((function(t){Object.assign(t.data,{cos_appid:0,cos_bucket:"",file_message:{appid:0,bucket:"",region:""},level:10}),r(t)}),(function(t){i(t)}))}))},e.prototype.heartbeat=function(t){var e=this;if(this.permissions){if(L.isPrivateEnv())return this._privateEnvHeartbeat();var r=this._getHeartbeatServerUrl()+"&usersig="+this.userSig+"&identifier="+this.identifier+"&contenttype=json&random="+1e8*Math.random();return ca({logger:this.logger,url:r,method:"post",data:$l($l({},t),{LastReportTime:0,HeartbeatVersion:"1.0"})}).then((function(t){var r,i;return 70001===(null===(r=t.data)||void 0===r?void 0:r.ErrorCode)&&(null===(i=e.event)||void 0===i||i.fireErrorEvent(Xt.TEDU_BOARD_SIGNATURE_EXPIRED,"The UserSig in use is expired")),t}),(function(t){return t}))}},e.prototype._privateEnvHeartbeat=function(){var t=this._getWhiteBoardServerUrl()+"&usersig="+this.userSig+"&identifier="+this.identifier;return ca({logger:this.logger,url:t,method:"post",data:{cmd:"open_conf_svc",sub_cmd:"heartbeat",conf_id:this.classId}})},e.prototype.requestFileMessage=function(t){return ca({logger:this.logger,url:t,method:"get"})},e.prototype.requestFont=function(t){return void 0===t&&(t=L.fontUrl),ca({timeout:1e4,logger:this.logger,url:t,method:"get"})},e.prototype.networkSniffer=function(t,e,r){return void 0===e&&(e="head"),new Promise((function(i,o){e=e.toLocaleLowerCase();var n=new XMLHttpRequest;n.timeout="head"===e?2e3:r||5e3,n.onreadystatechange=function(){if("head"===e&&2===n.readyState||4===n.readyState){var t=n.getAllResponseHeaders(),a=(n.getResponseHeader("content-type")||"").split(";")[0],s="";["application/javascript","text/css","text/html","application/json","application/x-javascript","text/plain","text/xml"].indexOf(a)>-1&&(s=encodeURI(escape(n.responseText.substr(-200)))),n.onreadystatechange=null,n.ontimeout=null;var l={timeout:r,method:e,type:"onreadystatechange",readyState:n.readyState,status:n.status,responseHeaders:ie(t),response:s};n.status>=200&&n.status<300||304===n.status?i(l):o(l)}},n.ontimeout=function(){var t=n.getAllResponseHeaders();n.onreadystatechange=null,n.ontimeout=null,o({method:e,type:"ontimeout",readyState:n.readyState,status:n.status,responseHeaders:ie(t),response:""})},n.open(e,t),n.send()}))},e.prototype.urlPost=function(t,e,r,i){void 0===window.axios?this.cPost(t,e,r,i):this.axiosPost(t,e,r,i)},e.prototype.post=function(t,e,r){var i=this._getWhiteBoardServerUrl()+"&usersig="+this.userSig+"&identifier="+this.identifier+"&random=".concat(Math.floor(1e8*Math.random()));"open_conf_svc"===t.cmd&&"report_board_data"===t.sub_cmd&&(i+="&contenttype=json"),this.urlPost(i,t,e,r)},e.prototype.axiosPost=function(t,e,r,i){var o=this;if(this.option.enableLocalMode)r("");else{var n=fn(),a={logger:this.logger,url:t,method:"post",headers:{"X-Tiw-Req-ID":n},data:e};L.isPrivateEnv()&&L.privateEnvConfig.token&&(a.headers={Authorization:"Bearer "+L.privateEnvConfig.token}),ca(a).then((function(t){var e,i;"object"==typeof t.data&&null!==t.data&&(t.data.reqId=n),r&&r(t.data,t),70001===(null===(e=t.data)||void 0===e?void 0:e.ErrorCode)&&(null===(i=o.event)||void 0===i||i.fireErrorEvent(Xt.TEDU_BOARD_SIGNATURE_EXPIRED,"The UserSig in use is expired"))})).catch((function(t){i&&i(t)}))}},e.prototype.corsGet=function(t,e,r){!function(t,e,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){2==i.readyState?(i.onreadystatechange=null,i.abort(),e()):4==i.readyState&&r()},i.open("GET",t),i.send()}(t,e,r)},e.prototype.cPost=function(t,e,r,i){this.option.enableLocalMode?r(""):function(t){var e,r,i,o=t.url,n=t.method,a=t.data,s=void 0===a?{}:a,l=t.headers,c=void 0===l?{}:l,h=t.params,u=void 0===h?{}:h,d=t.isAsync,p=void 0===d||d,f=t.onSuccess,g=void 0===f?null:f,m=t.onError,y=void 0===m?null:m,v=(i=window.ActiveXObject,XMLHttpRequest?new XMLHttpRequest:new i("Microsoft.XMLHTTP")),_=[],E=o;for(var T in u){var b=u[T];if(B(b))try{for(var S=(e=void 0,Zl(b)),x=S.next();!x.done;x=S.next()){var w=x.value;_.push("".concat(T,"[]=").concat(w))}}catch(t){e={error:t}}finally{try{x&&!x.done&&(r=S.return)&&r.call(S)}finally{if(e)throw e.error}}else _.push("".concat(T,"=").concat(b))}if(_.length){var O=_.join("&");E=o+(o.includes("?")?"&":"?")+O}for(var I in v.open(n,E,p),c)v.setRequestHeader(I,c[I]);v.onreadystatechange=function(){if(4===v.readyState)if(v.status>=200&&v.status<300||304==v.status)try{var t=JSON.parse(v.responseText);g&&g(t)}catch(t){y&&y(t)}else{var e=new Error("Network Error");y&&y(e)}},v.send(JSON.stringify(s))}({url:t,method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8","X-Tiw-Req-ID":fn()},data:e,onSuccess:r,onError:i})},e.prototype._getWhiteBoardServerUrl=function(){return L.getWhiteBoardServerUrl(this.isTest)+this.sdkAppId},e.prototype._getCosServerUrl=function(){return L.getCosServerUrl(this.isTest)},e.prototype._getWhiteListServerUrl=function(){return L.getWhiteListServerUrl(this.isTest)+this.sdkAppId},e.prototype._getTranscodeServerUrl=function(){return L.getTranscodeServerUrl(this.isTest)+this.sdkAppId},e.prototype._getHeartbeatServerUrl=function(){return L.getHeartbeatServerUrl(this.isTest)+this.sdkAppId},e}(X);!function(t){t[t.LINE=1]="LINE",t[t.ERASER=2]="ERASER",t[t.GRAPH=3]="GRAPH",t[t.TEXT=4]="TEXT",t[t.MOVE=5]="MOVE",t[t.DELETE=6]="DELETE",t[t.ELEMENT=7]="ELEMENT",t[t.PIECEWISE_ERASER=8]="PIECEWISE_ERASER",t[t.ELEMENT_UPDATE=9]="ELEMENT_UPDATE"}(Ul||(Ul={}));var ec,rc=Ul,ic=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),oc=function(t){function e(r,i,o){var n,a,s,l=this;return(l=t.call(this,r,{renderOnCanvas:!1,listener:{updatePosition:function(t,e){},updateScale:function(t,e,r,i){},updateRotate:function(t){}}},"watermark")||this).type="element",l.subType=Ta.TEDU_BOARD_ELEMENT_WATERMARK,l.boardId=M.COMMON_DEFAULT_BOARD,l.user="",l.rendered=!1,l._content="",l.erasable=!1,l._url="",l._text="",l._color="#777",l._opacity=1,l._textSize=e.Default_FontSize,l.watermarkType="0",l.fix=!1,l.interval=5e3,l.randomPositionTask=0,l.textWatermarkBoundingWidth=0,l.textWatermarkBoundingHeight=0,l.pointArr=[],l.store=o.store,l.erasable=!1,l.user=i.userId,l.width=i.width,l.height=i.height,l.time=i.time||Wt.getTimeStamp(),l.x=i.x||0,l.y=i.y||0,l.belongSeq=i.belongSeq,l.boardWidth=i.boardWidth,l.boardHeight=i.boardHeight,l.deg=i.deg||0,l.opacity=null!==(n=i.opacity)&&void 0!==n?n:1,l.show=null===(a=i.show)||void 0===a||a,l.visible=null===(s=i.visible)||void 0===s||s,l.ratio=i.ratio||M.RATIO,l.fix=i.fix||!1,l.interval=Math.max(1e3,Math.min(i.interval||5e3,1e4)),l.textSize=i.textSize||e.Default_FontSize,l.color=i.color||"#777777",l.lockElement=i.lockElement,l.content=i.content,l.watermarkType=e.getWatermarkType(l._content,l.fix),l._updateRectArea(),l.initEvent(),l}return ic(e,t),e.prototype.initEvent=function(){var t=this;this.event.on(tt.TIW_USERINFO_CHANGE,(function(e,r){t.content.includes("${nickname}")&&t.identifier===e&&t.formatContent()}))},e.prototype.getBoardId=function(){return this.boardId},e.prototype._createSvg=function(){var t='<text x="50%" y="50%" text-anchor="middle" dominant-baseline="middle">\n        '.concat(this._text,"\n      </text>"),r=e.measureTextSize(this._text,this.textSize),i=1;gt()&&(i=window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||1);var o=r[0]+120/i,n=r[1]+200/i,a=o*Math.abs(Math.cos(this.deg*Math.PI/180))+n*Math.abs(Math.sin(this.deg*Math.PI/180)),s=n*Math.abs(Math.cos(this.deg*Math.PI/180))+o*Math.abs(Math.sin(this.deg*Math.PI/180));return this.textWatermarkBoundingWidth=a,this.textWatermarkBoundingHeight=s,'<svg\n          width="'.concat(a,'px"\n          height="').concat(s,'px"\n          xmlns="http://www.w3.org/2000/svg"\n          xmlns:xlink="http://www.w3.org/1999/xlink">\n            <g style="font-family: customFontFamily; font-size: ').concat(this.textSize,"px;fill: ").concat(this.color,";transform:rotate(").concat(this.deg,'deg);transform-origin:center;">\n            ').concat(t,"\n            </g>\n       </svg>")},e.prototype.renderTo=function(t,e){var r=this;if("0"!==this.watermarkType&&this.isElementDisplay()){if(this.rendered)this._renderWatermark(e);else{var i="tiw-element__watermark__".concat(this.belongSeq),o=t.querySelector("#".concat(i));if(o&&o.remove(),this._el=document.createElement("div"),this._el.id=i,this._el.className="tiw-element__watermark",this.watermarkType===Nl.Image){var n=this._url;this.renderChecker=new sn({domainMap:this.store.getDomainMap(),accessibleDomains:this.store.getAccessibleDomains()}),this.renderChecker.runImage(n,5e3,(function(t){r.renderChecker=null,t&&(r.store.addAccessibleDomain(t),r._url=t),r._el.style.backgroundImage="url(".concat(r._url,")")}))}else this._el.classList.add("tiw-element__watermark-text"),this._el.style.backgroundImage="url(data:image/svg+xml;base64,".concat(window.btoa(unescape(encodeURIComponent(this._createSvg())))),this.fix?this._el.classList.add("fix_text"):this._dynamicPosition();t.appendChild(this._el),this._renderWatermark(e)}this.rendered=!0}else this.remove()},e.prototype._renderWatermark=function(t){this._renderImageWatermark(t),this._renderTextWatermark(t),this._el.style.opacity=this._opacity+"",this._el.style.color=this.color,this._el.style.fontSize=this.textSize+"px"},e.prototype._renderImageWatermark=function(t){if(this.watermarkType===Nl.Image){if(this.ratio!=t){var e=this.ratio.split(":"),r=t.split(":"),i=Number(e[0]).valueOf()/Number(e[1]).valueOf(),o=Number(r[0]).valueOf()/Number(r[1]).valueOf();this.height=this.height/(i/o),this.ratio=t,this._updateRectArea()}this.left=this.x*this.boardWidth/1e4,this.top=this.y*this.boardHeight/1e4;var n=this.width*this.boardWidth/1e4,a=this.height*this.boardHeight/1e4;this._el.style.left="".concat(this.left,"px"),this._el.style.top="".concat(this.top,"px"),this._el.style.width="".concat(n,"px"),this._el.style.height="".concat(a,"px"),this._el.style.backgroundRepeat="no-repeat",this._el.style.transform="rotate(".concat(this.deg,"deg)")}},e.prototype._renderTextWatermark=function(t){this.watermarkType!==Nl.Text&&this.watermarkType!==Nl.TextFix||(this.left=this.x*this.boardWidth/1e4,this.top=this.y*this.boardHeight/1e4,this._el.style.width="100%",this._el.style.height="100%")},e.prototype.getReportData=function(){return{type:this.type,property:{subType:this.subType,belongSeq:this.belongSeq,boardId:this.boardId,uid:this.user,updateTime:Wt.getTimeStamp(),content:this._content,x:this.x,y:this.y,width:this.width,height:this.height,deg:this.deg,textSize:this.textSize,color:this.color,opacity:this._opacity,hidden:Number(!this.show),visible:+this.visible,ratio:this.ratio,fix:this.fix,interval:this.interval,lockElement:this.lockElement}}},e.prototype.getRealTimeData=function(){return{action:M.PROTOCOL_ACTION.WATERMARK_ACTION,seq:this.seqUtil.getSeq(),belongSeq:this.belongSeq,x:this.x,y:this.y,width:this.width,height:this.height,content:this._content,deg:this.deg,opacity:this._opacity,color:this.color,textSize:this.textSize,show:this.show,visible:this.visible,ratio:this.ratio,fix:this.fix,interval:this.interval,lockElement:this.lockElement}},e.prototype.getElementOperatorReportData=function(){return{uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,updateTime:Wt.getTimeStamp(),updateContent:{content:this.content,textSize:this.textSize,color:this.color,opacity:this._opacity,lockElement:this.lockElement}}},e.prototype.getImageSize=function(t,e,r){var i=this;if(!this.initChecker)if(this._url){if(t&&e)return this.width=t,this.height=e,this._updateRectArea(),void(r&&r());var o=new Image;o.onload=function(t){o.onload=null;var e=o.naturalWidth,n=o.naturalHeight;i.width=1e4*e/i.boardWidth,i.height=1e4*n/i.boardHeight,i._updateRectArea(),r&&r()};var n=this._url;this.initChecker=new sn({domainMap:this.store.getDomainMap(),accessibleDomains:this.store.getAccessibleDomains()}),this.initChecker.runImage(n,5e3,(function(t){i.initChecker=null,t?i.store.addAccessibleDomain(t):t=n,o.src=t}))}else r&&r()},e.prototype.remove=function(){this.rendered=!1,this.initChecker&&this.initChecker.cancelChecker(),this.initChecker=null,this.renderChecker&&this.renderChecker.cancelChecker(),this.renderChecker=null,clearInterval(this.randomPositionTask),this.randomPositionTask=0,this._el&&this._el.remove()},e.prototype.getReportDataForHistory=function(t){var e=this.getReportData();return t?e:{type:e.type,seq:this.seqUtil.getSeq(),content:JSON.stringify(e.property)}},e.prototype._dynamicPosition=function(){var t=this;clearInterval(this.randomPositionTask),this.randomPositionTask=window.setInterval((function(){var e=Math.ceil(Math.random()*(t.boardWidth-t.textWatermarkBoundingWidth)),r=Math.ceil(Math.random()*(t.boardHeight-t.textWatermarkBoundingHeight));t._el.style.backgroundPosition="".concat(e,"px ").concat(r,"px")}),this.interval)},e.prototype.formatContent=function(){if(this._content.startsWith("http://")||this._content.startsWith("https://"))this._url=this._content;else{var t=this.store.getUserInfo(this.identifier,"nickname")||"";this._text=0==(e=this._content.replace("${userId}",this.identifier).replace("${nickname}",t).substring(0,20)).length?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&#39;").replace(/\"/g,"&quot;").replace(/\n/g,"<br/>")}var e;this._el&&(this._el.style.backgroundImage="url(data:image/svg+xml;base64,".concat(window.btoa(unescape(encodeURIComponent(this._createSvg())))))},Object.defineProperty(e.prototype,"content",{get:function(){return this._content},set:function(t){this._content=String(t).valueOf(),this.formatContent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(t){t=Math.min(1,Math.max(t,.1)),this._opacity=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t,this._el&&(this._el.style.backgroundImage="url(data:image/svg+xml;base64,".concat(window.btoa(unescape(encodeURIComponent(this._createSvg())))))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textSize",{get:function(){return this._textSize},set:function(t){this._textSize=t,this._el&&(this._el.style.backgroundImage="url(data:image/svg+xml;base64,".concat(window.btoa(unescape(encodeURIComponent(this._createSvg())))))},enumerable:!1,configurable:!0}),e.measureTextSize=function(t,e){var r=document.querySelector('[data-font="customFontFamily"]');return r&&(r.style.fontSize=e+"px",r.style.lineHeight=e+"px",r.innerHTML=t),[r.clientWidth,r.clientHeight]},e.getWatermarkType=function(t,e){return(t=String(t).valueOf()).startsWith("http://")||t.startsWith("https://")?Nl.Image:e?Nl.TextFix:Nl.Text},e.Default_FontSize=16,e}(ra),nc=function(t,e){return"string"==typeof t&&t.endsWith("px")?parseInt(t):Math.round(Number(t).valueOf()*e/1e4)},ac=function(t,e){return"string"==typeof t&&t.endsWith("px")?Math.round(1e4*parseInt(t)/e):Number(t).valueOf()};!function(t){t[t.CLEAR=0]="CLEAR",t[t.KEYBOARD=1]="KEYBOARD"}(ec||(ec={}));var sc={SUCCESS:0,PARSE_DATA_ERROR:1},lc={TEDU_BOARD_POSITION_CHANGE_START:0,TEDU_BOARD_POSITION_CHANGING:1,TEDU_BOARD_POSITION_CHANGE_END:2},cc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),hc=function(){return(hc=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},uc=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function a(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},dc=function(t,e){var r,i,o,n,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},pc=function(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(r[i[o]]=t[i[o]])}return r},fc=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},gc=function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},mc=function(t){function e(e,r){var i,o=t.call(this,e)||this;return o.renderHandler=new us,o.maxSeq=0,o.maxAddTextSeq=0,o.maxAddTextSeqMap={},o.maxMoveSeq=0,o.maxVideoSeq=0,o.maxImageElementSeq=0,o.maxWatermarkElementSeq=0,o.maxGraffitiMoveSeq=0,o.maxGraffitiAttrUpdateSeq=0,o.maxH5webElementSeq=new Map,o.maxCustomGraphElementSeq=0,o.maxBoardRemarkSeq=0,o.maxMagicLineElementSeq=0,o.maxJxgBoardElementSeq=0,o.maxFormulaElementSeq=0,o.maxDiscussionGroupActionSeq=0,o.graphStartPoint={},o.graphEndPoint={},o.graphSyncTimer={},o.needGraphSync={},o.styleSynced={},o.isDrawing=!1,o.maxUserInfoSeqMap={},o.maxGraphElementSeq={},o.maxHistoryGroupSeq=0,o.customGraphData={url:"",userData:"",erasable:!0},o.nextInputObj={text:"",keepFocus:!0},o.selectModel=new cs({startx:0,starty:0,x:0,y:0,user:"",color:Ss.select.border.color}),o.selectView=new Yn(o.selectModel),o.seqFilter={},o.laserDataMap={},o.graphDataMap={},o.permissions=0,o.accessibleUsers={},o.isLocalSetUserInfo=!1,o.isUserInfoChangeNeedRealtime=!1,o.isUserInfoChangeNeedReport=!1,o.userInfoMap={},o.initTypeConstant=-1,o.beforeToolType=o.initTypeConstant,o.progressEnable=M.PROGRESS_ENABLE,o.manualRemoveBoard={},o.tiwData=new Gl,o.pptFilePreloaded={},o.dragDataList=new Zn,o.scale=M.SCALE,o.ratio=M.RATIO,o.containerScale=1,o.currentGroup="",o.currentBoard="",o.boardList=[],o.groups=[],o.enableHandwriting=!1,o.remoteCursorVisible={drawing:!0,moving:!0},o.color="",o.thin=0,o.lineTransparent=!1,o.typeFaceMap={},o.typeFace=M.TEXT_FONT_FAMILY,o.textSize=0,o.textColor="",o.fontStyle=Jn.TEDU_BOARD_TEXT_STYLE_NORMAL,o.dataSyncEnable=!1,o.preloadDepth=0,o.highlighterColor="",o.lineStyle={lineType:mn.TEDU_BOARD_LINE_TYPE_SOLID,startArrowType:At.TEDU_BOARD_ARROW_TYPE_NONE,endArrowType:At.TEDU_BOARD_ARROW_TYPE_NONE,fillType:Qa.NONE},o.ovalDrawMode=Qn.TEDU_BOARD_OVAL_DRAW_MODE_FIX_START,o.ovalCenterPoint={},o.lineFitMode=xs.NONE,o.enableLineAutoFit=!1,o.autoLineFitDelay=0,o.transparent=!1,o.eraseLayerLimit=0,o.eraseLayerCount=0,o.eraseLayerTypeArr=[],o.seq=0,o.remoteSelectedListMap={},o.selectedList=[],o.selectArea={x:0,y:0,width:0,height:0},o.gSeq=0,o.boardIdSeq=0,o.realTimeData=[],o.reportAckDatas={},o.sendAckDatas={},o.needDrawLaserSeq={},o.beforeMoveType="",o.containerWidth=0,o.containerHeight=0,o.boardWidth=0,o.boardHeight=0,o.boardContentFitMode=0,o.imageTimeout=M.IMAGE_TIMEOUT,o.faceData=[],o.textInputTask=0,o.lastInputActionData=null,o.drawRaserTask=null,o.sendInterval=0,o.fileMessageCosInfo={bucket:"",appid:0,region:""},o.checkLoseLineTask=new ln,o.seqLineMap={},o.textAreaComponentMap={},o.systemCursorEnable=!1,o.toolTypePenTitleStyle={title:"",style:{}},o.toolTypeTitleStyleMap={},o.domainMap={},o.priorityDomainMap={},o.accessibleDomains={},o.SYNC_FPS=5,o.autoHideRemoteCursorTimer={},o.autoHideRemoteCursorSeqMap={},o.offlineWarningCount=0,o.boardRemarkMap={},o.currentMathGraphType=0,o.mathGraphElementQue=[],o.discussionGroupMap=new Il(o.seqUtil),o.lastActiveGroupInHistoryData="",o.groupCurrentBoard="",o.discussionGroupCurrentGroup="",o.piecewiseErasureSize=16,o.sendLaserCmd={},o.isSyncAudioStatus=!0,o.remoteUserTitleStyle={},o.isSendedLaserTitleStyleData=!1,o.drawingButNotReportData={},o.scrollDistance={offsetX:0,offsetY:0,left:0,top:0},o.eraserClipData=new Map,o.splitLineData=new Map,o.eraserMode=0,o.imageElementMapData={},o.customGraphMapData={},o.licenseVersion=0,o.prevFireSelectedElementIds=[],o.mathToolMap=new Map,o.stashTempElementData=new Map,o.notActiveBoardsDataFlagMap={},o.needDraw=!1,o.increasingDraw=!1,o.partDraw=!1,o.laserDraw=!1,o.showGraffiti=!0,o.mathToolLockReleaseTimer={},o.h5pptOperator=new Map,o.eraserLockedEventMap=new Map,o.textLineHeight=1,o.initFont=function(t,e){var r=this;if(!t)return this.setNeedDraw(!0),void e();this.request.requestFont(t).then((function(){r.setNeedDraw(!0),e()})).catch((function(){r.setNeedDraw(!0),e()}))},o.setHighlighterColor=function(t){void 0===t&&(t=M.COLOR.RED),this.logger.reportInfo(this.loggerModuleName,"setHighlighterColor",{param:{color:t}},ea.ONLY_ONLINE),this.cancelSelect();var e=W(t),r=e.replace(/[^,.\d]/g,"").split(",");if(4===r.length){var i=Number(r[3]).valueOf();(i>.9||i<.1)&&(i=.5),this.highlighterColor=W("rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", ").concat(i,")"))}else this.highlighterColor=e},o.reportElement=function(t){this.report.reportElement(t)},o.addSendAckData=function(t,e){if(void 0===e&&(e=!0),this.dataSyncEnable){try{t=JSON.parse(t)}catch(t){}t.value.actions=t.value.actions.filter((function(t){return 6!=t.action})),this.sendAckDatas[t.seq]?delete this.sendAckDatas[t.seq]:e||(this.sendAckDatas[t.seq]=t)}},o.addDiscussionGroup=function(t,e,r,i,o,n){void 0===i&&(i=""),void 0===o&&(o=""),void 0===n&&(n=!0);var a=this.discussionGroupMap.getGroupInfoByGroupId(t);if(!a||o&&e.includes(o)||(o=a.getCurrentBoard()),this.discussionGroupMap.addGroup(t,e,r,i,o),r.includes(this.identifier)&&(this.groupCurrentBoard=this.discussionGroupMap.getGroupInfoByGroupId(t).getCurrentBoard(),this.discussionGroupCurrentGroup=Ot(this.groupCurrentBoard),this.setNeedDraw(!0)),n){var s=this.discussionGroupMap.getGroupInfoByGroupId(t).getData();this.addRealtimeData({action:M.PROTOCOL_ACTION.DISCUSSION_GROUP_SETTING_ACTION,seq:this.seqUtil.getSeq(),content:{enable:this.settingConfig.isDiscussionGroupMode,type:Al.UPDATE,groupInfo:s}}),this.report.reportSetDiscussionGroup([s])}this.event.fireClassGroupStatusChangedEvent({enable:this.settingConfig.isDiscussionGroupMode,classGroupId:t,operationType:Al.UPDATE,message:""})},o.setDiscussionGroupTitle=function(t,e,r){if(void 0===r&&(r=!0),this.discussionGroupMap.setGroupTitle(t,e),r){var i=this.discussionGroupMap.getGroupInfoByGroupId(t).getData();this.addRealtimeData({action:M.PROTOCOL_ACTION.DISCUSSION_GROUP_SETTING_ACTION,seq:this.seqUtil.getSeq(),content:{enable:this.settingConfig.isDiscussionGroupMode,type:Al.UPDATE,groupInfo:i}}),this.report.reportSetDiscussionGroup([i])}this.event.fireClassGroupStatusChangedEvent({enable:this.settingConfig.isDiscussionGroupMode,classGroupId:t,operationType:Al.UPDATE,message:""})},o.resetDiscussionGroup=function(t){void 0===t&&(t=!0),this.discussionGroupMap.reset(),this.groupCurrentBoard="",this.discussionGroupCurrentGroup=this.currentGroup,this.setNeedDraw(!0),t&&(this.addRealtimeData({action:M.PROTOCOL_ACTION.DISCUSSION_GROUP_SETTING_ACTION,seq:this.seqUtil.getSeq(),content:{enable:this.settingConfig.isDiscussionGroupMode,type:Al.RESET,groupInfo:null}}),this.report.reportResetDiscussionGroup()),this.event.fireClassGroupStatusChangedEvent({enable:this.settingConfig.isDiscussionGroupMode,classGroupId:"",operationType:Al.RESET,message:""})},o.removeDiscussionGroup=function(t,e){if(void 0===e&&(e=!0),this.discussionGroupMap.hasGroup(t)){var r=this.discussionGroupMap.getGroupInfoByGroupId(t).getData();this.discussionGroupMap.checkIfUserInGroup(t,this.identifier)&&(this.groupCurrentBoard="",this.discussionGroupCurrentGroup=this.currentGroup,this.setNeedDraw(!0)),this.discussionGroupMap.deleteGroup(t),e&&(this.addRealtimeData({action:M.PROTOCOL_ACTION.DISCUSSION_GROUP_SETTING_ACTION,seq:this.seqUtil.getSeq(),content:{enable:this.settingConfig.isDiscussionGroupMode,type:Al.DELETE,groupInfo:r}}),this.report.reportDeleteDiscussionGroup(t)),this.event.fireClassGroupStatusChangedEvent({enable:this.settingConfig.isDiscussionGroupMode,classGroupId:t,operationType:Al.DELETE,message:""})}},o.getDiscussionGroupInfoById=function(t){return this.discussionGroupMap.getGroupInfoByGroupId(t)},o.getDiscussionGroupIdByUserId=function(t){return this.discussionGroupMap.getGroupIdByUserId(t)},o.checkIfUserInDiscussionGroup=function(t,e){return this.discussionGroupMap.checkIfUserInGroup(t,e)},o.removeUserInDiscussionGroup=function(t,e){var r=this.getDiscussionGroupInfoById(t);if(r){r.removeUser(e);var i=r.getData();this.addDiscussionGroup(t,i.boardIds,i.userIds,i.title,i.currentBoardId)}},o.checkIfInDiscussionGroupAndDiscussionGroupEnable=function(){return!!this.settingConfig.isDiscussionGroupMode&&!!this.getDiscussionGroupIdByUserId(this.identifier).length},o._setLaserVisibleInDiscussionModeEnable=function(t,e,r){return void 0===e&&(e="drawing"),void 0===r&&(r=1),M.PROTOCOL_ACTION.RASER_SHOW_ACTION,this.settingConfig.isDiscussionGroupMode?this.discussionGroupMap.checkIfUserInSameGroup([this.identifier,t])&&(r!==Xa.TEDU_BOARD_TOOL_TYPE_PEN||this.remoteCursorVisible[e])?M.PROTOCOL_ACTION.RASER_SHOW_ACTION:M.PROTOCOL_ACTION.RASER_HIDE_ACTION:r!==Xa.TEDU_BOARD_TOOL_TYPE_PEN||this.remoteCursorVisible[e]?M.PROTOCOL_ACTION.RASER_SHOW_ACTION:M.PROTOCOL_ACTION.RASER_HIDE_ACTION},o.getAllDiscussionGroupIds=function(){return this.discussionGroupMap.getAllGroupId()},o.options=JSON.parse(JSON.stringify(r)),o.renderHandler.addToRenderMap("select",o.selectView),o.request=new tc(e,r),o.report=new Yl(e,o.request),o.report.setCallback((function(t,e){e||o.addReportAckData(t)})),o.report.setPreCallback((function(t){o.addReportAckData(t,!1)})),F(r.syncHistroyEnable)||U(r.syncHistroyEnable)?o.syncHistroyEnable=!0:o.syncHistroyEnable=r.syncHistroyEnable,o.userInfo=new C(new ys(o.seqUtil,o.identifier,{}),{set:function(t,e,r){return(r||t[e])&&(o.isUserInfoChangeNeedRealtime=!0,o.isUserInfoChangeNeedReport=!0),Reflect.set(t,e,r)}}),o.userInfoMap=((i={})[o.identifier]=o.userInfo,i),o.scale=o.options.config.scale||M.SCALE,o.containerScale=o.options.config.containerScale||1,o.ratio=o.options.config.ratio||M.RATIO,o.settingConfig.setBoardRatio("default",o.ratio),o.downGradeH5PPtMap=new Map,o.downGradeElementMap=new Map,o.downGradePageIndexMap=[],o.setGlobalBackgroundColor(o.options.styleConfig.globalBackgroundColor||W(M.COLOR.WHITE),!0),o.heartbeat=new Kl(e,{newEnterId:o.options.newEnterId,request:o.request}),o.systemCursorEnable=o.options.authConfig.systemCursorEnable||!1,o.applyPermissions(),o.initInterval(),o.eraserClipData.set(o.identifier,{clipIndex:0,clipData:[]}),o.event.on(tt.TEB_GOTOBOARD,(function(t){o.formatLinePoints(t)})),o.reportDragThrottle=$t((function(t){o.report.reportDrag(t)}),500,!0),o}return cc(e,t),e.prototype.setH5PPTOperator=function(t,e,r,i){var o="".concat(t,"_").concat(e,"_").concat(r),n=this.h5pptOperator.get(o);void 0===n&&(n=[]),n.push(i),this.h5pptOperator.set(o,n)},e.prototype.getH5PPTOperator=function(t,e,r){var i="".concat(t,"_").concat(e,"_").concat(r),o=this.h5pptOperator.get(i);return o&&0!==o.length?o[0]:""},e.prototype.deleteH5PPTOperator=function(t,e,r){var i="".concat(t,"_").concat(e,"_").concat(r),o=this.h5pptOperator.get(i);o&&(o.shift(),this.h5pptOperator.set(i,o),0===o.length&&this.h5pptOperator.delete(i))},e.prototype.applyPermissions=function(){return uc(this,void 0,void 0,(function(){var t,e,r,i,o,n,a,s,l,c,h,u,d=this;return dc(this,(function(p){switch(p.label){case 0:this.logger.reportInfo(this.loggerModuleName,"applyPermissions",{param:{}},ea.ONLY_NATIVE),t=Wt.getTimeStamp(),e=0,r="",i="",o={code:0,message:""},n=function(t,n,a,s){e=t,r=n,i=a,o=s},p.label=1;case 1:return p.trys.push([1,3,,4]),a=void 0,[4,this.request.applyPermissions()];case 2:if(0===(null===(a=p.sent())||void 0===a?void 0:a.data.error_code)){if(t=a.config&&a.config.startTime||t,s=Wt.getTimeStamp(),a.data.level)return l=Math.floor((s-t)/2),Wt.adjustLocalTime(a.data.server_time,l),this.cosData={appid:a.data.cos_appid,bucket:a.data.cos_bucket},this.fileMessageCosInfo.bucket=a.data.file_message.bucket,this.fileMessageCosInfo.appid=a.data.file_message.appid,this.fileMessageCosInfo.region=a.data.file_message.region,this.fileCos=new Xl(this.instanceKey,Object.assign({sdkAppId:this.options.sdkAppId},this.options.cosData,this.cosData),this.request),this.permissions=a.data.level,this.request.setPermissions(!!this.permissions),L.isPrivateEnv()&&(this.licenseVersion=Number(a.data.version.replace(/^.{3}(\d).{3}(\d).{3}(\d).{3}(\d)$/,"$1$2$3$4")).valueOf()),this.setDefaultBoard(),this.initData(this.options),c=s-t,this.logger.reportInfo(this.loggerModuleName,"verify_sdk",{cost:c,param:{extraInfo:JSON.stringify({permissions:this.permissions,server_time:a.data.server_time,startTime:t,endTime:s})}},ea.ONLY_ONLINE),this.syncHistroyEnable&&this.classId?this.syncHistoryData():!this.syncHistroyEnable&&this.classId&&setTimeout((function(){d.event.fireHistoryDataSyncCompletedEvent()}),200),this.event.fireTiwInitEvent(),this.heartbeat.start(),this.setNeedDraw(!0),[2];n(a.data.error_code,JSON.stringify(a.data),"",{code:Xt.TEDU_BOARD_ERROR_AUTH,message:"please purchase the service first"})}else 34001===a.data.error_code?n(a.data.error_code,JSON.stringify(a.data),"",{code:Xt.TEDU_BOARD_ERROR_AUTH,message:a.data.error_msg}):void 0!==a.data.error_code&&0!=a.data.error_code?n(a.data.error_code,JSON.stringify(a.data),a.data.error_msg,{code:Xt.TEDU_BOARD_ERROR_RUNTIME,message:a.data.error_msg}):void 0!==a.data.ErrorCode?n(a.data.ErrorCode,JSON.stringify(a.data),"",60008===a.data.ErrorCode?{code:Xt.TEDU_BOARD_ERROR_AUTH_TIMEOUT,message:"the request has timed out. please try again"}:{code:Xt.TEDU_BOARD_ERROR_RUNTIME,message:"ErrorCode:".concat(a.data.ErrorCode,",ErrorInfo:").concat(a.data.ErrorInfo)}):n(-9999,JSON.stringify(a.data),"",{code:Xt.TEDU_BOARD_ERROR_RUNTIME,message:"server error"});return[3,4];case 3:return h=p.sent(),u="error.stack:".concat(h.stack,";error.message:").concat(h.message),n(-9998,u,"",{code:Xt.TEDU_BOARD_ERROR_AUTH_TIMEOUT,message:"the request has timed out. please try again"}),[3,4];case 4:return this.permissions=0,this.request.setPermissions(!!this.permissions),this.logger.reportInfo(this.loggerModuleName,"verify_sdk",{code:e,message:r,cost:Wt.getTimeStamp()-t,param:{extraInfo:JSON.stringify({permissions:this.permissions,message:i})}},ea.ONLY_ONLINE),this.event.fireErrorEvent(o.code,o.message),[2]}}))}))},e.prototype.setVisible=function(t){this.heartbeat.setVisible(t)},e.prototype.createBoardIdForFile=function(t,e,r,i,o,n){for(var a=1,s=[],l=0;l<i;l++){var c;c=n===M.FILE_TYPE.VOD?"".concat(o,"_").concat(e,"_").concat(Math.floor(Number(t.replace("#","")).valueOf()/1e3),"_").concat(a++,"_").concat(t):"".concat(o,"_").concat(e,"_").concat(r,"_").concat(a++,"_").concat(t),s.push(c)}return s},e.prototype.createBoardId=function(t,e){return void 0===t&&(t=this.currentGroup),void 0===e&&(e=Wt.getSecondTime()),this.logger.reportInfo(this.loggerModuleName,"createBoardId",{param:{}},ea.ONLY_NATIVE),0===this.boardIdSeq?(this.boardIdSeq++,M.COMMON_DEFAULT_BOARD):"".concat(i.PLATFORM,"_").concat(this.identifier,"_").concat(e,"_").concat(this.boardIdSeq++,"_").concat(t)},e.prototype.initInterval=function(){var t=this;this.sendInterval=window.setInterval((function(){t.realTimeData.length>0&&t.sendRequest()}),1e3/this.SYNC_FPS)},e.prototype.resetData=function(){this.logger.reportInfo(this.loggerModuleName,"resetData",{param:{}},ea.ONLY_NATIVE),this.tiwData.reset(),this.currentGroup="",this.currentBoard="",this.boardList=[],this.groups=[],this.groupCurrentBoard="",this.discussionGroupMap.reset(),this.discussionGroupCurrentGroup="",this.seq=0,this.maxSeq=0,this.maxAddTextSeq=0,this.maxAddTextSeqMap={},this.maxMoveSeq=0,this.maxVideoSeq=0,this.maxImageElementSeq=0,this.maxWatermarkElementSeq=0,this.maxGraffitiMoveSeq=0,this.maxH5webElementSeq=new Map,this.maxCustomGraphElementSeq=0,this.maxBoardRemarkSeq=0,this.maxMagicLineElementSeq=0,this.maxJxgBoardElementSeq=0,this.maxFormulaElementSeq=0,this.maxDiscussionGroupActionSeq=0,this.maxHistoryGroupSeq=0,this.seqFilter={},this.selectedList=[],this.selectArea={x:0,y:0,width:0,height:0},this.gSeq=0,this.boardIdSeq=0,this.realTimeData=[],this.beforeMoveType="",this.mathToolMap.clear(),this.dragDataList.resetDragData(),this.settingConfig.clearBoardRatio(),this.setGlobalBackgroundPic("",Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,M.BACKGROUND_TYPE.IMAGE,!0),this.setDefaultBoard(),this.notActiveBoardsDataFlagMap={}},e.prototype.initData=function(t){var e=this,r=t.config,i=t.styleConfig,o=t.authConfig;this.setDrawEnable(o.drawEnable),this.setProgressEnable(o.progressEnable),this.setColor(i.brushColor),this.setHighlighterColor(i.highlighterColor),this.setThin(i.brushThin),this.setTextFontFamily(i.textFamily),this.setTextSize(i.textSize),this.setTextColor(i.textColor),this.setTextLineHeight(),this.setTextFontStyle(i.textStyle),this.setDataSyncEnable(o.dataSyncEnable),this.setPreloadDepth(r.preloadDepth),this.setBoardContentFitMode(r.boardContentFitMode),this.setImageTimeout(r.imageTimeout||M.IMAGE_TIMEOUT),this.setSystemCursorEnable(o.systemCursorEnable||!1),this.setType(r.toolType),this.setGlobalBackgroundColor(i.globalBackgroundColor,!0);var n=i.globalBackgroundPic;this.setGlobalBackgroundPic(n.url,n.mode,n.type,!0),this.setSelectArea(),this.event.on("add_math_graph",this.addMathGraph.bind(this)),setTimeout((function(){e.fireCanRedoAndUndo()}),500)},e.prototype.addBoardInfo=function(t,e,r){if(this.tiwData.initData(t,this.identifier,{}),-1===this.boardList.indexOf(t))if(t.includes("#DEFAULT")){var i=this.boardList.filter((function(t){return t.includes("#DEFAULT")})),o=this.boardList.filter((function(t){return!t.includes("#DEFAULT")}));if(e>=0?i.splice(e,0,t):i.push(t),this.boardList=o.concat(i),r){var n=this.getFileInfo();n.boardSequenceList=i,this.updateFileInfo(n)}}else this.boardList.push(t)},e.prototype.addBoard=function(t,e,r,i,o){var n=this;if(void 0===i&&(i=-1),void 0===o&&(o=!1),t){var a=[],s={};return a=Array.isArray(t)?t:[t],e&&this.report.reportCreateBoards(this.getCurrentBoard(),a).then((function(t){}),(function(t){try{39005===JSON.parse(t)[0].code&&n.event.fireErrorEvent(Xt.TEDU_BOARD_MAX_BOARD_LIMITED,"The number of whiteboards exceeds the limit!")}catch(t){}n.deleteBoard(a,"",r)})),a.forEach((function(t){n.addBoardInfo(t,i,o),function(t,e){var r=Ot(t);s[r]||(s[r]=[]),e>=0?s[r].splice(e,0,t):s[r].push(t)}(t,i)})),function(){for(var t in s){var e=n.getFileInfo(t);e&&(e.pageCount=n.getBoardInfoList(t).length),n.event.fireAddBoardEvent(s[t],t)}}(),this.sortBoard(),this.boardList}},e.prototype.findLine=function(t,e,r){var i,o=this.tiwData.getElementsByUserId(t,e);if(o)for(var n=o.length-1;n>=0;n--){var a=o[n];if("line"===a.type&&a.seq===r){i=a;break}}return i},e.prototype.findGraph=function(t,e,r){var i=this.tiwData.getElementsByUserId(t,e),o=null;if(i)for(var n=0,a=i.length;n<a;n++){var s=i[n];if("graph"===s.type&&s.startPoint.seq===r.beginPoint.seq){o=s;break}}return o},e.prototype.setNeedDraw=function(t){void 0===t&&(t=!0),this.needDraw!=t&&(this.needDraw=t)},e.prototype.getNeedDraw=function(){return this.needDraw},e.prototype.setIncreasingDraw=function(t){void 0===t&&(t=!0),this.increasingDraw!=t&&(this.increasingDraw=t)},e.prototype.getIncreasingDraw=function(){return this.increasingDraw},e.prototype.setPartDraw=function(t){void 0===t&&(t=!0),this.partDraw!=t&&(this.partDraw=t)},e.prototype.getPartDraw=function(){return this.partDraw},e.prototype.setLaserDraw=function(t){void 0===t&&(t=!0),this.laserDraw!=t&&(this.laserDraw=t)},e.prototype.getLaserDraw=function(){return this.laserDraw},e.prototype.getBoardList=function(){return this.boardList},e.prototype.setDefaultBoard=function(){this.logger.reportInfo(this.loggerModuleName,"setDefaultBoard",{param:{}},ea.ONLY_NATIVE);var t=Wt.getSecondTime();this.addGroup(M.COMMON_GROUP,M.COMMON_GROUP,this.identifier,"",1,0,t,i.PLATFORM,M.FILE_TYPE.IMG,0,this.ratio),this.currentBoard=this.createBoardId(M.COMMON_GROUP),this.groupCurrentBoard=this.currentBoard,this.currentGroup=Ot(this.getCurrentBoard()),this.discussionGroupCurrentGroup=this.currentGroup,this.addBoard(this.getCurrentBoard(),!1,this.identifier),this.setGlobalBackgroundColor(this.options.styleConfig.globalBackgroundColor,!0);var e=this.getGlobalBackgroundColor();this.setBackgroundColor(e,!0)},e.prototype.deleteBoardInfo=function(t){this.tiwData.removeElementsByBoardId(t,!1),this.tiwData.removeOperations(t),this.tiwData.removeBackground(t)},e.prototype.removeBoard=function(t,e){var r=this;this.logger.reportInfo(this.loggerModuleName,"removeBoard",{param:{boardIds:t}},ea.ONLY_NATIVE),Array.isArray(t)||(t=[t]);for(var i,o,n=[],a=[],s=!1,l={},c=0,h=function(t){var e=r.getBoardByGroup(r.getCurrentFile()),i=e.indexOf(t);if(r.currentBoard=0===i?e[i+1]:e[i-1],!r.getCurrentBoard()){var o=r.getBoardByGroup(M.COMMON_GROUP);r.currentBoard=o[r.getFileInfo(M.COMMON_GROUP).currentPageIndex]}},u=function(t){var e=Ot(t),i=r.getBoardByGroup(e),o=r.getFileInfo(e);0===i.length?o&&(r.deleteGroup(e),a.push(e)):o&&(o.pageCount=o.pageCount-1,o.pageCount===o.currentPageIndex&&(o.currentPageIndex=o.currentPageIndex-1),r.updateFileInfo(o))},d=0,p=t.length;d<p;d++){var f=t[d];f!==M.COMMON_DEFAULT_BOARD&&(c=this.boardList.indexOf(f))>-1&&(n.push(f),l[o=Ot(i=f)]||(l[o]=[]),l[o].push(i),this.deleteBoardInfo(f),f===this.getCurrentBoard()&&(s=!0,h(f)),this.boardList.splice(c,1),this.manualRemoveBoard[f]=1,u(f))}for(var g in function(t){var e,i=Ot(r.getCurrentBoard()),o=r.getBoardByGroup(i),n=r.getFileInfo(i);n&&(n.pageCount=o.length,n.currentPageIndex=o.indexOf(r.getCurrentBoard()),n.boardSequenceList=null===(e=n.boardSequenceList)||void 0===e?void 0:e.filter((function(e){return!t.includes(e)})),r.updateFileInfo(n)),r.currentGroup=Ot(r.currentBoard)}(n),l)this.event.fireDeleteBoardEvent(l[g],g);return s&&(this.event.fireGotoBoardEvent(this.getCurrentBoard(),Ot(this.getCurrentBoard()),e),this.fireCanRedoAndUndo()),this.setNeedDraw(!0),{deleteBoards:n,deleteFids:a}},e.prototype.deleteBoard=function(t,e,r){var i;if(this.logger.reportInfo(this.loggerModuleName,"deleteBoard",{param:{boardId:t,fid:e}},ea.ONLY_NATIVE),!this.settingConfig.isDiscussionGroupMode){var o=this.discussionGroupMap.getAllGroupId();if("string"!=typeof t||!this.discussionGroupMap.checkIfBoardInAnyGroup(o,t)){var n=this.removeBoard(t,r)||[],a=n.deleteBoards,s=n.deleteFids;if(a.length){var l=this.getBackgroundImage(this.getCurrentBoard());if(l){var c=l.url||"";c&&this.addRealtimeData({action:M.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:c,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),mode:l.mode,type:l.type,angle:l.angle,cleanBoard:0,isGlobal:0})}var h=[];e?s.indexOf(e)>-1?h=s:h.push(e):h=s;var u=this.getBoardByGroup(this.getCurrentFile()),d=u.indexOf(this.getCurrentBoard()),p=this.getFileInfo(this.getCurrentFile()),f=0;p&&p.currentPageIndex===d&&(f=p.currentPageStep);var g=this.seqUtil.getSeq();this.addRealtimeData({action:M.PROTOCOL_ACTION.SWITCH_ACTION,time:Wt.getTimeStamp(),seq:g,toBoardId:this.getCurrentBoard(),deleteBoards:h.length?[]:a,deleteFiles:h.length?h:[],page:d,step:f,boardSequenceList:p.boardSequenceList}),this.isDataSyncEnable()&&(this.maxSeq=g),this.sendRequest(),this.report.reportDeleteBoard(a,this.getCurrentBoard()),p.currentPageIndex=d,p.currentPageStep=f,p.pageCount=u.length,(null===(i=p.pptMediaInfo)||void 0===i?void 0:i.videoIDList)&&delete p.pptMediaInfo.videoIDList,p.pptMediaInfo&&p.pptSlideAudioMap&&(p.pptMediaInfo.audioIDList=p.pptSlideAudioMap[d]||[]),delete p.pptMediaPlaybackStatus,this.report.reportAddFile(p),this.report.reportSwitchBoard({boardId:this.getCurrentBoard(),fid:p.fid,url:p.downloadURL,type:p.type,page:p.currentPageIndex,step:p.currentPageStep,ratio:p.ratio,scale:p.scale})}return a}this.event.fireClassGroupStatusChangedEvent({enable:this.settingConfig.isDiscussionGroupMode,classGroupId:"",operationType:Al.ERROR,message:"the board to be deleted is referenced by at least one group"})}},e.prototype.getGroup=function(){return this.groups},e.prototype.getFileInfoList=function(){var t=this,e=Object.assign([],this.groups);return e.forEach((function(e){e.boardInfoList=t.getBoardInfoList(e.fid),e.fileType=t.getActualFileType(e.type,e.fid)})),e},e.prototype.getBoardInfoList=function(t){var e=this,r=this.getFileInfo(t);if(!r)return[];var i=[],o=this.getBoardByGroup(t)||[];if(o.length)o.forEach((function(t){var r=e.tiwData.getBackground(t),o=new Vn(t,r.picture,r.color);i.push(o)}));else{var n=r.platform,a=r.uid,s=r.fid,l=r.pageCount,c=r.timestamp,h=r.type,u=r.downloadURL,d="",p=this.getGlobalBackgroundColor(),f=[],g="";h===M.FILE_TYPE.IMG&&(g=u?ee(u):"");for(var m=0;m<l;m++)g&&h===M.FILE_TYPE.IMG&&(g.endsWith("/")?f.push("".concat(g).concat(m+1,".jpg")):f.push(g+(m+1)));if(u&&h===M.FILE_TYPE.IMAGESFILE){var y=ct(u);f=JSON.parse(y)}for(var v=1;v<=l;){d=f[v-1]||"";var _;_=h===M.FILE_TYPE.VOD?"".concat(n,"_").concat(a,"_").concat(Math.floor(Number(s.replace("#","")).valueOf()/1e3),"_").concat(v++,"_").concat(s):"".concat(n,"_").concat(a,"_").concat(c,"_").concat(v++,"_").concat(s);var E=new Vn(_,{url:d},p);i.push(E)}}return i},e.prototype.getFileInfo=function(t){var e;void 0===t&&(t=this.getCurrentFile());for(var r=this.getGroup(),i=0,o=r.length;i<o;i++){var n=r[i];if(t===n.fid){(e=n).fileType=this.getActualFileType(e.type,e.fid);break}}return e},e.prototype.getBoardByGroup=function(t){void 0===t&&(t=this.getCurrentFile());for(var e=this.getFileInfo(t),r=[],i="_".concat(t),o=0;o<this.boardList.length;o++){var n=this.boardList[o];if(t===M.COMMON_GROUP&&n===M.COMMON_DEFAULT_BOARD)r.push(n);else{if(t!==M.COMMON_GROUP&&e&&e.uid!=It(n))continue;n.indexOf(i)>-1&&r.push(n)}}return r},e.prototype.addGroupNotReport=function(t,e,r,o,n,a,s,l,c,h,u,d,p,f,g,m,y,v){void 0===l&&(l=i.PLATFORM),void 0===c&&(c=M.FILE_TYPE.IMG),void 0===m&&(m=!1),this.logger.reportInfo(this.loggerModuleName,"addGroupNotReport",{param:{fid:t,uid:r,pageCount:n,currentPageIndex:a,currentPageStep:h}},ea.ONLY_NATIVE);for(var _=!1,E=0,T=this.groups.length;E<T;E++)if(this.groups[E].fid===t){_=!0;break}if(_)return this.groups;var b={fid:t,title:e||t,downloadURL:o,pageCount:n,currentPageIndex:a,currentPageStep:h,uid:r,timestamp:s,platform:l,ratio:u,type:c,scale:d,status:f,progress:g,slideStepData:{},pptMediaPlaybackStatus:y,boardSequenceList:v,thumbUrls:[],h5FileEnableDraw:m};this.groups.push(b),this.settingConfig.setFileRatio(t,u),p?this.event.fireAddTranscodeFileEvent(t):c===M.FILE_TYPE.IMG?this.event.fireAddFileEvent(t):c===M.FILE_TYPE.IMAGESFILE?(this.event.fireAddImagesFileEvent(t),this.logger.reportInfo(this.loggerModuleName,"add_images_file_event_peer",{param:{extraInfo:JSON.stringify({fid:t})}},ea.ONLY_ONLINE)):this.event.fireAddH5PPTFileEvent(t)},e.prototype.addGroup=function(t,e,r,o,n,a,s,l,c,h,u,d,p,f){return void 0===o&&(o=""),void 0===l&&(l=i.PLATFORM),void 0===c&&(c=M.FILE_TYPE.IMG),void 0===u&&(u=M.RATIO),void 0===d&&(d=M.SCALE),void 0===p&&(p=!1),void 0===f&&(f=!1),uc(this,void 0,void 0,(function(){var i,g,m,y,v;return dc(this,(function(_){switch(_.label){case 0:for(this.logger.reportInfo(this.loggerModuleName,"addGroup",{param:{fid:t,uid:r,pageCount:n,currentPageIndex:a,currentPageStep:h}},ea.ONLY_NATIVE),i=!1,g=0,m=this.groups.length;g<m;g++)if(this.groups[g].fid===t){i=!0;break}if(i)return[2,this.groups];y={fid:t,title:e||t,downloadURL:o,pageCount:n,currentPageIndex:a,currentPageStep:h,uid:r,timestamp:s,platform:l,ratio:u,type:c,scale:d,isTranscodeFile:!!p,progress:0,status:0,slideStepData:{},thumbUrls:[],h5FileEnableDraw:f},_.label=1;case 1:return _.trys.push([1,4,,5]),t&&t!==M.COMMON_GROUP&&this.isDataSyncEnable()?[4,this.report.reportAddFile(y)]:[3,3];case 2:_.sent(),_.label=3;case 3:return this.groups.push(y),this.settingConfig.setFileRatio(t,u),p?this.event.fireAddTranscodeFileEvent(t):c===M.FILE_TYPE.IMG?this.event.fireAddFileEvent(t):c===M.FILE_TYPE.IMAGESFILE?(this.event.fireAddImagesFileEvent(t),this.logger.reportInfo(this.loggerModuleName,"add_images_file_event_myself",{param:{extraInfo:JSON.stringify({fid:t})}},ea.ONLY_ONLINE)):this.event.fireAddH5PPTFileEvent(t),[2,Promise.resolve()];case 4:v=_.sent();try{if(39005===JSON.parse(v)[0].code)return[2,Promise.reject("The number of whiteboards exceeds the limit!")]}catch(t){}return[2,Promise.resolve()];case 5:return[2]}}))}))},e.prototype.deleteGroup=function(t,e){if(void 0===e&&(e=!0),this.logger.reportInfo(this.loggerModuleName,"deleteGroup",{param:{groupId:t,needReport:e}},ea.ONLY_NATIVE),t===M.COMMON_GROUP)return[];for(var r=-1,i=0,o=this.groups.length;i<o;i++)if(this.groups[i].fid===t){r=i;break}return r>-1&&(this.groups.splice(r,1),jn.clearIframeCache(this.iframeDom)),e&&this.report.reportDeleteFile(t),this.getBoardByGroup(t)},e.prototype.setDrawEnable=function(t){var e=["Element::Add::*","Element::Delete::*","Element::Move::*","Element::Select::*","Element::Update::*","Element::Scale::*","Element::Rotate::*","Background::Update::*","Board::Switch::*","Board::Clear::*","File::Clear::*"];t?this.permissionHandler.setInterceptor(e,["operator/"+this.identifier]):this.permissionHandler.setInterceptor(e,["operator/"]),t||(this.cancelSelect(),this.hideLaserData()),this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"setDrawEnable",data:t})}},ea.ONLY_ONLINE),this.logger.reportInfo(this.loggerModuleName,"setDrawEnable",{param:{drawEnable:t}},ea.ONLY_NATIVE)},e.prototype.isDrawEnable=function(){var t=this,e=["Element::Add::*","Element::Delete::*","Element::Move::*","Element::Select::*","Element::Update::*","Element::Scale::*","Element::Rotate::*","Background::Update::*","Board::Switch::*","Board::Clear::*","File::Clear::*"];return this.permissionHandler.filters(e,e.map((function(){return[{operator:t.identifier}]}))).some((function(t){return t}))},e.prototype.setColor=function(t){var e=this;void 0===t&&(t=M.COLOR.RED),this.logger.reportInfo(this.loggerModuleName,"setColor",{param:{color:t}},ea.ONLY_NATIVE),this.cancelSelect(),this.color=W(t),this.mathToolMap.forEach((function(t){t.toolType===$a.COMPASSES&&t.updateBrushColor(e.color)}))},e.prototype.setRemoteCursorVisible=function(t,e){void 0===t&&(t=!0),void 0===e&&(e="drawing"),this.remoteCursorVisible[e]=t},e.prototype.getColor=function(){return this.color},e.prototype.getHighlighterColor=function(){return this.highlighterColor},e.prototype.setThin=function(t){t||(t=M.THIN),this.cancelSelect(),this.thin=Math.floor(t)},e.prototype.setLineTransparent=function(t){this.lineTransparent=t},e.prototype.getLineTransparent=function(){return this.lineTransparent},e.prototype.getThin=function(){return this.thin},e.prototype.setTextSize=function(t){t||(t=M.TEXT_SIZE),this.cancelSelect(),this.textSize=t,this.logger.reportInfo(this.loggerModuleName,"set_text_size",{param:{extraInfo:JSON.stringify({size:t})}},ea.ONLY_ONLINE)},e.prototype.getTextSize=function(){return this.textSize},e.prototype.setTextColor=function(t){t||(t=M.TEXT_COLOR),this.cancelSelect(),this.textColor=W(t)},e.prototype.getTextColor=function(){return this.textColor},e.prototype.setTextFontFamily=function(t){var e=M.TEXT_FONT_FAMILY;!t||e.includes(t)?this.typeFace=e:this.typeFace="".concat(t,",").concat(e)},e.prototype.addTextFontFamily=function(t,e){this.typeFaceMap[t]=e},e.prototype.checkTextFontFamily=function(t){return!F(this.typeFaceMap[t])},e.prototype.getTextFontFamily=function(){return this.typeFace},e.prototype.setTextFontStyle=function(t){t||(t=Jn.TEDU_BOARD_TEXT_STYLE_NORMAL),this.cancelSelect(),this.fontStyle=t},e.prototype.getTextFontStyle=function(){return this.fontStyle},e.prototype.setTextLineHeight=function(t){void 0===t&&(t=1),this.cancelSelect(),this.textLineHeight=t},e.prototype.getTextLineHeight=function(){return this.textLineHeight},e.prototype.setDataSyncEnable=function(t){void 0===t&&(t=M.DATA_SYNC_ENABLE),this.logger.reportInfo(this.loggerModuleName,"setDataSyncEnable",{param:{enable:t}},ea.ONLY_NATIVE),this.request.setReportEnable(t),this.dataSyncEnable=t,this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"setDataSyncEnable",data:t})}},ea.ONLY_ONLINE)},e.prototype.isDataSyncEnable=function(){return this.dataSyncEnable},e.prototype.setProgressEnable=function(t){void 0===t&&(t=M.PROGRESS_ENABLE),this.progressEnable=t},e.prototype.isProgressEnable=function(){return this.progressEnable},e.prototype.setPreloadDepth=function(t){void 0===t&&(t=M.PRELOAD_DEPTH),this.preloadDepth=t},e.prototype.setType=function(t){this.cancelSelect(),this.hideLaserData(),this.teduToolType.toolType=t},e.prototype.setBackgroundColor=function(t,e){void 0===t&&(t=M.COLOR.WHITE),void 0===e&&(e=!1),this.logger.reportInfo(this.loggerModuleName,"setBackgroundColor",{param:{color:t}},ea.ONLY_NATIVE);var r,i=this.getCurrentBoard();("object"==typeof t&&(i=t.boardId,t=t.color),this.tiwData.setBackgroundColor(i,W(t)),this.setNeedDraw(!0),e)||(r=Y(this.tiwData.getBackgroundColor(i)),this.addRealtimeData({action:M.PROTOCOL_ACTION.UPDATE_BG_COLOR_ACTION,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),color:r,isGlobal:0}),this.report.reportSetBoardBgColor(i,r))},e.prototype.getBackgroundColor=function(){return this.tiwData.getBackgroundColor(this.getCurrentBoard())},e.prototype.setSelectArea=function(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.selectArea={x:t,y:e,width:r,height:i}},e.prototype.getSelectArea=function(){return this.selectArea},e.prototype.getCurrentBoard=function(){return this.checkIfInDiscussionGroupAndDiscussionGroupEnable()?this.groupCurrentBoard:this.currentBoard},e.prototype.getCurrentFile=function(){return this.checkIfInDiscussionGroupAndDiscussionGroupEnable()?this.discussionGroupCurrentGroup:this.currentGroup},e.prototype.getData=function(){return this.tiwData.getAllElements()},e.prototype.getFaceData=function(){var t,e,r=this.getCurrentBoardData(),i=this.faceData.pop();if(i&&i.content&&i.content.fid){var o=i.content;if(o.type===M.FILE_TYPE.IMG){t={downloadURL:o.url,currentPageIndex:o.page,currentPageStep:o.step,type:o.type,fid:o.fid,ratio:o.ratio};var n="";o.url&&((n=ee(o.url)).endsWith("/")?n+=o.page+1+".jpg":n+=o.page+1),e={mode:0,show:!0,type:0,angle:0,url:n}}else o.type===M.FILE_TYPE.H5PPT&&(t={downloadURL:o.url,currentPageIndex:o.page,currentPageStep:o.step,type:o.type,fid:o.fid,ratio:o.ratio},e={mode:0,show:!0,type:0,angle:0,url:""})}return this.faceData=[],{fileInfo:t,backgroundColor:r.backgroundColor,currentPic:e,data:r.data}},e.prototype.getCurrentBoardData=function(){return{data:this.tiwData.getElementsByBoardId(this.getCurrentBoard()),userData:this.tiwData.getUserElementsByBoardId(this.getCurrentBoard()),opData:this.tiwData.getOperations(this.getCurrentBoard()),opIndex:this.tiwData.getOperationIndex(this.getCurrentBoard()),backgroundPic:this.getBackgroundImage(this.getCurrentBoard(),!0),backgroundColor:this.tiwData.getBackgroundColor(this.getCurrentBoard()),ratio:this.settingConfig.boardRatio[this.getCurrentBoard()],scale:this.getBoardScale(),mathToolData:this.mathToolMap}},e.prototype.getSelectList=function(){return this.selectedList},e.prototype.getRemoteSelectListMap=function(){return this.remoteSelectedListMap},e.prototype.clearRemoteSelectList=function(t){delete this.remoteSelectedListMap[t]},e.prototype.clearBoard=function(t,e,r,i){this.logger.reportInfo(this.loggerModuleName,"clearBoard",{param:{clearBackground:e,clearSelectedOnly:r,accessAllUser:i}},ea.ONLY_NATIVE),t&&(r?this.teduToolType.isSelectToolType()&&(this.deleteSelectedData(ec.CLEAR),this.fireCanRedoAndUndo()):(i?this.deleteAllBoardData(t,e):this.deleteBoardData(t,e),this.cancelSelect(),this.fireCanRedoAndUndo()),this.setNeedDraw(!0))},e.prototype.deleteAllBoardData=function(t,e){var r=this;if(this.tiwData.getElementsByBoardId(t).forEach((function(t){if("line"===t.type)r.renderHandler.getRender(t.ID).remove();else if("graph"===t.type)r.renderHandler.getRender(t.ID).remove();else if("imageElement"===t.type)delete r.imageElementMapData[String(t.belongSeq)],t.remove();else if("inputtext"===t.type){var e=document.querySelector("#".concat(r.options.id," #tic-textarea__").concat(t.belongSeq));e&&(e.value="",e.blur(),e.remove())}else if("element"===t.type)if([Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO,Ta.TEDU_BOARD_ELEMENT_WATERMARK].includes(t.subType));else if(t.subType===Ta.TEDU_BOARD_ELEMENT_MATH_TOOL)k(t.remove)&&t.remove(),r.mathToolMap.delete(String(t.belongSeq));else if(t.subType===Ta.TEDU_BOARD_ELEMENT_CUSTOM_GRAPH)delete r.customGraphMapData[String(t.belongSeq)],k(t.remove)&&t.remove();else{k(t.remove)&&t.remove();var i=r.renderHandler.getRender(t.ID||"");i&&i.remove&&i.remove()}})),this.tiwData.removeOperations(t),this.tiwData.removeElementsByBoardId(t,!1),e){this.getCurrentFile()===M.COMMON_GROUP&&this.tiwData.setBackgroundPicture(t,{show:!0,user:"",url:"",angle:0,mode:Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,type:M.BACKGROUND_TYPE.IMAGE});var i=this.getGlobalBackgroundColor();this.tiwData.setBackgroundColor(t,i)}},e.prototype.clear=function(t,e){if(this.logger.reportInfo(this.loggerModuleName,"clear",{param:{extraInfo:JSON.stringify({clearBackground:t,clearSelectedOnly:e})}},ea.ONLY_ONLINE),this.permissionHandler.filter("Board::Clear::*",[{operator:this.identifier}]))if(e)this.clearBoard(this.getCurrentBoard(),!1,!0,!0);else if(this.permissionHandler.filter("Element::Delete::*",[{creator:""}],!1)){if(this.tiwData.getElementsByBoardId(this.getCurrentBoard()).some((function(t){return t.isLocked()})))return void this.clearBoard(this.getCurrentBoard(),t,!1,!1);t?(this.clearBoard(this.getCurrentBoard(),!0,!1,!0),this.addRealtimeData({action:101,seq:this.seqUtil.getSeq()}),this.report.reportClear(this.getCurrentBoard())):(this.clearBoard(this.getCurrentBoard(),!1,!1,!0),this.addRealtimeData({action:102,seq:this.seqUtil.getSeq()}),this.report.reportClearDraws(this.getCurrentBoard()))}else this.clearBoard(this.getCurrentBoard(),!1,!1,!1)},e.prototype.clearFileDrawData=function(t){var e=this;this.logger.reportInfo(this.loggerModuleName,"clearFileDrawData",{param:{fids:t}},ea.ONLY_NATIVE),t.forEach((function(t){(e.getBoardByGroup(t)||[]).forEach((function(t){e.tiwData.getElementsByBoardId(t).forEach((function(t){if("imageElement"===t.type)t.remove();else if("inputtext"===t.type){var r=document.querySelector("#".concat(e.options.id," #tic-textarea__").concat(t.belongSeq));r&&(r.value="",r.blur(),r.remove())}else"element"===t.type&&t.subType===Ta.TEDU_BOARD_ELEMENT_MATH_BOARD&&t.remove()})),e.tiwData.removeOperations(t),e.tiwData.removeElementsByBoardId(t,!1)}))})),this.cancelSelect(),this.setNeedDraw(!0)},e.prototype.clearFileDraws=function(t){var e=this;if(this.logger.reportInfo(this.loggerModuleName,"clearFileDraws",{param:{fids:t}},ea.ONLY_NATIVE),t){Array.isArray(t)||(t=[t]),this.clearFileDrawData(t);var r=[];t.forEach((function(t){r=r.concat(e.getBoardByGroup(t))})),this.addRealtimeData({action:M.PROTOCOL_ACTION.FILE_CLEAR_ACTION,seq:this.seqUtil.getSeq(),fids:t}),this.report.reportClearDraws(r)}},e.prototype.clearAll=function(t,e){t||(this.logger.reportInfo(this.loggerModuleName,"clearAll",{param:{}},ea.ONLY_NATIVE),this.report.reportCleanAll(),this.addRealtimeData({action:M.PROTOCOL_ACTION.RESET_DATA_ACTION,seq:this.seqUtil.getSeq()}),this.sendRequest()),this.removeAllElement(),this.resetData(),this.settingConfig.clearBoardRatio(),this.setBoardRatio("default",this.ratio,!1)},e.prototype.addBackgroundPic=function(t){var e=this,r=t.boardIds,i=t.urls,o=t.type,n=void 0===o?M.BACKGROUND_TYPE.IMAGE:o,a=t.angle,s=void 0===a?0:a,l=t.needReport,c=void 0===l||l,h=t.position,u=void 0===h?Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER:h,d=t.boardSequenceList;this.logger.reportInfo(this.loggerModuleName,"addBackgroundPic",{param:{boardIds:r,urls:i,type:n,needReport:c,position:u}},ea.ONLY_NATIVE);var p=[],f=[];if(Array.isArray(r)){if(!Array.isArray(i)||r.length!=i.length)return!1;p=r,f=i}else{if(Array.isArray(i))return!1;p=[r],f=[i]}var g=[];this.cancelSelect(),p.forEach((function(t,r){if(t===e.getCurrentBoard()&&c&&e.addRealtimeData({action:M.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:encodeURI(f[r]),time:Wt.getTimeStamp(),seq:e.seqUtil.getSeq(),mode:u,type:n,angle:s,cleanBoard:0,isGlobal:0}),!e.tiwData.isBoardExist(t))if(d){var i=d.findIndex((function(e){return e===t}));e.addBoard(t,!0,It(t),i,!0)}else e.addBoard(t,!0,It(t),-1,!0);e.tiwData.setBackgroundPicture(t,{url:f[r],show:!0,mode:u,type:n,angle:s,user:e.identifier}),g.push({type:"image",seq:e.seqUtil.getSeq(),content:{fid:Ot(t),boardId:t,url:f[r],updateTime:Wt.getTimeStamp(),type:n,mode:u,angle:s}})})),c&&this.report.reportImages(g),this.setNeedDraw(!0)},e.prototype.setBackgroundPic=function(t,e,r){if(void 0===r&&(r=Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER),this.logger.reportInfo(this.loggerModuleName,"setBackgroundPic",{param:{boardId:t,url:e,position:r}},ea.ONLY_NATIVE),Ot(t)==M.COMMON_GROUP){this.cancelSelect();var i=t||this.getCurrentBoard(),o=this.getBackgroundImage(i);this.addBackgroundPic({boardIds:i,urls:e,type:M.BACKGROUND_TYPE.IMAGE,angle:(null==o?void 0:o.angle)||0,needReport:!1,position:r});var n=this.getFileInfo().boardSequenceList;this.sendRequest(t,[{action:M.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:e,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),mode:r,angle:(null==o?void 0:o.angle)||0,type:M.BACKGROUND_TYPE.IMAGE,cleanBoard:0,isGlobal:0,boardSequenceList:n}]),this.report.reportImage(i,e,r,M.BACKGROUND_TYPE.IMAGE,(null==o?void 0:o.angle)||0)}},e.prototype.setBackgroundH5=function(t,e){if(void 0===e&&(e=this.getCurrentBoard()),this.logger.reportInfo(this.loggerModuleName,"setBackgroundH5",{param:{boardId:e,url:t}},ea.ONLY_NATIVE),this.getCurrentFile()==M.COMMON_GROUP){this.cancelSelect();var r=e||this.getCurrentBoard(),i=this.getBackgroundImage(r);this.addBackgroundPic({boardIds:e,urls:t,type:M.BACKGROUND_TYPE.H5,angle:(null==i?void 0:i.angle)||0,needReport:!1});var o=this.getFileInfo().boardSequenceList;this.addRealtimeData({action:M.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:t,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),mode:Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,type:M.BACKGROUND_TYPE.H5,cleanBoard:0,isGlobal:0,boardSequenceList:o}),this.report.reportImage(e,t,Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,M.BACKGROUND_TYPE.H5)}},e.prototype.updateCurrentFillMode=function(t){this.logger.reportInfo(this.loggerModuleName,"updateCurrentFillMode",{param:{position:t}},ea.ONLY_NATIVE);var e=this.getBackgroundImage(this.getCurrentBoard());e&&e.url&&this.setBackgroundPic(this.getCurrentBoard(),e.url,t)},e.prototype.deleteBackgroundPic=function(t){this.logger.reportInfo(this.loggerModuleName,"deleteBackgroundPic",{param:{boardId:t}},ea.ONLY_NATIVE),this.cancelSelect(),this.tiwData.setBackgroundPicture(t,{url:""}),this.setNeedDraw(!0)},e.prototype.clearGlobalBgColor=function(){this.logger.reportInfo(this.loggerModuleName,"clearGlobalBgColor",{param:{}},ea.ONLY_NATIVE),this.setGlobalBackgroundColor(this.options.styleConfig.globalBackgroundColor)},e.prototype.updateVideo=function(t,e,r,i){void 0===i&&(i=!0);var o=this.getFileInfo(t);if(null!==o){this.cancelSelect(),e>=0&&(o.status=e),r>=0&&(o.progress=r);var n=Wt.getTimeStamp();o.timestamp=n,i&&(this.addRealtimeData({action:M.PROTOCOL_ACTION.VIDEO_EVENT_ACTION,time:n,seq:this.seqUtil.getSeq(),fid:t,status:o.status,progress:o.progress}),this.sendRequest(),this.report.reportAddFile(o))}},e.prototype.switchPage=function(t,e){var r,i;return this.logger.reportInfo(this.loggerModuleName,"switchPage",{param:{index:t}},ea.ONLY_NATIVE),r=(i=this.getBoardByGroup(this.getCurrentFile()))[t=Math.min(t,i.length-1)],this.switchBoard(r,!0,e)},e.prototype.switchH5Board=function(t,e,r){var i=this,o=t.seq,n=t.fid,a=t.slideIndex,s=t.stepIndex,l=t.resetStep,c=t.usePrevNextStepMethod;void 0===r&&(r=!1),o||(o=this.seqUtil.getSeq()),this.logger.reportInfo(this.loggerModuleName,"switchH5Board",{param:{fid:n,slideIndex:a,stepIndex:s,resetStep:l,usePrevNextStepMethod:c}},ea.ONLY_NATIVE),this.cancelSelect();var h=this.getBoardByGroup(n),u=this.getFileInfo(n),d=h[a];this.getSingleBoardHisData(d);var p=!1;if(d!==this.getCurrentBoard()&&(p=!0),this.checkIfInDiscussionGroupAndDiscussionGroupEnable()){var f=this.getDiscussionGroupIdByUserId(this.identifier);this.discussionGroupMap.checkIfBoardInAnyGroup(f,d)&&(f.forEach((function(t){if(i.discussionGroupMap.checkIfBoardInGroup(t,d)){var e=i.discussionGroupMap.getGroupInfoByGroupId(t);null==e||e.setCurrentBoard(d),null==e||e.setCurrentPage(a),null==e||e.setCurrentStep(s)}})),this.groupCurrentBoard=d,this.discussionGroupCurrentGroup=n)}else this.currentBoard=d,this.currentGroup=n;return r||u.currentPageIndex!==a||u.currentPageStep!==Math.max(0,s)?(this.updateSwitchedBoard(u,a,Math.max(0,s),h.length,o,{step:s,resetStep:l,usePrevNextStepMethod:c}),p&&(this.event.fireGotoBoardEvent(d,n,e),this.fireCanRedoAndUndo()),this.setNeedDraw(!0),d):(this.event.fireGotoBoardEvent(d,n,e),this.fireCanRedoAndUndo(),d)},e.prototype.switchBoard=function(t,e,r,i){var o=this;if(this.getSingleBoardHisData(t),this.logger.reportInfo(this.loggerModuleName,"switchBoard",{param:{boardId:t}},ea.ONLY_NATIVE),this.cancelSelect(),!t||this.tiwData.isBoardExist(t)){if(t||(t=this.createBoardId(),this.addBoard(t,!0,r,i,!0)),e){var n=0;if(this.checkIfInDiscussionGroupAndDiscussionGroupEnable()){var a=this.getDiscussionGroupIdByUserId(this.identifier);if(this.discussionGroupMap.checkIfBoardInAnyGroup(a,t)){this.groupCurrentBoard=t,this.discussionGroupCurrentGroup=Ot(this.groupCurrentBoard);var s=this.getCurrentFile(),l=this.getBoardByGroup(s).indexOf(this.getCurrentBoard());a.forEach((function(e){if(o.discussionGroupMap.checkIfBoardInGroup(e,t)){var r=o.discussionGroupMap.getGroupInfoByGroupId(e);r&&(r.setCurrentBoard(t),r.setCurrentStep(l===r.currentPage?r.currentStep:0),r.setCurrentPage(l),n=r.currentStep)}}))}else this.currentBoard=t,this.currentGroup=Ot(this.currentBoard)}else this.currentBoard=t,this.currentGroup=Ot(this.currentBoard);var c=this.getCurrentFile(),h=this.getBoardByGroup(c),u=this.getFileInfo(c),d=h.indexOf(this.getCurrentBoard()),p=0;return p=this.checkIfInDiscussionGroupAndDiscussionGroupEnable()?n:u.currentPageStep,this.updateSwitchedBoard(u,d,p,h.length,null,{step:p}),this.event.fireGotoBoardEvent(this.getCurrentBoard(),c,r),this.fireCanRedoAndUndo(),this.setNeedDraw(!0),this.getCurrentBoard()}c=Ot(t),u=this.getFileInfo(c),h=this.getBoardByGroup(c);var f=u.currentPageIndex;return p=u.currentPageStep,this.updateSwitchedBoard(u,f,p,h.length,null,{newBoard:t,notSwitch:!0,step:p}),t}},e.prototype.updateSwitchedBoard=function(t,e,r,i,o,n){var a;void 0===o&&(o=null),void 0===n&&(n={}),this.checkIfInDiscussionGroupAndDiscussionGroupEnable()||(t.currentPageIndex=e,t.currentPageStep=r,t.pageCount=i);var s=n.newBoard||this.getCurrentBoard(),l=this.getBackgroundImage(s);if(l){var c=l.url;c&&this.addRealtimeData({action:M.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:c,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),mode:l.mode,type:l.type,angle:l.angle,cleanBoard:0,isGlobal:0})}var h=o||this.seqUtil.getSeq(),u=this.discussionGroupMap.getGroupIdByUserId(this.identifier);this.checkIfInDiscussionGroupAndDiscussionGroupEnable()&&!n.notSwitch?this.addRealtimeData(hc({action:M.PROTOCOL_ACTION.DISCUSSION_GROUP_SWITCH_ACTION,time:Wt.getTimeStamp(),seq:h,toBoardId:s,deleteBoards:[],deleteFiles:[],page:e,discussionGroupIds:u,boardSequenceList:t.boardSequenceList},n)):this.addRealtimeData(hc({action:M.PROTOCOL_ACTION.SWITCH_ACTION,time:Wt.getTimeStamp(),seq:h,toBoardId:s,deleteBoards:[],deleteFiles:[],page:t.currentPageIndex,boardSequenceList:t.boardSequenceList},n)),this.isDataSyncEnable()&&(this.maxSeq=h),this.sendRequest(),n.notSwitch||(this.checkIfInDiscussionGroupAndDiscussionGroupEnable()?this.report.reportSetDiscussionGroup(u.map((function(t){return{currentBoardId:s,discussionGroupId:t,currentPage:e,currentStep:r}}))):(this.report.reportSwitchBoard({boardId:s,fid:t.fid,url:t.downloadURL,type:t.type,page:t.currentPageIndex,step:t.currentPageStep,ratio:t.ratio,scale:t.scale}),(null===(a=t.pptMediaInfo)||void 0===a?void 0:a.videoIDList)&&delete t.pptMediaInfo.videoIDList,t.pptMediaInfo&&t.pptSlideAudioMap&&(t.pptMediaInfo.audioIDList=t.pptSlideAudioMap[e]||[]),delete t.pptMediaPlaybackStatus,this.report.reportAddFile(t)))},e.prototype.getSingleBoardHisData=function(t){var e=this;if(this.notActiveBoardsDataFlagMap.hasOwnProperty(t)&&!this.notActiveBoardsDataFlagMap[t]){var r=this,i=Wt.getTimeStamp();new Promise((function(o,n){e.request.getSingleBoardData(t,(function(t,e){t.error_code?(r.logger.reportInfo(r.loggerModuleName,"getSingleBoardData",{code:t.error_code,message:t.error_msg,cost:Wt.getTimeStamp()-i,param:{extraInfo:JSON.stringify(t)}},ea.ONLY_ONLINE),r.event.fireErrorEvent(Xt.TEDU_BOARD_ERROR_HISTORYDATA,"errorCode:".concat(t.error_code,",errorMessage:").concat(t.error_msg))):(r.logger.reportInfo(r.loggerModuleName,"getSingleBoardData",{cost:Wt.getTimeStamp()-i,param:{extraInfo:JSON.stringify(t)}},ea.ONLY_ONLINE),o({res:t,oresp:e}))}),(function(t){n(t)}))})).then((function(r){var i=r.res;e.analySingleBoardHistoryBoardData(i,t);var o={action:M.PROTOCOL_ACTION.BROADCAST_SINGLE_BOARD_DATA,boardId:t,time:Wt.getTimeStamp(),seq:e.seqUtil.getSeq(),dataRes:i};e.addRealtimeData(o)})).catch((function(t){r.event.fireErrorEvent(Xt.TEDU_BOARD_ERROR_HISTORYDATA,t.message),r.logger.reportInfo(r.loggerModuleName,"getSingleBoardData",{code:-3,message:t.message,cost:0,param:{extraInfo:JSON.stringify({stack:t.stack,message:t.message})}},ea.ONLY_ONLINE)}))}},e.prototype.setGlobalBackgroundColor=function(t,e){var r=this;void 0===t&&(t=M.COLOR.WHITE),this.logger.reportInfo(this.loggerModuleName,"setGlobalBackgroundColor",{param:{color:t,noSend:e}},ea.ONLY_NATIVE),this.tiwData.setGlobalBackgroundColor(t);var i,o=this.getGlobalBackgroundColor();(this.boardList.forEach((function(t){r.tiwData.setBackgroundColor(t,o)})),this.setNeedDraw(!0),e)||(i=Y(o),this.addRealtimeData({action:M.PROTOCOL_ACTION.UPDATE_BG_COLOR_ACTION,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),color:i,isGlobal:1}),this.report.reportGlobalBg(i,this.getGlobalBackgroundPic()))},e.prototype.getGlobalBackgroundColor=function(){return this.tiwData.getGlobalBackgroundColor()},e.prototype.preloadBoardPPT=function(){for(var t=[],e=0;e<this.groups.length;++e){var r=this.groups[e];if(r.type===M.FILE_TYPE.IMG){var i=this.getBoardByGroup(r.fid);t=t.concat(i)}else if(r.type===M.FILE_TYPE.H5PPT&&"ISPRING"===q(r.downloadURL)&&!this.pptFilePreloaded[r.fid]){if(r.fid===this.getCurrentFile()){this.pptFilePreloaded[r.fid]=!0;continue}!function(t,e){setTimeout((function(){var e=document.createElement("iframe");e.setAttribute("style","position:fixed;visibility:hidden;width:0px;height:0px;border:none;"),document.body.appendChild(e),e.onload=function(){setTimeout((function(){e.remove()}),100)},e.setAttribute("src",t)}),1e3)}(r.downloadURL+"?page=".concat(r.currentPageIndex,"&step=").concat(r.currentPageStep,"&fid=").concat(encodeURIComponent(r.fid))),this.pptFilePreloaded[r.fid]=!0}}return t},e.prototype.preloadBoardNormal=function(t){for(var e=t.indexOf(this.getCurrentBoard()),r=-this.preloadDepth;r<this.preloadDepth;++r){var i=e+r;if(!(i<0||i>=t.length)){var o=t[i],n=this.getBackgroundImage(o);if(n&&!n.preloaded&&void 0!==n.url&&""!==n.url){if(0===r){n.preloaded=!0;continue}n.type===M.BACKGROUND_TYPE.IMAGE?function(t,e){setTimeout((function(){var e=new Image;e.onload=function(){},e.onabort=function(){},e.onerror=function(){},e.src=t}),e)}(n.url,200*Math.abs(r)):n.type===M.BACKGROUND_TYPE.H5&&function(t,e){setTimeout((function(){var e=document.createElement("iframe");e.setAttribute("style","position:fixed;visibility:hidden;width:0px;height:0px;border:none;"),document.body.appendChild(e),e.onload=function(){e.remove()},e.setAttribute("src",t)}),e)}(n.url,200*(Math.abs(r)-1)),n.preloaded=!0,this.tiwData.setBackgroundPicture(o,n)}}}},e.prototype.preloadBoard=function(){var t=this.preloadBoardPPT();0!==t.length&&this.preloadBoardNormal(t)},e.prototype.resetOperation=function(){this.tiwData.resetOperation(this.getCurrentBoard())},e.prototype.collectRaserData=function(){var t=this;return{start:function(e,r,i,o){var n=Wt.getTimeStamp(),a=new ls({touchId:e,action:M.PROTOCOL_ACTION.RASER_SHOW_ACTION,color:t.color||W(M.COLOR.RED),radius:t.thin/2,x:r,y:i,timestamp:n,seq:t.seqUtil.getSeq(),toolType:o,title:t.toolTypePenTitleStyle.title,style:t.toolTypePenTitleStyle.style,user:t.identifier}),s={touchId:e,action:M.PROTOCOL_ACTION.RASER_HIDE_ACTION,r:a.radius,seq:a.seq,x:r,y:i,timestamp:n,toolType:o,ignore:!0,color:t.color};t.addRealtimeData(s),t.event.fireDrawLaserEvent(a)},draw:function(e,r,i,o,n,a){var s=Wt.getTimeStamp(),l=new ls({touchId:e,action:M.PROTOCOL_ACTION.RASER_SHOW_ACTION,color:t.color||W(M.COLOR.RED),radius:t.thin/2,x:r,y:i,timestamp:s,seq:t.seqUtil.getSeq(),toolType:o,title:t.toolTypePenTitleStyle.title,style:t.toolTypePenTitleStyle.style,user:t.identifier});if((1!==o&&19!==o||!n)&&a){var c={title:"",style:{},touchId:e,action:M.PROTOCOL_ACTION.RASER_SHOW_ACTION,seq:l.seq,x:r,y:i,r:l.radius,timestamp:s,toolType:o,color:t.color};t.isSendedLaserTitleStyleData||(c.title=t.toolTypePenTitleStyle.title,c.style=t.toolTypePenTitleStyle.style,t.isSendedLaserTitleStyleData=!0),t.addRealtimeData(c)}t.event.fireDrawLaserEvent(l)},end:function(e,r,i,o,n){void 0===n&&(n=!0);var a=M.PROTOCOL_ACTION.RASER_SHOW_ACTION;n||(a=M.PROTOCOL_ACTION.RASER_HIDE_ACTION);var s=Wt.getTimeStamp(),l=new ls({touchId:e,action:a,color:W(M.COLOR.RED),radius:t.thin/2,x:r,y:i,timestamp:s,seq:t.seqUtil.getSeq(),toolType:o,title:t.toolTypePenTitleStyle.title,style:t.toolTypePenTitleStyle.style,user:t.identifier}),c={touchId:e,action:a,seq:l.seq,r:t.thin/2,x:r,y:i,timestamp:s,toolType:o,color:t.color};t.addRealtimeData(c),t.isSendedLaserTitleStyleData=!1,t.event.fireDrawLaserEvent(l)},over:function(t,e){this.end(t,-1e4,-1e4,e,!1)}}},e.prototype.collectGraphArcData=function(){var t=this;return{start:function(e,r,i,o){var n=Ll.createElement(t.instanceKey,t.identifier,{color:t.color,thin:t.thin,belongSeq:t.seqUtil.getSeq(),boardId:t.getCurrentBoard(),show:!0,visible:!0,center:e,startPoint:r,radian:i,clockwise:o,style:Object.assign({},t.lineStyle),lockElement:!1,erasable:!0});n.setBoardSize(t.boardWidth,t.boardHeight),n.setBorder();var a=Rl.createElement(n);t.renderHandler.addToRenderMap(n.belongSeq+"",a),t.seq=n.belongSeq,t.tiwData.addElement(t.getCurrentBoard(),t.identifier,n),t.tiwData.insertOperation(t.getCurrentBoard(),new gn(t.identifier,{seq:n.belongSeq,type:rc.ELEMENT})),t.fireCanRedoAndUndo()},draw:function(e,r){for(var i=t.tiwData.getElementsByUserId(t.getCurrentBoard(),t.identifier),o=null,n=i.length-1;n>=0;n--)if("element"===i[n].type&&i[n].subType===Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ARC){o=i[n];break}if(o)return o.radian=e,o.clockwise=r,o.setBorder(),t.setNeedDraw(!0),{action:M.PROTOCOL_ACTION.GRAPH_ARC_ELEMENT,subType:Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ARC,seq:t.seqUtil.getSeq(),belongSeq:o.belongSeq,time:Wt.getTimeStamp(),color:Y(t.color),thin:t.thin,center:{x:o.center.x,y:o.center.y},startPoint:{x:o.startPoint.x,y:o.startPoint.y},radian:o.radian,clockwise:o.clockwise,style:o.style}},end:function(e,r){for(var i=t.tiwData.getElementsByUserId(t.getCurrentBoard(),t.identifier),o=null,n=i.length-1;n>=0;n--)if("element"===i[n].type&&i[n].subType===Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ARC){o=i[n];break}if(o){o.radian=e,o.clockwise=r,o.setBorder(),t.setNeedDraw(!0);var a={action:M.PROTOCOL_ACTION.GRAPH_ARC_ELEMENT,subType:Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ARC,seq:t.seqUtil.getSeq(),belongSeq:o.belongSeq,time:Wt.getTimeStamp(),color:Y(t.color),thin:t.thin,center:{x:o.center.x,y:o.center.y},startPoint:{x:o.startPoint.x,y:o.startPoint.y},radian:o.radian,clockwise:o.clockwise,style:o.style};t.addRealtimeData(a),t.report.reportElement(o.getReportData()),t.event.fireAddElementEvent({id:String(o.belongSeq),type:Ta.TEDU_BOARD_ELEMENT_GEOMETRY,userData:""})}},over:function(t,e){this.end(t,e)}}},e.prototype.computeMoveRange=function(t,e,r,i){var o,n,a,s;return t/e>r/i?(e>i?(a=50+(e-i)/2/e*100,s=50-(e-i)/2/e*100):(a=50,s=50),o=50+(t-r)/2/t*100,n=50-(t-r)/2/t*100):(a=50+(e-i)/2/e*100,s=50-(e-i)/2/e*100,t>r?(o=50+(t-r)/2/t*100,n=50-(t-r)/2/t*100):(o=50,n=50)),n=+n.toFixed(1),o=+o.toFixed(1),s=+s.toFixed(1),{maxLeft:o,minLeft:n,maxTop:a=+a.toFixed(1),minTop:s}},e.prototype.setBoardOffset=function(t,e){this.dragDataList.getDragData(this.getCurrentBoard())?this.dragDataList.updateDragData(this.getCurrentBoard(),{xOffset:t,yOffset:e}):this.dragDataList.addDragData(this.getCurrentBoard(),new Kn(this.seqUtil,{scale:this.getBoardScale(),xOffset:t,yOffset:e})),this.addRealtimeData(this.dragDataList.getDragData(this.getCurrentBoard()).getRealTimeData())},e.prototype.cancelSelect=function(t){for(var e=this,r=this.selectedList.length,i=0;i<r;i++){var o=this.selectedList[i];o.select=!!t&&t!==this.elementTypeTransformer(o)}this.selectedList=t?this.selectedList.filter((function(r){return t!==e.elementTypeTransformer(r)})):[],this.selectArea={x:0,y:0,width:0,height:0},this.selectModel.show=!1,this.selectModel.succeedSelect=!1,r&&this.setNeedDraw(!0),this.fireElementPosition([],!1,-1)},e.prototype.deleteSelectedData=function(t){var e=this;void 0===t&&(t=ec.CLEAR),this.logger.reportInfo(this.loggerModuleName,"deleteSelectedData",{param:{}},ea.ONLY_NATIVE);var r=[],i=[],o=[],n=[Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO,Ta.TEDU_BOARD_ELEMENT_WATERMARK];this.selectedList.forEach((function(a){n.includes(a.subType)&&t!==ec.KEYBOARD||(a.isLocked()?e.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENT_IS_LOCKED,a.getElementId()):e.permissionHandler.filter("Element::Delete::*",[{creator:a.user}],!1)&&(n.includes(a.subType)?i.push({uid:a.user,seq:a.belongSeq}):r.push({uid:a.user,seq:a.belongSeq}),o.push(String(a.belongSeq)),a.setElementDisplay(Bo.DELETE)))})),o.length&&this.event.fireRemoveElementEvent(o),this.reportEraserData(this.getCurrentBoard(),r,Bo.DELETE,!0,Xa.TEDU_BOARD_TOOL_TYPE_ERASER),this.reportEraserData(M.COMMON_DEFAULT_BOARD,i,Bo.DELETE,!0,Xa.TEDU_BOARD_TOOL_TYPE_ERASER),this.cancelSelect()},e.prototype.reportEraserData=function(t,e,r,i,o){if(e.length>0){var n=1,a=1;r===Bo.DISPLAY?(n=1,a=1):r===Bo.HIDE?(n=0,a=0):r===Bo.DELETE&&(n=0,a=1),i&&(this.tiwData.insertOperation(this.getCurrentBoard(),new gn(this.identifier,{seq:e,type:o,subType:a})),this.fireCanRedoAndUndo());var s={action:M.PROTOCOL_ACTION.ERASER_ACTION,boardId:t,display:n,visible:a,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),x:0,y:0,lines:e};this.addRealtimeData(s),this.report.reportDisplayLine({boardId:t||this.getCurrentBoard(),updateTime:Wt.getTimeStamp(),display:n,visible:a,lines:e}),this.setNeedDraw(!0)}},e.prototype.deleteBoardData=function(t,e){var r=this;this.logger.reportInfo(this.loggerModuleName,"deleteBoardData",{param:{}},ea.ONLY_NATIVE);var i=[],o=[Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO,Ta.TEDU_BOARD_ELEMENT_WATERMARK];if(this.tiwData.getElementsByBoardId(t).forEach((function(t){o.includes(t.subType)||t.isLocked()||r.permissionHandler.filter("Element::Delete::*",[{creator:t.user}],!1)&&(i.push({uid:t.user,seq:t.belongSeq}),t.setElementDisplay(Bo.DELETE))})),this.reportEraserData(this.getCurrentBoard(),i,Bo.DELETE,!0,Xa.TEDU_BOARD_TOOL_TYPE_ERASER),e){this.getCurrentFile()===M.COMMON_GROUP&&this._setBackgroundImage("");var n=this.getGlobalBackgroundColor();this.setBackgroundColor(n)}},e.prototype.eraserImpactCheck=function(t,e,r,i){var o=this;t&&this.eraserLockedEventMap.clear();var n=this.eraseLayerLimit>0,a=[],s=[],l=this.tiwData.getElementsByBoardId(this.getCurrentBoard()),c=[],h=[],u=[];if(l&&(l.forEach((function(t){if(o.permissionHandler.filter("Element::Delete::*",[{creator:t.user}],!1)){if(o.eraseLayerTypeArr.length&&-1===o.eraseLayerTypeArr.indexOf(t.type))return!0;if(t.show&&(1!==o.eraserMode&&2!==o.eraserMode||"line"!==t.type||"v2"!==t.version)&&!t.lineTransparent){var l=!1;if("graph"===t.type?l=o.renderHandler.getRender(t.ID).impactCheck(e,r,i,o.boardWidth,o.boardHeight):"element"===t.type||"imageElement"===t.type?(t.erasable||F(t.erasable))&&(l=t.impactCheck(e,r,i)):l=t.impactCheck(e,r,i),l){var d=o.eraserLockedEventMap.get(t.getElementId());if(t.isLocked())return void(d||(o.eraserLockedEventMap.set(t.getElementId(),!0),o.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENT_IS_LOCKED,t.getElementId())));n?"line"===t.type||"graph"===t.type?c.unshift(t):"inputtext"===t.type?h.unshift(t):u.unshift(t):(t.show=!1,a.push({uid:t.user,seq:t.belongSeq}),"element"!==t.type&&"imageElement"!==t.type||s.push(String(t.belongSeq)))}}}})),n))for(var d=c.concat(h).concat(u),p=0;p<d.length&&!(this.eraseLayerCount>=this.eraseLayerLimit);p++){var f=d[p];this.eraseLayerCount+=1,f.show=!1,a.push({uid:f.user,seq:f.belongSeq}),"element"!==f.type&&"imageElement"!==f.type||s.push(String(f.belongSeq))}return s.length&&this.event.fireRemoveElementEvent(s),a},e.prototype.piecewiseErasure=function(t,e,r){var i=this,o=this.tiwData.getElementsByBoardId(this.getCurrentBoard());if(o&&o.length){var n=[];o.forEach((function(o){if(o.show&&"line"===o.type&&o.getPoints()[o.getPoints().length-1].action===M.PROTOCOL_ACTION.LINE_END_ACTION&&"v2"===o.version&&(!r||r["".concat(o.belongSeq)])){for(var a=!1,s=0;s<t.length;s++){var l=t[s];if(a=o.pointImpactCheckV2(e,[l.x,l.y],{boardWidth:i.boardWidth,boardHeight:i.boardHeight}))break}if(a){var c=function(t,e,r,i){var o,n,a,s,l=t.getPointsTransformer(),c=[],h=!1,u=function(t,o){for(var n=!1,a=0;a<e.length;a++){var s=e[a];if(n=Ut(t,o,s.x,s.y,r,i))break}return h||(h=n),n};if(1===l.length)return{newLines:[],impactResult:!0};if(2===l.length){var d=l[1].y-l[0].y,p=l[1].x-l[0].x,f=l[1].w-l[0].w;if(0===p&&0===d)return{newLines:[],impactResult:!0};for(var g=[],m=!0,y=p<0,v=l[0].x;y?v>=l[1].x:v<=l[1].x;y?v--:v++){var _=0,E=void 0;v===l[0].x?(_=1,E=l[0].originSeq):v===l[1].x&&(_=1,E=l[1].originSeq);var T={w:f*(v-l[0].x)/p+l[0].w,x:v,y:d*(v-l[0].x)/p+l[0].y,timestamp:0,isOrigin:_,originSeq:E};u(T.x,T.y)?(h=!0,m=!0):(m?(T.timestamp=Wt.getTimeStamp(),g.push([T])):(g.length>1&&g[g.length-1].pop(),T.timestamp=Wt.getTimeStamp(),g[g.length-1].push(T)),m=!1)}return{newLines:g,impactResult:h}}for(var b=0,S=l.length;b<S-2;b+=2){var x=l[b],w=l[b+1],O=l[b+2];c.push(Yt(Yt({},x),{isOrigin:1,ctrlP:Yt(Yt({},w),{isOrigin:1})}));for(var I=1;I<20;I++)c.push(Yt(Yt({},jt(I/20,x,w,O)),{isOrigin:0,ratioPos:I}));b===S-3&&c.push(Yt(Yt({},O),{isOrigin:1,ctrlP:null}))}var A=[],D=!0,C=0;try{for(var P=zt(c),L=P.next();!L.done;L=P.next())u((F=L.value).x,F.y)?D=!0:(D?(A.push([F]),C++):A[C-1].push(F),D=!1)}catch(t){o={error:t}}finally{try{L&&!L.done&&(n=P.return)&&n.call(P)}finally{if(o)throw o.error}}var M=[];try{for(var R=zt(A),N=R.next();!N.done;N=R.next()){var B=N.value,k=[];for(S=B.length,b=0;b<S;b++){var F;(F=B[b]).isOrigin&&(k.push({middle:!!F.middle,x:F.x,y:F.y,w:F.w,isOrigin:F.isOrigin,originSeq:F.originSeq}),F.ctrlP&&k.push(F.ctrlP))}if(1!==B[0].isOrigin){var U=B[0],H=B.findIndex((function(t){return t.isOrigin}));if(-1===H){var G=(V=B[S-1]).ratioPos-U.ratioPos+1;1===G?k.push(U):2===G?(k.push(U),k.push(V)):(W=Vt(Y=1-1/G,U,B[S-2],V),k.push(U),k.push(W),k.push(V));continue}var q=B[H],W=null;if(19===U.ratioPos)W={x:(U.x+q.x)/2,y:(U.y+q.y)/2,w:(U.w+q.w)/2};else{var Y=1-1/H,z=B[H-1];W=Vt(Y,U,z,q)}k.unshift(W),k.unshift(U)}if(1!==B[S-1].isOrigin){k.pop();var j=-1;for(b=S-1;b>=0;b--)if(B[b].isOrigin){j=b;break}if(-1!==j){var V=B[S-1];q=B[j],W=null,1===V.ratioPos?W={x:(V.x+q.x)/2,y:(V.y+q.y)/2,w:(V.w+q.w)/2}:(Y=1-1/V.ratioPos,z=B[S-2],W=Vt(Y,q,z,V)),k.push(W),k.push(V)}}B[S-1].isOrigin&&B[S-1].ctrlP&&k.pop(),M.push(k.map((function(t){var e=t.x,r=t.y,i=t.w,o=void 0===i?0:i,n=t.isOrigin,a=t.originSeq,s=t.middle;return{x:+e.toFixed(4),y:+r.toFixed(4),w:+o.toFixed(4),isOrigin:n,originSeq:a,timestamp:Wt.getTimeStamp(),middle:!!s}})))}}catch(t){a={error:t}}finally{try{N&&!N.done&&(s=R.return)&&s.call(R)}finally{if(a)throw a.error}}return{newLines:M,impactResult:h}}(o,t,e,{boardWidth:i.boardWidth,boardHeight:i.boardHeight}),h=c.newLines;if(c.impactResult){if(o.show=!1,n.push({uid:o.user,seq:o.belongSeq}),0===h.length){var u=o.originBelongSeq+"",d=i.splitLineData.get(u);d||(d=[]);var p={points:[],lineModel:{show:!1,belongSeq:0},hideLines:n};return d=d.concat(p),void i.splitLineData.set(u,d)}h.forEach((function(t){var e,r=i.seqUtil.getSeq(),a=r;if(t.forEach((function(n,s){var l=n.x,c=n.y,h=n.w,u=n.timestamp;0===s?(null===(e=fs.createElement(i.instanceKey,i.identifier,{action:M.PROTOCOL_ACTION.LINE_START_ACTION,time:o.time,timestamp:u,color:o.color,thin:o.thin,x:l,y:c,w:h,belongSeq:r,seq:a,lineTransparent:o.lineTransparent,writing:o.writing,show:!0,visible:!0,boardId:o.boardId,scaleX:1,scaleY:1,deg:0,originBelongSeq:o.originBelongSeq,originSeq:n.originSeq,lockElement:o.lockElement},"v2"))||void 0===e||e.setBoardSize(i.boardWidth,i.boardHeight),i.renderHandler.addToRenderMap(e.ID,new ms(e))):(a+=1,e.addPoint({action:s===t.length-1?M.PROTOCOL_ACTION.LINE_END_ACTION:M.PROTOCOL_ACTION.LINE_MOVE_ACTION,x:l,y:c,w:h,belongSeq:r,seq:a,timestamp:u,originSeq:n.originSeq}),s===t.length-1&&(e.endSeq=t[s].seq)),null==e||e.setBorder(l,c)})),e instanceof fs){if(1===e.getPoints().length){var s=t[0],l=s.x,c=s.y,h=s.w,u=s.originSeq,d=s.timestamp;a+=1,e.addPoint({action:M.PROTOCOL_ACTION.LINE_END_ACTION,x:l,y:c,w:h,belongSeq:r,seq:a,timestamp:d,originSeq:u}),e.endSeq=a}e.drawIndex=e.getPoints().length;var p=e.boardId,f=e.user;i.tiwData.addElement(p,f,e,o,!0),i.seqLineMap[t.belongSeq]=e;var g=String(o.originBelongSeq),m=i.splitLineData.get(g);m||(m=[]);var y={points:t,lineModel:e,hideLines:n};m=m.concat(y),i.splitLineData.set(g,m)}}))}}}}))}},e.prototype.circleFix=function(t,e){var r,i,o,n,a=e.startPoint.x,s=e.startPoint.y,l=e.endPoint.x,c=e.endPoint.y;if(this.ovalDrawMode===Qn.TEDU_BOARD_OVAL_DRAW_MODE_FIX_CENTER){var h=(r=this.ovalCenterPoint[t],i=e.endPoint,o=r.x-i.x,n=r.y-i.y,Math.sqrt(o*o+n*n));e.startPoint.x=this.ovalCenterPoint[t].x-h,e.startPoint.y=this.ovalCenterPoint[t].y-Math.floor(h*this.boardWidth/this.boardHeight),e.endPoint.x=this.ovalCenterPoint[t].x+h,e.endPoint.y=this.ovalCenterPoint[t].y+Math.floor(h*this.boardWidth/this.boardHeight)}else{h=Math.abs(a-l);var u=Math.sign(l-a)*h,d=Math.sign(c-s)*Math.floor(h*this.boardWidth/this.boardHeight);e.endPoint.x=e.startPoint.x+u,e.endPoint.y=e.startPoint.y+d}},e.prototype.graphFix=function(t){var e=t.startPoint.x,r=t.startPoint.y,i=t.endPoint.x,o=t.endPoint.y;t.startPoint.x=Math.min(e,i),t.startPoint.y=Math.min(r,o),t.endPoint.x=Math.max(e,i),t.endPoint.y=Math.max(r,o)},e.prototype.squareFix=function(t){var e=t.startPoint.x,r=t.startPoint.y,i=t.endPoint.x,o=t.endPoint.y,n=Math.abs(e-i),a=Math.sign(i-e)*n,s=Math.sign(o-r)*Math.floor(n*this.boardWidth/this.boardHeight);t.endPoint.x=t.startPoint.x+a,t.endPoint.y=t.startPoint.y+s},e.prototype.sendRequest=function(t,e){var r=this;if(this.permissions&&this.dataSyncEnable){var i=JSON.parse(JSON.stringify(e||this.realTimeData));t=t||this.getCurrentBoard();var o=[];if(e)o=i;else{for(var n="",a=0,s=i.length;a<s;a++){var l=i[a];if(n+=JSON.stringify(l),l.boardId=l.boardId||t,n.length>M.REALTIMEDATA_MAX_LENGTH){0===a&&(o.push(l),a++);break}o.push(l)}this.realTimeData.splice(0,a)}var c={seq:this.seqUtil.getSeq(),timestamp:Wt.getTimeStamp(),value:{boardId:t,operator:this.identifier,actions:o}};if(o.length){if(this.isUserInfoChangeNeedRealtime){var h=this.userInfo.getRealtimeData();c.value.actions.push(h),this.isUserInfoChangeNeedRealtime=!1,this.logger.reportInfo(this.loggerModuleName,"send_user_info",{param:{extraInfo:JSON.stringify(h)}},ea.ONLY_ONLINE)}if(this.isUserInfoChangeNeedReport){var u=this.userInfo.getReportData();this.report.reportAddUserContent(u,(function(t){u.nickname===r.userInfo.nickname?r.isUserInfoChangeNeedReport=!1:r.isUserInfoChangeNeedReport=!0}),(function(t){r.isUserInfoChangeNeedReport=!0}))}this.fireSyncDataEvent(t,c)}}},e.prototype.fireSyncDataEvent=function(t,e){var r=this;this.checkOffline();var i=JSON.stringify(e);i.length>M.REALTIMEDATA_MAX_LENGTH+500?this.uploadBoardMessageToCos(i).then((function(e){var i={seq:r.seqUtil.getSeq(),timestamp:Wt.getTimeStamp(),value:{boardId:t,operator:r.identifier,actions:[{action:M.PROTOCOL_ACTION.FILE_MESSAGE_ACTION,seq:r.seqUtil.getSeq(),url:e,boardId:t}]}};r.addSendAckData(JSON.stringify(i),!1),r.event.fireSyncDataEvent(i)})):(this.addSendAckData(i,!1),this.event.fireSyncDataEvent(e));var o=e.value.actions.filter((function(t){return 6!==t.action&&7!==t.action}));o.length&&this.logger.reportInfo(this.loggerModuleName,"send_realtime_data",{param:{boardId:t,extraInfo:JSON.stringify(o)}},ea.ONLY_ONLINE)},e.prototype.addHistory=function(t,e){var r=this;void 0===e&&(e={isRenderFace:!1});var i=e.isRenderFace;this.logger.reportInfo(this.loggerModuleName,"addHistory",{param:{isRenderFace:i}},ea.ONLY_NATIVE);var o=!1;this.sortBoard(),t.forEach((function(t){r.seqFilter[t.seq+""]=!0;try{t.content=JSON.parse(t.content)}catch(t){}"setGlobalBG"===t.type||("createBoards"===t.type?r.addHistoryBoards(t):"addFile"===t.type?r.addHistoryFile(t):"addUserContent"===t.type?r.addHistoryUserContent(t):r.addHistoryOtherOperation(t)),t.content.colorRGBA&&(t.content.color=t.content.color||W(t.content.colorRGBA)),t.content.width&&(t.content.thin=t.content.thin||t.content.width),"addLine"===t.type?(r.addHistoryLine(t),o=!0):"addText"===t.type?r.addHistoryText(t):"displayLine"===t.type?r.addHistoryDisplayLine(t):"addPatternLine"===t.type||"addPatternCircle"===t.type||"addPatternRectangle"===t.type||"addPattern"===t.type?r.addHistoryPattern(t):"image"===t.type?r.addHistoryImage(t):"switchBoard"===t.type?r.addHistorySwitchBoard(t):"setBoardBG"===t.type?r.addHistoryBoardBackground(t):"setGlobalBG"===t.type?r.addHistoryGlobalBackground(t):"drag"===t.type?r.addHistoryDrag(t):"setRatio"===t.type?r.addHistoryRatio(t):"imageElement"===t.type?r.addHistoryImageElement(t):"element"===t.type?r.addHistoryElement(t):"layer"===t.type?r.addHistoryLayerElement(t):"setBoardRemark"===t.type?r.addHistoryBoardRemark(t):"enableDiscussionGroup"===t.type?r.addHistoryEnableDiscussionGroup(t):"setDiscussionGroup"===t.type?r.addHistoryDiscussionGroup(t):"resetDiscussionGroup"===t.type&&r.addHistoryResetDiscussionGroup()})),o&&this.formatLinePoints(this.getCurrentBoard()),i?this.event.fireDrawFaceEvent():this.setNeedDraw(!0)},e.prototype.addHistoryFile=function(t){for(var e=t.content,r=e.fid,i=e.title,o=L.historyRealtimeDataReplaceAssetsProtocol(e.downloadURL),n=e.pageCount,a=e.currentPageIndex,s=e.currentPageStep||0,l=e.timestamp,c=(e.updateTime,e.uid),h=e.platform,u=e.type,d=e.ratio,p=e.scale,f=e.status,g=e.progress,m=!!e.isTranscodeFile,y=e.pptMediaPlaybackStatus,v=e.boardSequenceList,_=!!e.h5FileEnableDraw,E="",T=!1,b=0,S=this.groups.length;b<S;b++){var x=this.groups[b];if(x.fid===r){x.title=i,x.downloadURL=o,x.pageCount=n,x.currentPageIndex=a,x.currentPageStep=s,x.timestamp=l,x.uid=c,x.type=u,x.ratio=d,x.scale=p,x.isTranscodeFile=m,x.status=f,x.progress=g,x.pptMediaPlaybackStatus=y,x.boardSequenceList=v,x.h5FileEnableDraw=_,T=!0;break}}if(T?T&&r===M.COMMON_GROUP&&this.event.fireAddFileEvent(r):this.addGroupNotReport(r,i,c,o,n,a,l,h,u,s,d,p,m,f,g,_,y,v),l||c){if(r!=M.COMMON_GROUP){var w=[],O=this.createBoardIdForFile(r,c,l,n,h,u),I=[],A="";for(u===M.FILE_TYPE.IMG&&(A=o?ee(o):""),b=0;b<n;b++)E=O[b],A&&u===M.FILE_TYPE.IMG&&(A.endsWith("/")?I.push("".concat(A).concat(b+1,".jpg")):I.push(A+(b+1))),E&&!this.tiwData.isBoardExist(E)&&w.push(E);if(this.addBoard(w,!1,c),o)if(u===M.FILE_TYPE.IMG)this.addBackgroundPic({boardIds:O,urls:I,type:M.BACKGROUND_TYPE.IMAGE,needReport:!1});else if(u===M.FILE_TYPE.IMAGESFILE){var D=(new Date).getTime(),C=ct(o),P=(new Date).getTime();I=JSON.parse(C),this.addBackgroundPic({boardIds:O,urls:I,type:M.BACKGROUND_TYPE.IMAGE,needReport:!1});var R=P-D;this.logger.reportInfo(this.loggerModuleName,"add_images_file_history",{param:{extraInfo:JSON.stringify({urls:C,urls_length:C.length,elapse:R})}},ea.ONLY_ONLINE)}}this.sortGroup()}},e.prototype.addHistoryBoards=function(t){var e=this,r="",i=[];t.content&&t.content.createBoards.forEach((function(t){(r=t)&&!e.tiwData.isBoardExist(r)&&i.push(r)})),i.length&&this.addBoard(i,!1,t.content.uid)},e.prototype.addHistoryUserContent=function(t){t.content.uid!==this.identifier?this.userInfoMap[t.content.uid]=new ys(this.seqUtil,t.content.uid,t.content):t.content.uid!==this.identifier||this.isLocalSetUserInfo||this.setUserInfo(t.content)},e.prototype.addHistoryOtherOperation=function(t){var e=t.content.boardId,r=t.content.uid;e&&!this.tiwData.isBoardExist(e)&&this.addBoard(e,!1,r)},e.prototype.addHistoryLine=function(t){var e,r,i=t.content,o=i.boardId,n=i.uid,a=i.version||"v1",s=[];if("v1"===a?s=i.points:"v2"===a&&(s=i.fullPoints),s.length){var l=i.points[0].seq,c=(i.thin,i.points[0]),h=c.x,u=c.y,d=c.w,p=c.seq,f=c.timestamp;(r=fs.createElement(this.instanceKey,n,{action:M.PROTOCOL_ACTION.LINE_START_ACTION,time:i.time,timestamp:f,color:i.color,thin:i.thin,x:h,y:u,w:d||i.thin,seq:p,belongSeq:l,writing:i.writing,show:!i.hidden,visible:!(null!==(e=i.visible)&&void 0!==e&&!e),lineTransparent:i.lineTransparent,boardId:i.boardId,scaleX:i.scaleX,scaleY:i.scaleY,deg:i.deg,originBelongSeq:l,originSeq:l,highlighter:i.highlighter,lockElement:i.lockElement},a,!0)).setBoardSize(this.boardWidth,this.boardHeight),r.setLines(s),r.setNeedFormat(),this.renderHandler.addToRenderMap(r.ID,new ms(r)),r&&(r.drawIndex=r.getPoints().length,this.tiwData.isElementExist(r.belongSeq)||this.tiwData.addElement(o,n,r),this.seqLineMap[r.belongSeq]=r)}},e.prototype.addHistoryText=function(t){var e,r=t.content,i=r.boardId,o=r.uid,n=new Wa(this.instanceKey,{belongSeq:r.belongSeq,x:r.x,y:r.y,user:o,boardId:r.boardId,scaleX:r.scaleX,scaleY:r.scaleY,deg:r.deg,show:!r.hidden,visible:!(null!==(e=r.visible)&&void 0!==e&&!e),lockElement:r.lockElement});n.seq=r.belongSeq,n.scale=r.scale,n.color=r.color,n.lineHeight=r.lineHeight,n.typeFace=r.typeface,n.textSize=r.textSize,n.fontStyle=r.fontStyle,n.time=r.time;try{n.text=unescape(decodeURI(r.text))}catch(t){n.text=r.text}try{var a=r.text_wh.split(",");n.textWidth=parseFloat(a[0]),n.textHeight=parseFloat(a[1])}catch(t){n.textWidth=0,n.textHeight=0}n.setBorder(),this.tiwData.isElementExist(n.belongSeq)||this.tiwData.addElement(i,o,n)},e.prototype.addHistoryDisplayLine=function(t){var e=t.content,r=e.lines,i=e.boardId,o=e.uid,n=this.tiwData.getElementsByUserId(i,o);r.forEach((function(e){for(var r=0;r<n.length;r++){var i=n[r];("line"===i.type&&i.startSeq===e.seq||"graph"===i.type&&i.startPoint.seq===e.seq||"inputtext"===i.type&&i.belongSeq===e.seq||"imageElement"===i.type&&i.belongSeq===e.seq)&&(i.show=!!t.content.display)}}))},e.prototype.addHistoryPattern=function(t){var e,r=t.content,i=r.boardId,o=r.uid,n={addPatternLine:"line",addPatternCircle:"oval",addPatternRectangle:"rect",addPattern:""}[t.type];n||(n=r.subType),t.content.graph=n,t.content.seq=t.content.beginPoint.seq,t.content.show=!t.content.hidden,t.content.visible=!(null!==(e=t.content.visible)&&void 0!==e&&!e),t.content.solid=!!t.content.fillRect;var a=ss.createElement(this.instanceKey,o,t.content);a.setBoardSize(this.boardWidth,this.boardHeight),a.setBorder();var s=qn.createElement(a);this.renderHandler.addToRenderMap(a.ID,s),this.tiwData.isElementExist(a.getElementId())||this.tiwData.addElement(i,o,a)},e.prototype.addHistoryImage=function(t){var e=t.content;if(e.url||0!==e.angle){var r=e.url;this.addBackgroundPic({boardIds:e.boardId,urls:r,type:e.type,angle:e.angle,needReport:!1,position:e.mode})}else this.deleteBackgroundPic(e.boardId)},e.prototype.addHistorySwitchBoard=function(t){var e=t.content,r=e.boardId;r&&((1*t.seq||0)>this.maxSeq?(e&&e.url&&(e.url=L.historyRealtimeDataReplaceAssetsProtocol(e.url)),this.maxSeq=t.seq,this.tiwData.isBoardExist(r)||this.addBoard(r,!1,It(r)),this.currentBoard=r,r===M.COMMON_DEFAULT_BOARD?this.currentGroup=M.COMMON_GROUP:this.currentGroup=r.match(/\d+_#\w+$/)[0].split("_")[1],this.settingConfig.setBoardRatio(this.getCurrentBoard(),this.getBoardRatio()),this.settingConfig.isDiscussionGroupMode||this.event.fireSwitchFileEvent(this.currentGroup)):this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxSeq:this.maxSeq,boardId:r,method:"addHistory"})}},ea.ONLY_ONLINE))},e.prototype.addHistoryBoardBackground=function(t){var e=t.content,r=e.boardId;this.setBackgroundColor({boardId:r,color:e.colorRGBA},!0)},e.prototype.addHistoryGlobalBackground=function(t){var e=t.content.colorRGBA,r=t.content.picture;this.setGlobalBackgroundColor(e,!0),r&&this.setGlobalBackgroundPic(r.url,r.mode,r.type,!0)},e.prototype.addHistoryDrag=function(t){var e=t.content,r=e.boardId;this.dragDataList.addDragData(r,new Kn(this.seqUtil,{scale:e.scale,xOffset:e.xOffset,yOffset:e.yOffset}))},e.prototype.addHistoryRatio=function(t){var e=t.content||{};for(var r in e)this.settingConfig.setBoardRatio(r,e[r])},e.prototype.addHistoryImageElement=function(t){var e,r=t.content,i=r.boardId,o=r.uid,n=L.historyRealtimeDataReplaceAssetsProtocol(r.url),a=!(!r.erasable&&!F(r.erasable)),s=new ma(this.instanceKey,{user:o,url:n,belongSeq:r.belongSeq,time:r.time,width:r.width,height:r.height,x:r.x,y:r.y,boardId:i,show:!r.hidden,visible:!(null!==(e=r.visible)&&void 0!==e&&!e),deg:r.deg,erasable:a,exifData:r.exifData,lockElement:r.lockElement},{store:{getDomainMap:this.getDomainMap.bind(this),getAccessibleDomains:this.getAccessibleDomains.bind(this),addAccessibleDomain:this.addAccessibleDomain.bind(this),getImageTimeout:this.getImageTimeout.bind(this),networkSniffer:this.networkSniffer.bind(this)}});this.tiwData.addElement(i,o,s)},e.prototype.addHistoryElement=function(t){var e,r,i,o,n,a,s,l=this,c=t.content,h=c.boardId,u=c.uid,d=!(!c.erasable&&!F(c.erasable));if(c.subType===Ta.TEDU_BOARD_ELEMENT_H5)(f=new xa(this.instanceKey,{belongSeq:c.belongSeq,user:c.uid,url:c.url,boardId:c.boardId,erasable:d,deg:c.deg,lockElement:c.lockElement})).setProperty({show:!c.hidden,visible:!(null!==(e=c.visible)&&void 0!==e&&!e),width:c.width,height:c.height,x:c.x,y:c.y,data:c.data,erasable:d,deg:c.deg}),this.tiwData.addElement(h,u,f);else if(c.subType===Ta.TEDU_BOARD_ELEMENT_CUSTOM_GRAPH){var p=c.url,f=new Ia(this.instanceKey,{belongSeq:c.belongSeq,user:c.uid,url:p,boardId:c.boardId,show:!c.hidden,visible:!(null!==(r=c.visible)&&void 0!==r&&!r),x:c.x,y:c.y,deg:c.deg,scaleX:c.scaleX,scaleY:c.scaleY,boardWidth:this.boardWidth,boardHeight:this.boardHeight,naturalWidth:c.naturalWidth,naturalHeight:c.naturalHeight,erasable:d,lockElement:c.lockElement,time:c.time});this.tiwData.addElement(h,u,f)}else if(c.subType===Ta.TEDU_BOARD_ELEMENT_AUDIO||c.subType===Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO)window.WeixinJSBridge?window.WeixinJSBridge.invoke("getNetworkType",{},(function(){var t;l.addAudioElement(c.uid,h,c.belongSeq,c.url,c.subType,c.title,null,c,{erasable:d,visible:!(null!==(t=c.visible)&&void 0!==t&&!t),show:!c.hidden,lockElement:c.lockElement})}),!1):this.addAudioElement(c.uid,h,c.belongSeq,c.url,c.subType,c.title,null,c,{erasable:d,visible:!(null!==(i=c.visible)&&void 0!==i&&!i),show:!c.hidden,lockElement:c.lockElement});else if(c.subType===Ta.TEDU_BOARD_ELEMENT_MAGIC_LINE){var g=Is.createElement(this.instanceKey,u,{time:c.time,color:c.color,thin:c.thin,belongSeq:c.belongSeq,show:!c.hidden,visible:!(null!==(o=c.visible)&&void 0!==o&&!o),boardId:c.boardId,scaleX:c.scaleX,scaleY:c.scaleY,deg:c.deg,isClosed:c.isClosed,fitCurve:c.fitCurve,fitMode:c.fitMode,lockElement:c.lockElement});g.setBoardSize(this.boardWidth,this.boardHeight),g.setFitBorder(),this.tiwData.addElement(h,u,g),this.renderHandler.addToRenderMap(g.ID,new Ds(g))}else if(c.subType===Ta.TEDU_BOARD_ELEMENT_FORMULA){var m=new Sl(this.instanceKey,{belongSeq:c.belongSeq,user:c.uid,boardId:c.boardId,expression:c.expression,show:!c.hidden,visible:!(null!==(n=c.visible)&&void 0!==n&&!n),x:c.x,y:c.y,naturalWidth:c.naturalWidth,naturalHeight:c.naturalHeight,baseWidth:c.baseWidth,baseHeight:c.baseHeight,width:c.width,height:c.height,deg:c.deg,scaleX:c.scaleX,scaleY:c.scaleY,boardWidth:this.boardWidth,boardHeight:this.boardHeight,erasable:d,color:c.color,textSize:c.textSize,lockElement:c.lockElement},Va.History);this.tiwData.addElement(h,u,m),this.loadMathJax()}else if(c.subType===Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ARC){c.show=!c.hidden;var y=Ll.createElement(this.instanceKey,u,c);y.setBoardSize(this.boardWidth,this.boardHeight),y.setBorder(),this.tiwData.addElement(h,u,y),this.renderHandler.addToRenderMap(y.ID,new Rl(y))}else c.subType===Ta.TEDU_BOARD_ELEMENT_MATH_TOOL?(c.show=!c.hidden,this.addMathTool(c.toolType,{x:c.x,y:c.y,width:c.width,height:c.height,deg:c.deg,user:u,boardId:h,belongSeq:c.belongSeq,show:c.show,visible:!(null!==(a=c.visible)&&void 0!==a&&!a),zIndex:c.zIndex,baseAngle:c.baseAngle,testAngle:c.testAngle,compassesLegLength:c.compassesLegLength,compassesLegAnchorOffset:c.compassesLegAnchorOffset,compassesResizeBtnOffset:c.compassesResizeBtnOffset,compassesHeaderLength:c.compassesHeaderLength,boardWidth:this.boardWidth,boardHeight:this.boardHeight,brushColor:this.color,lineType:mn.TEDU_BOARD_LINE_TYPE_SOLID},!1)):c.subType===Ta.TEDU_BOARD_ELEMENT_WATERMARK&&this.addWatermarkElement(c.belongSeq,{belongSeq:c.belongSeq,userId:u,boardId:h,content:c.content,left:c.x,top:c.y,time:c.time,width:c.width,height:c.height,deg:c.deg,color:c.color,opacity:c.opacity,show:!c.hidden,visible:!(null!==(s=c.visible)&&void 0!==s&&!s),ratio:c.ratio,fix:c.fix,interval:c.interval,textSize:c.textSize,lockElement:c.lockElement},Va.History)},e.prototype.addHistoryLayerElement=function(t){var e,r=t.content,i=r.boardId,o=r.uid,n=!(!r.erasable&&!F(r.erasable));if(r.subType===Ha){var a=new vl(this.instanceKey,{user:r.uid,belongSeq:r.belongSeq,boardId:r.boardId,show:!r.hidden,visible:!(null!==(e=r.visible)&&void 0!==e&&!e),width:r.width,height:r.height,x:r.x,y:r.y,deg:r.deg,boardAttr:r.boardAttr,axisColor:r.axisColor,erasable:n,lockElement:r.lockElement},{store:{addRealtimeData:this.addRealtimeData.bind(this),getMathGraphType:this.getMathGraphType.bind(this),report:this.report,event:this.event}});this.tiwData.addElement(i,o,a)}else if(r.subType===Ga){var s=this.tiwData.getElementByElementId(String(r.jxgId));if(s)try{a=ll.createElement(this.seqUtil,hc({user:r.uid,belongSeq:r.belongSeq,seq:r.seq,boardId:r.boardId,show:!r.hidden,jxgId:r.jxgId,jxgBelongSeq:r.parentBelongSeq,id:r.id,type:r.type,expression:r.expression,label:r.label,withLabel:r.withLabel,showLabel:r.showLabel,isHighlighted:r.isHighlighted,isSelected:r.isSelected,color:r.color,hightlightedColor:r.hightlightedColor,selectedColor:r.selectedColor},r)),s.updateGraph(a)}catch(t){}}},e.prototype.addHistoryBoardRemark=function(t){this.setBoardRemark(t.content.boardId,t.content.remark,!1)},e.prototype.addHistoryDiscussionGroupSwitch=function(t){if(!(1*t.seq<this.maxHistoryGroupSeq)){var e=t.content.boardId;this.maxHistoryGroupSeq=t.seq,this.tiwData.isBoardExist(e)||this.addBoard(e,!1,It(e)),this.groupCurrentBoard=e,e===M.COMMON_DEFAULT_BOARD?this.discussionGroupCurrentGroup=M.COMMON_GROUP:this.discussionGroupCurrentGroup=e.match(/\d+_#\w+$/)[0].split("_")[1],this.settingConfig.setBoardRatio(this.getCurrentBoard(),this.getBoardRatio()),this.settingConfig.isDiscussionGroupMode&&this.event.fireSwitchFileEvent(this.discussionGroupCurrentGroup)}},e.prototype.addHistoryEnableDiscussionGroup=function(t){if(this.setDiscussionGroupEnable(t.content.enable,!1),this.settingConfig.isDiscussionGroupMode&&this.lastActiveGroupInHistoryData){var e=this.discussionGroupMap.getGroupInfoByGroupId(this.lastActiveGroupInHistoryData);this.addHistoryDiscussionGroupSwitch({content:{boardId:(null==e?void 0:e.currentBoardId)||M.COMMON_DEFAULT_BOARD},seq:t.seq})}},e.prototype.addHistoryDiscussionGroup=function(t){var e=t.content;if(e&&e.discussionGroupId&&e.boardIds&&e.userIds){this.addDiscussionGroup(e.discussionGroupId,e.boardIds,e.userIds,e.title,e.currentBoardId,!1);var r=this.getDiscussionGroupInfoById(e.discussionGroupId);r.setCurrentPage(e.currentPage||0),r.setCurrentStep(e.currentStep||0),this.discussionGroupMap.checkIfUserInGroup(e.discussionGroupId,this.identifier)&&(this.settingConfig.isDiscussionGroupMode?this.addHistoryDiscussionGroupSwitch({content:{boardId:e.currentBoardId||M.COMMON_DEFAULT_BOARD},seq:t.seq}):this.lastActiveGroupInHistoryData||(this.lastActiveGroupInHistoryData=e.discussionGroupId))}},e.prototype.addHistoryResetDiscussionGroup=function(){this.resetDiscussionGroup(!1)},e.prototype.undo=function(){this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"undo"})}},ea.ONLY_ONLINE),this.cancelSelect();var t=this.tiwData.getOperation(this.getCurrentBoard());t&&(t.type===rc.LINE?this.undoRedoHandlerForLine(t,"undo"):t.type===rc.ERASER?this.undoRedoHandlerForEraser(t,"undo"):t.type===rc.GRAPH?this.undoRedoHandlerForGraph(t,"undo"):t.type===rc.TEXT?this.undoRedoHandlerForInputText(t,"undo"):t.type===rc.MOVE?this.undoRedoHandlerForMove(t,"undo"):t.type===rc.DELETE?this.undoRedoHandlerForEraser(t,"undo"):t.type===rc.ELEMENT?this.undoRedoHandlerForElement(t,"undo"):t.type===rc.PIECEWISE_ERASER?this.undoRedoHandlerForPiecewiseEraser(t,"undo"):t.type===rc.ELEMENT_UPDATE?this.undoRedoHandlerForUpdateElement(t,"undo"):-100===t.type&&this.undoRedoHandlerForDisplayElement(t,"undo"),this.tiwData.undoOperation(this.getCurrentBoard()),this.setNeedDraw(!0),this.fireCanRedoAndUndo())},e.prototype.canUndo=function(){return this.tiwData.canUndo(this.getCurrentBoard())},e.prototype.redo=function(){this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"redo"})}},ea.ONLY_ONLINE),this.cancelSelect();var t=this.tiwData.getOperation(this.getCurrentBoard(),0);t&&(t.type===rc.LINE?this.undoRedoHandlerForLine(t,"redo"):t.type===rc.ERASER?this.undoRedoHandlerForEraser(t,"redo"):t.type===rc.GRAPH?this.undoRedoHandlerForGraph(t,"redo"):t.type===rc.TEXT?this.undoRedoHandlerForInputText(t,"redo"):t.type===rc.MOVE?this.undoRedoHandlerForMove(t,"redo"):t.type===rc.DELETE?this.undoRedoHandlerForEraser(t,"redo"):t.type===rc.ELEMENT?this.undoRedoHandlerForElement(t,"redo"):t.type===rc.PIECEWISE_ERASER?this.undoRedoHandlerForPiecewiseEraser(t,"redo"):t.type===rc.ELEMENT_UPDATE?this.undoRedoHandlerForUpdateElement(t,"redo"):-100===t.type&&this.undoRedoHandlerForDisplayElement(t,"redo"),this.tiwData.redoOperation(this.getCurrentBoard()),this.setNeedDraw(!0),this.fireCanRedoAndUndo())},e.prototype.canRedo=function(){return this.tiwData.canRedo(this.getCurrentBoard())},e.prototype.undoRedoHandlerForLine=function(t,e){var r="redo"===e,i=this.tiwData.getElementByElementId(t.seq);if(i){var o=r?Bo.DISPLAY:Bo.DELETE;i.setElementDisplay(o);var n=[{uid:t.user,seq:t.seq}];this.reportEraserData(this.getCurrentBoard(),n,o,!1,Xa.TEDU_BOARD_TOOL_TYPE_ERASER)}},e.prototype.undoRedoHandlerForDisplayElement=function(t,e){var r,i=this,o="undo"===e;r=t.hasOwnProperty("subType")?!!t.subType===o?Bo.HIDE:Bo.DISPLAY:o?Bo.DISPLAY:Bo.HIDE,t.seq.forEach((function(t){var e=i.tiwData.getElementByElementId(t.seq);e&&e.setElementDisplay(r)})),this.reportEraserData(this.getCurrentBoard(),t.seq,r,!1,Xa.TEDU_BOARD_TOOL_TYPE_ERASER)},e.prototype.undoRedoHandlerForEraser=function(t,e){var r=this,i="undo"===e?Bo.DISPLAY:Bo.DELETE;t.seq.forEach((function(t){var e=r.tiwData.getElementByElementId(t.seq);e&&e.setElementDisplay(i)})),this.reportEraserData(this.getCurrentBoard(),t.seq,i,!1,Xa.TEDU_BOARD_TOOL_TYPE_ERASER)},e.prototype.undoRedoHandlerForGraph=function(t,e){var r="redo"===e,i=this.tiwData.getElementByElementId(t.seq);if(i){var o=r?Bo.DISPLAY:Bo.DELETE;i.setElementDisplay(o);var n=[{uid:t.user,seq:t.seq}];this.reportEraserData(this.getCurrentBoard(),n,o,!1,Xa.TEDU_BOARD_TOOL_TYPE_ERASER)}},e.prototype.undoRedoHandlerForInputText=function(t,e){var r="redo"===e,i=this.tiwData.getElementByElementId(t.seq);if(i){var o=r?Bo.DISPLAY:Bo.DELETE;i.setElementDisplay(o);var n=[{uid:t.user,seq:t.seq}];this.reportEraserData(this.getCurrentBoard(),n,o,!1,Xa.TEDU_BOARD_TOOL_TYPE_ERASER)}},e.prototype.undoRedoHandlerForMove=function(t,e){var r=this,i=[],o=[],n=0,a=0,s=function(t,e){var i=t.getReportData();"element"===e?o.push({type:i.type,seq:r.seqUtil.getSeq(),content:i.property}):o.push({type:e,seq:r.seqUtil.getSeq(),content:i})};("undo"===e?t.seq.origin:t.seq.final).forEach((function(t){var e=t.uid,o=r.tiwData.getElementByElementId(t.seq);o&&("line"===o.type?(function(t,e,r){var o=t.getPoints();n=e.x-o[0].x,a=e.y-o[0].y,t.border.maxX+=n,t.border.minX+=n,t.border.maxY+=a,t.border.minY+=a,o.forEach((function(t){t.x+=n,t.y+=a})),t.scaleX=e.scaleX,t.scaleY=e.scaleY,t.deg=e.deg,t.setBorder(-1,-1,!1),i.push(hc(hc({},t.getData()),{uid:r,seq:e.seq}))}(o,t,e),s(o,"updateContent")):"graph"===o.type?(function(t,e,r){n=e.x-t.startPoint.x,a=e.y-t.startPoint.y,t.startPoint.x+=n,t.startPoint.y+=a,t.endPoint.x+=n,t.endPoint.y+=a,t.scaleX=e.scaleX,t.scaleY=e.scaleY,t.deg=e.deg,t.setBorder(),i.push(hc(hc({},t.getData()),{uid:r,seq:e.seq}))}(o,t,e),s(o,"updateContent")):"inputtext"===o.type?(function(t,e,r){t.location.x=e.x,t.location.y=e.y,t.scaleX=e.scaleX,t.scaleY=e.scaleY,t.deg=e.deg,t.setBorder(),i.push(hc(hc({},t.getData()),{uid:r,seq:e.seq}))}(o,t,e),s(o,"updateContent")):"imageElement"===o.type?(function(t,e,o){var n=r.getBoardScale()/e.boardScale;t.setRealSize(e.width*n,e.height*n),t.setPosition(e.left*n-t.left,e.top*n-t.top),t.setRotate(e.deg),i.push(hc(hc({},t.getRealTimeData()),{uid:o,seq:t.belongSeq}))}(o,t,e),s(o,"imageElement")):"element"===o.type&&(o.subType===Ta.TEDU_BOARD_ELEMENT_CUSTOM_GRAPH?(function(t,e,o){var n=r.getBoardScale()/e.boardScale;t.setRealSize(e.scaleX*n,e.scaleY*n),t.x=e.x,t.y=e.y,t.setRotate(e.deg),i.push(hc(hc({},t.getRealTimeData()),{uid:o,seq:t.belongSeq}))}(o,t,e),s(o,"element")):o.subType===Ta.TEDU_BOARD_ELEMENT_H5?(function(t,e,o){t.x=e.x,t.y=e.y;var n=r.getBoardScale()/e.boardScale;t.setRealSize(e.width*n,e.height*n),t.setRotate(e.deg),i.push(hc(hc({},t.getRealTimeData()),{uid:t.user,seq:t.belongSeq}))}(o,t),s(o,"element")):o.subType===Ta.TEDU_BOARD_ELEMENT_MAGIC_LINE?(function(t,e,r){if(n=e.x-t.x,a=e.y-t.y,"ellipse"===t.fitMode){var o=t.fitCurve[0];o.center.x+=n,o.center.y+=a}else t.fitCurve.forEach((function(t){t.x+=n,t.y+=a}));t.scaleX=e.scaleX,t.scaleY=e.scaleY,t.deg=e.deg,t.setFitBorder(),i.push(hc(hc({},t.getData()),{uid:r,seq:e.seq}))}(o,t,e),s(o,"element")):o.subType===Ta.TEDU_BOARD_ELEMENT_MATH_BOARD?(function(t,e,r){t.setRealSize(e.width,e.height),t.setPosition(e.left-t.left,e.top-t.top),t.setRotate(e.deg),i.push(hc(hc({},t.getRealTimeData()),{uid:r,seq:t.belongSeq}))}(o,t,e),s(o,"layer")):o.subType===Ta.TEDU_BOARD_ELEMENT_FORMULA&&(function(t,e,o){t.scaleX=e.scaleX,t.scaleY=e.scaleY;var n=r.getBoardScale()/e.boardScale;t.setRealSize(e.width*n,e.height*n),t.setPosition(e.left*n-t.left,e.top*n-t.top),t.setRotate(e.deg),i.push(hc(hc({},t.getRealTimeData()),{uid:o,seq:t.belongSeq}))}(o,t,e),s(o,"element"))))})),this.addRealtimeData({action:M.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),moves:i}),this.report.reportGraphData(o)},e.prototype.undoRedoHandlerForElement=function(t,e){var r="redo"===e,i=this.tiwData.getElementByElementId(t.seq);if(i){var o=r?Bo.DISPLAY:Bo.DELETE;i.setElementDisplay(o);var n=[{uid:t.user,seq:t.seq}];this.reportEraserData(this.getCurrentBoard(),n,o,!1,Xa.TEDU_BOARD_TOOL_TYPE_ERASER)}},e.prototype.undoRedoHandlerForPiecewiseEraser=function(t,e){var r=this,i="undo"===e,o=i?Bo.DISPLAY:Bo.DELETE;t.seq.origin.forEach((function(t){var e=r.tiwData.getElementByElementId(t.seq);e&&e.setElementDisplay(o)})),this.reportEraserData(this.getCurrentBoard(),t.seq.origin,o,!1,Xa.TEDU_BOARD_TOOL_TYPE_ERASER);var n=i?Bo.DELETE:Bo.DISPLAY;t.seq.final.forEach((function(t){var e=r.tiwData.getElementByElementId(t.seq);e&&e.setElementDisplay(n)})),this.reportEraserData(this.getCurrentBoard(),t.seq.final,n,!1,Xa.TEDU_BOARD_TOOL_TYPE_ERASER)},e.prototype.undoRedoHandlerForUpdateElement=function(t,e){var r=this,i="undo"===e?t.seq.origin:t.seq.final,o=[],n=[],a=!1;i.forEach((function(t){var e=t.seq,i=(t.uid,pc(t,["seq","uid"])),s=r.tiwData.getElementByElementId(e);s&&("boolean"==typeof i.lockElement&&(a=i.lockElement,n.push(e+"")),Object.assign(s,i),o.push(s.getElementOperatorReportData()))})),this.addRealtimeData({action:M.PROTOCOL_ACTION.BROADCAST_ELEMENT_STYLE,seq:this.seqUtil.getSeq(),attrs:i}),this.report.reportUpdateContent(o),n&&n.length&&this.event.fireElementLockedChanged(n,a)},e.prototype.syncHistoryData=function(){var t=this;this.logger.reportInfo(this.loggerModuleName,"syncHistoryData",{param:{}},ea.ONLY_NATIVE);var e=this,r=[],i=[],o=[],n=[],a=0,s=!1,l=function(c,h,u){var d=Wt.getTimeStamp();new Promise((function(r,i){t.request.getBoardData(c,(function(t,i){t.error_code?(e.logger.reportInfo(e.loggerModuleName,"getBoardData",{code:t.error_code,message:t.error_msg,cost:Wt.getTimeStamp()-d,param:{extraInfo:JSON.stringify(t)}},ea.ONLY_ONLINE),e.event.fireErrorEvent(Xt.TEDU_BOARD_ERROR_HISTORYDATA,"errorCode:".concat(t.error_code,",errorMessage:").concat(t.error_msg))):(e.logger.reportInfo(e.loggerModuleName,"getBoardData",{cost:Wt.getTimeStamp()-d,param:{extraInfo:JSON.stringify(t)}},ea.ONLY_ONLINE),r({res:t,oresp:i}))}),(function(t){i(t)}))})).then((function(c){var d=c.res,p=c.oresp,f=JSON.parse(p.config.data).first_time;p&&f&&(r=[],i=[],o=[],n=[],a=0,s=!1,e.clearBoard(t.getCurrentBoard(),!0,!1,!0),e.resetData());var g=d.board_data_list||[],m=t.getDrawingButNotReportData(t.getCurrentBoard());m&&g.push(m),g.forEach((function(a){if("switchBoard"===a.type){if(s)return;s=!0,e.faceData.push(a);var l=JSON.parse(a.content).fid;o=o.filter((function(t){return JSON.parse(t.content).fid!=l||(n.push(t),!1)})),t.renderFace(n,e.faceData,r)}else"setGlobalBG"===a.type?r.push(a):"addFile"===a.type?o.push(a):"notActiveBoards"===a.type?(JSON.parse(a.content)||[]).forEach((function(e){t.notActiveBoardsDataFlagMap[e]=!1})):s?i.push(a):e.faceData.push(a)})),f&&t.event.firstFrameRendered(),a++,!d.is_finish&&a<50?l(!1,h,u):h()})).catch((function(t){e.event.fireErrorEvent(Xt.TEDU_BOARD_ERROR_HISTORYDATA,t.message),e.logger.reportInfo(e.loggerModuleName,"getBoardData",{code:-3,message:t.message,cost:0,param:{extraInfo:JSON.stringify({stack:t.stack,message:t.message})}},ea.ONLY_ONLINE)}))};return new Promise((function(t,n){l(!0,(function(){s||(e.addHistory(r),i=i.concat(e.faceData),e.faceData=[]),e.addHistory(o),e.addHistory(i),e.fixBoardData(),e.sortBoard(),e.syncBoardSeq(),s||e.switchFile(e.getCurrentFile(),"",0,e.identifier),setTimeout((function(){e.event.fireHistoryDataSyncCompletedEvent()}),200)}))}))},e.prototype._syncHistory=function(t){var e=this,r=[],i=[],o=[],n=[],a=!1;this.clearBoard(this.getCurrentBoard(),!0,!1,!0),this.resetData(),(t.board_data_list||[]).forEach((function(t){if("switchBoard"===t.type){if(a)return;a=!0,e.faceData.push(t);var s=JSON.parse(t.content).fid;o=o.filter((function(t){return JSON.parse(t.content).fid!=s||(n.push(t),!1)})),e.renderFace(n,e.faceData,r)}else"setGlobalBG"===t.type?r.push(t):"addFile"===t.type?o.push(t):a?i.push(t):e.faceData.push(t)})),a||(this.addHistory(r),i=i.concat(this.faceData),this.faceData=[]),this.addHistory(o),this.addHistory(i),this.fixBoardData(),this.sortBoard(),this.syncBoardSeq()},e.prototype.renderFace=function(t,e,r){this.addHistory(r),this.addHistory(t),this.addHistory(e,{isRenderFace:!0})},e.prototype.fixBoardData=function(){var t=this;try{var e=[];this.getGroup().forEach((function(t){e.push(t.fid)}));var r=[];this.boardList.forEach((function(i,o){var n=Ot(i);n!=M.COMMON_GROUP&&-1===e.indexOf(n)&&(r.push(o),t.tiwData.removeElementsByBoardId(i,!1),t.tiwData.removeOperations(i),t.tiwData.removeBackground(i))})),r.sort((function(t,e){return e-t})),r.forEach((function(e){t.boardList.splice(e,1)}))}catch(t){}},e.prototype.sortBoard=function(){var t=this.getFileInfo();if(this.boardList=this.boardList.sort((function(t,e){var r=t===M.COMMON_DEFAULT_BOARD?0:t.match(/\d+_\d+_#\w+$/)[0].split("_")[0],i=e===M.COMMON_DEFAULT_BOARD?0:e.match(/\d+_\d+_#\w+$/)[0].split("_")[0];return r!=i?r-i:(t===M.COMMON_DEFAULT_BOARD?0:t.match(/\d+_#\w+$/)[0].split("_")[0])-(e===M.COMMON_DEFAULT_BOARD?0:e.match(/\d+_#\w+$/)[0].split("_")[0])})),t){if(t.boardSequenceList){var e=this.boardList.filter((function(t){return!t.includes("#DEFAULT")}));this.boardList=e.concat(t.boardSequenceList)}}else this.logger.reportError("Report","noFileInfo",{code:-1,message:"",param:{}},ea.ONLY_ONLINE)},e.prototype.syncBoardSeq=function(){if(1===this.boardList.length&&this.boardList[0]===M.COMMON_DEFAULT_BOARD)this.boardIdSeq=1;else if(this.boardList[this.boardList.length-1]){var t=0;this.boardList.forEach((function(e){var r=e.match(/\d+_#\w+$/);r&&r.length>0&&(t=Math.max(1*r[0].split("_")[0]+1,t))})),this.boardIdSeq=t}},e.prototype.sortGroup=function(){this.groups=this.groups.sort((function(t,e){return t.fid===M.COMMON_GROUP?-1:e.fid===M.COMMON_GROUP?1:+t.fid.replace(/\D*/,"")-+e.fid.replace(/\D*/,"")}))},e.prototype.addData=function(t){var e=this;if(this.checkOffline(),this.permissions){(t=JSON.parse(JSON.stringify(t)))&&this.addDataReport(t);var r=t.value.operator,o=t.value.actions,n=t.value.boardId;if(!this.manualRemoveBoard[n]&&!this.tiwData.isBoardExist(n))if(null==o?void 0:o[0].boardSequenceList){var a=null==o?void 0:o[0].boardSequenceList.findIndex((function(t){return t===n}));this.addBoard(n,!1,It(n),a,!0)}else this.addBoard(n,!1,It(n));var s=0,l=0,c=!1,h=[],u=[];o.forEach((function(t,a){if(n=t.toBoardId||t.boardId||n,!e.manualRemoveBoard[n])if(t.color&&(t.color=W(t.color)),e.seqFilter[t.seq+""])t.action===M.PROTOCOL_ACTION.LINE_START_ACTION||t.action===M.PROTOCOL_ACTION.LINE_MOVE_ACTION||t.action===M.PROTOCOL_ACTION.LINE_END_ACTION?++l:t.action!==M.PROTOCOL_ACTION.RASER_SHOW_ACTION&&t.action!==M.PROTOCOL_ACTION.RASER_HIDE_ACTION||++s;else switch(e.seqFilter[t.seq+""]=!0,t.action){case M.PROTOCOL_ACTION.BROADCAST_ELEMENT_STYLE:e.addDataHandlerElementStyleAction(t,n);break;case M.PROTOCOL_ACTION.MEDIA_PLAY_IN_PPT:e.addDataHandlerMediaPlayInPptAction(t);break;case M.PROTOCOL_ACTION.BROADCAST_SINGLE_BOARD_DATA:e.addDataHandlerForSingleBoardHistoryDataAction(t);break;case M.PROTOCOL_ACTION.LINE_START_ACTION:e.addDataHandlerForLineStartAction(t,n,r,a),++l;break;case M.PROTOCOL_ACTION.LINE_MOVE_ACTION:case M.PROTOCOL_ACTION.LINE_END_ACTION:var d=fc(e.addDataHandlerForLineMoveEndAction(t,n,r,a),2),p=d[0];d[1]&&!u.includes(p)&&u.push(p),++l;break;case M.PROTOCOL_ACTION.RASER_SHOW_ACTION:e.addDataHandlerForLaserShowAction(t,n,r,a),++s;break;case M.PROTOCOL_ACTION.RASER_HIDE_ACTION:e.addDataHandlerForLaserHideAction(t,n,r,a),++s;break;case M.PROTOCOL_ACTION.ERASER_ACTION:e.addDataHandlerForEraserAction(t,n,(function(t){h=h.concat(t)}));break;case M.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION:e.addDataHandlerForMoveLineGraphAction(t,n,r,a);break;case M.PROTOCOL_ACTION.GRAPH_LINE_ACTION:case M.PROTOCOL_ACTION.GRAPH_CIRCLE_ACTION:case M.PROTOCOL_ACTION.GRAPH_RECT_ACTION:case M.PROTOCOL_ACTION.GRAPH_RIGHT_TRIANGLE_ACTION:case M.PROTOCOL_ACTION.GRAPH_ISOSCELES_TRIANGLE_ACTION:case M.PROTOCOL_ACTION.GRAPH_PARALLELOPGRAM_ACTION:case M.PROTOCOL_ACTION.GRAPH_CUBE_ACTION:case M.PROTOCOL_ACTION.GRAPH_CYLINDER_ACTION:case M.PROTOCOL_ACTION.GRAPH_CONE_ACTION:case M.PROTOCOL_ACTION.GRAPH_COORDINATE_ACTION:e.addDataHandlerForGraphAction(t,n,r,a);break;case M.PROTOCOL_ACTION.REALTIME_SYNC_GRAPH_ACTION:e.addDataHandlerForRealtimeSyncGraphAction(t,n,r,a);break;case M.PROTOCOL_ACTION.INPUT_TEXT_ACTION:e.addDataHandlerForInputTextAction(t,n,r,a,(function(){1===o.length&&(c=!0)}));break;case M.PROTOCOL_ACTION.IMAGE_ELEMENT:e.addDataHandlerForImageElementAction(t,n,r,a);break;case M.PROTOCOL_ACTION.GRAPH_CLEAR_ALL_ACTION:e.addDataHandlerForGraphClearAllAction(t);break;case M.PROTOCOL_ACTION.GRAPH_CLEAR_ACTION:e.addDataHandlerForGraphClearAction(t);break;case M.PROTOCOL_ACTION.FILE_CLEAR_ACTION:e.addDataHandlerForFileClearAction(t);break;case M.PROTOCOL_ACTION.RESET_DATA_ACTION:e.addDataHandlerForResetDataAction();break;case M.PROTOCOL_ACTION.SET_BOARD_RATIO_ACTION:e.addDataHandlerForSetBoardRatioAction(t,n);break;case M.PROTOCOL_ACTION.SET_BOARD_REMARK_ACTION:e.addDataHandlerForSetBoardRemarkAction(t,n);break;case M.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION:e.addDataHandlerForUpdateBackgroundImageAction(t,n);break;case M.PROTOCOL_ACTION.DELETE_BG_IMG_ACTION:e.addDataHandlerForDeleteBackgroundImageAction(n);break;case M.PROTOCOL_ACTION.UPDATE_BG_COLOR_ACTION:e.addDataHandlerForUpdateBackgroundColorAction(t);break;case M.PROTOCOL_ACTION.BOARD_MOVE_SCALE_ACTION:e.addDataHandlerForBoardMoveScaleAction(t,n);break;case M.PROTOCOL_ACTION.FILE_SCALE_ACTION:e.addDataHandlerForFileScaleAction(t,r);break;case M.PROTOCOL_ACTION.SWITCH_ACTION:e.addDataHandlerForSwitchAction(t,r);break;case M.PROTOCOL_ACTION.ADD_FILE_ACTION:e.addDataHandlerForAddFileAction(t.file,r);break;case M.PROTOCOL_ACTION.PPT_EVENT_ACTION:e.addDataHandlerForPptEventAction(t);break;case M.PROTOCOL_ACTION.WPS_EVENT_ACTION:e.addDataHandlerForWpsEventAction(t);break;case M.PROTOCOL_ACTION.VIDEO_EVENT_ACTION:e.addDataHandlerForVideoEventAction(t);break;case M.PROTOCOL_ACTION.H5Web_ELEMENT:e.addDataHandlerForH5WebElementAction(t,n,r);break;case M.PROTOCOL_ACTION.H5WEB_EVENT_ACTION:e.addDataHandlerForH5WebEventAction(t);break;case M.PROTOCOL_ACTION.FILE_MESSAGE_ACTION:e.addDataHandlerForFileMessageAction(t);break;case M.PROTOCOL_ACTION.CUSTOM_GRAPH_ELEMENT:e.addDataHandlerForCustomGraphAction(t,n,r);break;case M.PROTOCOL_ACTION.AUDIO_ELEMENT:case M.PROTOCOL_ACTION.GLOBAL_AUDIO_ELEMENT:e.addDataHandlerForAudioElementAction(t,n,r,(function(t){h=h.concat(t)}));break;case M.PROTOCOL_ACTION.JSXGRAPH_BOARD_ELEMENT:e.addDataHandlerForJsxgraphBoardElementAction(t,n,r);break;case M.PROTOCOL_ACTION.JSXGRAPH_GRAPH_ELEMENT:e.addDataHandlerForJsxgraphGraphElementAction(t,n,r);break;case M.PROTOCOL_ACTION.USERINFO_EVENT_ACTION:e.addDataHandlerForUserInfoEventAction(t,n,r);break;case M.PROTOCOL_ACTION.MAGIC_LINE_ELEMENT:e.addDataHandlerForMagicLineElementAction(t,n,r);break;case M.PROTOCOL_ACTION.FORMULA_ELEMENT:e.addDataHandlerForFormulaElementAction(t,n,r);break;case M.PROTOCOL_ACTION.DISCUSSION_GROUP_SWITCH_ACTION:e.addDataHandlerForDiscussionGroupSwitchAction(t,r);break;case M.PROTOCOL_ACTION.DISCUSSION_GROUP_SETTING_ACTION:e.addDataHandlerForDiscussionGroupSettingAction(t,n,r);break;case M.PROTOCOL_ACTION.POINT_ERASER_ACTION:e.addDataHandlerForPointEraserAction(t,n,r);break;case M.PROTOCOL_ACTION.SPLIT_LINE_ACTION:e.addDataHandlerForSplitLineAction(t,n,r);break;case M.PROTOCOL_ACTION.GRAPH_ARC_ELEMENT:e.addDataHandlerForGraphArcAction(t,n,r);break;case M.PROTOCOL_ACTION.MATH_TOOL_ACTION:e.addDataHandlerForMathToolAction(t,n,r);break;case M.PROTOCOL_ACTION.WATERMARK_ACTION:e.addDataHandlerForWatermarkAction(t,n,r);break;case M.PROTOCOL_ACTION.BROADCAST_LINUX_FORCEREFRESH:"Linux"===i.getPlatform()&&(e.event.fireLinuxRefreshEvent(),e.logger.reportInfo(e.loggerModuleName,"receive_force_refresh",{param:{extraInfo:JSON.stringify({platform:"linux"})}},ea.ONLY_ONLINE))}})),s===o.length||l===o.length||s+l===o.length||c||this.setNeedDraw(!0),u.forEach((function(t){t.sort(!0)})),u.length&&this.setPartDraw(!0),h.length&&this.event.fireRemoveElementEvent(h)}},e.prototype.addDataReport=function(t){try{var e=[6,7],r=t.value.actions.filter((function(t){return-1===e.indexOf(t.action)}));r.length&&this.logger.reportInfo(this.loggerModuleName,"addData",{param:{boardId:this.getCurrentBoard(),extraInfo:JSON.stringify({seq:t.seq,timestamp:t.timestamp,value:{boardId:t.value.boardId,operator:t.value.operator,actions:r}})}},ea.ONLY_ONLINE)}catch(t){}},e.prototype.addDataHandlerElementStyleAction=function(t,e){var r=this;if((1*t.seq||0)>this.maxGraffitiAttrUpdateSeq){this.maxGraffitiAttrUpdateSeq=t.seq;var i=[],o=!1;t.attrs.forEach((function(t){var e=t.seq,n=(t.uid,pc(t,["seq","uid"])),a=r.tiwData.getElementByElementId(e);a&&(Object.assign(a,n),a.setBorder(),F(n.lockElement)||(i.push(e),o=n.lockElement))})),i.length&&this.event.fireElementLockedChanged(i,o)}else this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxGraffitiAttrUpdateSeq:this.maxGraffitiAttrUpdateSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE)},e.prototype.addDataHandlerMediaPlayInPptAction=function(t){jn.pptMediaAction(this.iframeDom,this.seqUtil.getSeq(),t.data)},e.prototype.addDataHandlerForSingleBoardHistoryDataAction=function(t){this.analySingleBoardHistoryBoardData(t.dataRes,t.boardId)},e.prototype.analySingleBoardHistoryBoardData=function(t,e){var r=[],i=[],o=[];t&&(r=[],i=[],o=[]);var n=t.board_data_list||[],a=this.getDrawingButNotReportData(this.getCurrentBoard());a&&n.push(a),n.forEach((function(t){t.type&&("setGlobalBG"===t.type?r.push(t):"addFile"===t.type?o.push(t):i.push(t))})),this.addHistory(r),this.addHistory(o),this.addHistory(i),this.fixBoardData(),this.sortBoard(),this.syncBoardSeq(),this.notActiveBoardsDataFlagMap[e]=!0},e.prototype.addDataHandlerForLineStartAction=function(t,e,r,i){this.checkLoseLineTask.stopTask(t.belongSeq);var o=this.findLine(e,r,t.belongSeq);if(o){o.writing=t.writing,o.color=t.color,o.thin=t.thin,o.highlighter=t.highlighter,o.show=!0,o.visible=!0;var n={action:t.action,x:t.x,y:t.y,w:t.w||t.thin,belongSeq:t.belongSeq,seq:t.seq,timestamp:t.timestamp,originSeq:t.seq};o.addPoint(n),o.sort(),o.setBorder(t.x,t.y),this.setPartDraw(!0)}else t.originBelongSeq=t.belongSeq,t.originSeq=t.belongSeq,(o=fs.createElement(this.instanceKey,r,t,t.version)).show=!0,o.visible=!0,o.setBoardSize(this.boardWidth,this.boardHeight),o.setBorder(t.x,t.y),this.renderHandler.addToRenderMap(o.ID,new ms(o)),this.tiwData.addElement(e,r,o),this.seqLineMap[o.belongSeq]=o;o.touchId=t.touchId||M.MOUSE_TOUCH_ID,this.remoteUserTitleStyle[r]={title:t.title,style:t.style};var a={action:this._setLaserVisibleInDiscussionModeEnable(r,"drawing",1),color:t.color,radius:t.thin,x:t.x,y:t.y,timestamp:t.timestamp,seq:t.seq,toolType:1,touchId:t.touchId||M.MOUSE_TOUCH_ID};this._buildRaserData(i,r,a,!0),this.autoHideRemoteCursor(i,r,hc(hc({},a),{action:M.PROTOCOL_ACTION.RASER_HIDE_ACTION})),t.timestamp?t.highlighter?(o.drawIndex=o.getPoints().length,this.setNeedDraw(!0)):this.setIncreasingDraw(!0):this.setPartDraw(!0)},e.prototype.addDataHandlerForLineMoveEndAction=function(t,e,r,i){var o=this,n=!1,a=this.findLine(e,r,t.belongSeq);if(a){var s={action:t.action,x:t.x,y:t.y,w:t.w||t.thin,seq:t.seq,timestamp:t.timestamp,originSeq:t.seq},l=a.getPoints(),c=l.length;if(t.midPoint&&(a.addPoint(t.midPoint),c>=1)){var h=l[c-1];t.seq<h.seq&&(n=!0)}c=l.length,a.addPoint(s),c>=1&&(h=l[c-1],t.seq<h.seq&&(n=!0)),a.setBorder(t.x,t.y)}else{if(t.midPoint){var u=t.midPoint,d={action:t.action,x:t.x,y:t.y,w:t.w,seq:t.seq,timestamp:t.timestamp,originSeq:t.seq};t.action=u.action,t.x=u.x,t.y=u.y,t.w=u.w,t.seq=u.seq,t.timestamp=u.timestamp,(a=fs.createElement(this.instanceKey,r,t,t.version)).setBoardSize(this.boardWidth,this.boardHeight),a.setBorder(t.x,t.y),a.addPoint(d),a.setBorder(d.x,d.y)}else(a=fs.createElement(this.instanceKey,r,t,t.version)).setBoardSize(this.boardWidth,this.boardHeight),a.setBorder(t.x,t.y);this.renderHandler.addToRenderMap(a.ID,new ms(a)),this.tiwData.addElement(e,r,a),this.seqLineMap[a.belongSeq]=a,a.touchId=t.touchId||M.MOUSE_TOUCH_ID,this.checkLoseLineTask.startTask(t.belongSeq,(function(t){var e=o.seqLineMap[t],r=!0;if(e){for(var i=e.getPoints(),n=0,a=i.length;n<a;n++)if(1===i[n].action){r=!1;break}r&&o.event.fireWarningEvent($.TEDU_BOARD_WARNING_GRAFFITI_LOST,"graffiti lost")}}))}t.action===M.PROTOCOL_ACTION.LINE_END_ACTION&&(a.endSeq=t.seq,function(t,e){setTimeout((function(){t.color&&t.thin||o.request.getLineData({boardId:e,owner:t.user,seq:t.belongSeq},(function(t){t.error_code||t.content&&t.type&&(o.addHistory([{content:t.content,type:t.type}]),o.sortBoard(),o.syncBoardSeq(),o.setNeedDraw(!0))}))}),500)}(a,e));var p={action:this._setLaserVisibleInDiscussionModeEnable(r,"drawing",1),color:a.color,radius:t.thin,x:t.x,y:t.y,timestamp:t.timestamp,seq:t.seq,toolType:1,touchId:t.touchId||M.MOUSE_TOUCH_ID};return this._buildRaserData(i,r,p,!0),this.autoHideRemoteCursor(i,r,hc(hc({},p),{action:M.PROTOCOL_ACTION.RASER_HIDE_ACTION})),t.timestamp?t.highlighter?(a.drawIndex=a.getPoints().length,this.setNeedDraw(!0)):this.setIncreasingDraw(!0):this.setPartDraw(!0),[a,n]},e.prototype.addDataHandlerForLaserShowAction=function(t,e,r,i){t.toolType===Xa.TEDU_BOARD_TOOL_TYPE_PEN&&this.lineTransparent||(t.action=this._setLaserVisibleInDiscussionModeEnable(r,"moving",t.toolType),t.title&&t.style&&(this.remoteUserTitleStyle[r]={title:t.title,style:t.style}),this._buildRaserData(i,r,t),t.toolType===Xa.TEDU_BOARD_TOOL_TYPE_PEN&&this.autoHideRemoteCursor(i,r,hc(hc({},t),{action:M.PROTOCOL_ACTION.RASER_HIDE_ACTION})))},e.prototype.addDataHandlerForLaserHideAction=function(t,e,r,i){this._buildRaserData(i,r,t)},e.prototype.addDataHandlerForEraserAction=function(t,e,r){var i=this;if(t.lines){var o=[];t.lines.forEach((function(r){var n=r.seq+"",a=i.splitLineData.get(n)||null;if(a){var s={};a.forEach((function(t){var e=t.lineModel;s[e.belongSeq]=!0,e.show=!1})),i.tiwData.removeElementsByFilter(e,r.uid,(function(t){return!s[t]})),i.splitLineData.delete(n)}for(var l=i.tiwData.getElementsByUserId(e,r.uid),c=0;c<l.length;c++){var h=l[c];null!=h&&(h.belongSeq||h.startPoint&&h.startPoint.seq||h.startSeq||0)===r.seq&&(void 0===t.visible?t.display?h.setElementDisplay(Bo.DISPLAY):(h.setElementDisplay(Bo.DELETE),"element"===h.type&&o.push(String(h.belongSeq))):1===t.visible&&1===t.display?h.setElementDisplay(Bo.DISPLAY):0===t.visible&&0===t.display?h.setElementDisplay(Bo.HIDE):1===t.visible&&0===t.display&&h.setElementDisplay(Bo.DELETE))}})),r(o)}},e.prototype.addDataHandlerForMoveLineGraphAction=function(t,e,r,i){var o=this;if(t.moves){var n=0,a=0,s=this.selectedList.length,l=[],c=[],h=function(t){c.push(t),o.selectedList=o.selectedList.filter((function(e){return e.type!==t.type||e.belongSeq!==t.belongSeq||(l.push({type:e.type,seq:e.belongSeq}),!1)}))};if((1*t.seq||0)>this.maxGraffitiMoveSeq){if(this.maxGraffitiMoveSeq=t.seq,t.moves.forEach((function(t){var e,r,i,s=o.tiwData.getElementByElementId(t.seq);s&&("line"===s.type?(r=t,i=(e=s).getPoints(),n=r.x-i[0].x,a=r.y-i[0].y,e.border.maxX+=n,e.border.minX+=n,e.border.maxY+=a,e.border.minY+=a,i.forEach((function(t){t.x+=n,t.y+=a})),e.scaleX=r.scaleX||1,e.scaleY=r.scaleY||1,e.deg=r.deg||0,e.setBorder(-1,-1,!1),h(s)):"graph"===s.type?(function(t,e){n=e.x-t.startPoint.x,a=e.y-t.startPoint.y,t.startPoint.x+=n,t.startPoint.y+=a,t.endPoint.x+=n,t.endPoint.y+=a,t.scaleX=e.scaleX||1,t.scaleY=e.scaleY||1,t.deg=e.deg||0,t.setBorder()}(s,t),h(s)):"inputtext"===s.type?(function(t,e){t.location.x=e.x,t.location.y=e.y,t.scaleX=e.scaleX||1,t.scaleY=e.scaleY||1,t.deg=e.deg||0,t.setBorder()}(s,t),h(s)):"imageElement"===s.type?(function(t,e){t.seq=e.seq,t.width=e.width,t.height=e.height,t.x=e.x,t.y=e.y,t.show=e.show,t.deg=e.deg}(s,t),h(s)):"element"===s.type&&(s.subType===Ta.TEDU_BOARD_ELEMENT_CUSTOM_GRAPH?(function(t,e){t.show=e.show,t.x=e.x,t.y=e.y,t.deg=e.deg,t.boardWidth=o.boardWidth,t.boardHeight=o.boardHeight,t.naturalWidth=e.naturalWidth,t.naturalHeight=e.naturalHeight,t.setScaleXY(e.scaleX,e.scaleY)}(s,t),h(s)):s.subType===Ta.TEDU_BOARD_ELEMENT_H5?(function(t,e){t.show=e.show,t.x=e.x,t.y=e.y,t.deg=e.deg,t.erasable=e.erasable,t.width=e.width,t.height=e.height}(s,t),h(s)):s.subType===Ta.TEDU_BOARD_ELEMENT_MAGIC_LINE?(function(t,e){if(n=e.x-t.x,a=e.y-t.y,"ellipse"===t.fitMode){var r=t.fitCurve[0];r.center.x+=n,r.center.y+=a}else t.fitCurve.forEach((function(t){t.x+=n,t.y+=a}));t.scaleX=e.scaleX,t.scaleY=e.scaleY,t.deg=e.deg,t.setFitBorder()}(s,t),h(s)):s.subType===Ta.TEDU_BOARD_ELEMENT_MATH_BOARD?(function(t,e){t.seq=e.seq,t.x=e.x,t.y=e.y,t.show=e.show,t.deg=e.deg,t.setRealSize(e.width/1e4*o.boardWidth,e.height/1e4*o.boardHeight)}(s,t),h(s)):s.subType===Ta.TEDU_BOARD_ELEMENT_FORMULA?(function(t,e){t.seq=e.seq,t.x=e.x,t.y=e.y,t.show=e.show,t.deg=e.deg,t.scaleX=e.scaleX,t.scaleY=e.scaleY,t.deg=e.deg,t.width=e.width,t.height=e.height}(s,t),h(s)):s.subType===Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ARC&&(function(t,e){n=e.x-t.center.x,a=e.y-t.center.y,t.startPoint.x+=n,t.startPoint.y+=a,t.center.x+=n,t.center.y+=a,t.scaleX=e.scaleX||1,t.scaleY=e.scaleY||1,t.deg=e.deg||0,t.setBorder()}(s,t),h(s))))})),c.length&&(this.remoteSelectedListMap[r]=c),s!==this.selectedList.length){if(1===this.selectedList.length){var u=this.toolTypeTitleStyleMap[Xa.TEDU_BOARD_TOOL_TYPE_RECT_SELECT];u&&(u.title=this.getUserInfo(this.selectedList[0].user,"nickname"))}this.logger.reportInfo(this.loggerModuleName,"selected_area_change",{param:{extraInfo:JSON.stringify({oldLen:s,newLen:this.selectedList.length,removeItem:l,boardId:e})}},ea.ONLY_ONLINE),this.setNeedDraw(!0)}}else this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxAddTextSeq:this.maxGraffitiMoveSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE)}},e.prototype.addDataHandlerForGraphAction=function(t,e,r,i){this.maxGraphElementSeq[r]=t.seq;var o=this.findGraph(e,r,t);o?(o.isFinish=!0,this._buildRealtimeGraphData(o,t,r,i,!1)):this._buildGraphData(t,r,e,!0)},e.prototype.addDataHandlerForRealtimeSyncGraphAction=function(t,e,r,i){var o=this.maxGraphElementSeq[r]||0;if((1*t.seq||0)<o)this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxGraphElementSeq:this.maxGraphElementSeq[r],boardId:e,method:"addData"})}},ea.ONLY_ONLINE);else{this.maxGraphElementSeq[r]=t.seq,t.action=t.subAction;var n=this.findGraph(e,r,t);n?n.isFinish||this._buildRealtimeGraphData(n,t,r,i,!0):this._buildGraphData(t,r,e,!1)}},e.prototype._buildRealtimeGraphData=function(t,e,r,i,o){var n=t.startPoint.seq;this.graphDataMap[r]||(this.graphDataMap[r]={}),this.graphDataMap[r][n]||(this.graphDataMap[r][n]=[]);var a=this.graphDataMap[r][n],s=0;for(s=a.length-1;s>=0&&!(a[s].seq<e.seq);s--);var l={action:o?M.PROTOCOL_ACTION.RASER_SHOW_ACTION:M.PROTOCOL_ACTION.RASER_HIDE_ACTION,color:e.color,radius:e.thin,x:(e.syncPosition||e.endPoint).x,y:(e.syncPosition||e.endPoint).y,timestamp:e.timestamp,seq:e.seq,toolType:Xa["TEDU_BOARD_TOOL_TYPE_".concat(t.graph.toUpperCase().replace("-","_"))],title:e.toolTitle,style:e.toolStyle};a.splice(s,0,{seq:e.seq,endPoint:e.endPoint,startPoint:e.beginPoint,user:r,laser:l}),this._buildRaserData(i,r,l,!1,!0)},e.prototype._buildGraphData=function(t,e,r,i){var o,n=((o={})[M.PROTOCOL_ACTION.GRAPH_LINE_ACTION]="line",o[M.PROTOCOL_ACTION.GRAPH_CIRCLE_ACTION]="oval",o[M.PROTOCOL_ACTION.GRAPH_RECT_ACTION]="rect",o[M.PROTOCOL_ACTION.GRAPH_RIGHT_TRIANGLE_ACTION]="right-triangle",o[M.PROTOCOL_ACTION.GRAPH_ISOSCELES_TRIANGLE_ACTION]="isosceles-triangle",o[M.PROTOCOL_ACTION.GRAPH_PARALLELOPGRAM_ACTION]="parallelogram",o[M.PROTOCOL_ACTION.GRAPH_CUBE_ACTION]="cube",o[M.PROTOCOL_ACTION.GRAPH_CYLINDER_ACTION]="cylinder",o[M.PROTOCOL_ACTION.GRAPH_CONE_ACTION]="cone",o[M.PROTOCOL_ACTION.GRAPH_COORDINATE_ACTION]="coordinate",o);t.graph=n[t.action],t.solid=!!t.fillRect,t.show=!0,t.visible=!0;var a=ss.createElement(this.instanceKey,e,t);a.isFinish=i,a.setBoardSize(this.boardWidth,this.boardHeight),a.setBorder();var s=qn.createElement(a);this.renderHandler.addToRenderMap(a.ID,s),this.tiwData.addElement(r,e,a)},e.prototype.addDataHandlerForInputTextAction=function(t,e,r,i,o){var n;if(this.maxAddTextSeq=(null===(n=this.maxAddTextSeqMap[r])||void 0===n?void 0:n[e])||0,(1*t.seq||0)>this.maxAddTextSeq){this.maxAddTextSeqMap[r]||(this.maxAddTextSeqMap[r]={}),this.maxAddTextSeqMap[r][e]=t.seq;for(var a=null,s=this.tiwData.getElementsByBoardId(e),l=0;l<s.length;l++){var c=s[l];if(c.belongSeq===t.belongSeq){t.seq>c.seq&&(c.seq=t.seq),a=c;break}}a?a.text===unescape(decodeURI(t.text))&&a.textWidth===t.textWidth&&a.textHeight===t.textHeight&&a.color===t.color&&a.typeFace===t.typeFace&&a.textSize===t.textSize&&a.fontStyle===t.fontStyle?o():(a.text=unescape(decodeURI(t.text)),a.textWidth=t.textWidth,a.textHeight=t.textHeight,a.color=t.color,a.scale=t.scale,a.typeFace=t.typeFace,a.textSize=t.textSize,a.fontStyle=t.fontStyle,a.setBorder()):((a=new Wa(this.instanceKey,{x:t.x,y:t.y,belongSeq:t.belongSeq,user:r,boardId:t.boardId,scaleX:t.scaleX,scaleY:t.scaleY,deg:t.deg,show:!0,visible:!0,lockElement:t.lockElement})).setBoardSize(this.boardWidth,this.boardHeight),a.color=t.color,a.scale=t.scale,a.typeFace=t.typeFace,a.textSize=t.textSize,a.fontStyle=t.fontStyle,a.lineHeight=t.lineHeight,a.time=t.time,a.text=unescape(decodeURI(t.text)),a.textWidth=t.textWidth,a.textHeight=t.textHeight,a.setBorder(),this.tiwData.addElement(e,r,a))}else this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxAddTextSeq:this.maxAddTextSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE)},e.prototype.addDataHandlerForImageElementAction=function(t,e,r,i){var o;if((1*t.seq||0)<this.maxImageElementSeq)this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxImageElementSeq:this.maxImageElementSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE);else{this.maxImageElementSeq=t.seq;var n=this.tiwData.getElementByElementId(t.belongSeq);if(n)n.seq=t.seq,n.width=t.width,n.height=t.height,n.x=t.x,n.y=t.y,n.show=t.show,n.deg=t.deg;else{var a=L.historyRealtimeDataReplaceAssetsProtocol(t.url),s=!(!t.erasable&&!F(t.erasable));n=new ma(this.instanceKey,{user:r,url:a,belongSeq:t.belongSeq,time:t.time,width:t.width,height:t.height,x:t.x,y:t.y,boardId:e,show:t.show,visible:null===(o=t.visible)||void 0===o||o,deg:t.deg,erasable:s,exifData:t.exifData,lockElement:t.lockElement},{store:{getDomainMap:this.getDomainMap.bind(this),getAccessibleDomains:this.getAccessibleDomains.bind(this),addAccessibleDomain:this.addAccessibleDomain.bind(this),getImageTimeout:this.getImageTimeout.bind(this),networkSniffer:this.networkSniffer.bind(this)}}),this.tiwData.addElement(e,r,n)}}},e.prototype.addDataHandlerForGraphClearAllAction=function(t){this.clearBoard(t.boardId,!0,!1,!0)},e.prototype.addDataHandlerForGraphClearAction=function(t){this.clearBoard(t.boardId,!1,!1,!0)},e.prototype.addDataHandlerForFileClearAction=function(t){try{this.clearFileDrawData(t.fids)}catch(t){}},e.prototype.addDataHandlerForResetDataAction=function(){var t=document.querySelector("#".concat(this.options.id));if(t){var e=t.querySelector(".tic_board_textbox"),r=t.querySelector(".tic_board__imagewrap"),i=t.querySelector(".tiw_board_webview_wrap");e&&(e.innerHTML=""),r&&(r.innerHTML=""),i&&(i.innerHTML="")}this.removeAllElement(),this.resetData()},e.prototype.addDataHandlerForSetBoardRatioAction=function(t,e){this.setBoardRatio(e,t.ratio,!1)},e.prototype.addDataHandlerForSetBoardRemarkAction=function(t,e){(1*t.seq||0)<this.maxBoardRemarkSeq?this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxBoardRemarkSeq:this.maxBoardRemarkSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE):(this.maxBoardRemarkSeq=t.seq,this.setBoardRemark(e,t.remark,!1))},e.prototype.addDataHandlerForUpdateBackgroundImageAction=function(t,e){var r=t.url,i=t.type,o=t.angle,n=t.mode,a=t.isGlobal,s=t.boardSequenceList;a?this.setGlobalBackgroundPic(r,n,i,!0):this.addBackgroundPic({boardIds:e,urls:r,type:i,angle:o,needReport:!1,position:n,boardSequenceList:s})},e.prototype.addDataHandlerForDeleteBackgroundImageAction=function(t){this.deleteBackgroundPic(t)},e.prototype.addDataHandlerForUpdateBackgroundColorAction=function(t){t.color&&(t.color=Y(t.color)),t.isGlobal?this.setGlobalBackgroundColor(t.color,!0):this.setBackgroundColor(t.color,!0)},e.prototype.addDataHandlerForBoardMoveScaleAction=function(t,e){if((1*t.seq||0)>this.maxMoveSeq){this.maxMoveSeq=t.seq;var r=this.dragDataList.getDragData(e);r?this.dragDataList.updateDragData(e,{scale:t.scale,xOffset:t.xOffset,yOffset:t.yOffset}):(r=new Kn(this.seqUtil,{scale:t.scale,xOffset:t.xOffset,yOffset:t.yOffset}),this.dragDataList.addDragData(e,r)),this.dragDataList.addMaxSeqDragData(this.dragDataList.getDragData(e)),this.event.fireZoomDragStatusEvent({fid:Ot(e),scale:t.scale,xOffset:t.xOffset,yOffset:t.yOffset})}else this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxMoveSeq:this.maxMoveSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE)},e.prototype.addDataHandlerForFileScaleAction=function(t,e){this.resolveFileScaleAction(t,e)},e.prototype.addDataHandlerForSwitchAction=function(t,e){this.resolveSwitchBoardAction(t,e)},e.prototype.addDataHandlerForAddFileAction=function(t,e){this.resolveAddFileAction(t,e)},e.prototype.addDataHandlerForPptEventAction=function(t){jn.pptAction(this.iframeDom,this.seqUtil.getSeq(),t.data)},e.prototype.addDataHandlerForWpsEventAction=function(t){if(bs.instance){var e=t.data.type;if("triggerPlayEvent"===e){var r=t.data,i=r.targetShapeId,o=r.slideCategory,n=r.steps;bs.instance.playTriggerAnim(i,o,n,!0)}else if("slideMediaChanged"===e){var a=t.data,s=a.id,l=a.currentTime,c=a.isMediaPlay,h=a.isFullScreen;bs.instance.setMediaObject({id:s,currentTime:l,isMediaPlay:c,isFullScreen:h},!0)}}},e.prototype.addDataHandlerForVideoEventAction=function(t){this.resolveUpdateVideoAction(t)},e.prototype.addDataHandlerForH5WebElementAction=function(t,e,r){var i,o=!(!t.erasable&&!F(t.erasable)),n=t.belongSeq+"",a=this.maxH5webElementSeq.get(n)||0;if((1*t.seq||0)<a)this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxH5webElementSeq:a,boardId:e,method:"addData"})}},ea.ONLY_ONLINE);else{this.maxH5webElementSeq.set(n,t.seq);var s=this.tiwData.getElementByElementId(n);s||(s=new xa(this.instanceKey,{belongSeq:t.belongSeq,boardId:t.boardId,user:r,url:t.url,erasable:o,deg:t.deg,lockElement:t.lockElement}),this.tiwData.addElement(e,r,s)),s.setProperty({show:t.show,visible:null===(i=t.visible)||void 0===i||i,width:t.width,height:t.height,x:t.x,y:t.y,data:t.data,erasable:o,deg:t.deg})}},e.prototype.addDataHandlerForH5WebEventAction=function(t){var e=this.tiwData.getElementByElementId(String(t.belongSeq));e&&(e.updateData(t.data),e.postMessage(t.data))},e.prototype.addDataHandlerForFileMessageAction=function(t){this.resolveFileMessage(t)},e.prototype.addDataHandlerForCustomGraphAction=function(t,e,r){var i,o;if(!((1*t.seq||0)<this.maxCustomGraphElementSeq)){this.maxCustomGraphElementSeq=t.seq;var n=!(!t.erasable&&!F(t.erasable)),a=this.tiwData.getElementByElementId(String(t.belongSeq));a?(a.show=t.show,a.visible=null===(o=t.visible)||void 0===o||o,a.x=t.x,a.y=t.y,a.deg=t.deg,a.boardWidth=this.boardWidth,a.boardHeight=this.boardHeight,a.naturalWidth=t.naturalWidth,a.naturalHeight=t.naturalHeight,a.setScaleXY(t.scaleX,t.scaleY)):(a=new Ia(this.instanceKey,{belongSeq:t.belongSeq,user:r,url:t.url,boardId:t.boardId,show:t.show,visible:null===(i=t.visible)||void 0===i||i,x:t.x,y:t.y,deg:t.deg,scaleX:t.scaleX,scaleY:t.scaleY,boardWidth:this.boardWidth,boardHeight:this.boardHeight,naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight,erasable:n,time:t.time,lockElement:t.lockElement}),this.tiwData.addElement(e,r,a))}},e.prototype.addDataHandlerForAudioElementAction=function(t,e,r,i){var o=this,n=this.tiwData.getElementByElementId(String(t.belongSeq)),a=[];if(!((1*t.seq||0)<this.maxCustomGraphElementSeq||n&&!n.show)){this.maxCustomGraphElementSeq=t.seq,!t.erasable&&F(t.erasable);var s=t.action===M.PROTOCOL_ACTION.AUDIO_ELEMENT?Ta.TEDU_BOARD_ELEMENT_AUDIO:Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO;window.WeixinJSBridge?window.WeixinJSBridge.invoke("getNetworkType",{},(function(){o.addAudioElement(r,e,t.belongSeq,t.url,s,t.title,t,null)}),!1):this.addAudioElement(r,e,t.belongSeq,t.url,s,t.title,t,null),t.show||(a.push(String(t.belongSeq)),i(a))}},e.prototype.addDataHandlerForJsxgraphBoardElementAction=function(t,e,r){var i,o;if((1*t.seq||0)<this.maxJxgBoardElementSeq)this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxJxgBoardElementSeq:this.maxJxgBoardElementSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE);else{this.maxJxgBoardElementSeq=t.seq;var n=this.tiwData.getElementByElementId(String(t.belongSeq));if(n)n.seq=t.seq,n.width=t.width,n.height=t.height,n.x=t.x,n.y=t.y,n.show=t.show,n.visible=null===(i=t.visible)||void 0===i||i,n.deg=t.deg,n.updateBoard(t.boardAttr,!0,t.seq);else{var a=!(!t.erasable&&!F(t.erasable));n=new vl(this.instanceKey,{user:r,belongSeq:t.belongSeq,time:t.time,width:t.width,height:t.height,x:t.x,y:t.y,boardId:e,show:t.show,visible:null===(o=t.visible)||void 0===o||o,deg:t.deg,erasable:a,boardAttr:t.boardAttr,axisColor:t.axisColor,lockElement:t.lockElement},{store:{addRealtimeData:this.addRealtimeData.bind(this),getMathGraphType:this.getMathGraphType.bind(this),report:this.report,event:this.event}}),this.tiwData.addElement(e,r,n)}}},e.prototype.addDataHandlerForJsxgraphGraphElementAction=function(t,e,r){if((1*t.seq||0)<this.maxJxgBoardElementSeq)this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxJxgBoardElementSeq:this.maxJxgBoardElementSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE);else{this.maxJxgBoardElementSeq=t.seq;var i=this.tiwData.getElementByElementId(t.jxgBelongSeq);i&&i.updateGraph(ll.createElement(this.seqUtil,hc(hc({},t),{user:r,boardId:e})))}},e.prototype.addDataHandlerForUserInfoEventAction=function(t,e,r){var i=t.uid,o=this.maxUserInfoSeqMap[i]||0;(1*t.seq||0)<o?this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxUserInfoSeq:o,boardId:e,method:"addData"})}},ea.ONLY_ONLINE):(this.maxUserInfoSeqMap[i]=1*t.seq,this.userInfoMap[i]=new ys(this.seqUtil,i,t))},e.prototype.addDataHandlerForMagicLineElementAction=function(t,e,r){if((1*t.seq||0)<this.maxMagicLineElementSeq)this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxMagicLineElementSeq:this.maxMagicLineElementSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE);else if(this.maxMagicLineElementSeq=t.seq,this.tiwData.getElementByElementId(t.belongSeq+""));else{var i=Is.createElement(this.instanceKey,r,t);i.setBoardSize(this.boardWidth,this.boardHeight),i.setFitBorder(),this.renderHandler.addToRenderMap(i.ID,new Ds(i)),this.tiwData.addElement(e,r,i)}},e.prototype.addDataHandlerForFormulaElementAction=function(t,e,r){var i,o;if((1*t.seq||0)<this.maxFormulaElementSeq)this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxFormulaElementSeq:this.maxFormulaElementSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE);else{this.maxFormulaElementSeq=t.seq;var n=this.tiwData.getElementByElementId(t.belongSeq+"");n?(n.width=t.width,n.height=t.height,n.x=t.x,n.y=t.y,n.show=t.show,n.visible=null===(i=t.visible)||void 0===i||i,n.deg=t.deg,n.scaleX=t.scaleX,n.scaleY=t.scaleY):(n=new Sl(this.instanceKey,{belongSeq:t.belongSeq,user:r,boardId:e,expression:t.expression,show:t.show,visible:null===(o=t.visible)||void 0===o||o,x:t.x,y:t.y,naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight,baseWidth:t.baseWidth,baseHeight:t.baseHeight,width:t.width,height:t.height,deg:t.deg,scaleX:t.scaleX,scaleY:t.scaleY,boardWidth:this.boardWidth,boardHeight:this.boardHeight,erasable:t.erasable,color:t.color,textSize:t.textSize,lockElement:t.lockElement},Va.Realtime),this.tiwData.addElement(e,r,n),this.loadMathJax())}},e.prototype.addDataHandlerForDiscussionGroupSwitchAction=function(t,e){var r=this;if((1*t.seq||0)<this.maxDiscussionGroupActionSeq)this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxDiscussionGroupActionSeq:this.maxDiscussionGroupActionSeq,method:"addData"})}},ea.ONLY_ONLINE);else if(this.maxDiscussionGroupActionSeq=t.seq,this.checkIfInDiscussionGroupAndDiscussionGroupEnable()&&this.discussionGroupMap.checkIfUserInAnyGroup(t.discussionGroupIds,this.identifier)){var i=t.toBoardId;this.groupCurrentBoard=i;var o=Ot(i),n=o!==this.discussionGroupCurrentGroup;this.discussionGroupCurrentGroup=o;var a=Math.max(t.page,0),s=Math.max(t.step,0),l=this.getFileInfo(o);t.discussionGroupIds.forEach((function(t){if(r.discussionGroupMap.checkIfBoardInGroup(t,i)){var e=r.discussionGroupMap.getGroupInfoByGroupId(t);null==e||e.setCurrentBoard(i),null==e||e.setCurrentPage(a),null==e||e.setCurrentStep(s)}})),l?(l.type===M.FILE_TYPE.H5PPT&&(this.setH5PPTOperator(o,a,s,e),"WPS"===q(l.downloadURL)?bs.instance&&bs.instance.syncData({slideIndex:a,stepIndex:s,isPassive:!0,fid:o}):jn.gotoTimestampNew(this.iframeDom,this.seqUtil.getSeq(),{slideIndex:a,stepIndex:s,resetStep:t.resetStep,usePrevNextStepMethod:t.usePrevNextStepMethod,isPassive:!0,seq:t.seq})),n&&this.event.fireSwitchFileEvent(this.discussionGroupCurrentGroup),this.event.fireGotoBoardEvent(i,o,e),this.fireCanRedoAndUndo()):this.request.getFileInfo({fid:o},(function(c){c&&0===c.error_code?(l=JSON.parse(c.content),r.resolveAddFileAction(l,e),r.setNeedDraw(!0),setTimeout((function(){l.type===M.FILE_TYPE.H5PPT&&(r.setH5PPTOperator(o,a,s,e),"WPS"===q(l.downloadURL)?bs.instance&&bs.instance.syncData({slideIndex:a,stepIndex:s,isPassive:!0,fid:o}):jn.gotoTimestampNew(r.iframeDom,r.seqUtil.getSeq(),{slideIndex:a,stepIndex:s,resetStep:t.resetStep,usePrevNextStepMethod:t.usePrevNextStepMethod,isPassive:!0,seq:t.seq})),n&&r.event.fireSwitchFileEvent(r.discussionGroupCurrentGroup),r.event.fireGotoBoardEvent(i,o,e),r.fireCanRedoAndUndo()}),200)):r.event.fireWarningEvent($.TEDU_BOARD_WARNING_FILE_NOT_FOUND,o)}),(function(t){r.event.fireWarningEvent($.TEDU_BOARD_WARNING_FILE_NOT_FOUND,o)})),this.cancelSelect()}else{var c=t.toBoardId,h=Math.max(t.page,0),u=Math.max(t.step,0);t.discussionGroupIds.forEach((function(t){if(r.discussionGroupMap.checkIfBoardInGroup(t,c)){var e=r.discussionGroupMap.getGroupInfoByGroupId(t);null==e||e.setCurrentBoard(c),null==e||e.setCurrentPage(h),null==e||e.setCurrentStep(u)}}))}},e.prototype.addDataHandlerForDiscussionGroupSettingAction=function(t,e,r){if((1*t.seq||0)<this.maxDiscussionGroupActionSeq)this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxDiscussionGroupActionSeq:this.maxDiscussionGroupActionSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE);else{this.maxDiscussionGroupActionSeq=t.seq;var i=t.content;if(i.type===Al.SET_ENABLE)this.setDiscussionGroupEnable(i.enable,!1);else if(i.type===Al.RESET)this.resetDiscussionGroup(!1);else if(i.type===Al.DELETE)(s=i.groupInfo)&&this.removeDiscussionGroup(s.discussionGroupId,!1);else if(i.type===Al.UPDATE&&(s=i.groupInfo)){this.addDiscussionGroup(s.discussionGroupId,s.boardIds,s.userIds,s.title,s.currentBoardId,!1);var o=this.discussionGroupMap.getGroupInfoByGroupId(s.discussionGroupId);null==o||o.setCurrentPage(s.currentPage||0),null==o||o.setCurrentStep(s.currentStep||0)}if(this.settingConfig.isDiscussionGroupMode){var n=this.discussionGroupMap.getGroupIdByUserId(this.identifier),a=n.length;if(a){var s=this.discussionGroupMap.getGroupInfoByGroupId(n[0]);if(a>1)for(var l=s.getUpdateTimestamp(),c=1;c<a;c++){var h=this.discussionGroupMap.getGroupInfoByGroupId(n[c]),u=h.getUpdateTimestamp();u>l&&(l=u,s=h)}var d=Ot(s.currentBoardId),p=(f=this.getBoardByGroup(d)).indexOf(s.currentBoardId);this.addDataHandlerForDiscussionGroupSwitchAction({seq:t.seq,toBoardId:s.currentBoardId,page:p,step:p===s.currentPage?s.currentStep:0,discussionGroupIds:n},r)}else{d=Ot(this.currentBoard);var f=this.getBoardByGroup(d),g=this.getFileInfo(d);p=f.indexOf(this.currentBoard),this.resolveSwitchBoardAction({seq:t.seq,toBoardId:this.currentBoard,page:p,step:p===g.currentPageIndex?g.currentPageStep:0},r)}}else d=Ot(this.currentBoard),f=this.getBoardByGroup(d),g=this.getFileInfo(d),p=f.indexOf(this.currentBoard),this.resolveSwitchBoardAction({seq:t.seq,toBoardId:this.currentBoard,page:p,step:p===g.currentPageIndex?g.currentPageStep:0},r)}},e.prototype.resolveFileScaleAction=function(t,e){var r=this,i=t.fid,o=this.getFileInfo(i);o?(o.scale=t.scale,this.dragDataList.getDragDataByFid(i).forEach((function(e){r.dragDataList.updateDragData(e.bid,{scale:t.scale})})),this.event.fireZoomDragStatusEvent({fid:i,scale:t.scale,xOffset:0,yOffset:0}),this.setNeedDraw(!0)):this.request.getFileInfo({fid:i},(function(n){n&&0===n.error_code?(o=JSON.parse(n.content),r.resolveAddFileAction(o,e),o.scale=t.scale,r.dragDataList.getDragDataByFid(i).forEach((function(e){r.dragDataList.updateDragData(e.bid,{scale:t.scale})})),r.event.fireZoomDragStatusEvent({fid:i,scale:t.scale,xOffset:0,yOffset:0}),r.setNeedDraw(!0)):r.event.fireWarningEvent($.TEDU_BOARD_WARNING_FILE_NOT_FOUND,i)}),(function(t){r.event.fireWarningEvent($.TEDU_BOARD_WARNING_FILE_NOT_FOUND,i)}))},e.prototype.resolveSwitchBoardAction=function(t,e){var r=this;this.logger.reportInfo(this.loggerModuleName,"resolveSwitchBoardAction",{param:{}},ea.ONLY_NATIVE);var i=t.toBoardId,o=[],n=[],a=!1,s=function(){o=t.deleteFiles||[],n=t.deleteBoards||[],o.forEach((function(t){r.deleteGroup(t,!1),n=n.concat(r.getBoardByGroup(t))})),n.forEach((function(t){r.removeBoard(t,e),t!==M.COMMON_DEFAULT_BOARD&&(r.manualRemoveBoard[t]=1)}))};if((1*t.seq||0)>this.maxSeq){if(this.maxSeq=t.seq,s(),(!this.tiwData.isBoardExist(i)||!0===t.notSwitch)&&(this.addBoard(i,!1,It(i)),t.notSwitch))return;var l=!this.checkIfInDiscussionGroupAndDiscussionGroupEnable();this.currentBoard=i;var c=Ot(i);a=c!==this.currentGroup,this.currentGroup=c;var h=Math.max(t.page,0),u=Math.max(t.step,0),d=this.getFileInfo(c),p=function(){var o,n,s=d.currentPageIndex!=h,p=d.currentPageStep!=u;(null===(o=d.pptMediaInfo)||void 0===o?void 0:o.videoIDList)&&delete d.pptMediaInfo.videoIDList,d.pptMediaInfo&&d.pptSlideAudioMap&&(d.pptMediaInfo.audioIDList=(null===(n=d.pptSlideAudioMap)||void 0===n?void 0:n[h||0])||[]),r.updateFileInfo({fid:c,pageCount:r.getBoardByGroup(c).length,currentPageIndex:h||0,currentPageStep:u||0,boardSequenceList:t.boardSequenceList}),l&&(d.type===M.FILE_TYPE.H5PPT&&(r.setH5PPTOperator(c,h,u,e),"WPS"===q(d.downloadURL)?bs.instance&&bs.instance.syncData({slideIndex:h,stepIndex:u,isPassive:!0,fid:c}):jn.gotoTimestampNew(r.iframeDom,r.seqUtil.getSeq(),{slideIndex:h,stepIndex:u,resetStep:t.resetStep,usePrevNextStepMethod:t.usePrevNextStepMethod,isPassive:!0,seq:t.seq,userId:e})),a&&r.event.fireSwitchFileEvent(r.currentGroup),(a||s)&&r.event.fireGotoBoardEvent(i,Ot(i),e),(s||p)&&d&&d.type===M.FILE_TYPE.H5PPT&&d.slideStepData&&r.event.fireGotoStepEvent(u,d.slideStepData[d.currentPageIndex]),s&&r.downGradeH5PPtMap.get(c)&&r.event.fireH5PPtDownGradeInernalOperatorEvent(c,h),r.fireCanRedoAndUndo())};d?p():this.request.getFileInfo({fid:c},(function(t){t&&0===t.error_code?(d=JSON.parse(t.content),r.resolveAddFileAction(d,e),r.setNeedDraw(!0),setTimeout((function(){p()}),200)):r.event.fireWarningEvent($.TEDU_BOARD_WARNING_FILE_NOT_FOUND,c)}),(function(t){r.event.fireWarningEvent($.TEDU_BOARD_WARNING_FILE_NOT_FOUND,c)})),this.cancelSelect()}else s(),this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxSeq:this.maxSeq,boardId:i,method:"addData"})}},ea.ONLY_ONLINE)},e.prototype.resolveAddFileAction=function(t,e){this.logger.reportInfo(this.loggerModuleName,"resolveAddFileAction",{param:{}},ea.ONLY_NATIVE),t.downloadURL&&(t.downloadURL=L.historyRealtimeDataReplaceAssetsProtocol(t.downloadURL));var r=null,i=[];if(t.type===M.FILE_TYPE.H5PPT){i=[];for(var o=0;o<t.pageCount;o++)r="".concat(t.platform,"_").concat(t.uid,"_").concat(t.timestamp,"_").concat(o+1,"_").concat(t.fid),i.push(r);this.addBoard(i,!1,e),this.addGroupNotReport(t.fid,t.title,t.uid,t.downloadURL,t.pageCount,0,t.timestamp,t.platform,M.FILE_TYPE.H5PPT,0,t.ratio,t.scale,t.isTranscodeFile,t.status,t.progress,t.h5FileEnableDraw)}else if(t.type===M.FILE_TYPE.IMG){var n=t.downloadURL,a=n?ee(n):"",s=[];i=[];for(var l=0;l<t.pageCount;l++)r="".concat(t.platform,"_").concat(t.uid,"_").concat(t.timestamp,"_").concat(l+1,"_").concat(t.fid),i.push(r),a.endsWith("/")?s.push("".concat(a).concat(l+1,".jpg")):s.push(a+(l+1));this.addBoard(i,!1,e),n&&this.addBackgroundPic({boardIds:i,urls:s,type:M.BACKGROUND_TYPE.IMAGE,needReport:!1}),this.addGroupNotReport(t.fid,t.title,t.uid,t.downloadURL,t.pageCount,0,t.timestamp,t.platform,M.FILE_TYPE.IMG,0,t.ratio,t.scale,t.isTranscodeFile,t.status,t.progress,t.h5FileEnableDraw)}else if(t.type===M.FILE_TYPE.IMAGESFILE){if(t.downloadURL){var c=(new Date).getTime(),h=ct(t.downloadURL),u=(new Date).getTime();s=JSON.parse(h);var d=u-c;this.logger.reportInfo(this.loggerModuleName,"add_images_file_peer",{param:{extraInfo:JSON.stringify({urls:h,urls_length:h.length,elapse:d})}},ea.ONLY_ONLINE),this.addImagesToBoard(t,s,e)}}else if(t.type===M.FILE_TYPE.VOD||t.type===M.FILE_TYPE.VODFILE||t.type===M.FILE_TYPE.LIVE||t.type===M.FILE_TYPE.H5FILE){for(i=[],o=0;o<t.pageCount;o++)r="".concat(t.platform,"_").concat(t.uid,"_").concat(t.timestamp,"_").concat(o+1,"_").concat(t.fid),i.push(r);this.addBoard(i,!1,e),this.addGroupNotReport(t.fid,t.title,t.uid,t.downloadURL,t.pageCount,0,t.timestamp,t.platform,t.type,0,t.ratio,t.scale,t.isTranscodeFile,t.status,t.progress,t.h5FileEnableDraw)}},e.prototype.addImagesToBoard=function(t,e,r){this.logger.reportInfo(this.loggerModuleName,"addImagesToBoard",{param:{uid:t.uid,fid:t.fid}},ea.ONLY_NATIVE);for(var i=null,o=[],n=0;n<t.pageCount;n++)i="".concat(t.platform,"_").concat(t.uid,"_").concat(t.timestamp,"_").concat(n+1,"_").concat(t.fid),o.push(i);this.addBoard(o,!1,r),e&&e.length>0&&this.addBackgroundPic({boardIds:o,urls:e,type:M.BACKGROUND_TYPE.IMAGE,needReport:!1}),this.addGroupNotReport(t.fid,t.title,t.uid,t.downloadURL,t.pageCount,0,t.timestamp,t.platform,t.type,0,t.ratio,t.scale,t.isTranscodeFile,t.status,t.progress,t.h5FileEnableDraw)},e.prototype.resolveUpdateVideoAction=function(t){if((1*t.seq||0)>this.maxVideoSeq){this.maxVideoSeq=t.seq;var e=t.status,r=t.progress,i=t.fid,o=t.time;this.options.enableLocalMode&&(o=Wt.getTimeStamp()),this.updateFileInfo({fid:i,status:e,progress:r,timestamp:o}),this.event.fireRenderVideoEvent(i)}},e.prototype.addFile=function(t,e,r,o,n,a,s,l,c){return uc(this,void 0,void 0,(function(){var h,u,d,p,f,g,m,y,v,_,E,T;return dc(this,(function(b){switch(b.label){case 0:if(this.logger.reportInfo(this.loggerModuleName,"addFile",{param:{fid:t,downloadUrl:o}},ea.ONLY_NATIVE),!Array.isArray(e))return[2,""];t=t||"#".concat(Wt.getTimeStamp()),h=[],u=Wt.getSecondTime(),h=this.createBoardIdForFile(t,this.identifier,u,e.length,i.PLATFORM,s)||[],d=2===this.boardContentFitMode||1===this.boardContentFitMode?xt(n,M.RATIO):xt(this.ratio,M.RATIO),p=d.ratioWidth,f=d.ratioHeight,n=p+":"+f,2===this.boardContentFitMode?(m=this.containerWidth/p,y=this.containerHeight/f,v=Math.min(m,y),_=Math.max(m,y),g=_/v*100):(this.boardContentFitMode,g=100),b.label=1;case 1:return b.trys.push([1,3,,4]),[4,this.addGroup(t,r,this.identifier,o,e.length,0,u,i.PLATFORM,s,0,n,g,a)];case 2:return b.sent(),this.addBoard(h,!0,c),this.addBackgroundPic({boardIds:h,urls:e}),E={action:M.PROTOCOL_ACTION.ADD_FILE_ACTION,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),file:{fid:t,title:r,downloadURL:o,pageCount:e.length,uid:this.identifier,timestamp:u,platform:i.PLATFORM,type:s,ratio:n,scale:g,isTranscodeFile:a}},this.addRealtimeData(E),h.length&&l&&this.switchFile(t,"",0,c),[3,4];case 3:return T=b.sent(),this.event.fireErrorEvent(Xt.TEDU_BOARD_MAX_BOARD_LIMITED,T.message),[2,Promise.reject(t)];case 4:return[2,Promise.resolve(t)]}}))}))},e.prototype.addH5PPTFile=function(t,e,r,o,n,a,s,l,c){return uc(this,void 0,void 0,(function(){var h,u,d,p,f,g,m,y,v,_,E,T,b,S,x,w,O,I;return dc(this,(function(A){switch(A.label){case 0:for(e=L.reReplaceAssetsProtocol(e),this.logger.reportInfo(this.loggerModuleName,"addH5PPTFile",{param:{fid:t,uid:this.identifier,url:e}},ea.ONLY_NATIVE),h=!1,u=this.getGroup()||[],d=0,p=u.length;d<p;d++)if(u[d].downloadURL===e){h=!0;break}if(h)return[2];t=t||"#".concat(Wt.getTimeStamp()),f=[],g=Wt.getSecondTime(),f=this.createBoardIdForFile(t,this.identifier,g,o,i.PLATFORM,M.FILE_TYPE.H5PPT)||[],m=null,n&&a?(y=Ct(n,a),m=n/y+":"+a/y):m=this.ratio,v=2===this.boardContentFitMode||1===this.boardContentFitMode?xt(m,M.RATIO):xt(this.ratio,M.RATIO),_=v.ratioWidth,E=v.ratioHeight,m=_+":"+E,2===this.boardContentFitMode?(b=this.containerWidth/_,S=this.containerHeight/E,x=Math.min(b,S),w=Math.max(b,S),T=w/x*100):(this.boardContentFitMode,T=100),A.label=1;case 1:return A.trys.push([1,3,,4]),[4,this.addGroup(t,r,this.identifier,e,o,0,g,i.PLATFORM,M.FILE_TYPE.H5PPT,0,m,T,s)];case 2:return A.sent(),O={action:M.PROTOCOL_ACTION.ADD_FILE_ACTION,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),file:{fid:t,title:r,downloadURL:e,pageCount:o,uid:this.identifier,timestamp:g,platform:i.PLATFORM,type:M.FILE_TYPE.H5PPT,ratio:m,scale:T,isTranscodeFile:s}},this.addRealtimeData(O),this.addBoard(f,!0,c),f.length&&l&&this.switchFile(t,"",0,c),[3,4];case 3:return I=A.sent(),this.event.fireErrorEvent(Xt.TEDU_BOARD_MAX_BOARD_LIMITED,I.message),[2,Promise.reject(t)];case 4:return[2,Promise.resolve(t)]}}))}))},e.prototype.addH5File=function(t,e,r,i,o,n,a,s){void 0===s&&(s=!1),this.logger.reportInfo(this.loggerModuleName,"addH5File",{param:{fid:t,url:e,width:r,height:i,title:o}},ea.ONLY_NATIVE),this.addVideoFile(t,e,r,i,M.FILE_TYPE.H5FILE,o,n,a,s).catch((function(){}))},e.prototype.addVideoFile=function(t,e,r,o,n,a,s,l,c){return void 0===c&&(c=!1),uc(this,void 0,void 0,(function(){var h,u,d,p,f,g,m,y,v,_,E,T,b,S,x,w,O,I,A,D;return dc(this,(function(C){switch(C.label){case 0:for(this.logger.reportInfo(this.loggerModuleName,"addVideoFile",{param:{fid:t,url:e,width:r,height:o,type:n}},ea.ONLY_NATIVE),h=!1,u=1,d=!1,p=this.getGroup()||[],f=0,g=p.length;f<g;f++)if(p[f].downloadURL===e){h=!0;break}if(h)return[2];t=t||"#".concat(Wt.getTimeStamp()),a=a||t,m=[],y=Wt.getSecondTime(),m=this.createBoardIdForFile(t,this.identifier,y,u,i.PLATFORM,n)||[],v=null,r&&o?(_=Ct(r,o),v=r/_+":"+o/_):v=this.ratio,E=2===this.boardContentFitMode||1===this.boardContentFitMode?xt(v,M.RATIO):xt(this.ratio,M.RATIO),T=E.ratioWidth,b=E.ratioHeight,v=T+":"+b,2===this.boardContentFitMode?(x=this.containerWidth/T,w=this.containerHeight/b,O=Math.min(x,w),I=Math.max(x,w),S=I/O*100):(this.boardContentFitMode,S=100),C.label=1;case 1:return C.trys.push([1,3,,4]),[4,this.addGroup(t,a,this.identifier,e,u,0,y,i.PLATFORM,n,0,v,S,d,c)];case 2:return C.sent(),this.addBoard(m,!0,l),A={action:M.PROTOCOL_ACTION.ADD_FILE_ACTION,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),file:{fid:t,title:a,downloadURL:e,pageCount:u,uid:this.identifier,timestamp:y,platform:i.PLATFORM,type:n,ratio:v,scale:S,isTranscodeFile:d,status:0,progress:0,h5FileEnableDraw:c}},this.addRealtimeData(A),s&&m.length&&this.switchFile(t,"",0,l),[3,4];case 3:return D=C.sent(),this.event.fireErrorEvent(Xt.TEDU_BOARD_MAX_BOARD_LIMITED,D.message),[2,Promise.reject(t)];case 4:return[2,Promise.resolve(t)]}}))}))},e.prototype.deleteFile=function(t,e){if(this.logger.reportInfo(this.loggerModuleName,"deleteFile",{param:{fid:t}},ea.ONLY_NATIVE),t===M.COMMON_GROUP)return!1;var r=this.deleteGroup(t);return t===this.getCurrentFile()&&this.switchFile(M.COMMON_GROUP,"",0,e),this.event.fireDeleteFileEvent(t),!(!r||!r.length||(this.deleteBoard(r,t,e),0))},e.prototype.switchFile=function(t,e,r,i){var o=this;this.logger.reportInfo(this.loggerModuleName,"switchFile",{param:{fid:t,boardId:e,stepIndex:r}},ea.ONLY_NATIVE);for(var n=!1,a=0,s=this.groups.length;a<s;a++)if(this.groups[a].fid===t){n=!0;break}if(n){if(this.checkIfInDiscussionGroupAndDiscussionGroupEnable()){this.discussionGroupCurrentGroup=t;var l=(h=this.getBoardByGroup(this.discussionGroupCurrentGroup)).indexOf(e),c=this.getDiscussionGroupIdByUserId(this.identifier);this.discussionGroupMap.checkIfBoardInAnyGroup(c,e)&&(this.groupCurrentBoard=e,this.discussionGroupCurrentGroup=Ot(this.groupCurrentBoard),c.forEach((function(t){if(o.discussionGroupMap.checkIfBoardInGroup(t,e)){var i=o.discussionGroupMap.getGroupInfoByGroupId(t);null==i||i.setCurrentBoard(e),null==i||i.setCurrentStep(null!=r?r:0),null==i||i.setCurrentPage(l)}})))}else{this.currentGroup=t;var h=this.getBoardByGroup(this.currentGroup),u=this.getFileInfo(this.currentGroup),d=h.indexOf(e);0<=d&&d<=u.pageCount&&(u.currentPageIndex=d),d=Math.max(0,u.currentPageIndex),isNaN(d)&&(d=u.currentPageIndex||0),u.currentPageIndex=d,u.fid!==M.COMMON_GROUP&&(r=Math.max(0,null!=r?r:u.currentPageStep||0),u.currentPageStep=r),e=h[d]}return this.event.fireSwitchFileEvent(t),this.hideLaserData(),this.switchBoard(e,!0,i),t}return!1},e.prototype.setBoardSize=function(t,e){this.boardWidth=t,this.boardHeight=e},e.prototype.setContainerSize=function(t,e){this.containerWidth=t,this.containerHeight=e},e.prototype.setIframeDom=function(t){this.iframeDom=t},e.prototype.setBoardRatio=function(t,e,r){void 0===r&&(r=!0),this.logger.reportInfo(this.loggerModuleName,"setBoardRatio",{param:{boardId:t,ratio:e,needReport:r}},ea.ONLY_NATIVE),this.settingConfig.setBoardRatio(t,e);var i={};i[t]=e,r&&this.addRealtimeData({action:M.PROTOCOL_ACTION.SET_BOARD_RATIO_ACTION,seq:this.seqUtil.getSeq(),ratio:e}),r&&this.report.reportSetBoardRatio(i),this.setNeedDraw(!0)},e.prototype.getBoardRatio=function(){var t=this.settingConfig.getBoardRatio(this.getCurrentBoard());if(this.getCurrentFile()===M.COMMON_GROUP)return t;if(t)return t;var e=this.getFileInfo(this.getCurrentFile());return e&&e.ratio?e.ratio:this.ratio},e.prototype.addDragData=function(t,e){var r=new Kn(this.seqUtil,e);this.dragDataList.addDragData(t,r)},e.prototype.getDragData=function(){return this.dragDataList.getDragData(this.getCurrentBoard())},e.prototype.setBoardScale=function(t,e){void 0===e&&(e="userSetting"),t||(t=M.SCALE),t=Math.max(this.settingConfig.minBoardScale,Math.min(this.settingConfig.maxBoardScale,t));var r=this.dragDataList.getDragData(this.getCurrentBoard()),i=0,o=0;r?this.dragDataList.updateDragData(this.getCurrentBoard(),{scale:t}):(i=50,o=50,r=new Kn(this.seqUtil,{scale:t,xOffset:i,yOffset:o}),this.dragDataList.addDragData(this.getCurrentBoard(),r)),this.addRealtimeData(r.getRealTimeData()),this.report.reportDrag(Object.assign(r.getReportData(),{boardId:this.getCurrentBoard(),type:"boardscale_".concat(e)})),this.event.fireBoardScaleChangeEvent({boardId:this.getCurrentBoard(),scale:t,xOffset:i,yOffset:o}),this.setNeedDraw(!0)},e.prototype.getBoardScale=function(){var t,e=this.dragDataList.getDragData(this.getCurrentBoard());if(e)t=e.scale;else{var r=this.getFileInfo(this.getCurrentFile());r&&(t=r.scale),t||(t=this.scale)}return t},e.prototype.getContainerScale=function(){return this.containerScale},e.prototype.setContainerScale=function(t){this.containerScale=t},e.prototype.setBoardContentFitMode=function(t){this.logger.reportInfo(this.loggerModuleName,"setBoardContentFitMode",{param:{mode:t}},ea.ONLY_NATIVE),this.boardContentFitMode=t||Xn.TEDU_BOARD_FILE_FIT_MODE_NONE},e.prototype.getBoardContentFitMode=function(){return this.boardContentFitMode||Xn.TEDU_BOARD_FILE_FIT_MODE_NONE},e.prototype.updateFileInfo=function(t){this.logger.reportInfo(this.loggerModuleName,"updateFileInfo",{param:{fid:t.fid,uid:t.uid}},ea.ONLY_NATIVE);for(var e=t.fid,r=!1,o=0,n=this.groups.length;o<n;o++){var a=this.groups[o];if(a.fid===e){a.title=a.title||t.title,a.pageCount=t.pageCount||a.pageCount,a.currentPageIndex=void 0===t.currentPageIndex?a.currentPageIndex:t.currentPageIndex,a.currentPageStep=void 0===t.currentPageStep?a.currentPageStep:t.currentPageStep,a.downloadURL=a.downloadURL||t.downloadURL,a.uid=a.uid||t.uid,a.timestamp=t.timestamp||a.timestamp,a.ratio=t.ratio||a.ratio,a.scale=t.scale||a.scale,a.status=void 0===t.status?a.status:t.status,a.progress=void 0===t.progress?a.progress:t.progress,a.pptMediaInfo=void 0===t.pptMediaInfo?a.pptMediaInfo:t.pptMediaInfo,a.pptMediaPlaybackStatus=void 0===t.pptMediaPlaybackStatus?a.pptMediaPlaybackStatus:t.pptMediaPlaybackStatus,a.pptSlideAudioMap=void 0===t.pptSlideAudioMap?a.pptSlideAudioMap:t.pptSlideAudioMap,a.boardSequenceList=void 0===t.boardSequenceList?a.boardSequenceList:t.boardSequenceList,a.h5FileEnableDraw=t.h5FileEnableDraw||a.h5FileEnableDraw,r=!0;break}}var s={fid:t.fid,title:t.title,pageCount:t.pageCount,currentPageIndex:t.currentPageIndex||0,currentPageStep:t.currentPageStep||0,downloadURL:t.downloadURL,uid:t.uid,timestamp:t.timestamp,type:t.type||0,ratio:t.ratio||0,scale:t.scale,status:t.status||0,progress:t.progress||0,platform:i.PLATFORM,slideStepData:{},pptMediaInfo:t.pptMediaInfo,pptMediaPlaybackStatus:t.pptMediaPlaybackStatus,pptSlideAudioMap:t.pptSlideAudioMap,thumbUrls:t.thumbUrls||[],boardSequenceList:t.boardSequenceList||null,h5FileEnableDraw:!!t.h5FileEnableDraw};r||(this.groups.push(s),this.settingConfig.setFileRatio(t.fid,t.ratio))},e.prototype.isFileUrlExist=function(t){for(var e=this.getGroup()||[],r=null,i=0,o=e.length;i<o;i++){var n=e[i],a=n.downloadURL||"";a.indexOf("?")>-1&&(a=a.substr(0,a.indexOf("?"))),t.indexOf("?")>-1&&(t=t.substr(0,t.indexOf("?")));var s=a.replace(/^.*:\/\//,"https://"),l=t.replace(/^.*:\/\//,"https://"),c=ae(l);if(s===l||c===s){r=n.fid;break}}return r},e.prototype.setGraphStyle=function(t){this.logger.reportInfo(this.loggerModuleName,"setGraphStyle",{param:{extraInfo:JSON.stringify(t)}},ea.ONLY_ONLINE),"object"==typeof t&&(this.lineStyle=Object.assign(this.lineStyle,t))},e.prototype.getGraphStyle=function(){return this.lineStyle},e.prototype.setOvalDrawMode=function(t){this.logger.reportInfo(this.loggerModuleName,"setOvalDrawMode",{param:{mode:t}},ea.ONLY_NATIVE),this.ovalDrawMode=t},e.prototype.getOvalDrawMode=function(){return this.ovalDrawMode},e.prototype.setCursorIcon=function(t,e){var r;this.logger.reportInfo(this.loggerModuleName,"setCursorIcon",{param:{extraInfo:JSON.stringify({toolType:t,cursorIcon:e})}},ea.BOTH),N(e)&&(H(e.offsetX)?(e.offsetX>32&&(e.offsetX=Math.min(32,e.offsetX)),e.offsetX<0&&(e.offsetX=Math.max(0,e.offsetX))):delete e.offsetX,H(e.offsetY)?(e.offsetY>32&&(e.offsetY=Math.min(32,e.offsetY)),e.offsetY<0&&(e.offsetY=Math.max(0,e.offsetY))):delete e.offsetY,Object.assign(M.ICONS,((r={})[t]=Object.assign(M.ICONS[t],e),r)))},e.prototype.setRemoteCursorIcon=function(t,e){var r;this.logger.reportInfo(this.loggerModuleName,"setRemoteCursorIcon",{param:{toolType:t,cursorIcon:e}},ea.ONLY_NATIVE),N(e)&&Object.assign(M.ICONS,((r={})[t]=Object.assign(M.ICONS[t],{remote_url:e}),r))},e.prototype.setZoomCursorIcon=function(t,e){this.logger.reportInfo(this.loggerModuleName,"setZoomCursorIcon",{param:{zoomInCursorIcon:t,zoomOutCursorIcon:e}},ea.ONLY_NATIVE),N(t)&&Object.assign(M.ICONS,{12:t})},e.prototype.getCursorIcons=function(){return M.ICONS},e.prototype.pptMediaAction=function(t){var e,r;this.logger.reportInfo(this.loggerModuleName,"pptMediaAction",{param:{data:t}},ea.ONLY_NATIVE),this.addRealtimeData({action:M.PROTOCOL_ACTION.MEDIA_PLAY_IN_PPT,seq:this.seqUtil.getSeq(),data:t});var i=this.getFileInfo(),o=i.fid,n=i.fileType,a=i.currentPageIndex,s=i.pptMediaPlaybackStatus,l=void 0===s?{}:s;if(n===Cl.H5_COURSEWARE){var c={},h=t.type,u=t.id,d=t.currentTime,p=t.playstate;if("video"===h){var f=(l[a]||{}).video,g=hc({},void 0===f?{}:f);g[u]={currentTime:d,playstate:p,currentTimestamp:Wt.getCurrentTimeStamp()},c=hc(hc({},l),((e={})[a]=hc(hc({},l[a]),{video:g}),e))}if("audio"===h){var m=(l[a]||{}).audio,y=hc({},void 0===m?{}:m);y[u]={currentTime:d,playstate:p,currentTimestamp:Wt.getCurrentTimeStamp()},c=hc(hc({},l),((r={})[a]=hc(hc({},l[a]),{audio:y}),r))}this.updateFileInfo({fid:o,pptMediaPlaybackStatus:c}),this.report.reportAddFile(hc(hc({},i),{pptMediaPlaybackStatus:c}))}},e.prototype.pptAction=function(t){this.logger.reportInfo(this.loggerModuleName,"pptAction",{param:{data:t}},ea.ONLY_NATIVE),this.addRealtimeData({action:M.PROTOCOL_ACTION.PPT_EVENT_ACTION,seq:this.seqUtil.getSeq(),data:t})},e.prototype.wpsPptAction=function(t,e){this.logger.reportInfo(this.loggerModuleName,"pptAction",{param:{type:e,data:t}},ea.ONLY_NATIVE),this.addRealtimeData({action:M.PROTOCOL_ACTION.WPS_EVENT_ACTION,seq:this.seqUtil.getSeq(),data:hc({type:e},t)})},e.prototype.h5WebAction=function(t,e){var r=this.tiwData.getElementByElementId(String(t));r&&(r.updateData(e),this.addRealtimeData({action:M.PROTOCOL_ACTION.H5WEB_EVENT_ACTION,belongSeq:r.belongSeq,seq:this.seqUtil.getSeq(),id:t,data:e}),this.report.reportElement(r.getReportData()))},e.prototype.destroy=function(){this.logger.reportInfo(this.loggerModuleName,"destroy",{param:{}},ea.ONLY_NATIVE),this.realtimeHideLaser(),this.heartbeat&&this.heartbeat.destroy(),this.textInputTask&&clearInterval(this.textInputTask),this.drawRaserTask&&clearInterval(this.drawRaserTask),this.sendInterval&&clearInterval(this.sendInterval),clearTimeout(this.dragScrollTimer),clearTimeout(this.dragMouseOverTimer),this.removeAllElement()},e.prototype.addImageElement=function(t,e,r,i,o,n){void 0===r&&(r=!0),void 0===o&&(o=1),void 0===n&&(n={erasable:!0,left:5e3,top:5e3,customWidth:0,customHeight:0,deg:0,downGrade:!1});var a=this.getCurrentBoard();this.logger.reportInfo(this.loggerModuleName,"addImageElement",{param:{boardId:a,extraInfo:JSON.stringify({url:e})}},ea.ONLY_ONLINE),t||(t=this.seqUtil.getSeq()+""),function(e){var o=this,s=new ma(this.instanceKey,{belongSeq:+(t||0),user:this.identifier,url:e,boardId:a,show:r,visible:i,erasable:n.erasable,x:n.left,y:n.top,deg:Number(n.deg)||0,lockElement:!1},{store:{getDomainMap:this.getDomainMap.bind(this),getAccessibleDomains:this.getAccessibleDomains.bind(this),addAccessibleDomain:this.addAccessibleDomain.bind(this),getImageTimeout:this.getImageTimeout.bind(this),networkSniffer:this.networkSniffer.bind(this)}});s.getImageSize(this.boardWidth,this.boardHeight,this.getBoardScale(),n.customWidth,n.customHeight,(function(){o.tiwData.addElement(a,o.identifier,s),o.setNeedDraw(!0),n.downGrade||(o.addRealtimeData(s.getRealTimeData()),o.report.reportImageElement(s.getReportData())),o.tiwData.insertOperation(a,new gn(o.identifier,{seq:s.belongSeq,type:rc.ELEMENT})),o.fireCanRedoAndUndo(),o.logger.reportInfo(o.loggerModuleName,"add_image_element",{param:{extraInfo:JSON.stringify(s.getReportData())}},ea.ONLY_ONLINE)}))}.call(this,e),1===o?(this.event.fireAddElementEvent({id:String(t),type:Ta.TEDU_BOARD_ELEMENT_IMAGE,userData:""}),this.downGradeElementMap.set(String(t),this.getCurrentFile())):this.event.fireAddImageElementEvent("",e,"")},e.prototype.addJxgBoardElement=function(t,e,r,i,o){void 0===e&&(e={}),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===o&&(o={erasable:!0,left:0,top:0});var n=this.getCurrentBoard();t||(t=this.seqUtil.getSeq()+"");var a=this.getBoardScale()/100,s=new vl(this.instanceKey,{belongSeq:+t,user:this.identifier,boardId:n,show:r,visible:i,erasable:o.erasable,width:Bt(e.width||"50%",1e4/this.boardWidth*a),height:Bt(e.height||"50%",1e4/this.boardHeight*a),boardWidth:this.boardWidth,boardHeight:this.boardHeight,x:o.left,y:o.top,boundingbox:e.boundingbox,axisColor:e.axisColor,axis:e.axis,grid:e.grid,showNavigation:e.showControl,enableZoom:e.enableZoom,enablePan:e.enablePan,lockElement:!1},{store:{addRealtimeData:this.addRealtimeData.bind(this),getMathGraphType:this.getMathGraphType.bind(this),report:this.report,event:this.event}});return this.tiwData.addElement(n,this.identifier,s),this.setNeedDraw(!0),this.addRealtimeData(s.getRealTimeData()),this.report.reportLayerElement(s.getReportData()),this.event.fireAddElementEvent({id:String(t),type:Ta.TEDU_BOARD_ELEMENT_MATH_BOARD,userData:""}),s.ID},e.prototype.addJxgGraphElement=function(t,e){return uc(this,void 0,void 0,(function(){var r,i,o,n,a,s,l,c,h;return dc(this,(function(u){switch(u.label){case 0:return r=this.getCurrentBoard(),i=t.mathBoardId,o=t.color,n=t.selectedColor,a=pc(t,["mathBoardId","color","selectedColor"]),s={user:this.identifier,boardId:r,color:o,selectedColor:n},l=this.tiwData.getElementByElementId(String(i)),a.type=a.type||"expression","line"!==a.type?[3,2]:[4,this._addSubGraphForLine(l,s,a)];case 1:return u.sent(),[3,8];case 2:return"circle"!==a.type?[3,4]:[4,this._addSubGraphForCircle(l,s,a)];case 3:return u.sent(),[3,8];case 4:return"angle"!==a.type?[3,6]:[4,this._addSubGraphForAngle(l,s,a)];case 5:return u.sent(),[3,8];case 6:return"polygon"!==a.type?[3,8]:[4,this._addSubGraphForPolygon(l,s,a)];case 7:u.sent(),u.label=8;case 8:return c=this.seqUtil.getSeq(),e.seq=c,h=l.graphCounter.getElementLabel(a.type),"expression"===a.type&&a.expression&&(h=a.expression),[4,this._addJxgGraphElementHandler(l,hc({seq:c,user:this.identifier,boardId:r,color:o,selectedColor:n,label:h},a))];case 9:return u.sent(),[2,{graphId:c+"",boardId:l.ID}]}}))}))},e.prototype._addJxgGraphElementHandler=function(t,e,r){return void 0===r&&(r=!0),uc(this,void 0,void 0,(function(){var i;return dc(this,(function(o){switch(o.label){case 0:return i=ll.createElement(this.seqUtil,e),[4,t.updateGraph(i)];case 1:return o.sent()&&(this.addRealtimeData(i.getRealTimeData()),this.report.reportLayerElement(i.getReportData()),r&&this.event.fireAddElementEvent({id:e.seq+"",type:Ta.TEDU_BOARD_ELEMENT_MATH_GRAPH,userData:""})),[2]}}))}))},e.prototype._addSubGraph=function(t,e,r,i,o){return uc(this,void 0,void 0,(function(){var n,a,s,l,c,h;return dc(this,(function(u){switch(u.label){case 0:return B(e)?(n=i.user,a=i.boardId,s=i.color,l=i.selectedColor,c=this.seqUtil.getSeq(),h=t.graphCounter.getElementLabel("point"),[4,this._addJxgGraphElementHandler(t,{seq:c,user:n,boardId:a,color:s,selectedColor:l,type:"point",x:e[0],y:e[1],label:h,show:!0},!1)]):[3,2];case 1:u.sent(),o[r]=c+"",u.label=2;case 2:return[2]}}))}))},e.prototype._addSubGraphForLine=function(t,e,r){return uc(this,void 0,void 0,(function(){var i,o;return dc(this,(function(n){switch(n.label){case 0:return i=r.startPoint,o=r.endPoint,B(i)?[4,this._addSubGraph(t,i,"startPoint",e,r)]:[3,2];case 1:n.sent(),n.label=2;case 2:return B(o)?[4,this._addSubGraph(t,o,"endPoint",e,r)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},e.prototype._addSubGraphForCircle=function(t,e,r){return uc(this,void 0,void 0,(function(){var i,o;return dc(this,(function(n){switch(n.label){case 0:return i=r.centerPoint,o=r.circlePoint,B(i)?[4,this._addSubGraph(t,i,"centerPoint",e,r)]:[3,2];case 1:n.sent(),n.label=2;case 2:return o&&B(o)?[4,this._addSubGraph(t,o,"circlePoint",e,r)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},e.prototype._addSubGraphForAngle=function(t,e,r){return uc(this,void 0,void 0,(function(){var i,o,n;return dc(this,(function(a){switch(a.label){case 0:return i=r.vertexA,o=r.vertexB,n=r.vertexC,B(i)?[4,this._addSubGraph(t,i,"vertexA",e,r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return B(o)?[4,this._addSubGraph(t,o,"vertexB",e,r)]:[3,4];case 3:a.sent(),a.label=4;case 4:return B(n)?[4,this._addSubGraph(t,n,"vertexC",e,r)]:[3,6];case 5:a.sent(),a.label=6;case 6:return[2]}}))}))},e.prototype._addSubGraphForPolygon=function(t,e,r){return uc(this,void 0,void 0,(function(){var i,o,n=this;return dc(this,(function(a){return i=r.vertices,o=-1,r.vertices=i.map((function(i){return uc(n,void 0,void 0,(function(){var n;return dc(this,(function(a){switch(a.label){case 0:return B(i)?(++o,n=String.fromCharCode(65+o),[4,this._addSubGraph(t,i,n,e,r)]):[3,2];case 1:return a.sent(),[2,e.label+"."+n];case 2:return[2,i]}}))}))})),[2]}))}))},e.prototype.addFormulaElement=function(t,e,r,i){return void 0===r&&(r=!0),void 0===i&&(i=!0),uc(this,void 0,void 0,(function(){var o,n,a,s,l,c=this;return dc(this,(function(h){switch(h.label){case 0:return o=this.getCurrentBoard(),t||(t=this.seqUtil.getSeq()+""),n=e.fontSize?nc(e.fontSize,this.boardHeight):Sl.Default_FontSize,a=new Sl(this.instanceKey,{belongSeq:+t,user:this.identifier,boardId:o,show:r,visible:i,erasable:e.erasable,boardWidth:this.boardWidth||0,boardHeight:this.boardHeight||0,x:e.left,y:e.top,expression:e.expression,color:e.fontColor,textSize:n,lockElement:!1,deg:Number(e.deg)||0},Va.Local),s=0,l=function(){return new Promise((function(t){var e=setInterval((function(){(window.MathJaxLoaded||++s>=100)&&(clearInterval(e),t(0))}),100)}))},this.loadMathJax(),[4,l()];case 1:return h.sent(),a.getFormulaSize(this.boardWidth,this.boardHeight,this.getBoardScale(),(function(e){c.tiwData.addElement(o,c.identifier,a),c.setNeedDraw(!0),c.addRealtimeData(a.getRealTimeData()),c.report.reportElement(a.getReportData()),c.tiwData.insertOperation(o,new gn(c.identifier,{seq:a.belongSeq,subType:Ta.TEDU_BOARD_ELEMENT_FORMULA,type:rc.ELEMENT})),c.fireCanRedoAndUndo(),c.logger.reportInfo(c.loggerModuleName,"add_formula_element",{param:{extraInfo:JSON.stringify(a.getReportData())}},ea.ONLY_ONLINE),c.event.fireAddElementEvent({id:String(t),type:Ta.TEDU_BOARD_ELEMENT_FORMULA,userData:""})})),[2,a.belongSeq]}}))}))},e.prototype.updateElements=function(t){var e=this,r=[],i=[],o=[],n=[],a=[];t.forEach((function(t){"imageElement"===t.type?(r.push(t.getReportData()),a.push(hc(hc({},t.getRealTimeData()),{uid:t.user,seq:t.belongSeq})),e.addRealtimeData(t.getRealTimeData())):"element"===t.type?t.subType===Ta.TEDU_BOARD_ELEMENT_MATH_BOARD?(i.push(t.getReportData()),a.push(hc(hc({},t.getRealTimeData()),{uid:t.user,seq:t.belongSeq}))):(o.push(t.getReportData()),a.push(hc(hc({},t.getRealTimeData()),{uid:t.user,seq:t.belongSeq})),e.addRealtimeData(t.getRealTimeData())):"line"!==t.type&&"graph"!==t.type&&"inputtext"!==t.type||(n.push(t.getReportData()),a.push(t.getData()))})),a.length&&this.addRealtimeData({action:M.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION,seq:this.seqUtil.getSeq(),moves:a,time:Wt.getTimeStamp()}),this.report.reportImageElement(r),this.report.reportLayerElement(i),this.report.reportElement(o),this.report.reportUpdateContent(n)},e.prototype.updateDragDataFromTextTool=function(t,e,r){var i=!1,o=0,n=0;if(this.dragDataList.getDragData(this.getCurrentBoard())){var a=this.getDragData();r=Math.floor(r?a.scale/r:a.scale),r=Math.max(this.settingConfig.minBoardScale,Math.min(this.settingConfig.maxBoardScale,r)),(t||e||a.scale!==r)&&(i=!0),o=a.xOffset-t,n=a.yOffset-e,this.dragDataList.updateDragData(this.getCurrentBoard(),{scale:r,xOffset:o,yOffset:n})}else o=50-t,n=50-e,this.dragDataList.addDragData(this.getCurrentBoard(),new Kn(this.seqUtil,{scale:this.getBoardScale(),xOffset:o,yOffset:n})),(t||e)&&(i=!0);i&&(this.event.fireBoardScaleChangeEvent({boardId:this.getCurrentBoard(),scale:r,xOffset:o,yOffset:n}),this.addRealtimeData(this.dragDataList.getDragData(this.getCurrentBoard()).getRealTimeData()),this.reportDragThrottle(Object.assign(this.dragDataList.getDragData(this.getCurrentBoard()).getReportData(),{boardId:this.getCurrentBoard(),type:"textInput"})))},e.prototype.addRealtimeData=function(t){if(this.dataSyncEnable){if(t.action===M.PROTOCOL_ACTION.BOARD_MOVE_SCALE_ACTION){if(!(t.seq>=this.maxMoveSeq))return this.dragDataList.updateDragData(this.getCurrentBoard(),this.dragDataList.maxSeqDragData),void this.setNeedDraw(!0);this.maxMoveSeq=t.seq}else if(t.action===M.PROTOCOL_ACTION.LINE_START_ACTION||t.action===M.PROTOCOL_ACTION.RASER_SHOW_ACTION){var e=t.touchId+"";this.sendLaserCmd[e]=!0}else if(t.action===M.PROTOCOL_ACTION.RASER_HIDE_ACTION){if(e=t.touchId+"",!this.sendLaserCmd[e])return;this.sendLaserCmd[e]=!1}t.boardId=t.boardId||this.getCurrentBoard(),this.realTimeData.push(t)}},e.prototype.addReportAckData=function(t,e){var r=this;void 0===e&&(e=!0),t.forEach((function(t,i){r.reportAckDatas[t.seq]?delete r.reportAckDatas[t.seq]:e||(r.reportAckDatas[t.seq]=t)}))},e.prototype.syncAndReload=function(){var t=this;if(this.permissions){var e=Object.keys(this.reportAckDatas).length;e&&this.isDataSyncEnable()?(this.request.reportMsg(Object.values(this.reportAckDatas),(function(){t.syncHistoryData()}),(function(){})),this.logger.reportInfo(this.loggerModuleName,"sync_report_failed",{param:{extraInfo:JSON.stringify({count:e})}},ea.ONLY_ONLINE),this.reportAckDatas={}):this.syncHistoryData();var r=Object.keys(this.sendAckDatas).length;if(r>0){var i=null;Object.values(this.sendAckDatas).forEach((function(t,e){null===i?i=t:(t.timestamp>i.timestamp&&(i.timestamp=t.timestamp,i.seq=t.seq),i.value.actions.push.apply(i.value.actions,t.value.actions))})),this.fireSyncDataEvent(this.getCurrentBoard(),i),this.logger.reportInfo(this.loggerModuleName,"sync_send_failed",{param:{extraInfo:JSON.stringify({count:r})}},ea.ONLY_ONLINE),this.sendAckDatas={}}}},e.prototype.setImageTimeout=function(t){void 0===t&&(t=M.IMAGE_TIMEOUT),H(t)||(t=M.IMAGE_TIMEOUT),this.imageTimeout=t,this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"setImageTimeout",data:t})}},ea.ONLY_ONLINE)},e.prototype.getImageTimeout=function(){return this.imageTimeout},e.prototype.setHandwritingEnable=function(t){this.enableHandwriting=t},e.prototype.isHandwritingEnable=function(){return this.enableHandwriting},e.prototype.addH5Element=function(t,e,r){var i=this;void 0===r&&(r={erasable:!0,left:0,top:0,width:1e4,height:1e4,deg:0,lockElement:!1});var o=this.getCurrentBoard(),n=new xa(this.instanceKey,{belongSeq:+t,user:this.identifier,url:e.url,boardId:o,erasable:r.erasable,deg:0,lockElement:r.lockElement,onloadDone:function(){i.event.fireAddElementEvent({id:String(t),type:Ta.TEDU_BOARD_ELEMENT_H5,userData:e.userData||""}),i.addRealtimeData(n.getRealTimeData()),i.reportElement(n.getReportData())}});return n.setProperty({show:!0,visible:!0,x:r.left,y:r.top,width:r.width,height:r.height,deg:Number(r.deg)||0}),this.tiwData.addElement(o,this.identifier,n),this.setNeedDraw(!0),n},e.prototype.addCustomGraphElement=function(t){var e=this,r=this.getCurrentBoard(),i=t.url,o=t.show,n=t.x,a=t.y,s=t.erasable,l=t.visible;this.logger.reportInfo(this.loggerModuleName,"addCustomGraphElement",{param:{boardId:r,url:i}},ea.ONLY_NATIVE);var c=this.seqUtil.getSeq(),h=new Ia(this.instanceKey,{belongSeq:c,user:this.identifier,url:i,boardId:r,show:o,visible:l,x:n,y:a,boardWidth:this.boardWidth,boardHeight:this.boardHeight,erasable:s,lockElement:!1});this.tiwData.addElement(r,this.identifier,h),h.getImageSize(this.boardWidth,this.boardHeight,(function(){e.tiwData.insertOperation(r,new gn(h.user,{seq:h.belongSeq,type:rc.ELEMENT})),e.fireCanRedoAndUndo()}))},e.prototype.addElement=function(t,e,r){void 0===r&&(r={});var i=null,o=!0,n=0,a=0,s=0,l=0,c="",h=this.getBoardScale()/100;R(r)&&(i=Number(r),r={}),N(r)||U(r)||F(r)?(i=this.seqUtil.getSeq(),N(e)&&(r=Object.assign({},e,r||{})),r.hasOwnProperty("erasable")&&(o=!!r.erasable),r.hasOwnProperty("left")&&(n=Bt(r.left,1e4/this.boardWidth*h)),r.hasOwnProperty("top")&&(a=Bt(r.top,1e4/this.boardHeight*h)),r.hasOwnProperty("width")&&(s=Bt(r.width,1e4/this.boardWidth*h)),r.hasOwnProperty("height")&&(l=Bt(r.height,1e4/this.boardHeight*h)),r.hasOwnProperty("title")&&(c=r.title)):i=this.seqUtil.getSeq();var u=this.getCurrentBoard();if(this.logger.reportInfo(this.loggerModuleName,"addElement",{param:Object.assign({seq:i,boardId:u,elementOpt:r},e)},ea.ONLY_NATIVE),t===Ta.TEDU_BOARD_ELEMENT_H5)this.addH5Element(i,{url:e,userData:e},{erasable:o,left:n,top:a,width:s,height:l,deg:r.deg,lockElement:!1});else if(t===Ta.TEDU_BOARD_ELEMENT_IMAGE){var d=!1;r.hasOwnProperty("downGrade")&&(d=r.downGrade),this.addImageElement(i,e,!0,!0,1,{erasable:o,left:n,top:a,customWidth:s,customHeight:l,deg:r.deg,downGrade:d})}else if(t===Ta.TEDU_BOARD_ELEMENT_CUSTOM_GRAPH)this.customGraphData.url=e,this.customGraphData.userData=e,this.customGraphData.erasable=o,Z(this.customGraphData.url);else if(t===Ta.TEDU_BOARD_ELEMENT_AUDIO)this.addAudioElement(this.identifier,this.getCurrentBoard(),i,e,t,c,null,null,{erasable:o,show:!0,visible:!0,lockElement:!1});else if(t===Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO)this.addAudioElement(this.identifier,this.getCurrentBoard(),i,e,t,c,null,null,{erasable:o,show:!0,visible:!0,lockElement:!1});else if(t===Ta.TEDU_BOARD_ELEMENT_MATH_BOARD)this.addJxgBoardElement(i,e,!0,!0,{erasable:o,left:n,top:a});else if(t===Ta.TEDU_BOARD_ELEMENT_MATH_GRAPH){var p={seq:i};this.addJxgGraphElement(e,p),i=p.seq}else if(t===Ta.TEDU_BOARD_ELEMENT_FORMULA){var f=Object.assign({},e,r,{left:n,top:a,deg:r.deg});this.addFormulaElement(i,f,!0,!0)}else t===Ta.TEDU_BOARD_ELEMENT_TEXT?this.addTextElement(i,e,{erasable:o,left:n,top:a,deg:r.deg}):t===Ta.TEDU_BOARD_ELEMENT_WATERMARK&&(f=Object.assign({},e,{userId:this.identifier,left:n,top:a,customWidth:s,customHeight:l,deg:r.deg,color:r.color,opacity:r.opacity,show:!0,visible:!0,ratio:this.ratio}),this.addWatermarkElement(i,f,Va.Local));return i.toString()},e.prototype.removeElement=function(t){var e=[Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO,Ta.TEDU_BOARD_ELEMENT_WATERMARK],r=this.getCurrentBoard(),i=this.tiwData.getElementByElementId(t);if(!i)return!1;if(e.includes(i.subType)?r=M.COMMON_DEFAULT_BOARD:i.subType===Ta.TEDU_BOARD_ELEMENT_AUDIO&&i.boardId&&""!=i.boardId&&(r=i.boardId),i.isLocked())return this.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENT_IS_LOCKED,t+""),!1;var o=[{uid:i.user,seq:i.belongSeq}];return i.setElementDisplay(Bo.DELETE),this.reportEraserData(r,o,Bo.DELETE,!0,Xa.TEDU_BOARD_TOOL_TYPE_ERASER),this.cancelSelect(),!0},e.prototype._setBackgroundImage=function(t,e){void 0===e&&(e=Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER);var r=this.getCurrentBoard();this.setBackgroundPic(r,t||"",e),this.event.fireSetBackgroundImageEvent("",t||"","")},e.prototype._setBackgroundImageAngle=function(t){var e=this.getCurrentBoard();this.tiwData.isBoardExist(e)||this.addBoard(e,!0,It(e)),t=Number(t).valueOf(),this.tiwData.setBackgroundPictureAngle(e,t);var r=this.getBackgroundImage(e);this.sendRequest(e,[{action:M.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:(null==r?void 0:r.url)||"",time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),mode:(null==r?void 0:r.mode)||0,angle:null==r?void 0:r.angle,type:M.BACKGROUND_TYPE.IMAGE,cleanBoard:0,isGlobal:0}]),this.report.reportImage(e,(null==r?void 0:r.url)||"",(null==r?void 0:r.mode)||0,M.BACKGROUND_TYPE.IMAGE,t),this.setNeedDraw(!0)},e.prototype.uploadBoardMessageToCos=function(t){var e=this,r="".concat(this.identifier,"_").concat(Wt.formatDateTime(Wt.getTimeStamp()),"_").concat(Math.floor(1e6*Math.random()),".txt"),i=new File([t],r,{type:"text/plain"});return new Promise((function(t,r){e.fileCos.upload({bucket:e.fileMessageCosInfo.bucket,appid:e.fileMessageCosInfo.appid,region:e.fileMessageCosInfo.region,body:i,path:"/message/"+e.sdkAppId+"/"+e.classId+"/"+i.name}).then((function(e){var r=e.Bucket.substr(0,e.Bucket.lastIndexOf("-")),i="https://".concat(r,".").concat(L.CDN_DOMAIN,"/").concat(e.Key);t(i)}),(function(t){r(t)}))}))},e.prototype.resolveFileMessage=function(t){var e=this,r=t.url;this.request.requestFileMessage(r).then((function(t){200===t.status&&(e.addData(t.data),e.setNeedDraw())}))},e.prototype.getFileScale=function(t){var e;void 0===t&&(t=this.getCurrentFile());var r=this.getFileInfo(t);return r&&(e=r.scale),e||(e=this.scale),e},e.prototype.setFileScale=function(t,e){var r=this,i=this.getFileInfo(t);if(i){e=Math.max(this.settingConfig.minBoardScale,Math.min(e,this.settingConfig.maxBoardScale)),isNaN(e)&&(e=M.SCALE),i.scale=e;var o={action:M.PROTOCOL_ACTION.FILE_SCALE_ACTION,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),fid:t,scale:e};this.dragDataList.getDragDataByFid(t).forEach((function(t){r.dragDataList.updateDragData(t.bid,{scale:e})})),this.addRealtimeData(o),this.report.reportAddFile(Object.assign({},i,{isUpdateScale:1})),this.report.reportSwitchBoard({boardId:this.getCurrentBoard(),fid:i.fid,url:i.downloadURL,type:i.type,page:i.currentPageIndex,step:i.currentPageStep,ratio:i.ratio,scale:i.scale}),this.setNeedDraw(!0)}},e.prototype._buildRaserData=function(t,e,r,i,o){void 0===i&&(i=!1),void 0===o&&(o=!1);var n=1*r.seq||0,a=r.touchId||M.MOUSE_TOUCH_ID,s=this.getLaserRecordId(e,a),l=this.laserDataMap[s]||[];if(0===l.length||n>=l[0].seq){var c="",h={};r.title&&r.style?(c=r.title,h=r.style):(c=this.remoteUserTitleStyle[e]?this.remoteUserTitleStyle[e].title:"",h=this.remoteUserTitleStyle[e]?this.remoteUserTitleStyle[e].style:{});var u=new ls({action:r.action,color:r.color,radius:r.r,x:r.x,y:r.y,timestamp:r.timestamp,seq:r.seq,toolType:r.toolType,title:c,style:h,user:e,touchId:a});i||o?(u.ignore=!0,o||(this.needDrawLaserSeq[s]||(this.needDrawLaserSeq[s]={}),this.needDrawLaserSeq[s][n]=u),this.pushLaserData(u)):r.timestamp&&!r.ignore?(this.pushLaserData(u),this.setLaserDraw(!0)):t%3!=0||r.ignore||(this.pushLaserData(u),this.setLaserDraw(!0))}else l[0].seq},e.prototype._buildOnlyRaserData=function(t,e){return new ls({action:e.action,color:e.color,radius:e.r,x:e.x,y:e.y,timestamp:e.timestamp,seq:e.seq,toolType:e.toolType,title:e.title,style:e.style,user:t,touchId:e.touchId||M.MOUSE_TOUCH_ID})},e.prototype.hideLaserData=function(){var t=this.teduToolType;(t.isPenToolType()||t.isLaserToolType()||t.isHighLighterToolType()||t.isEraserToolType())&&this.collectRaserData().over(M.MOUSE_TOUCH_ID,t.isLaserToolType()?3:1)},e.prototype.realtimeHideLaser=function(t){var e=this,r=[];F(t)?r=Object.keys(this.sendLaserCmd):r.push(t+"");var i=this.teduToolType;r.forEach((function(t){(i.isPenToolType()||i.isLaserToolType()||i.isHighLighterToolType())&&e.sendLaserCmd[t]&&(e.sendLaserCmd[t]=!1,e.sendRequest("",[{action:M.PROTOCOL_ACTION.RASER_HIDE_ACTION,timestamp:Wt.getTimeStamp(),seq:e.seqUtil.getSeq(),r:e.thin/2,x:-1e4,y:-1e4,toolType:i.isLaserToolType()?3:1}]))}))},e.prototype.setSystemCursorEnable=function(t){void 0===t&&(t=!1),this.systemCursorEnable=t},e.prototype.getSystemCursorEnable=function(){return this.systemCursorEnable},e.prototype.pushLaserData=function(t){var e=this.getLaserRecordId(t.user,t.touchId),r=this.laserDataMap[e];if(r||(this.laserDataMap[e]=[],r=this.laserDataMap[e]),r.push(t),r.length>1){var i=r[r.length-1],o=r[r.length-2];i.seq<o.seq&&(this.laserDataMap[e]=r.sort((function(t,e){return t.seq-e.seq})))}},e.prototype.setToolTypeTitle=function(t,e,r){void 0===e&&(e={}),void 0===r&&(r=Xa.TEDU_BOARD_TOOL_TYPE_PEN);var i={position:Ua.TEDU_BOARD_POSITION_RIGHT_TOP,size:200,color:"#000000",style:Jn.TEDU_BOARD_TEXT_STYLE_NORMAL,displaySelf:!0},o=Object.assign({},i,e);o.size&&H(o.size)&&o.size,this.toolTypeTitleStyleMap[r]={title:t||this.userInfo.nickname,style:o,operatorId:this.identifier},r===Xa.TEDU_BOARD_TOOL_TYPE_PEN&&(this.toolTypePenTitleStyle=this.toolTypeTitleStyleMap[r]),this.logger.reportInfo(this.loggerModuleName,"setToolTypeTitle",{param:Object.assign({},o,{toolType:r})},ea.ONLY_NATIVE)},e.prototype.enableAudioControl=function(t){this.event.fireAudioControlEnableChangedEvent(t),this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"enableAudioControl",data:t})}},ea.ONLY_ONLINE),this.logger.reportInfo(this.loggerModuleName,"enableAudioControl",{param:{enable:t}},ea.ONLY_NATIVE)},e.prototype.setSyncAudioStatusEnable=function(t){this.isSyncAudioStatus=t},e.prototype.addAudioElement=function(t,e,r,i,o,n,a,s,l){var c=this;void 0===n&&(n=""),void 0===a&&(a=null),void 0===s&&(s=null),void 0===l&&(l={erasable:!0,show:!0,visible:!0,lockElement:!1});var h=this.tiwData.getElementByElementId(String(r));if(o===Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO&&(e=M.COMMON_DEFAULT_BOARD,s&&(s.boardId=e)),!h){(h=new ka(this.instanceKey,{belongSeq:r,user:t,url:i,subType:o,boardId:e,boardWidth:this.boardWidth,boardHeight:this.boardHeight,erasable:l.erasable,title:n,show:l.show,visible:l.visible,lockElement:l.lockElement})).setDataListener((function(t,e,r){!c.isSyncAudioStatus&&r||(c.addRealtimeData(t),c.reportElement(e))}));var u=0;h.setEventListener((function(t,e,i){t===Fa.TEDU_BOARD_AUDIO_STATUS_LOADED&&(a||s||(s=h.getReportData(),a=h.getRealTimeData(),c.addRealtimeData(a),c.reportElement(s))),h.show&&(5===t?e>0&&e!=u&&e%2==0&&(u=e,c.logger.reportInfo(c.loggerModuleName,"audio_status_change",{param:{extraInfo:JSON.stringify({id:String(r),status:t,progress:e,duration:i,audio_id:h.audioId()})}},ea.ONLY_ONLINE)):c.logger.reportInfo(c.loggerModuleName,"audio_status_change",{param:{extraInfo:JSON.stringify({id:String(r),status:t,progress:e,duration:i,audio_id:h.audioId()})}},ea.ONLY_ONLINE),c.event.fireAudioStatusChangedEvent({id:String(r),status:t,progress:e,duration:i}))})),this.tiwData.addElement(e,t,h),a||s||setTimeout((function(){c.event.fireAddElementEvent({id:String(r),type:o,userData:i,title:n})}),0)}return a&&h.setRealTimeData(a),s&&h.setReportData(s),this.setNeedDraw(!0),h},e.prototype.getBoardElementList=function(t,e){var r=this;t=t||this.getCurrentBoard();var i=[],o=[],n=this.filterGlobalElement();return this.tiwData.getElementsByBoardId(t).concat(n).forEach((function(t){var n=String(t.belongSeq);(t.isElementDisplay()||e&&t.isElementHide())&&!o.includes(n)&&(i.push({boardId:t.getBoardId(),elementId:String(t.belongSeq),type:r.elementTypeTransformer(t),url:t.url,show:t.isElementDisplay()}),o.push(n))})),i},e.prototype.removeAllElement=function(){var t=this.tiwData.getAllElements(),e=[];for(var r in t.forEach((function(t,r){t.show&&e.push(r),t.show=!1,t.remove&&t.remove(),t.destroy&&t.destroy()})),this.textAreaComponentMap){var i=this.textAreaComponentMap[String(r)];i&&i.remove()}this.textAreaComponentMap={},this.imageElementMapData={},this.customGraphMapData={},e.length&&this.event.fireRemoveElementEvent(e)},e.prototype.removeRenderedElement=function(){var t=this,e=this.tiwData.getAllElements(),r=[Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO,Ta.TEDU_BOARD_ELEMENT_WATERMARK];return e.forEach((function(e,i){if(!r.includes(e.subType))try{e.getBoardId()===t.getCurrentBoard()&&e.show||e.remove&&e.remove()}catch(t){}})),[]},e.prototype.isElementInSelectList=function(t){for(var e=this.getSelectList()||[],r=!1,i=0,o=e.length;i<o;i++)if(e[i].belongSeq===t){r=!0;break}return r},e.prototype.filterGlobalElement=function(){var t=this.tiwData.getAllElements(),e=[],r=[Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO,Ta.TEDU_BOARD_ELEMENT_WATERMARK];return t.forEach((function(t){r.includes(t.subType)&&e.push(t)})),e},e.prototype.filterWatermarkElement=function(){var t=this.tiwData.getAllElements(),e=[],r=[Ta.TEDU_BOARD_ELEMENT_WATERMARK];return t.forEach((function(t){r.includes(t.subType)&&e.push(t)})),e},e.prototype.setDomainMap=function(t){var e=this.domainMap;this.domainMap=hc(hc({},e),t),this.setNeedDraw(!0)},e.prototype.addBackupDomain=function(t,e,r){if(void 0===r&&(r=0),e&&t){var i=oe(t),o=oe(e);if(Object.prototype.hasOwnProperty.call(this.priorityDomainMap,i)){var n=this.priorityDomainMap[i];if(!n.find((function(t){return t.url===o}))){for(var a=0;a<n.length&&!(r>n[a].priority);a++);n.splice(a,0,{url:o,priority:r})}}else this.priorityDomainMap[i]=[{url:o,priority:r}];this.domainMap[i]=this.priorityDomainMap[i].map((function(t){return t.url})),this.logger.reportInfo(this.loggerModuleName,"add_backup_domain",{param:{extraInfo:JSON.stringify({domain:i,backup:o,currentMap:this.getDomainMap()})}},ea.ONLY_ONLINE)}},e.prototype.removeBackupDomain=function(t,e){var r=this;void 0===e&&(e="");var i=oe(t),o=oe(e);if(Object.prototype.hasOwnProperty.call(this.domainMap,i))if(o){var n=this.domainMap[i],a=this.priorityDomainMap[i];this.domainMap[i]=n.filter((function(t){return t!==o})),this.priorityDomainMap[i]=a.filter((function(t){return t.url!==o})),Object.prototype.hasOwnProperty.call(this.accessibleDomains,o)&&delete this.accessibleDomains[o]}else this.domainMap[i].forEach((function(t){Object.prototype.hasOwnProperty.call(r.accessibleDomains,t)&&delete r.accessibleDomains[t]})),delete this.domainMap[i],delete this.priorityDomainMap[i];this.logger.reportInfo(this.loggerModuleName,"remove_backup_domain",{param:{extraInfo:JSON.stringify({domain:i,backup:o,currentMap:this.getDomainMap()})}},ea.ONLY_ONLINE)},e.prototype.getDomainMap=function(){return this.domainMap},e.prototype.addAccessibleDomain=function(t){var e,r=this.accessibleDomains,i=t.match(/^https?:\/\/[^/]+/i),o=i?i[0]:"";o&&(this.accessibleDomains=hc(hc({},r),((e={})[o]=1,e)))},e.prototype.checkDomainAccessible=function(t){var e=t.match(/^https?:\/\/[^/]+/i),r=e?e[0]:"";return!!r&&!!this.accessibleDomains[r]},e.prototype.getAccessibleDomains=function(){return this.accessibleDomains},e.prototype.setEraseLayerLimit=function(t){this.eraseLayerLimit=t},e.prototype.setEraseLayerType=function(t){var e=t.map((function(t){return t===hs.LINE?"line":t===hs.GRAPH?"graph":t===hs.TEXT?"inputtext":t===hs.IMAGE?"imageElement":t===hs.ELEMENT?"element":void 0}));this.eraseLayerTypeArr=e},e.prototype.setSyncFps=function(t){this.SYNC_FPS=Math.min(Math.max(t,5),20),clearInterval(this.sendInterval),this.initInterval()},e.prototype.updateElementOperationForPosition=function(t,e){var r=this;void 0===e&&(e=!1);var i=[];if(t.forEach((function(t){t.getData&&i.push(hc(hc({},t.getData()),{user:r.identifier,boardScale:r.getBoardScale()}))})),e){for(var o=this.tiwData.getOperations(this.getCurrentBoard()),n=o.length,a=null,s=function(t,e){var r,i;if(t.length!==e.length)return!1;var o=t.concat(e),n=0;try{for(var a=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(o),s=a.next();!s.done;s=a.next())n^=+s.value.seq}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return 0===n};n>0;){var l=(a=o[n-1]).seq.origin;if(a.type===rc.MOVE&&s(l,i))break;--n}a&&(a.seq.final.length||(a.seq.final=i))}else this.tiwData.insertOperation(this.getCurrentBoard(),new gn(this.identifier,{seq:{origin:i,final:[]},type:rc.MOVE}));this.fireCanRedoAndUndo()},e.prototype.autoHideRemoteCursor=function(t,e,r){var i,o=this;if(this.settingConfig.isAutoHideRemoteCursor){var n=this.getLaserRecordId(e,r.touchId),a=null===(i=this.laserDataMap[n])||void 0===i?void 0:i.length,s=a?this.laserDataMap[n][a-1].seq:0,l=this.autoHideRemoteCursorSeqMap[n]||0;this.autoHideRemoteCursorSeqMap[n]=Math.max(l,s),clearTimeout(this.autoHideRemoteCursorTimer[n]),this.autoHideRemoteCursorTimer[n]=setTimeout((function(){r.seq=o.autoHideRemoteCursorSeqMap[n]+1,o._buildRaserData(t,e,r,!1)}),this.settingConfig.autoHideRemoteCursorTimeout)}},e.prototype.setUserInfo=function(t){for(var e in this.isLocalSetUserInfo=!0,this.userInfo.nickname=t.nickname||"",this.userInfoMap[this.identifier]=this.userInfo,this.event.fireUserInfoChange(this.identifier,this.userInfo),this.toolTypeTitleStyleMap){var r=this.toolTypeTitleStyleMap[e];r.title||(r.title=this.userInfo.nickname)}this.logger.reportInfo(this.loggerModuleName,"setUserInfo",{param:{extraInfo:JSON.stringify({userId:this.identifier,userInfo:t})}},ea.ONLY_ONLINE)},e.prototype.getUserInfo=function(t,e){var r=this.userInfoMap[t],i=r&&r[e];return i||"nickname"!==e||(i=""),i||null},e.prototype.elementTypeTransformer=function(t){var e=t.subType||t.graph&&"graph-".concat(t.graph)||t.type;return Object.values(Ta).includes(e)?e:"line"===e?t.highlighter?Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_HIGHLIGHTER:Ta.TEDU_BOARD_ELEMENT_GRAFFITI_LINE:"graph-line"===e?Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_LINE:"graph-rect"===e?Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_RECT:"graph-oval"===e?Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_OVAL:"graph-right-triangle"===e?Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_RIGHT_TRIANGLE:"graph-isosceles-triangle"===e?Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ISOSCELES_TRIANGLE:"graph-parallelogram"===e?Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_PARALLELOGRAM:"graph-cube"===e?Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_CUBE:"graph-cylinder"===e?Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_CYLINDER:"graph-cone"===e?Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_CONE:"graph-coordinate"===e?Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_COORDINATE:"inputtext"===e?Ta.TEDU_BOARD_ELEMENT_TEXT:"imageElement"===e?Ta.TEDU_BOARD_ELEMENT_IMAGE:void 0},e.prototype.checkOffline=function(){var t=this;clearInterval(this.offlineWarningTimer),this.offlineWarningCount=0,this.offlineWarningTimer=window.setInterval((function(){++t.offlineWarningCount,t.event.fireOfflineWarning(t.offlineWarningCount)}),this.settingConfig.offlineWarningTimeout)},e.prototype.addSnapshotMark=function(){this.report.reportAddSnapshotMark({boardId:this.getCurrentBoard()})},e.prototype.setPenAutoFittingMode=function(t){this.lineFitMode=t,this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"setPenAutoFittingMode",data:this.lineFitMode})}},ea.ONLY_ONLINE)},e.prototype.fireCanRedoAndUndo=function(){this.event.fireCanRedoStatusChangedEvent(this.canRedo()),this.event.fireCanUndoStatusChangedEvent(this.canUndo())},e.prototype.setBoardRemark=function(t,e,r){void 0===t&&(t=this.getCurrentBoard()),void 0===r&&(r=!0),R(e)||(e=JSON.stringify(e)),this.boardRemarkMap[t]=e,r&&(this.addRealtimeData({action:M.PROTOCOL_ACTION.SET_BOARD_REMARK_ACTION,boardId:t,remark:e,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq()}),this.report.reportSetBoardRemark(t,e)),this.event.fireBoardRemarkChanged({boardId:t,remark:e})},e.prototype.getBoardRemark=function(t){var e;return t?-1===this.getBoardList().indexOf(t)?{}:((e={})[t]=this.boardRemarkMap[t]||"",e):this.boardRemarkMap},e.prototype.setMathGraphType=function(t){this.currentMathGraphType!==t&&(this.currentMathGraphType=t,this.mathGraphElementQue=[])},e.prototype.getMathGraphType=function(t){return this.currentMathGraphType},e.prototype._addMathLineGraph=function(t,e,r,i){return void 0===i&&(i=0),uc(this,void 0,void 0,(function(){var o,n,a,s,l,c,h,u,d,p,f,g,m,y,v,_,E,T;return dc(this,(function(b){switch(b.label){case 0:return o=r.vertexA,n=r.vertexB,a=r.straightFirst,s=void 0===a||a,l=r.straightLast,c=void 0===l||l,h=r.firstArrow,u=void 0!==h&&h,d=r.lastArrow,p=void 0!==d&&d,f=r.show,g=void 0===f||f,m=r.dash,y=void 0===m?0:m,v=r.subType,_=void 0===v?"line":v,E=i||this.seqUtil.getSeq(),T=hc({seq:E,user:this.identifier,boardId:e,label:t.graphCounter.getElementLabel(_),startPoint:o,endPoint:n,type:"line",straightFirst:s,straightLast:c,firstArrow:u&&{type:4,size:8},lastArrow:p&&{type:4,size:8},dash:y,show:g},Ss.mathBoardElementStyle.line),[4,this._addJxgGraphElementHandler(t,T)];case 1:return b.sent(),[2]}}))}))},e.prototype._addMathPointGraph=function(t,e,r,i,o){return void 0===i&&(i=0),void 0===o&&(o=!0),uc(this,void 0,void 0,(function(){var n,a,s,l,c,h;return dc(this,(function(u){switch(u.label){case 0:return n=r.x,a=r.y,s=r.visible,l=void 0===s||s,c=i||this.seqUtil.getSeq(),h=hc({seq:c,user:this.identifier,boardId:e,label:t.graphCounter.getElementLabel("point"),x:n,y:a,type:"point",show:l},Ss.mathBoardElementStyle.point),[4,this._addJxgGraphElementHandler(t,h,o)];case 1:return u.sent(),[2]}}))}))},e.prototype._addMathCircleGraph=function(t,e,r){var i=r.centerPoint,o=r.circlePoint;return uc(this,void 0,void 0,(function(){var r,n;return dc(this,(function(a){switch(a.label){case 0:return r=this.seqUtil.getSeq(),n=hc({seq:r,user:this.identifier,boardId:e,label:t.graphCounter.getElementLabel("circle"),centerPoint:i,circlePoint:o,type:"circle"},Ss.mathBoardElementStyle.circle),[4,this._addJxgGraphElementHandler(t,n)];case 1:return a.sent(),[2]}}))}))},e.prototype._addMathAngleGraph=function(t,e,r){var i=r.vertexA,o=r.vertexB,n=r.vertexC;return uc(this,void 0,void 0,(function(){var r,a;return dc(this,(function(s){switch(s.label){case 0:return r=this.seqUtil.getSeq(),a=hc({seq:r,user:this.identifier,boardId:e,label:t.graphCounter.getElementLabel("angle"),vertexA:i,vertexB:o,vertexC:n,type:"angle"},Ss.mathBoardElementStyle.angle),[4,this._addJxgGraphElementHandler(t,a)];case 1:return s.sent(),[2]}}))}))},e.prototype._addMathGliderGraph=function(t,e,r,i){return void 0===i&&(i=0),uc(this,void 0,void 0,(function(){var o,n,a,s,l,c,h;return dc(this,(function(u){switch(u.label){case 0:return o=r.relyElement,n=r.x,a=void 0===n?0:n,s=r.y,l=void 0===s?0:s,c=i||this.seqUtil.getSeq(),h=hc({seq:c,user:this.identifier,boardId:e,label:"glider_test"+i,relyElement:o,x:a,y:l,type:"glider"},Ss.mathBoardElementStyle.line),[4,this._addJxgGraphElementHandler(t,h)];case 1:return u.sent(),[2]}}))}))},e.prototype._addMathMirrorPointGraph=function(t,e,r,i){return void 0===i&&(i=0),uc(this,void 0,void 0,(function(){var o,n,a,s,l,c;return dc(this,(function(h){switch(h.label){case 0:return o=r.originPoint,n=r.mirrorAnchor,a=r.show,s=void 0===a||a,l=i||this.seqUtil.getSeq(),c=hc({seq:l,user:this.identifier,boardId:e,label:t.graphCounter.getElementLabel("point"),originPoint:o,mirrorAnchor:n,show:s,type:"mirrorpoint"},Ss.mathBoardElementStyle.line),[4,this._addJxgGraphElementHandler(t,c)];case 1:return h.sent(),[2]}}))}))},e.prototype._addMathCurveGraph=function(t,e,r,i){return void 0===i&&(i=0),uc(this,void 0,void 0,(function(){var o,n,a,s,l,c,h,u;return dc(this,(function(d){switch(d.label){case 0:return o=r.x,n=r.y,a=r.a,s=r.b,l=r.dash,c=void 0===l?0:l,h=i||this.seqUtil.getSeq(),u=hc({seq:h,user:this.identifier,boardId:e,label:t.graphCounter.getElementLabel("line"),x:o,y:n,a:a,b:s,dash:c,type:"curve"},Ss.mathBoardElementStyle.line),[4,this._addJxgGraphElementHandler(t,u)];case 1:return d.sent(),[2]}}))}))},e.prototype._addMathCircularConeGraph=function(t,e,r){var i=r.centerPoint,o=r.xAxisPoint,n=r.zAxisPoint;return uc(this,void 0,void 0,(function(){var r,a,s,l,c,h,u,d,p;return dc(this,(function(f){switch(f.label){case 0:return r=this.seqUtil.getSeq(),a=this.seqUtil.getSeq(),s=this.seqUtil.getSeq(),l=this.seqUtil.getSeq(),c=this.seqUtil.getSeq(),h=this.seqUtil.getSeq(),u=this.seqUtil.getSeq(),d=this.seqUtil.getSeq(),p=hc({seq:d,user:this.identifier,boardId:e,label:"circular-cone",centerPoint:i+"",xAxisPoint:o+"",zAxisPoint:n+"",radius:r+"",high:a+"",mirrorPoint:s+"",leftEdge:l+"",rightEdge:c+"",upperHalfCircle:h+"",lowerHalfCircle:u+"",type:"circularcone"},Ss.mathBoardElementStyle.point),[4,this._addJxgGraphElementHandler(t,p)];case 1:return f.sent(),[2]}}))}))},e.prototype._addMathParallelPointGraph=function(t,e,r,i){return void 0===i&&(i=0),uc(this,void 0,void 0,(function(){var o,n,a,s,l,c,h;return dc(this,(function(u){switch(u.label){case 0:return o=r.pointA,n=r.pointB,a=r.pointC,s=r.show,l=void 0===s||s,c=i||this.seqUtil.getSeq(),h=hc({seq:c,user:this.identifier,boardId:e,label:t.graphCounter.getElementLabel("point"),pointA:o,pointB:n,pointC:a,show:l,type:"parallelpoint"},Ss.mathBoardElementStyle.point),[4,this._addJxgGraphElementHandler(t,h)];case 1:return u.sent(),[2]}}))}))},e.prototype._addMathCylinderGraph=function(t,e,r){var i=r.centerPoint,o=r.xAxisPoint,n=r.zAxisPoint;return uc(this,void 0,void 0,(function(){var r,a,s,l,c,h,u,d,p,f,g,m,y;return dc(this,(function(v){switch(v.label){case 0:return r=this.seqUtil.getSeq(),a=this.seqUtil.getSeq(),s=this.seqUtil.getSeq(),l=this.seqUtil.getSeq(),c=this.seqUtil.getSeq(),h=this.seqUtil.getSeq(),u=this.seqUtil.getSeq(),d=this.seqUtil.getSeq(),p=this.seqUtil.getSeq(),f=this.seqUtil.getSeq(),g=this.seqUtil.getSeq(),m=this.seqUtil.getSeq(),y=hc({seq:m,user:this.identifier,boardId:e,label:"cylinder",centerPoint:i+"",xAxisPoint:o+"",zAxisPoint:n+"",topParallelPoint:l+"",topMirrorPoint:c+"",bottomMirrorPoint:s+"",radius:r+"",high:a+"",leftEdge:h+"",rightEdge:u+"",topUpperHalfCircle:d+"",topLowerHalfCircle:p+"",bottomUpperHalfCircle:f+"",bottomLowerHalfCircle:g+"",type:"cylinder"},Ss.mathBoardElementStyle.point),[4,this._addJxgGraphElementHandler(t,y)];case 1:return v.sent(),[2]}}))}))},e.prototype._addMathCubeGraph=function(t,e,r){var i=r.pointA,o=r.pointB,n=r.pointC,a=r.pointA1;return uc(this,void 0,void 0,(function(){var r,s,l,c,h,u,d,p=this;return dc(this,(function(f){switch(f.label){case 0:return r="".concat(this.seqUtil.getSeq()),s="".concat(this.seqUtil.getSeq()),l="".concat(this.seqUtil.getSeq()),c="".concat(this.seqUtil.getSeq()),h=Array.from({length:12}).map((function(t){return p.seqUtil.getSeq()+""})),u=this.seqUtil.getSeq(),d=hc({seq:u,user:this.identifier,boardId:e,label:"cube",vertexA:i+"",vertexB:o+"",vertexC:n+"",vertexD:r,vertexA1:a+"",vertexB1:s,vertexC1:c,vertexD1:l,edgeAB:h[0],edgeBC:h[1],edgeCD:h[2],edgeDA:h[3],edgeA1B1:h[4],edgeB1C1:h[5],edgeC1D1:h[6],edgeD1A1:h[7],edgeAA1:h[8],edgeBB1:h[9],edgeCC1:h[10],edgeDD1:h[11],type:"cube"},Ss.mathBoardElementStyle.point),[4,this._addJxgGraphElementHandler(t,d)];case 1:return f.sent(),[2]}}))}))},e.prototype._addMathEllipseGraph=function(t,e,r){var i=r.f1,o=r.f2,n=r.ellipsePoint;return uc(this,void 0,void 0,(function(){var r,a;return dc(this,(function(s){switch(s.label){case 0:return r=this.seqUtil.getSeq(),a=hc({seq:r,user:this.identifier,boardId:e,label:t.graphCounter.getElementLabel("ellipse"),f1:i+"",f2:o+"",ellipsePoint:n+"",type:"ellipse"},Ss.mathBoardElementStyle.circle),[4,this._addJxgGraphElementHandler(t,a)];case 1:return s.sent(),[2]}}))}))},e.prototype.addMathGraph=function(t){return uc(this,void 0,void 0,(function(){var e,r,i,o,n,a,s,l,c,h,u,d,p,f,g,m;return dc(this,(function(y){switch(y.label){case 0:return e=t.coords,r=t.boardId,i=t.mathBoardId,o=t.mathGraphs,n=this.tiwData.getElementByElementId(String(i)),a=o.reduce((function(t,e){return"point"===e.type&&t.push(e.id),t}),[]),this.mathGraphElementQue=this.mathGraphElementQue.concat(a),this.currentMathGraphType!==hl.POLYGON&&(this.mathGraphElementQue=this.mathGraphElementQue.filter((function(t,e,r){return r.indexOf(t)===e}))),0!==o.length||this.currentMathGraphType===hl.NONE?[3,11]:this.currentMathGraphType<100?(s=this.seqUtil.getSeq(),[4,this._addMathPointGraph(n,r,{x:e[0],y:e[1]},s)]):[3,2];case 1:return y.sent(),this.mathGraphElementQue.push(s+""),[3,11];case 2:return this.currentMathGraphType!==hl.CIRCULAR_CONE&&this.currentMathGraphType!==hl.CYLINDER?[3,6]:(s=this.seqUtil.getSeq(),[4,this._addMathPointGraph(n,r,{x:e[0],y:e[1]},s,!1)]);case 3:return y.sent(),this.mathGraphElementQue.push(s+""),s=this.seqUtil.getSeq(),[4,this._addMathPointGraph(n,r,{x:e[0]+2,y:e[1]},s,!1)];case 4:return y.sent(),this.mathGraphElementQue.push(s+""),s=this.seqUtil.getSeq(),[4,this._addMathPointGraph(n,r,{x:e[0],y:e[1]+4},s,!0)];case 5:return y.sent(),this.mathGraphElementQue.push(s+""),[3,11];case 6:return this.currentMathGraphType!==hl.CUBE?[3,11]:(s=this.seqUtil.getSeq(),[4,this._addMathPointGraph(n,r,{x:e[0],y:e[1]},s,!1)]);case 7:return y.sent(),this.mathGraphElementQue.push(s+""),s=this.seqUtil.getSeq(),[4,this._addMathPointGraph(n,r,{x:e[0]+2,y:e[1]},s,!1)];case 8:return y.sent(),this.mathGraphElementQue.push(s+""),s=this.seqUtil.getSeq(),[4,this._addMathPointGraph(n,r,{x:e[0]+2.8,y:e[1]+.6},s,!1)];case 9:return y.sent(),this.mathGraphElementQue.push(s+""),s=this.seqUtil.getSeq(),[4,this._addMathPointGraph(n,r,{x:e[0],y:e[1]+2},s,!1)];case 10:y.sent(),this.mathGraphElementQue.push(s+""),y.label=11;case 11:return this.currentMathGraphType!==hl.POINT?[3,12]:[3,56];case 12:return this.currentMathGraphType!==hl.LINE?[3,16]:this.mathGraphElementQue.length>=2?(g=this.mathGraphElementQue,m=g.length,n.hasGraph("line",g[m-2],g[m-1])?[3,14]:[4,this._addMathLineGraph(n,r,{vertexA:g[m-2],vertexB:g[m-1],straightFirst:!0,straightLast:!0})]):[3,15];case 13:y.sent(),y.label=14;case 14:this.mathGraphElementQue=[],y.label=15;case 15:return[3,56];case 16:return this.currentMathGraphType!==hl.LINE_SEGMENT?[3,20]:this.mathGraphElementQue.length>=2?(g=this.mathGraphElementQue,m=g.length,n.hasGraph("line-segment",g[m-2],g[m-1])?[3,18]:[4,this._addMathLineGraph(n,r,{vertexA:g[m-2],vertexB:g[m-1],straightFirst:!1,straightLast:!1})]):[3,19];case 17:y.sent(),y.label=18;case 18:this.mathGraphElementQue=[],y.label=19;case 19:return[3,56];case 20:return this.currentMathGraphType!==hl.RAY?[3,24]:this.mathGraphElementQue.length>=2?(g=this.mathGraphElementQue,m=g.length,n.hasGraph("ray",g[m-2],g[m-1])?[3,22]:[4,this._addMathLineGraph(n,r,{vertexA:g[m-2],vertexB:g[m-1],straightFirst:!1,straightLast:!0})]):[3,23];case 21:y.sent(),y.label=22;case 22:this.mathGraphElementQue=[],y.label=23;case 23:return[3,56];case 24:return this.currentMathGraphType!==hl.CIRCLE?[3,28]:this.mathGraphElementQue.length>=2?(g=this.mathGraphElementQue,m=g.length,l=g[m-2],c=g[m-1],n.hasGraph("circle",l,c)?[3,26]:[4,this._addMathCircleGraph(n,r,{centerPoint:l,circlePoint:c})]):[3,27];case 25:y.sent(),y.label=26;case 26:this.mathGraphElementQue=[],y.label=27;case 27:return[3,56];case 28:return this.currentMathGraphType!==hl.ANGLE?[3,36]:this.mathGraphElementQue.length>=3?(g=this.mathGraphElementQue,m=g.length,h=g[m-3],u=g[m-2],d=g[m-1],p=n.hasGraph("line",h,u),f=n.hasGraph("line",u,d),n.hasGraph("angle",h,u,d)?[3,34]:p?[3,30]:[4,this._addMathLineGraph(n,r,{vertexA:h,vertexB:u,straightFirst:!1,straightLast:!1})]):[3,35];case 29:y.sent(),y.label=30;case 30:return f?[3,32]:[4,this._addMathLineGraph(n,r,{vertexA:u,vertexB:d,straightFirst:!1,straightLast:!1})];case 31:y.sent(),y.label=32;case 32:return[4,this._addMathAngleGraph(n,r,{vertexA:h,vertexB:u,vertexC:d})];case 33:y.sent(),y.label=34;case 34:this.mathGraphElementQue=[],y.label=35;case 35:return[3,56];case 36:return this.currentMathGraphType!==hl.POLYGON?[3,40]:this.mathGraphElementQue.length>=2?(g=this.mathGraphElementQue,m=g.length,n.hasGraph("line-segment",g[m-2],g[m-1])?[3,38]:[4,this._addMathLineGraph(n,r,{vertexA:g[m-2],vertexB:g[m-1],straightFirst:!1,straightLast:!1})]):[3,39];case 37:y.sent(),y.label=38;case 38:g[0]===g[m-1]&&(this.mathGraphElementQue=[]),y.label=39;case 39:return[3,56];case 40:return this.currentMathGraphType!==hl.VECTOR?[3,44]:this.mathGraphElementQue.length>=2?(g=this.mathGraphElementQue,m=g.length,n.hasGraph("vector",g[m-2],g[m-1])?[3,42]:[4,this._addMathLineGraph(n,r,{vertexA:g[m-2],vertexB:g[m-1],straightFirst:!1,straightLast:!1,firstArrow:!1,lastArrow:!0,subType:"vector"})]):[3,43];case 41:y.sent(),y.label=42;case 42:this.mathGraphElementQue=[],y.label=43;case 43:return[3,56];case 44:return this.currentMathGraphType!==hl.CIRCULAR_CONE?[3,47]:this.mathGraphElementQue.length>=3?(g=this.mathGraphElementQue,m=g.length,[4,this._addMathCircularConeGraph(n,r,{centerPoint:g[m-3],xAxisPoint:g[m-2],zAxisPoint:g[m-1]})]):[3,46];case 45:y.sent(),this.mathGraphElementQue=[],y.label=46;case 46:return[3,56];case 47:return this.currentMathGraphType!==hl.CYLINDER?[3,50]:this.mathGraphElementQue.length>=3?(g=this.mathGraphElementQue,m=g.length,[4,this._addMathCylinderGraph(n,r,{centerPoint:g[m-3],xAxisPoint:g[m-2],zAxisPoint:g[m-1]})]):[3,49];case 48:y.sent(),this.mathGraphElementQue=[],y.label=49;case 49:return[3,56];case 50:return this.currentMathGraphType!==hl.CUBE?[3,53]:this.mathGraphElementQue.length>=4?(g=this.mathGraphElementQue,m=g.length,[4,this._addMathCubeGraph(n,r,{pointA:g[m-4],pointB:g[m-3],pointC:g[m-2],pointA1:g[m-1]})]):[3,52];case 51:y.sent(),this.mathGraphElementQue=[],y.label=52;case 52:return[3,56];case 53:return this.currentMathGraphType!==hl.ELLIPSE?[3,56]:this.mathGraphElementQue.length>=3?(g=this.mathGraphElementQue,m=g.length,n.hasGraph("ellipse",g[m-3],g[m-2],g[m-1])?[3,55]:[4,this._addMathEllipseGraph(n,r,{f1:g[m-3],f2:g[m-2],ellipsePoint:g[m-1]})]):[3,56];case 54:y.sent(),y.label=55;case 55:this.mathGraphElementQue=[],y.label=56;case 56:return[2]}}))}))},e.prototype.loadMathJax=function(){var t=this;window.MathJax?window.MathJax.tex2svg&&(window.MathJaxLoaded=!0):(window.MathJaxLoaded=!1,window.MathJax={startup:{pageReady:function(){delete window.MathJax._.output.svg.Wrappers.math.SVGmath.styles['mjx-container[jax="SVG"][display="true"]'].margin,window.MathJax.startup.defaultPageReady()}}},K(L.mathjaxURL,(function(){window.MathJaxLoaded=!0,t.setNeedDraw(!0)})))},e.prototype.setDiscussionGroupEnable=function(t,e){void 0===e&&(e=!0),this.settingConfig.setIsDiscussionGroupMode(t),this.setNeedDraw(!0),e&&(this.addRealtimeData({action:M.PROTOCOL_ACTION.DISCUSSION_GROUP_SETTING_ACTION,seq:this.seqUtil.getSeq(),content:{enable:t,type:Al.SET_ENABLE,groupInfo:null}}),this.report.reportEnableDiscussionGroup({enable:t})),this.event.fireClassGroupStatusChangedEvent({enable:this.settingConfig.isDiscussionGroupMode,classGroupId:"",operationType:Al.SET_ENABLE,message:""})},e.prototype.getDiscussionGroupEnable=function(){return this.settingConfig.isDiscussionGroupMode},e.prototype.addUserToDiscussionGroup=function(t,e){var r=this.getDiscussionGroupInfoById(t);if(r){r.addUser(e);var i=r.getData();this.addDiscussionGroup(t,i.boardIds,i.userIds,i.title,i.currentBoardId)}},e.prototype.removeBoardInDiscussionGroup=function(t,e){var r=this.getDiscussionGroupInfoById(t);if(r){r.removeBoard(e);var i=r.getData();e===i.currentBoardId&&(i.currentBoardId=i.boardIds.length?i.boardIds[0]:""),this.addDiscussionGroup(t,i.boardIds,i.userIds,i.title,i.currentBoardId)}},e.prototype.addBoardToDiscussionGroup=function(t,e){var r=this.getDiscussionGroupInfoById(t);if(r){r.addBoard(e);var i=r.getData();this.addDiscussionGroup(t,i.boardIds,i.userIds,i.title,i.currentBoardId)}},e.prototype.networkSniffer=function(t,e,r){var i=this;void 0===e&&(e="head"),void 0===r&&(r=5e3);var o=Wt.getTimeStamp();this.request.networkSniffer(t,e,r).then((function(e){var r=e.timeout,n=e.readyState,a=e.status,s=e.type,l=e.method,c=e.responseHeaders,h=e.response;i.logger.reportInfo(i.loggerModuleName,"network_sniffer",{code:0,cost:Wt.getTimeStamp()-o,param:{extraInfo:JSON.stringify({readyState:n,status:a,type:s,method:l,url:t,timeout:r,responseHeaders:c,response:h})}})}),(function(e){var r=e.timeout,n=e.readyState,a=e.status,s=e.type,l=e.method,c=e.responseHeaders,h=e.response;i.logger.reportInfo(i.loggerModuleName,"network_sniffer",{code:-1,cost:Wt.getTimeStamp()-o,param:{extraInfo:JSON.stringify({readyState:n,status:a,type:s,method:l,url:t,timeout:r,responseHeaders:c,response:h})}})}))},e.prototype.getActualFileType=function(t,e){return t===M.FILE_TYPE.IMG?e===M.COMMON_GROUP?Cl.WHITEBOARD:Cl.IMAGE_COURSEWARE:t===M.FILE_TYPE.VOD||t===M.FILE_TYPE.VODFILE||t===M.FILE_TYPE.LIVE?Cl.VIDEO_FILE:t===M.FILE_TYPE.H5FILE?Cl.H5_FILE:t===M.FILE_TYPE.IMAGESFILE?Cl.IMAGES_FILE:t===M.FILE_TYPE.H5PPT?Cl.H5_COURSEWARE:Cl.WHITEBOARD},e.prototype.saveDrawingButNotReportData=function(t,e){"line"===e.type&&(this.drawingButNotReportData[t]=e)},e.prototype.deleteDrawingButNotReportData=function(t){delete this.drawingButNotReportData[t]},e.prototype.getDrawingButNotReportData=function(t){var e=this.drawingButNotReportData[t];if(!e)return null;var r=[],i=[];return e.getPoints().forEach((function(t,e){var o={seq:t.seq,x:t.x,y:t.y,w:t.w,timestamp:Wt.getTimeStamp()};0!==e&&e%2!=1||r.push(o),i.push(o)})),{type:"addLine",seq:this.seqUtil.getSeq(),content:JSON.stringify({belongSeq:e.belongSeq,boardId:e.boardId,uid:e.user,colorRGBA:e.color,scale:100,width:e.thin,writing:e.writing,time:e.time,updateTime:Wt.getTimeStamp(),seq:e.seq,hidden:+!e.show,points:r,fullPoints:i,version:e.version})}},e.prototype.setScrollDistance=function(t,e,r,i){this.scrollDistance={left:Number(t.toFixed(2)).valueOf(),top:Number(e.toFixed(2)).valueOf(),offsetX:Math.max(r-this.boardWidth,0)/2,offsetY:Math.max(i-this.boardHeight,0)/2}},e.prototype.fireElementPosition=function(t,e,r){var i=this;if(0!==this.prevFireSelectedElementIds.length||0!==t.length){var o=1e4/this.boardWidth,n=1e4/this.boardHeight,a=this.scrollDistance,s=a.left,l=a.top,c=a.offsetX,h=a.offsetY,u=[],d=t.map((function(t){var e=t.getRealSize(),r=e.left,a=e.top,d=e.width,p=e.height,f=t.rectArea,g=f.minX,m=f.minY,y=f.maxX,v=f.maxY;return u.push(t.belongSeq),{elementId:"".concat(t.belongSeq),type:i.elementTypeTransformer(t),width:0|d,height:0|p,left:r-s+c|0,top:a-l+h|0,rotate:0|t.deg,locked:t.isLocked(),boundingbox:{left:g/o-s+c|0,top:m/n-l+h|0,width:(y-g)/o|0,height:(v-m)/n|0}}}));this.prevFireSelectedElementIds=u,e?this.event.fireElementPositionChangeEvent(d,r):this.event.fireSelectedElements(d)}},e.prototype.setGlobalBackgroundPic=function(t,e,r,i){void 0===i&&(i=!1),this.logger.reportInfo(this.loggerModuleName,"setGlobalBackgroundPic",{param:{url:t,mode:e,type:r}},ea.ONLY_NATIVE),this.cancelSelect(),this.tiwData.setGlobalBackgroundImage(t,e,r),i||(this.addRealtimeData({action:M.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:t,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),mode:e,type:r,cleanBoard:0,isGlobal:1}),this.report.reportGlobalBg(Y(this.getGlobalBackgroundColor()),this.getGlobalBackgroundPic())),this.setNeedDraw(!0)},e.prototype.getGlobalBackgroundPic=function(){return this.tiwData.getGlobalBackgroundImage()},e.prototype.addTextElement=function(t,e,r){var i=this,o=this.getTextFontFamily(),n=r.left,a=void 0===n?100:n,s=r.top,l=void 0===s?100:s,c=e.textContent,h=e.fontColor,u=void 0===h?this.getTextColor():h,d=e.fontSize,p=void 0===d?this.getTextSize():d,f=e.fontFace,g=void 0===f?o:f,m=e.fontStyle,y=void 0===m?this.getTextFontStyle():m,v=e.lineHeight,_=void 0===v?this.getTextLineHeight():v,E=this.getCurrentBoard(),T=g.split(",").filter((function(t){return-1===o.indexOf(t)&&i.checkTextFontFamily(t)})).join(","),b=T?T+","+o:o,S=new Wa(this.instanceKey,{x:a,y:l,deg:Number(r.deg)||0,belongSeq:t,user:this.identifier,boardId:E,show:!0,visible:!0,lockElement:!0});S.text=c,S.color=u,S.textSize=p,S.typeFace=b,S.fontStyle=y,S.lineHeight=_,this.tiwData.addElement(E,this.identifier,S),this.tiwData.insertOperation(E,new gn(this.identifier,{seq:S.belongSeq,type:this.teduToolType.toolType})),this.fireCanRedoAndUndo();var x=S.belongSeq,w=S.time,O=S.user,I=S.location,A=S.color,D=S.typeFace,C=S.textSize,P=S.fontStyle,L=S.textWidth,R=S.textHeight,N=S.scaleX,B=S.scaleY,k=S.deg,F=S.text;this.report.reportAddText({belongSeq:x,time:w,boardId:E,uid:O,x:Math.floor(I.x),y:Math.floor(I.y),colorRGBA:Y(W(A)),scale:100,updateTime:Wt.getTimeStamp(),hidden:0,typeface:D,textSize:Math.floor(C),fontStyle:P,text:encodeURI(escape(F)),text_wh:"".concat(L,",").concat(R),scaleX:N,scaleY:B,deg:k,lineHeight:_});var U={action:M.PROTOCOL_ACTION.INPUT_TEXT_ACTION,seq:t,belongSeq:x,color:Y(W(A)),scale:100,typeFace:D,textSize:Math.floor(C),fontStyle:P,time:Wt.getTimeStamp(),x:I.x,y:I.y,text:encodeURI(escape(F)),textWidth:L,textHeight:R,lineHeight:_};this.sendRequest(E,[U]),this.setNeedDraw(!0)},e.prototype.addDataHandlerForPointEraserAction=function(t,e,r){if(e==this.getCurrentBoard()){var i=t.radius*this.boardWidth/1e4;if(this.tiwData.isBoardExist(e)){var o=t.permissionMap||void 0;this.piecewiseErasure(this.insertEraserPoint(t.points,i),i,o),this.setNeedDraw(!0)}}},e.prototype.addDataHandlerForSplitLineAction=function(t,e,r){var i=this;t.data.forEach((function(o){var n=String(o.seq),a=o.lines||JSON.parse(ct(o.compressLines)),s=i.findLineByBelongSeq(e,Number(n)),l=i.splitLineData.get(n)||null;if(l){var c={};l.forEach((function(t){var e=t.lineModel;c[e.belongSeq]=!0,e.show=!1})),i.tiwData.removeElementsByFilter(e,r,(function(t){return!c[t]})),i.splitLineData.delete(n)}s&&(s.show=!1,a.forEach((function(e){var o=e.fittingPoint.headPoint,n=e.fittingPoint.headCtrlPoint,a=e.fittingPoint.tailCtrlPoint,l=e.fittingPoint.tailPoint,c=e.originPoint,h=s.getRangePointsBySeq(c.headPointSeq,c.tailPointSeq),u=[];try{if(h.forEach((function(t){u.push(s.pointTransformer(t))})),n&&n.timestamp&&u.unshift(n),o&&o.timestamp&&u.unshift(o),l.timestamp&&(a&&a.timestamp&&u.push(a),u.push(l)),!u.length)return;var d=u.shift(),p=e.belongSeq,f=p,g=Wt.getTimeStamp(),m=fs.createElement(i.instanceKey,r,{action:M.PROTOCOL_ACTION.LINE_START_ACTION,show:!0,visible:!0,color:s.color,thin:s.thin,writing:s.writing,boardId:t.boardId,scaleX:1,scaleY:1,deg:0,lineTransparent:t.lineTransparent,belongSeq:p,time:d.timestamp||g,timestamp:d.timestamp||g,x:d.x,y:d.y,w:d.w||s.thin,seq:f,originBelongSeq:p,originSeq:p,lockElement:!1},"v2");m.setBoardSize(i.boardWidth,i.boardHeight),i.renderHandler.addToRenderMap(m.ID,new ms(m)),m.setBorder(d.x,d.y),u.forEach((function(t,r){var i=t.x,o=t.y,n=t.w,a=t.timestamp;++f,m.addPoint({action:r===u.length-1?M.PROTOCOL_ACTION.LINE_END_ACTION:M.PROTOCOL_ACTION.LINE_MOVE_ACTION,x:i,y:o,w:n||e.thin,belongSeq:p,seq:f,timestamp:a,originSeq:f}),r===u.length-1&&(m.endSeq=f),m.setBorder(i,o)}));var y=m.getPoints();if(1===y.length){var v=y[0],_=v.x,E=v.y,T=v.w,b=v.timestamp;f+=1,m.addPoint({action:M.PROTOCOL_ACTION.LINE_END_ACTION,x:_,y:E,w:T||e.thin,belongSeq:p,seq:f,timestamp:b,originSeq:f}),m.endSeq=f}if(m){m.drawIndex=m.getPoints().length;var S=m.boardId,x=m.user;i.tiwData.addElement(S,x,m,s,!0),i.seqLineMap[m.belongSeq]=m}}catch(t){}})))})),this.setNeedDraw(!0)},e.prototype.addDataHandlerForGraphArcAction=function(t,e,r){t.show=!0;var i=Ll.createElement(this.instanceKey,r,t);i.setBoardSize(this.boardWidth,this.boardHeight),i.setBorder();var o=Rl.createElement(i);this.renderHandler.addToRenderMap(i.ID,o),this.tiwData.addElement(e,r,i)},e.prototype.addDataHandlerForMathToolAction=function(t,e,r){var i,o=t.belongSeq,n=this.mathToolMap.get(o+"");if(n){var a=t.lock||!1,s=t.lockTime||ns.LOCK_RELEASE_TIMESTAMP;a?s<=n.lockTime&&(n.lock=!1,n.lockTime=s,n.reset(hc(hc({},t),{x:t.x,y:t.y,width:t.width,height:t.height,brushColor:t.compassDrawing?t.brushColor:this.color})),clearTimeout(this.mathToolLockReleaseTimer["".concat(o)]),this.mathToolLockReleaseTimer["".concat(o)]=setTimeout((function(){n.resetPointerId(),n.lock=!1,n.lockTime=ns.LOCK_RELEASE_TIMESTAMP}),1e3)):n.lock||(n.lock=!1,n.lockTime=s,n.reset(hc(hc({},t),{x:t.x,y:t.y,width:t.width,height:t.height,brushColor:t.compassDrawing?t.brushColor:this.color})),clearTimeout(this.mathToolLockReleaseTimer["".concat(o)]),s!==ns.LOCK_RELEASE_TIMESTAMP&&(this.mathToolLockReleaseTimer["".concat(o)]=setTimeout((function(){n.resetPointerId(),n.lock=!1,n.lockTime=ns.LOCK_RELEASE_TIMESTAMP}),1e3)))}else this.addMathTool(t.toolType,{x:t.x,y:t.y,width:t.width,height:t.height,deg:t.deg,user:r,boardId:e,belongSeq:o,show:t.show,visible:null===(i=t.visible)||void 0===i||i,zIndex:t.zIndex,baseAngle:t.baseAngle,testAngle:t.testAngle,compassesLegLength:t.compassesLegLength,compassesLegAnchorOffset:t.compassesLegAnchorOffset,compassesResizeBtnOffset:t.compassesResizeBtnOffset,compassesHeaderLength:t.compassesHeaderLength,boardWidth:this.boardWidth,boardHeight:this.boardHeight,brushColor:t.brushColor||this.color,lineType:mn.TEDU_BOARD_LINE_TYPE_SOLID},!1)},e.prototype.addDataHandlerForWatermarkAction=function(t,e,r){var i;if((1*t.seq||0)<this.maxWatermarkElementSeq)this.logger.reportInfo(this.loggerModuleName,"throw_seq",{param:{extraInfo:JSON.stringify({seq:t.seq,maxWatermarkElementSeq:this.maxWatermarkElementSeq,boardId:e,method:"addData"})}},ea.ONLY_ONLINE);else{this.maxWatermarkElementSeq=t.seq;var o=this.tiwData.getElementByElementId(t.belongSeq);o?(o.width=t.width,o.height=t.height,o.x=t.x,o.y=t.y,o.deg=t.deg):this.addWatermarkElement(t.belongSeq,{belongSeq:t.belongSeq,userId:r,boardId:e,content:t.content,left:t.x,top:t.y,time:t.time,width:t.width,height:t.height,deg:t.deg,color:t.color,opacity:t.opacity,show:t.show,visible:null===(i=t.visible)||void 0===i||i,ratio:t.ratio,fix:t.fix,interval:t.interval,textSize:t.textSize,lockElement:t.lockElement},Va.Realtime)}},e.prototype.findLineByBelongSeq=function(t,e){return this.tiwData.getElementByElementId(e)},e.prototype.setPiecewiseErasureEnable=function(t){this.eraserMode=t?1:0},e.prototype.setEraserMode=function(t){this.eraserMode=t},e.prototype.isPiecewiseErasureEnable=function(){return!!this.eraserMode},e.prototype.setEraserSize=function(t){this.piecewiseErasureSize=t},e.prototype.getEraserSize=function(){return this.piecewiseErasureSize},e.prototype.formatLinePoints=function(t){var e=this,r=this.tiwData.getElementsByBoardId(t);r&&r.forEach((function(t){"line"===t.type&&t.getNeedFormat()&&t.formatHistoryPoints()&&e.tiwData.replaceElement(t.belongSeq,Za.deepProxy(t,t))}))},e.prototype.insertEraserPoint=function(t,e){for(var r=[],i=0;i<t.length-1;i++){var o={x:t[i].x/1e4*this.boardWidth,y:t[i].y/1e4*this.boardHeight},n={x:t[i+1].x/1e4*this.boardWidth,y:t[i+1].y/1e4*this.boardHeight},a=Lt(o.x,o.y,n.x,n.y),s=Math.floor(a/e),l={x:(n.x-o.x)/a*e,y:(n.y-o.y)/a*e};for(r.push(t[i]);s--;)r.push({x:(o.x+(s+1)*l.x)/this.boardWidth*1e4,y:(o.y+(s+1)*l.y)/this.boardHeight*1e4});i===t.length-2&&r.push(t[i+1])}return r},e.prototype.canAddMathTool=function(t){var e,r=this,i=((e={})[$a.RULER]=1,e[$a.TRIANGLE]=1,e[$a.ISOSCELES_TRIANGLE]=1,e[$a.PROTRACTOR]=1,e[$a.COMPASSES]=1,e),o={};return this.mathToolMap.forEach((function(t){t.show&&t.getBoardId()===r.getCurrentBoard()&&(o[t.toolType]=(o[t.toolType]||0)+1)})),!(o[t]+1>i[t])},e.prototype.addMathTool=function(t,e,r){var i=this;void 0===e&&(e=null),void 0===r&&(r=!0),this.logger.reportInfo(this.loggerModuleName,"addMathTool",{param:{extraInfo:JSON.stringify({mathToolType:t,boardWidth:this.boardWidth,boardHeight:this.boardHeight})}},ea.ONLY_ONLINE);var o=e;o||(o={x:2500,y:2500,boardWidth:this.boardWidth,boardHeight:this.boardHeight,brushColor:this.color,lineType:mn.TEDU_BOARD_LINE_TYPE_SOLID,user:this.identifier,boardId:this.getCurrentBoard(),belongSeq:this.seqUtil.getSeq()});var n=this.mathToolMap.get(o.belongSeq+"");if(!n){n=new ns(this.instanceKey,o,t,this);var a=null,s=Qt((function(){a&&i.addRealtimeData(a),i.addRealtimeData(n.getRealTimeData())}),200);n.bindCallback((function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(1===t)i.fireElementPosition([n],!0,lc.TEDU_BOARD_POSITION_CHANGE_START);else if(2===t){var o=e[0],l=e[1],c=!1;i.getMathTool().forEach((function(t){t.show&&t.getBoardId()===i.getCurrentBoard()&&t.checkInContainer(l,o.target)&&(c=!0)})),c&&o.stopPropagation()}else if(3===t){var h=e[0],u=e[1],d=e[2]/180*Math.PI,p=e[3],f=e[4];h.x=h.x/i.boardWidth*1e4,h.y=h.y/i.boardHeight*1e4,u.x=u.x/i.boardWidth*1e4,u.y=u.y/i.boardHeight*1e4,i.permissionHandler.filter("Element::Add::Graph",[{operator:i.identifier}],"down"===f)&&("down"===f?(a=null,i.collectGraphArcData().start(h,u,d,p)):"move"===f?a=i.collectGraphArcData().draw(d,p)||null:"up"===f&&(a=null,i.collectGraphArcData().end(d,p)))}else 4===t?(s(),clearTimeout(i.mathToolLockReleaseTimer["".concat(n.belongSeq)]),i.mathToolLockReleaseTimer["".concat(n.belongSeq)]=setTimeout((function(){n.resetPointerId(),n.lock=!1,n.lockTime=ns.LOCK_RELEASE_TIMESTAMP,s(),i.reportElement(n.getReportData())}),5e3),i.fireElementPosition([n],!0,lc.TEDU_BOARD_POSITION_CHANGING)):5===t&&(clearTimeout(i.mathToolLockReleaseTimer["".concat(n.belongSeq)]),s(),i.reportElement(n.getReportData()),i.fireElementPosition([n],!0,lc.TEDU_BOARD_POSITION_CHANGE_END))})),n.setBoardSize(this.boardWidth,this.boardHeight),this.mathToolMap.set(o.belongSeq+"",n),this.tiwData.addElement(n.getBoardId(),n.user,n)}this.setGraphStyle({lineType:mn.TEDU_BOARD_LINE_TYPE_SOLID,startArrowType:At.TEDU_BOARD_ARROW_TYPE_NONE,endArrowType:At.TEDU_BOARD_ARROW_TYPE_NONE}),n.setLineType(mn.TEDU_BOARD_LINE_TYPE_SOLID),this.setNeedDraw(!0),n&&r&&(this.addRealtimeData(n.getRealTimeData()),this.reportElement(n.getReportData())),this.event.fireAddElementEvent({id:String(o.belongSeq),type:Ta.TEDU_BOARD_ELEMENT_MATH_TOOL,userData:""})},e.prototype.getMathTool=function(){return this.mathToolMap},e.prototype.enablePenAutoFit=function(t,e){void 0===e&&(e=2e3),this.enableLineAutoFit=t,this.autoLineFitDelay=e,this.lineFitMode=t?xs.AUTO:xs.NONE,this.logger.reportInfo(this.loggerModuleName,"enablePenAutoFit",{param:{extraInfo:JSON.stringify({enable:t,delay:e})}},ea.ONLY_ONLINE)},e.prototype.getPenFitSetting=function(){return{isAuto:this.enableLineAutoFit,delay:this.autoLineFitDelay,mode:this.lineFitMode}},e.prototype.getElementById=function(t){var e=this,r=function(){var r=null,i=e.tiwData.getElementByElementId(t);if(i){var o=1e4/e.boardWidth,n=1e4/e.boardHeight,a=e.scrollDistance,s=a.left,l=a.top,c=a.offsetX,h=a.offsetY,u=i.getRealSize(),d=u.left,p=u.top,f=u.width,g=u.height,m=i.rectArea,y=m.minX,v=m.minY,_=m.maxX,E=m.maxY;r={elementId:i.getElementId(),type:e.elementTypeTransformer(i),boardId:i.boardId,userId:i.user||i.userId,show:i.isElementDisplay(),select:i.select,title:i.title||"",textSize:i.textSize||0,content:i.content||"",opacity:i.opacity||1,deg:i.deg||0,interval:i.interval||0,url:i.url||i._url||"",locked:i.isLocked(),boundingbox:{left:Number((y/o-s+c).toFixed(2)).valueOf()||0,top:Number((v/n-l+h).toFixed(2)).valueOf()||0,width:Number(((_-y)/o).toFixed(2)).valueOf()||0,height:Number(((E-v)/n).toFixed(2)).valueOf()||0},rect:{left:Number((d-s+c).toFixed(2)).valueOf()||0,top:Number((p-l+h).toFixed(2)).valueOf()||0,width:Number(f.toFixed(2)).valueOf()||0,height:Number(g.toFixed(2)).valueOf()||0,rotate:i.deg||0},style:{borderWidth:i.thin||0,borderColor:i.color,fill:i.solid,fillColor:i.color,borderType:i.style?i.style.lineType:mn.TEDU_BOARD_LINE_TYPE_SOLID,startArrowType:i.style?i.style.startArrowType:At.TEDU_BOARD_ARROW_TYPE_NONE,endArrowType:i.style?i.style.endArrowType:At.TEDU_BOARD_ARROW_TYPE_NONE,left:0,top:0}},i instanceof ns&&(r.style.left=i._x,r.style.top=i._y)}return r}();return this.logger.reportInfo(this.loggerModuleName,"getElementById",{param:{elementId:t}},ea.ONLY_ONLINE),JSON.parse(JSON.stringify(r))},e.prototype.updateElementById=function(t,e){var r=this;!function(e){var i=r.tiwData.getElementByElementId(t);if(i&&e){if(e.type===Dl.EL_DELETE)return void r.removeElement(t);var o={origin:[],final:[]};switch(e.type){case Dl.CHANGE_TEXT_SIZE:if(i instanceof Wa||i instanceof Sl||i instanceof oc){var n=e.value;n=i instanceof Sl||i instanceof oc?nc(n,r.boardHeight):ac(n,r.boardHeight),n=Math.max(12,n),o.origin.push({seq:i.belongSeq,uid:i.user,textSize:i.textSize}),o.final.push({seq:i.belongSeq,uid:i.user,textSize:n}),i.textSize=n}break;case Dl.BOARDER_COLOR:n="".concat(e.value),o.origin.push({seq:i.belongSeq,uid:i.user,color:i.color}),o.final.push({seq:i.belongSeq,uid:i.user,color:n}),i.color=n;break;case Dl.BOARDER_WIDTH:n=Number(e.value).valueOf(),o.origin.push({seq:i.belongSeq,uid:i.user,thin:i.thin}),o.final.push({seq:i.belongSeq,uid:i.user,thin:n}),i.thin=n;break;case Dl.BOARDER_LINE_TYPE:i.style||(i.style={}),o.origin.push({seq:i.belongSeq,uid:i.user,style:JSON.parse(JSON.stringify(i.style))}),i.style.lineType=e.value,o.final.push({seq:i.belongSeq,uid:i.user,style:JSON.parse(JSON.stringify(i.style))});break;case Dl.CHANGE_POSITION:var a=[];a.push(i),r.updateElementOperationForPosition(a),i.style||(i.style={}),(e.value.offsetX||e.value.offsetY)&&i.setPosition(e.value.offsetX,e.value.offsetY,!0),r.updateElements(a),r.updateElementOperationForPosition(a,!0);break;case Dl.CONTENT:(n=e.value)&&n!==i.content&&(o.origin.push({seq:i.belongSeq,uid:i.user,content:i.content}),o.final.push({seq:i.belongSeq,uid:i.user,content:n}),i.content=n);break;case Dl.OPACITY:n=Math.min(1,Math.max(Number(e.value).valueOf(),.1)),o.origin.push({seq:i.belongSeq,uid:i.user,opacity:i.opacity}),o.final.push({seq:i.belongSeq,uid:i.user,opacity:n}),i.opacity=n;break;case Dl.ROTATION_ANGLE:var s=e.value;o.final.push({seq:i.belongSeq,uid:i.user,deg:s}),i.setRotate(s)}e.type!==Dl.CHANGE_POSITION&&r.tiwData.insertOperation(r.getCurrentBoard(),new gn(r.identifier,{seq:o,type:rc.ELEMENT_UPDATE}));var l=o.final;if(r.addRealtimeData({action:M.PROTOCOL_ACTION.BROADCAST_ELEMENT_STYLE,seq:r.seqUtil.getSeq(),attrs:l}),i.setBorder(),i.subType!==Ta.TEDU_BOARD_ELEMENT_MATH_TOOL){var c=[];c.push(i.getElementOperatorReportData()),r.report.reportUpdateContent(c)}r.fireCanRedoAndUndo(),r.setNeedDraw(!0)}}(e),e.elementID=t,this.logger.reportInfo(this.loggerModuleName,"updateElementById",{param:{elementId:t,extraInfo:JSON.stringify(e)}},ea.ONLY_ONLINE)},e.prototype.getLaserRecordId=function(t,e){return void 0===e&&(e="0"),"".concat(t,"_").concat(e)},e.prototype.enableShowGraffiti=function(t){this.showGraffiti=t,this.setNeedDraw(!0)},e.prototype.getShowGraffiti=function(){return this.showGraffiti},e.prototype.addWatermarkElement=function(t,e,r){var i=this;void 0===r&&(r=Va.Local);var o=this.tiwData.getWatermarkElements(),n=oc.getWatermarkType(e.content,e.fix);if(r===Va.Local&&e.show){if(n===Nl.Image&&o.imageWatermarkElement)return void this.event.fireWarningEvent($.TEDU_BOARD_WARNING_IMAGE_WATERMARK_ALREADY_EXISTS,String(o.imageWatermarkElement.getElementId()).valueOf());if(n===Nl.Text&&o.textWatermarkElement||n===Nl.TextFix&&o.fixTextWatermarkElement){var a=n===Nl.Text?o.textWatermarkElement:o.fixTextWatermarkElement;return void this.event.fireWarningEvent($.TEDU_BOARD_WARNING_TEXT_WATERMARK_ALREADY_EXISTS,String(a.getElementId()).valueOf())}}var s=this.getCurrentBoard(),l=M.COMMON_DEFAULT_BOARD,c=e.content;if(c){var h=oc.Default_FontSize;if(r===Va.Local?(this.logger.reportInfo(this.loggerModuleName,"addWatermarkElement",{param:{boardId:s,extraInfo:JSON.stringify(e)}},ea.ONLY_ONLINE),h=nc(e.textSize||oc.Default_FontSize,this.boardHeight)):h=e.textSize,t||(t=this.seqUtil.getSeq()),!this.tiwData.getElementByElementId(t+"")){var u=e.userId,d=new oc(this.instanceKey,{belongSeq:t,userId:u,content:c,erasable:!1,x:e.left,y:e.top,width:e.width,height:e.height,boardWidth:this.boardWidth,boardHeight:this.boardHeight,deg:Number(e.deg)||0,color:e.color,opacity:e.opacity,show:e.show,visible:e.visible,ratio:e.ratio,fix:e.fix,interval:e.interval,textSize:h,lockElement:e.lockElement},{store:{getDomainMap:this.getDomainMap.bind(this),getAccessibleDomains:this.getAccessibleDomains.bind(this),addAccessibleDomain:this.addAccessibleDomain.bind(this),getImageTimeout:this.getImageTimeout.bind(this),getUserInfo:this.getUserInfo.bind(this)}}),p=function(){if(r===Va.Local){var o=d.getReportData();i.addRealtimeData(d.getRealTimeData()),i.report.reportElement(o),i.tiwData.insertOperation(l,new gn(i.identifier,{seq:d.belongSeq,subType:Ta.TEDU_BOARD_ELEMENT_WATERMARK,type:rc.ELEMENT})),i.logger.reportInfo(i.loggerModuleName,"add_watermark_element",{param:{extraInfo:JSON.stringify(o)}},ea.ONLY_ONLINE),i.fireCanRedoAndUndo(),i.event.fireAddElementEvent({id:String(t),type:Ta.TEDU_BOARD_ELEMENT_WATERMARK,userData:e.userData})}i.tiwData.addElement(l,u,d),i.setNeedDraw(!0)};d.watermarkType===Nl.Image&&r===Va.Local?d.getImageSize(e.customWidth||0,e.customHeight||0,(function(){p()})):p()}}},e.prototype.exportInLocalMode=function(t){var e,r=this;try{e=this._formatExportImportFilter(t)}catch(t){return void this.event.fireWarningEvent($.TEDU_BOARD_WARNING_EXPORTIMPORT_FILTERRULE_ILLEGAL,t.message)}var i=fc(this._validExportImportFilter(e),2),o=i[0],n=i[1];if(o){this._validElementTypesExists(e.exclude.types.concat(e.hide.types))||this.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENTTYPE_NOT_EXISTS,"exportInLocalMode: element type does not exist"),this._validElementIdsExists(e.exclude.ids.concat(e.hide.ids))||this.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENTID_NOT_EXISTS,"exportInLocalMode: element id does not exist");var a=[],s=[];this.tiwData.boardBackgroundMap.forEach((function(t,e){a.push({key:e,value:t})}));var l=[],c=[],h=function(t,r,i,o){if(e.exclude.types.length&&e.exclude.types.includes(r))l.push({boardId:i,elementId:o});else if(e.exclude.ids.length&&e.exclude.ids.includes(o))l.push({boardId:i,elementId:o});else{if(e.hide.types.includes(r)||e.hide.ids.includes(o)){var n=JSON.parse(t.content);n.hidden=1,n.visible=0,t.content=JSON.stringify(n),c.push({boardId:i,elementId:o})}else{if(e.include.ids.length&&!e.include.ids.includes(o))return void l.push({boardId:i,elementId:o});if(e.include.types.length&&!e.include.types.includes(r))return void l.push({boardId:i,elementId:o})}t.boardId=i,t.elementId=o,t.elementType=r,s.push(t)}};this.tiwData.getAllElements().forEach((function(t){t.show;var e=t.getElementId(),i=t.getReportDataForHistory(!1),o=r.elementTypeTransformer(t),n=t.getBoardId();if(h(i,o,n,e),t.subType===Ta.TEDU_BOARD_ELEMENT_MATH_BOARD)for(var a in t.graphs){var s=t.graphs[a],l=s.getReportDataForHistory(!1);h(l,Ta.TEDU_BOARD_ELEMENT_MATH_GRAPH,n,s.getElementId())}}));var u=this.tiwData.getOperationDataAndIndexMap(),d=fc(Fl(u.dataMap,u.indexMap),2),p=d[0],f=d[1];l.concat(c).forEach((function(t){var e=t.boardId,r=t.elementId;kl(p,e,+r)&&Bl(p,f,e,+r)}));var g={dataMap:Object.fromEntries(p.entries()),indexMap:Object.fromEntries(f.entries())},m={files:this.groups,boards:this.boardList,elements:s,currentBoardId:this.getCurrentBoard(),currentFileId:this.getCurrentFile(),boardBackgroundMap:a,dragData:this.dragDataList.getAllDragData(),ratio:this.settingConfig.boardRatio,boardRemark:this.getBoardRemark(""),operationRecord:g},y=lt(JSON.stringify(m));return this.logger.reportInfo(this.loggerModuleName,"exportInLocalMode",{param:{extraInfo:y}},ea.ONLY_NATIVE),y}this.event.fireWarningEvent($.TEDU_BOARD_WARNING_EXPORTIMPORT_FILTERRULE_ILLEGAL,n)},e.prototype.importInLocalMode=function(t,e,r){var i,o=this;try{i=this._formatExportImportFilter(e)}catch(t){return void this.event.fireWarningEvent($.TEDU_BOARD_WARNING_EXPORTIMPORT_FILTERRULE_ILLEGAL,t.message)}var n=fc(this._validExportImportFilter(i),2),a=n[0],s=n[1];if(a){if(this._validElementTypesExists(i.exclude.types.concat(i.hide.types))||this.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENTTYPE_NOT_EXISTS,"importInLocalMode: element type does not exist"),this.logger.reportInfo(this.loggerModuleName,"importInLocalMode",{param:{extraInfo:"importInLocalMode.length:"+t.length}},ea.ONLY_ONLINE),this.logger.reportInfo(this.loggerModuleName,"importInLocalMode",{param:{extraInfo:t}},ea.ONLY_NATIVE),t)try{var l=JSON.parse(ct(t));this.clearAll(!0,r),this.setNeedDraw(!0),l.boardBackgroundMap.forEach((function(t){o.tiwData.boardBackgroundMap.set(t.key,t.value)}));var c=l.files;if(this.groups=c,B(c)){var h=[Cl.H5_COURSEWARE,Cl.IMAGE_COURSEWARE];c.forEach((function(t){var e=t.type,r=t.fid;h.includes(t.fileType)?o.event.fireAddTranscodeFileEvent(r):e===M.FILE_TYPE.IMG?o.event.fireAddFileEvent(r):e===M.FILE_TYPE.IMAGESFILE?o.event.fireAddImagesFileEvent(r):o.event.fireAddH5PPTFileEvent(r)}))}this.addBoard(l.boards,!1,r),this.currentBoard=l.currentBoardId,this.currentGroup=l.currentFileId;var u=[],d=[],p=[],f=[];l.elements.forEach((function(t){var e=t.elementId;f.push(e);var r=t.elementType,o=t.boardId;if(o||(o=JSON.parse(t.content).boardId),i.exclude.types.length&&i.exclude.types.includes(r))u.push({boardId:o,elementId:e});else if(i.exclude.ids.length&&i.exclude.ids.includes(e))u.push({boardId:o,elementId:e});else{if(i.hide.types.includes(r)||i.hide.ids.includes(e)){var n=JSON.parse(t.content);n.hidden=1,n.visible=0,t.content=JSON.stringify(n),d.push({boardId:o,elementId:e})}else{if(i.include.types.length&&!i.include.types.includes(r))return void u.push({boardId:o,elementId:e});if(i.include.ids.length&&!i.include.ids.includes(e))return void u.push({boardId:o,elementId:e})}p.push(t)}})),this.addHistory(p);var g=this._validElementIdsExists(i.exclude.ids.concat(i.hide.ids),f);for(var m in g||this.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENTID_NOT_EXISTS,"importInLocalMode: element id does not exist"),l.dragData)this.dragDataList.addDragData(m,new Kn(this.seqUtil,{scale:l.dragData[m].scale,xOffset:l.dragData[m].xOffset,yOffset:l.dragData[m].yOffset}));for(var m in l.ratio)this.setBoardRatio(m,l.ratio[m],!1);this.boardRemarkMap=l.boardRemark||{};var y=new Map(Object.entries(l.operationRecord.dataMap)),v=new Map(Object.entries(l.operationRecord.indexMap)),_=fc(Fl(y,v),2),E=_[0],T=_[1];this.tiwData.setOperationDataAndIndexMap(E,T),u.concat(d).forEach((function(t){var e=t.boardId,r=t.elementId;o.tiwData.isOperationExistInAllOperations(e,+r)&&o.tiwData.removeOperationBySeq(e,+r)})),setTimeout((function(){o.event.fireSwitchFileEvent(o.currentGroup),o.event.fireGotoBoardEvent(o.currentBoard,o.currentGroup,r),o.fireCanRedoAndUndo(),o.setNeedDraw(!0)}),100),this.event.fireImportInLocalMode(sc.SUCCESS)}catch(t){this.event.fireImportInLocalMode(sc.PARSE_DATA_ERROR)}}else this.event.fireWarningEvent($.TEDU_BOARD_WARNING_EXPORTIMPORT_FILTERRULE_ILLEGAL,s)},e.prototype.getBackgroundImage=function(t,e){return void 0===e&&(e=!1),this.tiwData.getBackgroundPicture(t||this.getCurrentBoard(),e)},e.prototype.exportSelectedElementsData=function(){var t=[];return this.getSelectList().forEach((function(e){if(e.show&&(t.push(e.getReportDataForHistory(!1)),e.subType===Ta.TEDU_BOARD_ELEMENT_MATH_BOARD))for(var r in e.graphs)t.push(e.graphs[r].getReportDataForHistory(!1))})),t},e.prototype.importElementsData=function(t,e){var r=this,i=Number((1e4*(e[0]||0)/this.boardWidth).toFixed(2)).valueOf(),o=Number((1e4*(e[1]||0)/this.boardHeight).toFixed(2)).valueOf(),n=[],a=0,s=function(t,e,r){e.x+=i,e.y+=o,e.originSeq+=t-a,e.seq+=t-a};t.forEach((function(t){var e=JSON.parse(t.content);if(e.subType!==Ta.TEDU_BOARD_ELEMENT_WATERMARK){e.boardId=r.getCurrentBoard();var l=r.seqUtil.getSeq();n.push(l),a=e.belongSeq,e.belongSeq=l,e.user=r.identifier,"addLine"===t.type?(e.fullPoints.forEach((function(t,e){s(l,t)})),e.points.forEach((function(t,e){s(l,t)}))):(e.x+=i,e.y+=o),t.content=JSON.stringify(e)}})),this.addHistory(t),n.forEach((function(t){var e=r.tiwData.getElementByElementId(t);e&&(r.addRealtimeData(e.getRealTimeData()),"line"===e.type?r.report.reportAddLine(e.getReportDataForHistory(!0)):"imageElement"===e.type&&r.report.reportImageElement(e.getReportData()))}))},e.prototype.setElementsDisplay=function(t,e,r){var i=this,o=Bo.DISPLAY;o=r?Bo.DISPLAY:Bo.HIDE;var n=this.tiwData.getAllElements(),a=[];B(t)?this._validElementTypesExists(t)||this.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENTTYPE_NOT_EXISTS,"setElementsDisplay: element type does not exist"):t=[],B(e)?this._validElementIdsExists(e)||this.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENTID_NOT_EXISTS,"setElementsDisplay: element id does not exist"):e=[],n.forEach((function(r){if(!r.isLocked()){var n=i.elementTypeTransformer(r);return 0===t.length&&0===e.length?(a.push({uid:r.user,seq:+r.getElementId()}),void r.setElementDisplay(o)):t.includes(n)?(r.setElementDisplay(o),void a.push({uid:r.user,seq:+r.getElementId()})):e.includes(r.getElementId())?(a.push({uid:r.user,seq:+r.getElementId()}),void r.setElementDisplay(o)):void 0}i.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENT_IS_LOCKED,r.getElementId())})),a.length&&(this.reportEraserData(this.getCurrentBoard(),a,o,!0,-100),this.cancelSelect(),this.setNeedDraw(!0))},e.prototype.sendRefreshData=function(){var t=this.seqUtil.getSeq();this.addRealtimeData({action:M.PROTOCOL_ACTION.BROADCAST_LINUX_FORCEREFRESH,time:Wt.getTimeStamp(),seq:t})},e.prototype._formatExportImportFilter=function(t){var e={include:{types:[],ids:[]},exclude:{types:[],ids:[]},hide:{types:[],ids:[]}},r={};if(R(t))try{r=JSON.parse(t)}catch(e){if(""!==t)throw new Error("filter condition illegal");r={}}else r=t||{};return Object.keys(e).forEach((function(t){r[t]&&(e[t].types=r[t].types||[],e[t].ids=r[t].ids||[])})),e},e.prototype._validExportImportFilter=function(t){var e=function(t,e){return t.length+e.length!==Array.from(new Set(gc(gc([],fc(t),!1),fc(e),!1))).length};return(null==t?void 0:t.include)&&t.exclude&&e(t.include.types,t.exclude.types)?[!1,"filter condition conflict between include.types and exclude.types"]:(null==t?void 0:t.include)&&t.exclude&&e(t.include.ids,t.exclude.ids)?[!1,"filter condition conflict between include.ids and exclude.ids"]:[!0,""]},e.prototype._validElementTypesExists=function(t){var e=Object.values(Ta);return!t.some((function(t){return!e.includes(t)}))},e.prototype._validElementIdsExists=function(t,e){var r=this;return!t.some((function(t){return e?!e.includes(t):!r.tiwData.isElementExist(t)}))},e.prototype.lockElements=function(t,e){var r=this,i=[],o=[],n=[],a={origin:[],final:[]};t.forEach((function(t){var s=r.tiwData.getElementByElementId(t);s&&(n.push(s.getElementId()),s.isLocked()!==e&&(s.setLockElement(e),i.push({seq:s.getElementId(),uid:s.user,lockElement:s.lockElement}),o.push(s.getElementOperatorReportData()),a.origin.push({seq:s.belongSeq,uid:s.user,lockElement:!e}),a.final.push({seq:s.belongSeq,uid:s.user,lockElement:e})))})),n.length&&(i.length&&(this.tiwData.insertOperation(this.getCurrentBoard(),new gn(this.identifier,{seq:a,type:rc.ELEMENT_UPDATE})),this.addRealtimeData({action:M.PROTOCOL_ACTION.BROADCAST_ELEMENT_STYLE,seq:this.seqUtil.getSeq(),attrs:i}),this.report.reportUpdateContent(o)),this.event.fireElementLockedChanged(n,e),this.fireCanRedoAndUndo())},e.prototype.setH5PPTMediaPlaybackStatus=function(t,e,r){var i=this;if("WPS"===q(this.getFileInfo().downloadURL))bs.instance.changeAllMediaStatus(r);else{if(0===t.length)return;t.forEach((function(t){var o={id:t,type:0===e?"video":"audio",playstate:r?1:2};jn.pptMediaAction(i.iframeDom,i.seqUtil.getSeq(),hc(hc({},o),{isPassiveMediaAction:!1}))}))}},e}(X),yc="\n    .tic-board__audiowrap {\n      pointer-events: none;\n      position: absolute;\n      z-index: 50;\n      width:100%;\n      height:100%;\n      top: 0;\n      left: 0;\n      font-size: 12px;\n    }\n\n    .tiw-audio__wrap {\n      position: absolute;\n      pointer-events: auto;\n      display: flex;\n      align-items: center;\n      background: #f1f3f4;\n      height: 54px;\n      padding: 0 2%;\n      border-radius: 200px;\n      box-sizing: border-box;\n      cursor: auto;\n    }\n\n    .tiw-audio__wrap .tiw-play__btn {\n      width: 6.5%;\n      height: 100%;\n      cursor: pointer;\n      background-size: contain;\n      background-repeat: no-repeat;\n      background-position: center center;\n    }\n\n    .tiw-audio__wrap .tiw-play__btn.disable {\n      cursor: not-allowed;\n    }\n\n    .tiw-audio__wrap .tiw-play__btn:hover {\n      transform: scale(1.2);\n      -webkit-transform: scale(1.2);\n    }\n\n    .tiw-audio__wrap .tiw-play__btn.disable:hover {\n      transform: scale(1);\n      -webkit-transform: scale(1);\n    }\n\n    .tiw-audio__wrap .tiw-play__btn.start-btn {\n      background-image: url(".concat(L.audioIcons.startIcon,");\n    }\n\n    .tiw-audio__wrap .tiw-play__btn.pause-btn {\n      background-image: url(").concat(L.audioIcons.pauseIcon,");\n    }\n\n    .tiw-audio__wrap .tiw-play__btn.start-btn.disable {\n      background-image: url(").concat(L.audioIcons.disableStartIcon,");\n    }\n\n    .tiw-audio__wrap .tiw-play__btn.pause-btn.disable {\n      background-image: url(").concat(L.audioIcons.disablePauseIcon,");\n    }\n\n    .tiw-audio__wrap .tiw-play__time-progress {\n      padding: 0 3%;\n      font-size: 108%;\n      width: 28%;\n      transform-origin: 0;\n      font-family: customFontFamily;\n      color: #0b0b0b;\n      word-break: keep-all;\n    }\n\n    .tiw-audio__wrap .tiw-play__time-split {\n      margin: 2px;\n    }\n\n    .tiw-audio__wrap .tiw-play__bar-progress-wrap {\n      flex: 1;\n      height: 100%;\n      tap-highlight-color: rgba(0, 0, 0, 0);\n      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n    }\n\n    .tiw-audio__wrap .tiw-play__bar-progress {\n      position: relative;\n      background: #c1c2c3;\n      height: 6%;\n      border-radius: 4px;\n      top: 50%;\n      transform: translateY(-50%);\n      -webkit-transform:translateY(-50%);\n      cursor: pointer;\n    }\n\n    .tiw-audio__wrap .tiw-play__bar-progress.disable {\n      cursor: not-allowed;\n    }\n\n    .tiw-audio__wrap .tiw-play__bar-progress:hover {\n      box-shadow:0px 0px 4px #c1c2c3;\n      -webkit-box-shadow:0px 0px 4px #c1c2c3; \n    }\n\n    .tiw-audio__wrap .tiw-play__bar-progress.disable:hover {\n      box-shadow:none;\n      -webkit-box-shadow:none;\n    }\n\n    .tiw-audio__wrap .tiw-play__bar-progress .tiw-progress__real {\n      pointer-events: none;\n      background: #0b0b0b;\n      height: 100%;\n      width: 0;\n      border-radius: 4px;\n    }\n    \n    .tiw-audio__wrap .tiw-play__bar-progress .tiw-progress__circle {\n      position: absolute;\n      width: 12px;\n      height: 12px;\n      border-radius: 50%;\n      background-color: #0b0b0b;\n      top: -4px;\n    }\n\n    .tiw-audio__wrap .tiw-play__bar-progress .tiw-progress__circle:hover {\n      transform: scale(1.2, 1.2);\n      -webkit-transform: scale(1.2, 1.2);\n    }\n\n    .tiw-audio__wrap .tiw-play__bar-progress .tiw-progress__circle.disable {\n      background-color: #bfbfbf;\n    }\n\n    .tiw-audio__wrap .tiw-play__bar-progress .tiw-progress__circle.disable:hover {\n      transform: scale(1);\n      -webkit-transform: scale(1);\n    }\n\n\n    .tiw-audio__wrap .tiw-play__btn-muted {\n      margin-left: 4%;\n      width: 6.5%;\n      height: 100%;\n      background-size: contain;\n      background-repeat: no-repeat;\n      background-position: center center;\n      cursor: pointer;\n    }\n\n    .tiw-audio__wrap .tiw-play__btn-muted.disable {\n      cursor: not-allowed;\n    }\n\n    .tiw-audio__wrap .tiw-play__btn-muted:hover {\n      transform: scale(1.2);\n      -webkit-transform: scale(1.2);\n    }\n\n    .tiw-audio__wrap .tiw-play__btn-muted.disable:hover {\n      transform: scale(1);\n      -webkit-transform: scale(1);\n    }\n\n    .tiw-audio__wrap .tiw-play__btn-muted.muted-btn {\n      background-image: url(").concat(L.audioIcons.mutedIcon,");\n    }\n\n    .tiw-audio__wrap .tiw-play__btn-muted.muted-btn.disable {\n      background-image: url(").concat(L.audioIcons.disableMutedIcon,");\n    }\n\n    .tiw-audio__wrap .tiw-play__btn-muted.unmuted-btn {\n      background-image: url(").concat(L.audioIcons.unmutedIcon,");\n    }\n\n    .tiw-audio__wrap .tiw-play__btn-muted.unmuted-btn.disable {\n      background-image: url(").concat(L.audioIcons.disableUnmutedIcon,");\n    }\n\n\n    .tiw-audio__wrap .tiw-close__btn {\n      position: absolute;\n      right: 0;\n      top: 0;\n      width: 6%;\n      background-size: contain;\n      background-repeat: no-repeat;\n      background-position: center center;\n      cursor: pointer;\n      background-image: url(").concat(L.audioIcons.closeIcon,");\n    }\n\n    .tiw-audio__wrap .tiw-close__btn:hover {\n      transform: scale(1.2);\n      -webkit-transform: scale(1.2);\n    }\n\n    .tiw-audio__wrap .tiw-close__btn.disable {\n      cursor: not-allowed;\n      background-image: url(").concat(L.audioIcons.disableCloseIcon,");\n    }\n\n    \n    .tiw-audio__wrap .tiw-close__btn.disable:hover {\n        transform: scale(1);\n        -webkit-transform: scale(1);\n    }\n"),vc=function(){function t(t){this._insertStyle(t)}return t.prototype._insertStyle=function(t){var e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.innerText=function(t){return"\n  ".concat("\n    .tiw_board_mathtool_wrap {\n      font-family: customFontFamily, sans-serif, serif, monospace;\n      --mathToolBackgroundColor: rgba(255, 255, 255, 0.8);\n      --borderColor: rgba(225, 225, 225, 0.8);\n      --innerBorderColor: rgba(255, 255, 255, 0.8);\n    }\n    \n    /* 禁止交互按钮 */\n    .tiw-mathtool-interaction_disable .tiw-interaction__btn.tiw-close-btn {\n      pointer-events: auto;\n      opacity: 1;\n      background-color: rgb(255, 255, 255);\n    }\n\n    .tiw-mathtool-interaction_disable .tiw-interaction__btn, \n    .tiw-mathtool-interaction_disable .tiw-angle__icon, \n    .tiw-mathtool-interaction_disable.tiw-compasses-container .tiw-rotate-resize-btn,\n    .tiw-mathtool-interaction_disable .tiw-protractor-measure-line-l .testline, \n    .tiw-mathtool-interaction_disable .tiw-protractor-measure-line-l .baseline,\n    .tiw-mathtool-delete_disable .tiw-interaction__btn.tiw-close-btn \n     {\n      pointer-events: none;\n      opacity: 0.6;\n      background-color: rgb(229, 229, 229);\n    }\n    \n    .tiw-mathtool-interaction_disable.tiw-compasses-container .tiw-compasses-header {\n      pointer-events: auto;\n    }\n    \n    .tiw-mathtool-interaction_disable .tiw-interaction__btn.tiw-compasses-leg, .tiw-mathtool-interaction_disable .tiw-interaction__btn.tiw-compasses-pen {\n      pointer-events: auto;\n      background-color: transparent;\n      opacity: 1;\n    }\n    \n    .tiw-compasses-container.tiw-mathtool-interaction_disable .tiw-compasses-body__left.tiw-mathtool-btn__active .tiw-compasses-leg {\n      background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 34 260' width='34' height='260' class='design-iconfont'%3E%3Cdefs%3E%3Cpath d='M16,2.27373675e-13 C24.836556,2.25750426e-13 32,7.163444 32,16 L32,246 L32,246 L10.9278525,227.561871 C3.98337383,221.485452 3.66571922e-14,212.707019 0,203.479417 L0,16 C-1.082166e-15,7.163444 7.163444,2.28996924e-13 16,2.27373675e-13 Z' id='pba0i8jqv__imb3ekayea'/%3E%3C/defs%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cpath d='M22.935,238.067 L31.999,245.998 L32,256.501444 C32,257.052931 31.552931,257.5 31.0014436,257.5 C30.4019455,257.5 29.8664868,257.124977 29.6615752,256.561586 L22.935,238.067 Z' fill-opacity='.88' fill='%238F9AB0' transform='translate(1 1)'/%3E%3Cg transform='translate(1 1)'%3E%3Cpath d='M21.8000888,236.409427 L32.4979568,245.771095 L32.5,256.501444 C32.5,256.915258 32.3322684,257.289898 32.061083,257.561083 C31.7898976,257.832268 31.4152585,258 31.0014436,258 C30.596574,258 30.2133288,257.873364 29.8967044,257.651608 C29.58008,257.429851 29.3300764,257.112973 29.1916889,256.732486 L29.1916889,256.732486 L21.8000888,236.409427 Z M16,-0.5 C20.5563492,-0.5 24.6813492,1.34682541 27.6672619,4.33273811 C30.6531746,7.31865081 32.5,11.4436508 32.5,16 L32.5,16 L32.5,247.101884 L10.5986002,227.938159 C3.54561404,221.766796 -0.5,212.851201 -0.5,203.479417 L-0.5,203.479417 L-0.5,16 C-0.5,11.4436508 1.34682541,7.31865081 4.33273811,4.33273811 C7.31865081,1.34682541 11.4436508,-0.5 16,-0.5 Z' stroke-opacity='.6' stroke='transparent'/%3E%3Cmask id='pba0i8jqv__je5mgjrirb' fill='%23fff'%3E%3Cuse xlink:href='%23pba0i8jqv__imb3ekayea'/%3E%3C/mask%3E%3Cuse fill-opacity='.88' fill='%23D3D9E5' xlink:href='%23pba0i8jqv__imb3ekayea'/%3E%3Cpath d='M16,2.27373675e-13 C24.836556,2.25750426e-13 32,7.163444 32,16 L32.0002124,46.2435558 C29.3789258,46.7351576 26.6765232,46.9947041 23.9152006,47 C15.0907395,47.0168643 6.87802621,44.4348102 -0.00131277517,39.9754694 L2.84219263e-14,16 C2.73397841e-14,7.163444 7.163444,2.28996924e-13 16,2.27373675e-13 Z' fill-opacity='.08' fill='%23313C52' mask='url(%23pba0i8jqv__je5mgjrirb)'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A\");\n    }\n    \n    .tiw-compasses-container.tiw-mathtool-interaction_disable .tiw-compasses-body__right.tiw-mathtool-btn__active .tiw-compasses-leg {\n      background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 34 260' width='34' height='260' class='design-iconfont'%3E%3Cdefs%3E%3Cpath d='M16.0466409,0 C24.8574378,1.61851714e-15 32,7.14256217 32,15.9533591 L32,15.9533591 L32,118.27 L0,237.7 L0.0870290099,15.9533579 C0.0904411009,7.24771671 7.06371622,0.172328003 15.7288775,0.00310041107 Z' id='98o1qdfts__x06y36xhpa'/%3E%3C/defs%3E%3Cg transform='translate(1 1)' fill='none' fill-rule='evenodd'%3E%3Cpath d='M15.7287057,-0.496899559 C20.3542969,-0.498489073 24.4824694,1.28068991 27.4854616,4.16637412 C30.5221241,7.0844133 32.4090697,11.134671 32.4968992,15.6356175 L32.4968992,15.6356175 L32.500002,118.335816 L-0.501492833,241.503583 L-0.412970952,15.9531619 C-0.411213244,11.4685312 1.38395797,7.40338429 4.29417595,4.4357858 C7.210365,1.4620985 11.2462069,-0.40944993 15.7287057,-0.496899559 Z' stroke-opacity='.59665408' stroke='trasnparent' stroke-linejoin='round'/%3E%3Cmask id='98o1qdfts__rlvmo14l1b' fill='%23fff'%3E%3Cuse xlink:href='%2398o1qdfts__x06y36xhpa'/%3E%3C/mask%3E%3Cuse fill-opacity='.88' fill='%23BAC6D6' xlink:href='%2398o1qdfts__x06y36xhpa'/%3E%3Cpath d='M32,105.282 L32,118.27 L-5.82206885e-14,237.7 L0.016,196.878 L32,105.282 Z' fill-opacity='.08' fill='%233D4A66' mask='url(%2398o1qdfts__rlvmo14l1b)'/%3E%3Cpath d='M16,-6.3731152e-15 C24.836556,-9.07853021e-15 32,7.163444 32,16 L32,16 L32.0008876,39.9760466 C25.1217041,44.4350094 16.9093519,47.0168368 8.08531932,47 C5.32386878,46.9947123 2.6213445,46.7351502 -5.56504835e-05,46.2435121 L6.39449431e-14,16 C6.39449431e-14,7.163444 7.163444,-3.6677002e-15 16,-6.3731152e-15 Z' fill-opacity='.08' fill='%233D4A66' mask='url(%2398o1qdfts__rlvmo14l1b)'/%3E%3C/g%3E%3C/svg%3E%0A\");\n    }\n    \n    .tiw-compasses-container.tiw-mathtool-interaction_disable .tiw-compasses-body__right .tiw-compasses-pen.tiw-mathtool-btn__active, .tiw-compasses-container.tiw-mathtool-interaction_disable .tiw-compasses-body__right .tiw-compasses-pen.tiw-mathtool-btn__active.tiw-partial-draw  {\n      --compassesPenStrokeColor: transparent;\n      --compassesPenPartialStrokeColor: transparent;\n    }\n\n    /* 禁止交互按钮 */\n    \n    .tiw-mathtool-hide {\n      display:none;\n    }\n\n    .tiw-scale-container {\n      pointer-events: none;\n      transform-origin: 50% top;\n      transform: scale(var(--scaleX), var(--scaleY));\n      position: relative;\n    }\n\n    .tiw-ruler-container {\n      display: flex;\n      flex-direction: column;\n      height: 120px;\n      box-sizing: border-box;\n      background: var(--mathToolBackgroundColor);\n      border-left: 1px solid var(--borderColor);\n      border-right: 1px solid var(--borderColor);\n    }\n\n    ul.tiw-geraduation-box {\n      padding: 0 0 0 calc(var(--shadowWidth) * var(--scaleX));\n    }\n\n    ul.tiw-protractor-line-container {\n      padding: 0;\n    }\n\n    ul.tiw-protractor-line-inner-container {\n      padding: 0;\n    }\n\n    .tiw-geraduation-box {\n      display: flex;\n      height: var(--shadowWidth) * var(--scaleY);\n      width: 100%;\n      list-style: none;\n      background: rgba(0, 0, 0, 0.1);\n      box-sizing: border-box;\n      pointer-events: none;\n    }\n    .tiw-geraduation-box.tiw-ruler-reverse {\n      align-items: end;\n    }\n    /* 文字变更到上方 */\n    .tiw-geraduation-box.tiw-ruler-reverse .tiw-ruler-cm::after {\n      transform: translate(-50%, calc((-1) * var(--calibrationSize) - 2px))  scale(var(--calibrationScale));\n    }\n    /* 刻度 */\n    .tiw-geraduation-box .tiw-ruler-calibration {\n      margin-left: calc(0.1 * var(--unitLen) - 1px);\n      list-style: none;\n      flex-shrink: 0; /* 禁止被压缩 */ \n      background: var(--calibrationColor);\n    }\n    .tiw-geraduation-box .tiw-ruler-calibration:first-of-type {\n      margin-left: 0;\n    }\n    /* 厘米 */\n    .tiw-geraduation-box .tiw-ruler-cm {\n      height: var(--calibrationSize);\n      width: 1px;\n    }\n    /* 厘米文字 */\n    .tiw-geraduation-box .tiw-ruler-cm::after {\n      content: attr(data-value);\n      position: absolute;\n      transform-origin: 50% top;\n      transform: translate(-50%, calc(var(--calibrationSize) + 2px)) scale(var(--calibrationScale));\n      font-size: 12px;\n      line-height: 1;\n      color: #333;\n    }\n    /* 毫米 */\n    .tiw-geraduation-box .tiw-ruler-mm {\n      height: calc(var(--calibrationSize) / 3);\n      width: 1px;\n    }\n    /* 5毫米 */\n    .tiw-geraduation-box .tiw-ruler-5mm {\n      height: calc(var(--calibrationSize) / 1.5);\n      width: 1px;\n    }\n\n    /* 垂直方向 */\n    .tiw-triangle-container .tiw-geraduation-box.tiw-ruler-vertical {\n      align-items: self-start;\n      display: flex;\n      position: absolute;\n      left: 0;\n      bottom: 0;\n      width: 12px;\n      height: 100%;\n      flex-direction: column-reverse;\n      padding: 0 0 calc(var(--shadowWidth) * 2 * var(--scaleY)) 0;\n    }\n    \n    .tiw-ruler-vertical .tiw-ruler-cm::after {\n      transform-origin: left 50%;\n      transform: translate(calc(var(--calibrationSize) + 2px), -50%) scale(var(--calibrationScale));\n    }\n    \n    .tiw-geraduation-box.tiw-ruler-vertical .tiw-ruler-calibration {\n      margin-top: calc(0.1 * var(--unitLen) - 1px);\n      margin-left: 0px;\n      list-style: none;\n    }\n    \n    .tiw-geraduation-box.tiw-ruler-vertical .tiw-ruler-cm {\n      width: var(--calibrationSize);\n      height: 1px;\n    }\n    \n    .tiw-geraduation-box.tiw-ruler-vertical .tiw-ruler-mm {\n      width: calc(var(--calibrationSize) / 3);\n      height: 1px;\n      background: var(--calibrationColor);\n    }\n    \n    .tiw-geraduation-box.tiw-ruler-vertical .tiw-ruler-5mm {\n      width: calc(var(--calibrationSize) / 1.5);\n      height: 1px;\n      background: #bbb;\n    }\n\n    .tiw-triangle-container .tiw-geraduation-box {\n      background: transparent;\n      padding: 0 0 0 calc(var(--shadowWidth) * 2 * var(--scaleX));\n    }\n    \n    /* 斜边 */\n    .tiw-triangle-container .tiw-geraduation-box.tiw-ruler-hypotenuse {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: calc(var(--innerTriangleHypotenuseWidth));\n      transform-origin: left top;\n      transform: rotate(var(--triangleAngle));\n      padding: 0 0 0 calc(var(--shadowWidth) * 4 * var(--scaleX));\n    }\n\n    .tiw-triangle-container {\n      position: relative;\n      box-sizing: border-box;\n      width: var(--triangleWidth);\n      height: var(--triangleHeight);\n    }\n\n    .tiw-mathtool-triangle-shadow-container {\n      box-sizing: border-box;\n      width: var(--triangleWidth);\n      height: var(--triangleHeight);\n      border-top: calc(var(--triangleHeight) / 2) solid transparent;\n      border-bottom: calc(var(--triangleHeight) / 2) solid var(--borderColor);\n      border-right: calc(var(--triangleWidth) / 2) solid transparent;\n      border-left: calc(var(--triangleWidth) / 2) solid var(--borderColor);\n      pointer-events: none;\n    }\n\n    .tiw-mathtool-triangle-inner-shadow-container {\n      position: absolute;\n      left: calc(var(--scaleX) * var(--shadowWidth));\n      bottom: calc(var(--scaleY) * var(--shadowWidth));\n      display: block;\n      width: calc(var(--innerTriangleWidth));\n      height: var(--innerTriangleHeight);\n      content: \"\";\n      box-sizing: border-box;\n      border-top: calc(var(--innerTriangleHeight) / 2) solid transparent;\n      border-bottom: calc(var(--innerTriangleHeight) / 2) solid var(--innerBorderColor);\n      border-right: calc(var(--innerTriangleWidth) / 2) solid transparent;\n      border-left: calc(var(--innerTriangleWidth) / 2) solid var(--innerBorderColor);\n      pointer-events: none;\n    }\n\n    .tiw-triangle-container .triangle-bottom {\n      position: absolute;\n      bottom: 0;\n    }\n\n    .tiw-protractor-container {\n      --protractorInnerWidth: calc(var(--protractorWidth) * 0.85);\n      position: relative;\n      width: var(--protractorWidth);\n      height: calc(var(--protractorWidth)/2);\n      --protractorShadowWidth: calc(var(--shadowWidth) * var(--scaleX) * 1.5);\n    }\n\n    .tiw-mathtool-protractor-outer-container {\n      position: absolute;\n      width: var(--protractorWidth);\n      height: calc(var(--protractorWidth)/2);\n      overflow: hidden;\n      bottom: 0;\n      left: 50%;\n      transform: translate(-50%);\n      pointer-events: none;\n    }\n\n    .tiw-mathtool-protractor-outer-container::before {\n      position: absolute;\n      content: \"\";\n      width: var(--protractorWidth);\n      height: var(--protractorWidth);\n      border: var(--protractorShadowWidth) solid var(--bgColor);\n      border-radius: 50% 50% 0 0;\n      box-sizing: border-box;\n      background: var(--mathToolBackgroundColor);\n    }\n\n    .tiw-protractor-line-container {\n      position: absolute;\n      bottom: 0;\n      width: calc(var(--protractorWidth)/2);\n      list-style: none;\n    }\n\n    .tiw-protractor-line {\n      position: absolute;\n      bottom: 0;\n      width: 100%;\n      height: 1px;\n      transform-origin: right bottom;\n      list-style: none;\n    }\n\n    /* 处理最后一个180deg 会看不见 */\n    .tiw-protractor-line.tiw-protractor-line-2l:last-of-type {\n      transform: rotate(179.9deg) !important;\n    }\n\n    .tiw-protractor-line::after {\n      position: absolute;\n      content: \"\";\n      width: calc(0.3 * var(--protractorShadowWidth));\n      height: 1px;\n      background-color: var(--calibrationColor);\n    }\n\n    .tiw-protractor-line.tiw-protractor-line-2l::after {\n      width: var(--protractorShadowWidth);\n    }\n\n    .tiw-protractor-line.tiw-protractor-line-2l::before {\n      position: absolute;\n      content: attr(data-value);\n      bottom: 0;\n      left: var(--protractorShadowWidth);\n      transform: rotate(270deg) translate(-145%) scale(var(--calibrationScale));\n      font-size: 12px;\n      color: #333;\n      text-align: center;\n      width: var(--borderWidth);\n      height: var(--borderWidth);\n      line-height: var(--borderWidth);\n      transform-origin: left top;\n    }\n\n    .tiw-protractor-line-2l:first-of-type::before {\n      transform: rotate(270deg) translate(-120%) scale(var(--calibrationScale));\n    }\n\n    /* 最后一个出边界去了 */\n    .tiw-protractor-line.tiw-protractor-line-2l:last-of-type:before {\n      transform: rotate(270deg) translate(-200%) scale(var(--calibrationScale));\n    }\n\n    /* 中间值 */\n    .tiw-protractor-line.tiw-protractor-line-l::after {\n      width: calc(0.6 * var(--protractorShadowWidth));\n    }\n\n    .tiw-mathtool-protractor-inner-container {\n      position: absolute;\n      width: var(--protractorInnerWidth);\n      height: calc(var(--protractorInnerWidth)/2);\n      overflow: hidden;\n      bottom: 0;\n      left: 50%;\n      transform: translate(-50%);\n      pointer-events: none;\n    }\n\n    .tiw-mathtool-protractor-inner-container::after {\n      position: absolute;\n      content: \"\";\n      width: var(--protractorInnerWidth);\n      height: var(--protractorInnerWidth);\n      border: var(--protractorShadowWidth) solid var(--bgColor);\n      border-radius: 50% 50% 0 0;\n      box-sizing: border-box;\n    }\n\n    .tiw-protractor-line-inner-container {\n      position: absolute;\n      bottom: 0;\n      width: calc(var(--protractorInnerWidth)/2);\n      list-style: none;\n    }\n\n    .tiw-protractor-line-inner-container .tiw-protractor-line-2l::before {\n      left: 0;\n    }\n\n    .tiw-protractor-line-inner-container .tiw-protractor-line-2l::after {\n      width: 75%;\n      left: var(--protractorShadowWidth);\n    }\n\n    .tiw-protractor-line-inner-container .tiw-protractor-line-2l:first-of-type::after {\n      \n    }\n    \n    .tiw-protractor-line-inner-container .tiw-protractor-line-2l:last-of-type::after {\n      bottom: -1px;\n    }\n\n\n    .tiw-protractor-line-inner-container .tiw-protractor-line-2l:first-of-type::before {\n      transform: rotate(270deg) translate(-100%) scale(var(--calibrationScale));\n    }\n\n    .tiw-protractor-line-inner-container .tiw-protractor-line-2l:last-of-type::before {\n      transform: rotate(270deg) translate(-180%) scale(var(--calibrationScale));\n    }\n\n    .tiw-protractor-container .tiw-mathtool-btn-box {\n      position: absolute;\n      width: calc(var(--protractorInnerWidth) - 80px);\n      bottom: 0;\n      left: 50%;\n      transform: translateX(-50%);\n      padding: 0;\n    }\n\n    .tiw-protractor-container .tiw-mathtool-btn-box .tiw-size__btn {\n      \n    }\n\n    .tiw-protractor-measure-line {\n      list-style: none;\n      position: absolute;\n      width: calc(var(--protractorWidth) / 2);\n      height: 1px;\n      bottom: 0;\n      left: 50%;\n      overflow: visible;\n      pointer-events: none;\n      font-family: sans-serif, serif, monospace, customFontFamily;\n    }\n\n    .tiw-protractor-measure-line .baseline, .tiw-protractor-measure-line .testline  {\n      --measureButtonSize: calc(24px * var(--buttonScale));\n      width: 30px;\n      height: 30px;\n      border: 1px solid #00A870;\n      border-radius: 50%;\n      position: absolute;\n      right: calc(-30px + (1 - var(--boardScale) * var(--buttonScale)) * 30px / 2);\n      top: -15px;\n      background: #fff;\n      pointer-events: auto;\n      cursor: pointer;\n      color: #333;\n      font-size: 12px;\n      text-align: center;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      transform: rotate(calc(var(--angle) * -1)) scale(calc(var(--boardScale) * var(--buttonScale)));\n    }\n    \n    .tiw-protractor-measure-line .baseline:hover, .tiw-protractor-measure-line .testline:hover {\n      border-color: #008357;\n      box-shadow: 0 0 5px #00A870;\n    }\n\n    .tiw-protractor-measure-line .tiw-protractor-measure-line-l.measure-line-moving {\n      background: #266FE8;\n    }\n\n    .tiw-protractor-measure-line .tiw-protractor-measure-line-l.measure-line-moving .baseline,\n    .tiw-protractor-measure-line .tiw-protractor-measure-line-l.measure-line-moving .testline {\n      background: #266FE8;\n      border: 1px solid #266FE8;\n      color: #fff;\n    }\n    \n    .tiw-protractor-measure-line .tiw-protractor-measure-line-l {\n      height: 1px;\n      width: calc(var(--protractorWidth) / 2 + 50px * var(--boardScale) * var(--scaleX));\n      background-color: #00A870;\n      position: absolute;\n      left: 0;\n      top: 0;\n      transform-origin: 0 50%;\n      transform:rotate(var(--angle));\n    }\n\n    .tiw-mathtool-protractor-anchor {\n      position: absolute;\n      width: 4px;\n      height: 4px;\n      left: calc(50% - 2px);\n      bottom: 0;\n    }\n\n    .tiw-mathtool-protractor-anchor::before {\n      content: '';\n      background: #333;\n      position: absolute;\n      width: 1px;\n      height: 4px;\n      left: 50%;\n      bottom: 0;\n    }\n\n    .tiw-mathtool-protractor-anchor::after {\n      content: '';\n      background: #333;\n      position: absolute;\n      width: 5px;\n      height: 1px;\n      bottom: 0;\n    }\n\n    .tiw-mathtool-protractor-angle {\n      width: 40px;\n      height: 20px;\n      position: absolute;\n      left: calc(50% - 20px);\n      bottom: 0;\n      transform-origin: 50% 100%;\n    }\n\n    .tiw-btn__icon {\n      width: 24px;\n      height: 24px;\n      box-sizing: border-box;\n      border-radius: 50%;\n      text-align: center;\n      line-height: 1;\n      outline: none;\n      cursor: pointer;\n      margin-right: calc(var(--buttonScale) * 10px);\n      pointer-events: auto;\n      transform: rotate(var(--rotateAngle)) scale(var(--buttonScale));\n      background-size: 24px;\n      background-repeat: no-repeat;\n      background-position: center center;\n      background-color: #fff;\n      border: 1px solid rgba(0, 0, 0, 0.08);\n      box-shadow: 0 4px 12px 0 rgba(0,0,0,0.08);\n    }\n    \n    .tiw-btn__icon.tiw-mathtool-btn__active {\n      border-color: rgba(35, 108, 250, 0.4);\n      background-color: rgba(35,108,250,0.08);\n    }\n\n    .tiw-ruler-btn-box {\n      position: relative;\n      flex: 1;\n      display: flex;\n      align-items: center;\n      padding: 0 calc(4px * var(--buttonScale));\n      pointer-events: none;\n    }\n    \n    .tiw-btn__icon {\n      width: calc(24px * var(--buttonScale));\n      height: calc(24px * var(--buttonScale));\n      transform: rotate(var(--rotateAngle));\n      background-size: calc(24px * var(--buttonScale));\n    }\n\n    .tiw-ruler-btn-box .tiw-rotate-btn {\n      margin-left: auto;\n    }\n\n    .tiw-ruler-btn-box .tiw-resize-btn {\n      margin-right: 0;\n    }\n\n    .tiw-triangle-btn-box {\n      position: absolute;\n      left: 0;\n      top: 6px;\n      width: calc(var(--innerTriangleHypotenuseWidth) * 0.7);\n      transform-origin: left top;\n      transform: translate(-6%, calc(var(--shadowWidth) * var(--scaleY))) rotate(var(--triangleAngle));\n      display: flex;\n      justify-content: space-around;\n      pointer-events: none;\n      padding: 0 calc(var(--innerTriangleHypotenuseWidth) * 0.25) 0 calc(var(--innerTriangleHypotenuseWidth) * 0.15);\n      box-sizing: content-box;\n    }\n\n    .tiw-isosceles-triangle-container .tiw-triangle-btn-box {\n      top: 0px;\n      padding: 0 calc(var(--innerTriangleHypotenuseWidth) * 0.25);\n    }\n\n    .tiw-protractor-btn-box {\n      position: absolute;\n      /* width = 总宽度 - 内外环的diff宽度 - 内环的阴影 - buffer(直接用内环的阴影) */\n      width: calc(100% - (var(--protractorWidth) - var(--protractorInnerWidth)) - var(--protractorShadowWidth) * 2 - var(--protractorShadowWidth) * 2);\n      height: calc(100% - (var(--protractorWidth) - var(--protractorInnerWidth)) / 2 - var(--protractorShadowWidth) - var(--protractorShadowWidth));\n      bottom: 2px;\n      left: 50%;\n      transform: translateX(-50%);\n      pointer-events: none;\n    }\n\n    .tiw-protractor-btn-box .tiw-rotate-btn {\n      position: absolute;\n      right: 0;\n      bottom: 0;\n      margin-right: 0;\n      transform-origin: center bottom;\n    }\n\n    .tiw-protractor-btn-box .tiw-close-btn {\n      position: absolute;\n      left: 0;\n      bottom: 0px;\n      transform-origin: center bottom;\n\n    }\n\n    .tiw-protractor-btn-box .tiw-resize-btn {\n      position: absolute;\n      top: calc(2px * var(--scaleY));\n      left: 50%;\n      transform: rotate(90deg) translateY(50%);\n    }\n\n    .draw-angle-text {\n      position: absolute;\n      bottom: 6px;\n      left: calc(50% - 16px);\n      width: 32px;\n      height: 32px;\n      font-size: 12px;\n      line-height: 32px;\n      vertical-align: middle;\n      transform: rotate(var(--rotateAngle)) scale(var(--buttonScale));\n      transform-origin: center bottom;\n      margin-right: 0;\n    }\n\n    .draw-angle-text:hover {\n      color: #ffffff;\n    }\n    \n    /*\n     * 旋转角度\n     */\n    .tiw-angle__icon {\n      position: absolute;\n      z-index: 1;\n      background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cg stroke='%23000' stroke-width='2' fill='none' fill-rule='evenodd'%3E%3Cpath d='M8,10.6547905 C8,8.09550735 6.93175729,5.78572569 5.21683191,4.14700553' transform='translate%285.5 7%29'/%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M9 -4.4408921e-13L1.47792889e-12 10 13 10' transform='translate%285.5 7%29'/%3E%3C/g%3E%3C/svg%3E%0A\");\n    }\n    \n    .tiw-angle__icon.tiw-mathtool-btn__active {\n      background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cg stroke='%23236CFA' stroke-width='2' fill='none' fill-rule='evenodd'%3E%3Cpath d='M8,10.6547905 C8,8.09550735 6.93175729,5.78572569 5.21683191,4.14700553' transform='translate%285.5 7%29'/%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M9 -4.4408921e-13L1.47792889e-12 10 13 10' transform='translate%285.5 7%29'/%3E%3C/g%3E%3C/svg%3E%0A\");\n    }\n    \n    .tiw-angle__icon:hover .tiw-mathtool-angle-btn-box {\n      display: flex;\n    }\n    \n    .tiw-angle__icon:hover::after {\n        position: absolute;\n        top: 24px;\n        content: '';\n        width: 180px;\n        height: 20px;\n        background: transparent;\n        left: 50%;\n        transform: translateX(-50%);\n    }\n    \n    .tiw-mathtool-angle-btn-box {\n      position: absolute;\n      z-index: 1;\n      display: none;\n      left: 50%;\n      top: 32px;\n      flex-wrap: wrap;\n      width: 200px;\n      background: rgba(255, 255, 255, 0.8);\n      border-radius: 10px;\n      justify-content: center;\n      align-items: center;\n      box-shadow: 0px 0px 5px #333;\n      transform: translateX(-50%);\n      padding: 10px 0;\n    }\n\n   .tiw-mathtool-angle-btn-box .tiw-angle-switch__btn {\n      width: 34px;\n      height: 34px;\n      line-height: 34px;\n      outline: none;\n      border: none;\n      cursor: pointer;\n      background: none;\n      border-radius: 50%;\n      margin: 0 6px;\n      text-align: center;\n      font-size: 12px;\n      color: #333;\n      padding: 0;\n   }\n   .tiw-mathtool-angle-btn-box .tiw-angle-switch__btn:hover {\n      background-color: #236CFA;\n      color: #fff;\n   }\n   \n\n   /* 文本内容 */\n  .tiw-mathtool-value__cm-angle {\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%) rotate(var(--rotateAngle));\n    height: 30px;\n    line-height: 30px;\n    font-size: calc(16px * var(--boardScale));\n    text-align:center;\n    color: #000000;\n    pointer-events: none;\n  }\n\n  .tiw-triangle-btn-box .tiw-angle__icon, .tiw-ruler-btn-box .tiw-angle__icon {\n    position: relative;\n  }\n\n  .tiw-triangle-container .tiw-mathtool-value__cm-angle {\n    top: auto;\n    left: calc(var(--shadowWidth) * var(--scaleX) + (12px * var(--calibrationScale)));\n    bottom: calc(var(--shadowWidth) * var(--scaleY) + (12px * var(--calibrationScale)));\n    transform: rotate(var(--rotateAngle));\n  }\n\n  .tiw-triangle-btn-box .tiw-btn__icon {\n    transform: rotate(calc(var(--rotateAngle) - var(--triangleAngle)));\n    margin-right: 4px;\n  }\n\n  .tiw-protractor-btn-box .tiw-angle__icon {\n    left: 32px;\n    bottom: 0;\n  }\n\n  .tiw-resize-btn {\n    transform:none;\n  }\n\n  .tiw-close-btn {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cg stroke='%23000' stroke-width='2' fill='none' fill-rule='evenodd' stroke-linecap='round'%3E%3Cpath d='M0 0L11 11' transform='translate%286.5 6.5%29'/%3E%3Cpath d='M11 0L0 11' transform='translate%286.5 6.5%29'/%3E%3C/g%3E%3C/svg%3E%0A\");\n  }\n\n  .tiw-close-btn.tiw-mathtool-btn__active {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cg stroke='%23236CFA' stroke-width='2' fill='none' fill-rule='evenodd' stroke-linecap='round'%3E%3Cpath d='M0 0L11 11' transform='translate%286.5 6.5%29'/%3E%3Cpath d='M11 0L0 11' transform='translate%286.5 6.5%29'/%3E%3C/g%3E%3C/svg%3E%0A\");\n  }\n\n  .tiw-rotate-btn {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cpath d='M11.4705531,2.1268117 L13.4705531,4.79347836 C13.6362385,5.01439226 13.591467,5.32779294 13.3705531,5.49347836 C13.284005,5.55838943 13.1787382,5.59347836 13.0705531,5.59347836 L9.07055306,5.59347836 C8.79441068,5.59347836 8.57055306,5.36962074 8.57055306,5.09347836 C8.57055306,4.98529326 8.60564199,4.88002645 8.67055306,4.79347836 L10.6705531,2.1268117 C10.8362385,1.9058978 11.1496392,1.86112627 11.3705531,2.0268117 C11.4084559,2.05523882 11.4421259,2.08890886 11.4705531,2.1268117 Z' fill='%23000' transform='scale%281 -1%29 rotate%2861 23.90313776 2.80091958%29'/%3E%3Cpath d='M10.2918131,3.36211091 C9.20237015,2.24712825 7.68201196,1.55500619 6,1.55500619 C2.6862915,1.55500619 0,4.24129769 0,7.55500619 C0,10.8687147 2.6862915,13.5550062 6,13.5550062 C8.21693097,13.5550062 10.1530394,12.3526618 11.1918104,10.5644878' stroke='%23000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' transform='translate%285.918037 4.444994%29'/%3E%3Cpath d='M6.08196282,9.05500619 C6.91038994,9.05500619 7.58196282,8.38343331 7.58196282,7.55500619 C7.58196282,6.72657906 6.91038994,6.05500619 6.08196282,6.05500619 C5.25353569,6.05500619 4.58196282,6.72657906 4.58196282,7.55500619 C4.58196282,8.38343331 5.25353569,9.05500619 6.08196282,9.05500619 Z' fill='%23000' transform='translate%285.918037 4.444994%29'/%3E%3C/g%3E%3C/svg%3E%0A\");\n  }\n\n  .tiw-rotate-btn.tiw-mathtool-btn__active {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cpath d='M11.4705531,2.13491139 L13.4705531,4.80157805 C13.6362385,5.02249195 13.591467,5.33589263 13.3705531,5.50157805 C13.284005,5.56648912 13.1787382,5.60157805 13.0705531,5.60157805 L9.07055306,5.60157805 C8.79441068,5.60157805 8.57055306,5.37772043 8.57055306,5.10157805 C8.57055306,4.99339295 8.60564199,4.88812614 8.67055306,4.80157805 L10.6705531,2.13491139 C10.8362385,1.91399749 11.1496392,1.86922596 11.3705531,2.03491139 C11.4084559,2.06333851 11.4421259,2.09700855 11.4705531,2.13491139 Z' fill='%23236CFA' transform='scale%281 -1%29 rotate%2859 24.31643086 3.0116005%29'/%3E%3Cpath d='M10.2918131,3.3702106 C9.20237015,2.25522794 7.68201196,1.56310588 6,1.56310588 C2.6862915,1.56310588 0,4.24939738 0,7.56310588 C0,10.8768144 2.6862915,13.5631059 6,13.5631059 C8.21693097,13.5631059 10.1530394,12.3607615 11.1918104,10.5725875' stroke='%23236CFA' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' transform='translate%285.918037 4.436894%29'/%3E%3Cpath d='M6.08196282,9.06310588 C6.91038994,9.06310588 7.58196282,8.391533 7.58196282,7.56310588 C7.58196282,6.73467875 6.91038994,6.06310588 6.08196282,6.06310588 C5.25353569,6.06310588 4.58196282,6.73467875 4.58196282,7.56310588 C4.58196282,8.391533 5.25353569,9.06310588 6.08196282,9.06310588 Z' fill='%23236CFA' transform='translate%285.918037 4.436894%29'/%3E%3C/g%3E%3C/svg%3E%0A\");\n  }\n\n  .tiw-resize-btn {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cg fill-rule='evenodd'%3E%3Cpath d='M9 11.988c0 .553-.447 1.001-1 1.003l-1.999.005-.001.845a.5.5 0 0 1-.078.268l-.058.075a.5.5 0 0 1-.707.02l-1.951-1.84a.5.5 0 0 1 0-.728l1.95-1.84a.5.5 0 0 1 .844.363l.001.837L8 10.991a.997.997 0 0 1 1 .994v.003zM15.003 11.988c0 .553.448 1.001 1 1.003l2 .005v.845a.5.5 0 0 0 .078.268l.059.075a.5.5 0 0 0 .706.02l1.951-1.84a.5.5 0 0 0 0-.728l-1.95-1.84a.5.5 0 0 0-.844.363v.837l-2-.005a.997.997 0 0 0-1 .994v.003zM12 16a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1zm0-6a1 1 0 0 1 1 1v2a1 1 0 1 1-2 0v-2a1 1 0 0 1 1-1zm0-6a1 1 0 0 1 1 1v2a1 1 0 1 1-2 0V5a1 1 0 0 1 1-1z'/%3E%3C/g%3E%3C/svg%3E\");\n  }\n\n  .tiw-resize-btn.tiw-mathtool-btn__active {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cg fill='%23236CFA' fill-rule='evenodd'%3E%3Cpath d='M2.98620708,5.00166089 C3.53898177,5.00166089 3.98756351,5.44888414 3.98924008,6.00165629 L3.99469896,8.00066089 L4.83913931,8.00166089 C4.93482657,8.00166089 5.02779918,8.02909475 5.10745364,8.07974972 L5.18227599,8.13798903 C5.38312641,8.32749819 5.39232032,8.64394715 5.20281116,8.84479757 L5.20281116,8.84479757 L3.36201097,10.7957613 C3.35536618,10.8028037 3.34851824,10.8096517 3.3414758,10.8162964 C3.14062538,11.0058056 2.82417642,10.9966117 2.63466726,10.7957613 L2.63466726,10.7957613 L0.793867072,8.84479757 C0.706310247,8.75200087 0.657538924,8.6292439 0.657538924,8.50166089 C0.657538924,8.22551851 0.88139655,8.00166089 1.15753892,8.00166089 L1.15753892,8.00166089 L1.99469896,8.00066089 L1.98924008,6.00165629 C1.98757007,5.45104661 2.4325736,5.00333547 2.98318327,5.00166547 L2.98620708,5.00166089 Z' transform='rotate%2890 2.5000005 11.5016615%29'/%3E%3Cpath d='M14.9862071,5.00166089 C15.5389818,5.00166089 15.9875635,5.44888414 15.9892401,6.00165629 L15.994699,8.00066089 L16.8391393,8.00166089 C16.9348266,8.00166089 17.0277992,8.02909475 17.1074536,8.07974972 L17.182276,8.13798903 C17.3831264,8.32749819 17.3923203,8.64394715 17.2028112,8.84479757 L17.2028112,8.84479757 L15.362011,10.7957613 C15.3553662,10.8028037 15.3485182,10.8096517 15.3414758,10.8162964 C15.1406254,11.0058056 14.8241764,10.9966117 14.6346673,10.7957613 L14.6346673,10.7957613 L12.7938671,8.84479757 C12.7063102,8.75200087 12.6575389,8.6292439 12.6575389,8.50166089 C12.6575389,8.22551851 12.8813965,8.00166089 13.1575389,8.00166089 L13.1575389,8.00166089 L13.994699,8.00066089 L13.9892401,6.00165629 C13.9875701,5.45104661 14.4325736,5.00333547 14.9831833,5.00166547 L14.9862071,5.00166089 Z' transform='matrix%280 1 1 0 10.00166 -2.998339%29'/%3E%3Cpath d='M8.99667929,12 C9.54896404,12 9.99667929,12.4477153 9.99667929,13 L9.99667929,15 C9.99667929,15.5522847 9.54896404,16 8.99667929,16 C8.44439454,16 7.99667929,15.5522847 7.99667929,15 L7.99667929,13 C7.99667929,12.4477153 8.44439454,12 8.99667929,12 Z M8.99667929,6 C9.54896404,6 9.99667929,6.44771525 9.99667929,7 L9.99667929,9 C9.99667929,9.55228475 9.54896404,10 8.99667929,10 C8.44439454,10 7.99667929,9.55228475 7.99667929,9 L7.99667929,7 C7.99667929,6.44771525 8.44439454,6 8.99667929,6 Z M8.99667929,0 C9.54896404,-1.01453063e-16 9.99667929,0.44771525 9.99667929,1 L9.99667929,3 C9.99667929,3.55228475 9.54896404,4 8.99667929,4 C8.44439454,4 7.99667929,3.55228475 7.99667929,3 L7.99667929,1 C7.99667929,0.44771525 8.44439454,1.01453063e-16 8.99667929,0 Z' transform='translate%283.003321 4%29'/%3E%3C/g%3E%3C/svg%3E%0A\");\n  }\n\n  .tiw-triangle-btn-box .tiw-resize-btn {\n    transform: rotate(-90deg);\n  }\n  \n  .tiw-move-btn {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cpath d='M7 13.853a.5.5 0 0 1-.84.366l-1.988-1.847a.5.5 0 0 1 0-.732l1.987-1.855a.5.5 0 0 1 .841.366V11h10v-.843a.5.5 0 0 1 .84-.367l1.99 1.845a.5.5 0 0 1 .002.732l-1.99 1.86A.5.5 0 0 1 17 13.86V13H7z'/%3E%3Cpath d='M10.155 7.004a.5.5 0 0 1-.366-.84l1.847-1.988a.5.5 0 0 1 .732 0l1.855 1.987a.5.5 0 0 1-.366.841h-.85v10h.844a.5.5 0 0 1 .366.84l-1.844 1.99a.5.5 0 0 1-.732.002l-1.86-1.99a.5.5 0 0 1 .366-.842h.86v-10z'/%3E%3C/svg%3E\");\n  }\n  \n  .tiw-move-btn.tiw-mathtool-btn__active {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cg fill='%23236CFA' fill-rule='nonzero'%3E%3Cpath d='M2.98717921,9.83577569 C2.98717921,9.96207419 2.93938272,10.0836936 2.85339304,10.1761981 C2.66538293,10.3784524 2.3490111,10.3899996 2.14675678,10.2019895 L2.14675678,10.2019895 L0.159579429,8.35476343 C0.150917763,8.34671178 0.142544479,8.33835537 0.134475376,8.32970996 C-0.053942288,8.12783526 -0.0430332038,7.81144079 0.158841498,7.62302312 L0.158841498,7.62302312 L2.14601885,5.7683117 C2.23860433,5.681898 2.36053246,5.63383818 2.48717921,5.63383818 C2.76332159,5.63383818 2.98717921,5.8576958 2.98717921,6.13383818 L2.98717921,6.13383818 L2.98717921,6.98322338 L12.9871792,6.98322338 L12.9871792,6.14021514 C12.9871792,5.86407276 13.2110368,5.64021514 13.4871792,5.64021514 C13.613192,5.64021514 13.734558,5.68779611 13.8269951,5.77343839 L15.817825,7.61792711 C16.0203902,7.80560222 16.032461,8.12195451 15.8447859,8.32451971 C15.836602,8.33335289 15.8281017,8.34188755 15.8193016,8.35010699 L13.8284717,10.2095746 C13.6266651,10.3980652 13.3102667,10.3872705 13.1217761,10.1854639 C13.0352863,10.092864 12.9871792,9.97088059 12.9871792,9.84417142 L12.9871792,8.98322338 L2.98717921,8.98322338 Z' transform='translate%284.012821 4.016777%29'/%3E%3Cpath d='M2.98717921,9.83577569 C2.98717921,9.96207419 2.93938272,10.0836936 2.85339304,10.1761981 C2.66538293,10.3784524 2.3490111,10.3899996 2.14675678,10.2019895 L2.14675678,10.2019895 L0.159579429,8.35476343 C0.150917763,8.34671178 0.142544479,8.33835537 0.134475376,8.32970996 C-0.053942288,8.12783526 -0.0430332038,7.81144079 0.158841498,7.62302312 L0.158841498,7.62302312 L2.14601885,5.7683117 C2.23860433,5.681898 2.36053246,5.63383818 2.48717921,5.63383818 C2.76332159,5.63383818 2.98717921,5.8576958 2.98717921,6.13383818 L2.98717921,6.13383818 L2.98717921,6.98322338 L12.9871792,6.98322338 L12.9871792,6.14021514 C12.9871792,5.86407276 13.2110368,5.64021514 13.4871792,5.64021514 C13.613192,5.64021514 13.734558,5.68779611 13.8269951,5.77343839 L15.817825,7.61792711 C16.0203902,7.80560222 16.032461,8.12195451 15.8447859,8.32451971 C15.836602,8.33335289 15.8281017,8.34188755 15.8193016,8.35010699 L13.8284717,10.2095746 C13.6266651,10.3980652 13.3102667,10.3872705 13.1217761,10.1854639 C13.0352863,10.092864 12.9871792,9.97088059 12.9871792,9.84417142 L12.9871792,8.98322338 L2.98717921,8.98322338 Z' transform='rotate%2890 7.987028 12.003805%29'/%3E%3C/g%3E%3C/svg%3E%0A\");\n  }\n\n  .tiw-line-style-solid {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' %3E%3Cpath d='M4,12 L20,12' fill='none' stroke='%23000' stroke-width='2px' stroke-linecap='round'/%3E%3C/svg%3E\");\n  }\n\n  .tiw-line-style-solid.tiw-mathtool-btn__active {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' %3E%3Cpath d='M4,12 L20,12' fill='none' stroke='%23236CFA' stroke-width='2px' stroke-linecap='round'/%3E%3C/svg%3E\");\n  }\n\n  .tiw-line-style-dotted {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' %3E%3Cpath d='M4,12 L10,12' stroke='%23000' stroke-width='2' stroke-linecap='round'%3E%3C/path%3E%3Cpath d='M14,12 L20,12' stroke='%23000' stroke-width='2' stroke-linecap='round'%3E%3C/path%3E%3C/svg%3E\");\n  }\n\n  .tiw-line-style-dotted.tiw-mathtool-btn__active {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' %3E%3Cpath d='M4,12 L10,12' stroke='%23236CFA' stroke-width='2' stroke-linecap='round'%3E%3C/path%3E%3Cpath d='M14,12 L20,12' stroke='%23236CFA' stroke-width='2' stroke-linecap='round'%3E%3C/path%3E%3C/svg%3E\");\n  }\n\n  .tiw-rotate-resize-btn {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cg fill-rule='evenodd'%3E%3Cpath d='M9 11.994c0 .55-.445.995-.994.997l-2.005.005-.001.845a.5.5 0 0 1-.078.268l-.058.075a.5.5 0 0 1-.707.02l-1.951-1.84a.5.5 0 0 1 0-.728l1.95-1.84a.5.5 0 0 1 .844.363l.001.85 2.005-.006a.991.991 0 0 1 .994.988v.003ZM15 11.994c0 .55.445.995.994.997l2.008.005.001.845a.5.5 0 0 0 .078.268l.059.075a.5.5 0 0 0 .706.02l1.951-1.84a.5.5 0 0 0 0-.728l-1.95-1.84a.5.5 0 0 0-.844.363v.85l-2.009-.006a.991.991 0 0 0-.994.988v.003ZM12.018 9a.997.997 0 0 1-.997-.994L11.016 6h-.857a.5.5 0 0 1-.268-.078l-.075-.058a.5.5 0 0 1-.02-.707l1.84-1.951a.5.5 0 0 1 .728 0l1.84 1.95a.5.5 0 0 1-.363.844h-.837l.005 2.006a.991.991 0 0 1-.988.994h-.003ZM12.018 15a.997.997 0 0 0-.997.994L11.016 18h-.857a.5.5 0 0 0-.268.078l-.075.058a.5.5 0 0 0-.02.707l1.84 1.951.02.02a.5.5 0 0 0 .708-.02l1.84-1.95a.5.5 0 0 0-.363-.844h-.837l.005-2.006a.991.991 0 0 0-.988-.994h-.003ZM12 10.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z'/%3E%3C/g%3E%3C/svg%3E\");\n  }\n\n  .tiw-rotate-resize-btn.tiw-mathtool-btn__active {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='128' height='128' class='design-iconfont'%3E%3Cg fill='%23236CFA' fill-rule='evenodd'%3E%3Cpath d='M9 11.994c0 .55-.445.995-.994.997l-2.005.005-.001.845a.5.5 0 0 1-.078.268l-.058.075a.5.5 0 0 1-.707.02l-1.951-1.84a.5.5 0 0 1 0-.728l1.95-1.84a.5.5 0 0 1 .844.363l.001.85 2.005-.006a.991.991 0 0 1 .994.988v.003ZM15 11.994c0 .55.445.995.994.997l2.008.005.001.845a.5.5 0 0 0 .078.268l.059.075a.5.5 0 0 0 .706.02l1.951-1.84a.5.5 0 0 0 0-.728l-1.95-1.84a.5.5 0 0 0-.844.363v.85l-2.009-.006a.991.991 0 0 0-.994.988v.003ZM12.018 9a.997.997 0 0 1-.997-.994L11.016 6h-.857a.5.5 0 0 1-.268-.078l-.075-.058a.5.5 0 0 1-.02-.707l1.84-1.951a.5.5 0 0 1 .728 0l1.84 1.95a.5.5 0 0 1-.363.844h-.837l.005 2.006a.991.991 0 0 1-.988.994h-.003ZM12.018 15a.997.997 0 0 0-.997.994L11.016 18h-.857a.5.5 0 0 0-.268.078l-.075.058a.5.5 0 0 0-.02.707l1.84 1.951.02.02a.5.5 0 0 0 .708-.02l1.84-1.95a.5.5 0 0 0-.363-.844h-.837l.005-2.006a.991.991 0 0 0-.988-.994h-.003ZM12 10.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z'/%3E%3C/g%3E%3C/svg%3E\");\n  }\n\n  /* 圆规 */\n  .tiw-compasses-container {\n    display: flex;\n    flex-direction: column;\n    /* 激活态颜色 */\n    --compassesActiveColor: rgba(35, 108, 250, 0.4);\n    --brushColor: #f00;\n    --compassesRotate:0deg;\n    align-items: center;\n    transform-origin: calc(var(--scaleX) * 36px) 100%;\n    transform: rotate(var(--compassesRotate));\n    --testColor: blue;\n  }\n  \n  .tiw-compasses-container .tiw-compasses-header {\n    position: relative;\n    z-index:1;\n    background-size: contain;\n    height: 108px;\n    width: 72px;\n    cursor: auto;\n    pointer-events: auto;\n    transform: translateY(50px);\n    background-position:center center;\n    background-repeat: no-repeat;\n    background-size: 72px 108px;\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 72 108' width='72' height='108' class='design-iconfont'%3E%3Cdefs%3E%3Cfilter x='-3.6%25' y='-3.3%25' width='107.1%25' height='106.7%25' filterUnits='objectBoundingBox' id='mwdt4wquk__529f07mqlb'%3E%3CfeOffset dy='2' in='SourceAlpha' result='shadowOffsetInner1'/%3E%3CfeComposite in='shadowOffsetInner1' in2='SourceAlpha' operator='arithmetic' k2='-1' k3='1' result='shadowInnerInner1'/%3E%3CfeColorMatrix values='0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.4 0' in='shadowInnerInner1'/%3E%3C/filter%3E%3Cfilter x='0%25' y='0%25' width='100%25' height='100%25' filterUnits='objectBoundingBox' id='mwdt4wquk__dpsn1q913e'%3E%3CfeOffset in='SourceAlpha' result='shadowOffsetInner1'/%3E%3CfeComposite in='shadowOffsetInner1' in2='SourceAlpha' operator='arithmetic' k2='-1' k3='1' result='shadowInnerInner1'/%3E%3CfeColorMatrix values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0' in='shadowInnerInner1'/%3E%3C/filter%3E%3Cfilter x='-2.8%25' y='-2.4%25' width='105.6%25' height='104.8%25' filterUnits='objectBoundingBox' id='mwdt4wquk__u6j7rs7yig'%3E%3CfeOffset dy='2' in='SourceAlpha' result='shadowOffsetInner1'/%3E%3CfeComposite in='shadowOffsetInner1' in2='SourceAlpha' operator='arithmetic' k2='-1' k3='1' result='shadowInnerInner1'/%3E%3CfeColorMatrix values='0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.398389696 0' in='shadowInnerInner1' result='shadowMatrixInner1'/%3E%3CfeOffset dy='-4' in='SourceAlpha' result='shadowOffsetInner2'/%3E%3CfeComposite in='shadowOffsetInner2' in2='SourceAlpha' operator='arithmetic' k2='-1' k3='1' result='shadowInnerInner2'/%3E%3CfeColorMatrix values='0 0 0 0 0.239215686 0 0 0 0 0.290196078 0 0 0 0 0.4 0 0 0 0.08 0' in='shadowInnerInner2' result='shadowMatrixInner2'/%3E%3CfeMerge%3E%3CfeMergeNode in='shadowMatrixInner1'/%3E%3CfeMergeNode in='shadowMatrixInner2'/%3E%3C/feMerge%3E%3C/filter%3E%3Cpath d='M8,0 L20,0 C24.418278,-8.11624501e-16 28,3.581722 28,8 L28,30 L28,30 L0,30 L0,8 C-5.41083001e-16,3.581722 3.581722,8.11624501e-16 8,0 Z' id='mwdt4wquk__gqlhjvdw7a'/%3E%3Cpath d='M4,0 L4,30 L0,30 L0,0 L4,0 Z M12,0 L12,30 L8,30 L8,0 L12,0 Z M20,0 L20,30 L16,30 L16,0 L20,0 Z M28,0 L28,30 L24,30 L24,0 L28,0 Z' id='mwdt4wquk__h46n3ksfsd'/%3E%3Cpath d='M36,24 C55.882251,24 72,40.117749 72,60 C72,63.9080819 71.3772689,67.6707171 70.2256222,71.19409 C63.9460363,91.4637677 42.783352,108 36,108 C29.207486,108 7.9967702,91.4190678 1.74860376,71.1112822 C0.613111106,67.6123563 0,63.8777781 0,60 C0,40.117749 16.117749,24 36,24 Z' id='mwdt4wquk__g59t599iyf'/%3E%3C/defs%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg transform='translate(22)'%3E%3Cmask id='mwdt4wquk__cx3duj21ic' fill='%23fff'%3E%3Cuse xlink:href='%23mwdt4wquk__gqlhjvdw7a'/%3E%3C/mask%3E%3Cuse fill='%23C2CCD8' xlink:href='%23mwdt4wquk__gqlhjvdw7a'/%3E%3Cuse fill='%23000' filter='url(%23mwdt4wquk__529f07mqlb)' xlink:href='%23mwdt4wquk__gqlhjvdw7a'/%3E%3Cg mask='url(%23mwdt4wquk__cx3duj21ic)'%3E%3Cuse fill-opacity='.20083896' fill='%23FFF' xlink:href='%23mwdt4wquk__h46n3ksfsd'/%3E%3Cuse fill='%23000' filter='url(%23mwdt4wquk__dpsn1q913e)' xlink:href='%23mwdt4wquk__h46n3ksfsd'/%3E%3C/g%3E%3Cpath fill-opacity='.08' fill='%233D4A66' mask='url(%23mwdt4wquk__cx3duj21ic)' d='M14 18A42 42 0 1 0 14 102A42 42 0 1 0 14 18Z'/%3E%3C/g%3E%3Cg%3E%3Cuse fill='%23DCE1EA' xlink:href='%23mwdt4wquk__g59t599iyf'/%3E%3Cuse fill='%23000' filter='url(%23mwdt4wquk__u6j7rs7yig)' xlink:href='%23mwdt4wquk__g59t599iyf'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A\");\n  }\n  \n  .tiw-compasses-container .tiw-compasses-body {\n    display: flex;\n    width: 69px;\n    height: calc(100% - 108px);\n    justify-content: space-between;\n    pointer-events: none;\n  }\n  \n  .tiw-compasses-container .tiw-compasses-body__left {\n    position: relative;\n    flex-shrink: 0;\n    flex: 1;\n    height: 260px;\n    pointer-events: none;\n    cursor: inherit;\n    transform-origin: right top;\n    overflow:visible;\n    transform: rotate(var(--compassesLegAngle));\n  }\n\n  .tiw-compasses-container .tiw-compasses-body__left .tiw-compasses-leg {\n    position: absolute;\n    width: 36px;\n    height: 260px;\n    right: -1px;\n    bottom: 0;\n    border-radius: 0;\n    border: none;\n    box-shadow: none;\n    transform-origin: left top;\n    transform: none;\n    background-position: left top;\n    background-color: transparent;\n    background-repeat: no-repeat;\n    background-size: 36px 260px;\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 34 260' width='34' height='260' class='design-iconfont'%3E%3Cdefs%3E%3Cpath d='M16,2.27373675e-13 C24.836556,2.25750426e-13 32,7.163444 32,16 L32,246 L32,246 L10.9278525,227.561871 C3.98337383,221.485452 3.66571922e-14,212.707019 0,203.479417 L0,16 C-1.082166e-15,7.163444 7.163444,2.28996924e-13 16,2.27373675e-13 Z' id='pba0i8jqv__imb3ekayea'/%3E%3C/defs%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cpath d='M22.935,238.067 L31.999,245.998 L32,256.501444 C32,257.052931 31.552931,257.5 31.0014436,257.5 C30.4019455,257.5 29.8664868,257.124977 29.6615752,256.561586 L22.935,238.067 Z' fill-opacity='.88' fill='%238F9AB0' transform='translate(1 1)'/%3E%3Cg transform='translate(1 1)'%3E%3Cpath d='M21.8000888,236.409427 L32.4979568,245.771095 L32.5,256.501444 C32.5,256.915258 32.3322684,257.289898 32.061083,257.561083 C31.7898976,257.832268 31.4152585,258 31.0014436,258 C30.596574,258 30.2133288,257.873364 29.8967044,257.651608 C29.58008,257.429851 29.3300764,257.112973 29.1916889,256.732486 L29.1916889,256.732486 L21.8000888,236.409427 Z M16,-0.5 C20.5563492,-0.5 24.6813492,1.34682541 27.6672619,4.33273811 C30.6531746,7.31865081 32.5,11.4436508 32.5,16 L32.5,16 L32.5,247.101884 L10.5986002,227.938159 C3.54561404,221.766796 -0.5,212.851201 -0.5,203.479417 L-0.5,203.479417 L-0.5,16 C-0.5,11.4436508 1.34682541,7.31865081 4.33273811,4.33273811 C7.31865081,1.34682541 11.4436508,-0.5 16,-0.5 Z' stroke-opacity='.6' stroke='transparent'/%3E%3Cmask id='pba0i8jqv__je5mgjrirb' fill='%23fff'%3E%3Cuse xlink:href='%23pba0i8jqv__imb3ekayea'/%3E%3C/mask%3E%3Cuse fill-opacity='.88' fill='%23D3D9E5' xlink:href='%23pba0i8jqv__imb3ekayea'/%3E%3Cpath d='M16,2.27373675e-13 C24.836556,2.25750426e-13 32,7.163444 32,16 L32.0002124,46.2435558 C29.3789258,46.7351576 26.6765232,46.9947041 23.9152006,47 C15.0907395,47.0168643 6.87802621,44.4348102 -0.00131277517,39.9754694 L2.84219263e-14,16 C2.73397841e-14,7.163444 7.163444,2.28996924e-13 16,2.27373675e-13 Z' fill-opacity='.08' fill='%23313C52' mask='url(%23pba0i8jqv__je5mgjrirb)'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A\");\n    cursor: auto;\n  }\n\n  .tiw-compasses-container .tiw-compasses-body__left.tiw-mathtool-btn__active .tiw-compasses-leg {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 34 260' width='34' height='260' class='design-iconfont'%3E%3Cdefs%3E%3Cpath d='M16,2.27373675e-13 C24.836556,2.25750426e-13 32,7.163444 32,16 L32,246 L32,246 L10.9278525,227.561871 C3.98337383,221.485452 3.66571922e-14,212.707019 0,203.479417 L0,16 C-1.082166e-15,7.163444 7.163444,2.28996924e-13 16,2.27373675e-13 Z' id='pba0i8jqv__imb3ekayea'/%3E%3C/defs%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cpath d='M22.935,238.067 L31.999,245.998 L32,256.501444 C32,257.052931 31.552931,257.5 31.0014436,257.5 C30.4019455,257.5 29.8664868,257.124977 29.6615752,256.561586 L22.935,238.067 Z' fill-opacity='.88' fill='%238F9AB0' transform='translate(1 1)'/%3E%3Cg transform='translate(1 1)'%3E%3Cpath d='M21.8000888,236.409427 L32.4979568,245.771095 L32.5,256.501444 C32.5,256.915258 32.3322684,257.289898 32.061083,257.561083 C31.7898976,257.832268 31.4152585,258 31.0014436,258 C30.596574,258 30.2133288,257.873364 29.8967044,257.651608 C29.58008,257.429851 29.3300764,257.112973 29.1916889,256.732486 L29.1916889,256.732486 L21.8000888,236.409427 Z M16,-0.5 C20.5563492,-0.5 24.6813492,1.34682541 27.6672619,4.33273811 C30.6531746,7.31865081 32.5,11.4436508 32.5,16 L32.5,16 L32.5,247.101884 L10.5986002,227.938159 C3.54561404,221.766796 -0.5,212.851201 -0.5,203.479417 L-0.5,203.479417 L-0.5,16 C-0.5,11.4436508 1.34682541,7.31865081 4.33273811,4.33273811 C7.31865081,1.34682541 11.4436508,-0.5 16,-0.5 Z' stroke-opacity='.6' stroke='%23236CFA'/%3E%3Cmask id='pba0i8jqv__je5mgjrirb' fill='%23fff'%3E%3Cuse xlink:href='%23pba0i8jqv__imb3ekayea'/%3E%3C/mask%3E%3Cuse fill-opacity='.88' fill='%23D3D9E5' xlink:href='%23pba0i8jqv__imb3ekayea'/%3E%3Cpath d='M16,2.27373675e-13 C24.836556,2.25750426e-13 32,7.163444 32,16 L32.0002124,46.2435558 C29.3789258,46.7351576 26.6765232,46.9947041 23.9152006,47 C15.0907395,47.0168643 6.87802621,44.4348102 -0.00131277517,39.9754694 L2.84219263e-14,16 C2.73397841e-14,7.163444 7.163444,2.28996924e-13 16,2.27373675e-13 Z' fill-opacity='.08' fill='%23313C52' mask='url(%23pba0i8jqv__je5mgjrirb)'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A\");\n  }\n\n  .tiw-compasses-container .tiw-compasses-body__left::after {\n    position: absolute;\n    content: '';\n    background: red;\n    border-radius: 50%;\n    display: block;\n    width: 4px;\n    height: 4px;\n    right: 0;\n    top:0;\n  }\n  \n  .tiw-compasses-container .tiw-compasses-body__right {\n    position: relative;\n    flex-shrink: 0;\n    flex: 1;\n    overflow: visible;\n    height: 260px;\n    pointer-events: none;\n    cursor: inherit;\n    transform-origin: left top;\n    transform: rotate(calc(var(--compassesLegAngle) * -1));\n  }\n\n  .tiw-compasses-container .tiw-compasses-body__right .tiw-compasses-leg {\n    position: absolute;\n    width: 36px;\n    height: 260px;\n    left: -1px;\n    bottom: 0;\n    border-radius: 0;\n    transform-origin: left top;\n    transform: rotate(358.5deg);\n    background-position: left top;\n    background-repeat: no-repeat;\n    background-color: transparent;\n    background-size: 36px 260px;\n    border: none;\n    box-shadow: none;\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 34 260' width='34' height='260' class='design-iconfont'%3E%3Cdefs%3E%3Cpath d='M16.0466409,0 C24.8574378,1.61851714e-15 32,7.14256217 32,15.9533591 L32,15.9533591 L32,118.27 L0,237.7 L0.0870290099,15.9533579 C0.0904411009,7.24771671 7.06371622,0.172328003 15.7288775,0.00310041107 Z' id='98o1qdfts__x06y36xhpa'/%3E%3C/defs%3E%3Cg transform='translate(1 1)' fill='none' fill-rule='evenodd'%3E%3Cpath d='M15.7287057,-0.496899559 C20.3542969,-0.498489073 24.4824694,1.28068991 27.4854616,4.16637412 C30.5221241,7.0844133 32.4090697,11.134671 32.4968992,15.6356175 L32.4968992,15.6356175 L32.500002,118.335816 L-0.501492833,241.503583 L-0.412970952,15.9531619 C-0.411213244,11.4685312 1.38395797,7.40338429 4.29417595,4.4357858 C7.210365,1.4620985 11.2462069,-0.40944993 15.7287057,-0.496899559 Z' stroke-opacity='.59665408' stroke='trasnparent' stroke-linejoin='round'/%3E%3Cmask id='98o1qdfts__rlvmo14l1b' fill='%23fff'%3E%3Cuse xlink:href='%2398o1qdfts__x06y36xhpa'/%3E%3C/mask%3E%3Cuse fill-opacity='.88' fill='%23BAC6D6' xlink:href='%2398o1qdfts__x06y36xhpa'/%3E%3Cpath d='M32,105.282 L32,118.27 L-5.82206885e-14,237.7 L0.016,196.878 L32,105.282 Z' fill-opacity='.08' fill='%233D4A66' mask='url(%2398o1qdfts__rlvmo14l1b)'/%3E%3Cpath d='M16,-6.3731152e-15 C24.836556,-9.07853021e-15 32,7.163444 32,16 L32,16 L32.0008876,39.9760466 C25.1217041,44.4350094 16.9093519,47.0168368 8.08531932,47 C5.32386878,46.9947123 2.6213445,46.7351502 -5.56504835e-05,46.2435121 L6.39449431e-14,16 C6.39449431e-14,7.163444 7.163444,-3.6677002e-15 16,-6.3731152e-15 Z' fill-opacity='.08' fill='%233D4A66' mask='url(%2398o1qdfts__rlvmo14l1b)'/%3E%3C/g%3E%3C/svg%3E%0A\");\n    cursor: auto;\n  }\n\n  .tiw-compasses-container .tiw-compasses-body__right.tiw-mathtool-btn__active .tiw-compasses-leg {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 34 260' width='34' height='260' class='design-iconfont'%3E%3Cdefs%3E%3Cpath d='M16.0466409,0 C24.8574378,1.61851714e-15 32,7.14256217 32,15.9533591 L32,15.9533591 L32,118.27 L0,237.7 L0.0870290099,15.9533579 C0.0904411009,7.24771671 7.06371622,0.172328003 15.7288775,0.00310041107 Z' id='98o1qdfts__x06y36xhpa'/%3E%3C/defs%3E%3Cg transform='translate(1 1)' fill='none' fill-rule='evenodd'%3E%3Cpath d='M15.7287057,-0.496899559 C20.3542969,-0.498489073 24.4824694,1.28068991 27.4854616,4.16637412 C30.5221241,7.0844133 32.4090697,11.134671 32.4968992,15.6356175 L32.4968992,15.6356175 L32.500002,118.335816 L-0.501492833,241.503583 L-0.412970952,15.9531619 C-0.411213244,11.4685312 1.38395797,7.40338429 4.29417595,4.4357858 C7.210365,1.4620985 11.2462069,-0.40944993 15.7287057,-0.496899559 Z' stroke-opacity='.59665408' stroke='%23236CFA' stroke-linejoin='round'/%3E%3Cmask id='98o1qdfts__rlvmo14l1b' fill='%23fff'%3E%3Cuse xlink:href='%2398o1qdfts__x06y36xhpa'/%3E%3C/mask%3E%3Cuse fill-opacity='.88' fill='%23BAC6D6' xlink:href='%2398o1qdfts__x06y36xhpa'/%3E%3Cpath d='M32,105.282 L32,118.27 L-5.82206885e-14,237.7 L0.016,196.878 L32,105.282 Z' fill-opacity='.08' fill='%233D4A66' mask='url(%2398o1qdfts__rlvmo14l1b)'/%3E%3Cpath d='M16,-6.3731152e-15 C24.836556,-9.07853021e-15 32,7.163444 32,16 L32,16 L32.0008876,39.9760466 C25.1217041,44.4350094 16.9093519,47.0168368 8.08531932,47 C5.32386878,46.9947123 2.6213445,46.7351502 -5.56504835e-05,46.2435121 L6.39449431e-14,16 C6.39449431e-14,7.163444 7.163444,-3.6677002e-15 16,-6.3731152e-15 Z' fill-opacity='.08' fill='%233D4A66' mask='url(%2398o1qdfts__rlvmo14l1b)'/%3E%3C/g%3E%3C/svg%3E%0A\");\n  }\n\n  .tiw-compasses-container .tiw-compasses-body__right .tiw-compasses-pen {\n    --compassesPenStrokeColor: transparent;\n    --compassesPenPartialStrokeColor: transparent;\n    position: absolute;\n    width: 50px;\n    height: 168px;\n    left: 0px;\n    bottom: 0px;\n    border-radius: 0;\n    transform-origin: 2px 100%;\n    transform: rotate(14deg);\n    overflow: hidden;\n    background-position: center center;\n    background-repeat: no-repeat;\n    background-color: transparent;\n    background-size: 100% 100%;\n    border: none;\n    box-shadow: none;\n  }\n\n  .tiw-compasses-container .tiw-compasses-body__right .tiw-compasses-pen.tiw-mathtool-btn__active {\n    --compassesPenStrokeColor: #236CFA;\n    --compassesPenPartialStrokeColor: transparent;\n  }\n\n  .tiw-compasses-container .tiw-compasses-body__right .tiw-compasses-pen.tiw-mathtool-btn__active.tiw-partial-draw {\n    --compassesPenStrokeColor: transparent;\n    --compassesPenPartialStrokeColor: #236CFA;\n  }\n  \n  .tiw-compasses-container .tiw-btn__icon {\n    margin: 0;\n    width: 32px;\n    height: 32px;\n    background-size: 32px;\n  }\n  \n  .tiw-compasses-header .tiw-btn__icon.tiw-interaction__btn.tiw-close-btn {\n    transform: translate(20px, 48px); \n  }\n  \n  .tiw-compasses-body__right .tiw-btn__icon.tiw-interaction__btn.tiw-rotate-resize-btn {\n    transform: translate(32px, 159px) rotate(var(--compassesLegAngle));\n  }\n\n  .tiw-compasses-container .tiw-compasses-text__radius {\n    position: absolute;\n    left: var(--compassesLegAnchorOffset)；\n    right: var(--compassesLegAnchorOffset);\n    bottom: 0px;\n    height: 0px;\n    border: 1px dashed #FF3B30;\n  }\n\n  .tiw-compasses-container .tiw-compasses-text__radius::after {\n    position: absolute;\n    padding: 4px 6px;\n    top: 24px;\n    left: 50%;\n    transform: translateX(-50%) rotate(var(--rotateAngle));\n    content: attr(data-radius);\n    opacity: 0.94;\n    background: #000000;\n    border: 1px solid rgba(255,255,255,0.32);\n    box-shadow: 0 2px 4px 0 rgba(0,0,0,0.20);\n    border-radius: 4px;\n    color: #fff;\n    font-size: calc(12px * var(--boardScale));\n  }\n","\n  ").concat(yc,"\n  ").concat(function(t){return"\n    .tiw-scroll-vertical__wrap {\n        position: absolute;\n        right: 0;\n        top: 0;\n        width: 10px;\n        height: 100%;\n        overflow-y: auto;\n        z-index: 2000;\n    }\n\n    .tiw-scroll-horizontal__wrap {\n        position: absolute;\n        left: 0;\n        bottom: 0;\n        width: 100%;\n        height: 10px;\n        overflow-x: auto;\n        z-index: 2000;\n    }\n\n    .tiw-scroll-vertical__wrap.disable-scroll, .tiw-scroll-horizontal__wrap.disable-scroll {\n        pointer-events: none;\n    }\n\n    .tiw-scroll-vertical__wrap.pointer-none, .tiw-scroll-horizontal__wrap.pointer-none {\n        pointer-events: none;\n    }\n\n    .tiw-scroll-vertical__wrap.hidden, .tiw-scroll-horizontal__wrap.hidden {\n        visibility: hidden;\n    }\n\n    .tiw-scroll-vertical {\n        width: 10px;\n    }\n\n    .tiw-scroll-horizontal {\n        height: 10px;\n    }\n\n\n    /* 滚动条滑轨 */\n    .tiw-scroll-vertical__wrap::-webkit-scrollbar {\n        width: 10px;\n        height: 0;\n    }\n\n    .tiw-scroll-horizontal__wrap::-webkit-scrollbar {\n        width: 0;\n        height: 10px;\n    }\n\n    /* 滚动条滑轨 */\n    .tiw-scroll-vertical__wrap::-webkit-scrollbar-track, .tiw-scroll-horizontal__wrap::-webkit-scrollbar-track{\n        border-radius: 6px;\n        background: ".concat(t.scrollbarTrackColor||"rgba(0,0,0,0.06)",";\n    }\n\n    /* 滚动条滑块 */\n    .tiw-scroll-vertical__wrap::-webkit-scrollbar-thumb, .tiw-scroll-horizontal__wrap::-webkit-scrollbar-thumb {\n        border-radius: 6px;\n        background: ").concat(t.scrollbarThumbColor||"rgba(0,0,0,0.12)",";\n        -webkit-box-shadow: inset 0 0 10px rgba(0,0,0,0.2);\n    }\n\n  ")}(t),"\n  ").concat("\n  .tx_board_canvas_wrap {\n    -webkit-user-select:none; /*webkit浏览器*/\n    user-select:none;\n  }\n  \n  .tiw-pointer-events_none, .tiw-pointer-events_none * {\n    pointer-events: none !important;\n  }\n  \n  .tx_board_canvas_wrap .tic_element__formula {\n    font-size: 16px;\n    line-height: 1;\n    color: black;\n    font-family: customFontFamily;\n  }\n  .MathJax {\n    font-family: customFontFamily;\n  }\n  \n  #tiw-formula-prerender {\n    line-height: 1;\n    font-family: customFontFamily;\n    visibility: hidden;\n    position: fixed;\n    left: -100000px;\n    top: -100000px;\n  }\n","\n  ").concat("\n.tic_board_textbox, .tic_board_textbox textarea {\n    -webkit-user-select:auto; /*webkit浏览器*/\n    user-select:auto;\n    -webkit-appearance: none; /* 在IOS下，input 和textarea表单默认会有个内阴影*/\n  }\n","\n  ").concat(".tic-board_laserwrap {\n    pointer-events: none;\n    position:relative;\n    z-index:40;\n    width:100%;\n    height:100%;\n    top: 0;\n    left: 0;\n  }\n\n  .tic-board_laser-item {\n    position: absolute;\n    left: 0;\n    top: 0;\n    z-index: 40;\n    will-change: transform;\n    pointer-events: none;\n  }\n  \n  .tic-board_laser-item-img {\n    width: 100%;\n    height: auto;\n    display: block;\n    pointer-events: none;\n  }\n\n  .tic-board_laser-item-img.tiw-hide {\n    visibility: hidden;\n  }\n\n  .tic-board_laser-item-title {\n    position: absolute;\n    z-index: 40;\n    line-height:1;\n    white-space: nowrap;\n    pointer-events: none;\n  }\n  ","\n  ").concat("\n    .tic_board__transcode {\n        position: absolute;\n        z-index: 8;\n        width:100%;\n        height:100%;\n        top: 0;\n        left: 0;\n        font-size: 12px;\n    }\n","\n  ").concat("\n\n.tiw_watermark__wrap {\n  position: absolute;\n  z-index: 110;\n  pointer-events: none;\n  width:100%;\n  height:100%;\n}\n\n.tiw-element__watermark {\n  position: absolute;\n  pointer-events: none;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n  z-index: 110;\n  background-size: 100% 100%;\n}\n\n.tiw-element__watermark-text {\n  background-size: auto;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n\n.tiw-element__watermark-text.fix_text {\n  background-repeat: space;\n}\n","\n  ")}(t),e.appendChild(r)},t.prototype.getTemplate=function(){return"".concat('<canvas class="tiw-sketch__canvas" style="z-index:10;position:absolute; top:0; left:0;line-height:1;"></canvas>','\n    <div class="tic-board_laserwrap"></div>\n    <div class="tic-board__audiowrap"></div>\n    <div id="tic_video_wrap" style="z-index:20;position:absolute; top:0; left:0; display:none;"></div>\n    <div class="tic_board__imagewrap" style="position:absolute;z-index:7;width:100%;height:100%;"></div>\n    <div class="tic_board__mathgraphwrap" style="position:absolute;z-index:7;width:100%;height:100%;"></div>\n    <div class="tic_board_textbox" style="position:absolute;z-index:11;width:100%;height:100%;"></div>\n    <div class="tic_cursorlayer__wrap" style="position:absolute;z-index:0;width:100%;height:100%;"></div>\n    <div class="tic_cursorlayer_remote__wrap" style="position:absolute;z-index:0;width:100%;height:100%;pointer-events: none;"></div>\n    <div class="tiw_board_webview_wrap" style="position:absolute;z-index:0;width:100%;height:100%;"></div>\n    <div class="tiw_board_mathtool_wrap" style="position:absolute;z-index:0;width:100%;height:100%;"></div>\n    <div class="tiw_watermark__wrap"></div>\n    <div class="tx_board_canvas_box" style="position: absolute;">\n      <img src="').concat(L.defaultLoadingImage,'" width="48" height="48" class="tic_board_bg_progress" style="display:none;position:absolute;left: 50%;top: 50%;-webkit-transform: translateX(-50%) translateY(-50%);transform: translateX(-50%) translateY(-50%);" />\n      <img class="tic_board_img_bg" style="visibility:hidden; position:absolute; top:0; left:0;z-index:5;" />\n      <div class="tic_board_bg" style="z-index:4;position:absolute; top:0; left:0;"></div>\n      <textarea maxlength="').concat(M.TEXT_MAX_LENGTH,'" style="display:none;" rows="1"></textarea>\n      <div class="tic_board__transcode" style="position:absolute;z-index:0;width:100%;height:100%;"></div>\n    </div>\n    ')},t}(),_c=function(){function t(){this.compositionLock=!1,this.compositionEndCallback=null}return t.prototype.onCompositionstart=function(){this.compositionLock=!0},t.prototype.onCompositionupdate=function(){},t.prototype.onCompositionend=function(){this.compositionLock=!1,this.compositionEndCallback&&this.compositionEndCallback()},t}(),Ec=function(){function t(t,e,r){this.isInRotateMode=!1,this.hasMouseUp=!0,this.container=t,this.listener=e,this._insertStyle(),this._createElement(),this.isTouchDown=!1,this.touchId=null,this.left=0,this.top=0,this.deg=0,this.prevTitleStyle="",this.isReadonly=r.readonly||!1,this.isShowOperator=r.showOperator||!1,this.containerScale=r.containerScale||1,this.canMove=!0}return t.prototype._insertStyle=function(){var t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style"),r='\n      .tiw-left-top__dir {\n        left:-6px;\n        top:-6px;\n        cursor:nwse-resize;\n      }\n\n      .tiw-top-center__dir {\n        left:calc(50% - 6px);\n        top:-6px;\n        cursor:ns-resize;\n      }\n\n      .tiw-right-top__dir {\n        right:-6px;\n        top:-6px;\n        cursor:nesw-resize;\n      }\n\n      .tiw-right-center__dir {\n        right:-6px;\n        top:calc(50% - 6px);\n        cursor:ew-resize;\n      }\n\n      .tiw-right-bottom__dir {\n        right:-6px;\n        bottom:-6px;\n        cursor:nwse-resize;\n      }\n\n      .tiw-bottom-center__dir {\n        left:calc(50% - 6px);\n        bottom:-6px;\n        cursor:ns-resize;\n      }\n\n      .tiw-left-bottom__dir {\n        left:-6px;\n        bottom:-6px;\n        cursor:nesw-resize;\n      }\n\n      .tiw-left-center__dir {\n        left:-6px;\n        top:calc(50% - 6px);\n        cursor:ew-resize;\n      }\n\n      .tiw-selector-title {\n        position: absolute;\n        white-space: nowrap;\n        padding: 4px 8px;\n        border-radius: 4px;\n        background-color: #1B242D;\n        color: #ffffff;\n        font-size: 12px;\n      }\n\n      .tiw-rotate-div {\n        border: 2px solid red;\n        border-right-color: transparent !important;\n        height: 16px;\n        width: 16px;\n        border-radius: 50%;\n        position: relative;\n        -webkit-transform: rotate(-15deg);\n        -ms-transform: rotate(-15deg);\n        transform: rotate(-15deg);\n        margin-left:-10px;\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        box-sizing: content-box;\n      }\n\n      .tiw-rotate-div:before {\n        content: "";\n        position: absolute;\n        top: 1px;\n        left: 80%;\n        height: 0;\n        width: 0;\n        border: 4px solid transparent;\n        border-left-color: inherit;\n        -webkit-transform: rotate(45deg);\n        -ms-transform: rotate(45deg);\n        transform: rotate(45deg);\n      }\n    ';gt(),r="\n        .tiw-drag__dir {\n          position: absolute;\n          width: ".concat(un(),"px;\n          height: ").concat(un(),"px;\n          background:red;\n          background-clip: padding-box;\n          border: ").concat(dn(),"px solid transparent;\n          box-sizing: content-box;\n        }")+r,e.innerText=r,t.appendChild(e)},t.prototype._createElement=function(){var t=this.cursorPositionLayer=document.createElement("div");t.setAttribute("style","position:absolute;width:100%;height:100%;border:1px dashed red;cursor:move;visibility: hidden;");var e=this.leftTopScaleEl=this._createScaleElement("tiw-left-top__dir tiw-point__0");t.appendChild(e);var r=this.topCenterScaleEl=this._createScaleElement("tiw-top-center__dir tiw-point__1");t.appendChild(r);var i=this.rightTopScaleEl=this._createScaleElement("tiw-right-top__dir tiw-point__2");t.appendChild(i);var o=this.rightCenterScaleEl=this._createScaleElement("tiw-right-center__dir tiw-point__3");t.appendChild(o);var n=this.rightBottomScaleEl=this._createScaleElement("tiw-right-bottom__dir tiw-point__4");t.appendChild(n);var a=this.bottomCenterScaleEl=this._createScaleElement("tiw-bottom-center__dir tiw-point__5");t.appendChild(a);var s=this.leftBottomScaleEl=this._createScaleElement("tiw-left-bottom__dir tiw-point__6");t.appendChild(s);var l=this.leftCenterScaleEl=this._createScaleElement("tiw-left-center__dir tiw-point__7");t.appendChild(l);var c=this.operatorDiv=document.createElement("div");this.operatorDiv.classList.add("tiw-selector-title"),this.operatorDiv.setAttribute("style","left: 0; top: -28px;"),t.appendChild(c),this.eightDirectionEl=[this.leftTopScaleEl,this.topCenterScaleEl,this.rightTopScaleEl,this.rightCenterScaleEl,this.rightBottomScaleEl,this.bottomCenterScaleEl,this.leftBottomScaleEl,this.leftCenterScaleEl];var h=this.rotateEl=this._createRotateElement();t.appendChild(h),this.container.appendChild(t)},t.prototype._createScaleElement=function(t){var e=document.createElement("div");return e.setAttribute("class","tiw-drag__dir ".concat(t||"")),e},t.prototype._createRotateElement=function(){var t=this.rotateDivEl=document.createElement("div"),e=L.cursorLayerImages,r=(e.rotateImgSrc,e.rotateCursorImgSrc),i=e.rotateCursorImgSrc2;t.setAttribute("class","tiw-rotate-div"),t.setAttribute("style","cursor:url(".concat(r,") 11 11, url(").concat(i,") 11 11, auto;"));var o=this.lineDiv=document.createElement("div");o.setAttribute("style","width:1px;height:16px;background:red;");var n=this.rotateContainerDiv=document.createElement("div");return n.setAttribute("style","position:absolute;left:calc(50%);top:-36px;"),n.appendChild(t),n.appendChild(o),n},t.prototype.calcCursorStyle=function(t){return t<=22.5?"n-resize":t<=67.5?"ne-resize":t<=112.5?"e-resize":t<=157.5?"se-resize":t<=202.5?"s-resize":t<=247.5?"sw-resize":t<=292.5?"w-resize":t<=337.5?"nw-resize":"n-resize"},t.prototype.showSelectLayer=function(t){var e=this;t&&(this.elements=t);var r=!1,i=!1,o=!1,n=!1;if(this.isReadonly)r=!0,i=!0,o=!0,n=!0;else if(this.elements.length>1)this.deg=this.deg||0,r=!0,this.elements.forEach((function(t){i=i||t.disableMove,o=o||t.disableProportionScale,n=n||t.disableArbitraryScale}));else{var a=this.elements[0];this.deg=a.deg,r=a.disableRotate,i=a.disableMove,o=a.disableProportionScale,n=a.disableArbitraryScale}r?this._showElement(this.rotateContainerDiv,!1):this._showElement(this.rotateContainerDiv,!0),this.canMove=!i,o?(this._showElement(this.leftTopScaleEl,!this.isInRotateMode&&!1),this._showElement(this.rightTopScaleEl,!this.isInRotateMode&&!1),this._showElement(this.rightBottomScaleEl,!this.isInRotateMode&&!1),this._showElement(this.leftBottomScaleEl,!this.isInRotateMode&&!1)):(this._showElement(this.leftTopScaleEl,!this.isInRotateMode&&!0),this._showElement(this.rightTopScaleEl,!this.isInRotateMode&&!0),this._showElement(this.rightBottomScaleEl,!this.isInRotateMode&&!0),this._showElement(this.leftBottomScaleEl,!this.isInRotateMode&&!0)),n?(this._showElement(this.topCenterScaleEl,!this.isInRotateMode&&!1),this._showElement(this.rightCenterScaleEl,!this.isInRotateMode&&!1),this._showElement(this.bottomCenterScaleEl,!this.isInRotateMode&&!1),this._showElement(this.leftCenterScaleEl,!this.isInRotateMode&&!1)):(this._showElement(this.topCenterScaleEl,!this.isInRotateMode&&!0),this._showElement(this.rightCenterScaleEl,!this.isInRotateMode&&!0),this._showElement(this.bottomCenterScaleEl,!this.isInRotateMode&&!0),this._showElement(this.leftCenterScaleEl,!this.isInRotateMode&&!0)),this.isShowOperator?this._showElement(this.operatorDiv,!0):this._showElement(this.operatorDiv,!1),this._showSelectLayer(),this.cursorPositionLayer.style.visibility="visible",this.rotateDivEl.onmouseenter=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault()},this.rotateDivEl.onmousedown=function(t){if(t.stopPropagation(),t.cancelable&&t.preventDefault(),e.listener.checkAccessible("Element::Rotate::*",e.elements)){e.isInRotateMode=!0,e._hideScaleElement(),e.execOnStartCallback();var r=L.cursorLayerImages.rotateCursorImgSrc2;e.rotateDivEl.style.cursor="url(".concat(r,") 11 11, auto");var i=e._getEventPageXY(t);e.rotateAction(t,i.clientX,i.clientY)}},this.cursorPositionLayer.onmouseenter=function(t){e.cursorPositionLayer.style.cursor="move"},this.cursorPositionLayer.onmousedown=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault(),e.cursorPositionLayer.style.cursor="move",e.listener.checkAccessible("Element::Move::*",e.elements)&&(e.execOnStartCallback(),e.moveScaleAction(t,e.cursorPositionLayer))},this.cursorPositionLayer.removeEventListener("touchstart",this.cursorPositionLayerTouchStartHandler,!1),this.cursorPositionLayerTouchStartHandler=function(t){e.cursorPositionLayer.style.cursor="move",t.stopPropagation(),t.cancelable&&t.preventDefault(),e.listener.checkAccessible("Element::Move::*",e.elements)&&(e.execOnStartCallback(),e.isTouchDown=!0,e.moveScaleAction(t,e.cursorPositionLayer),e.listener.ontouchstart&&e.listener.ontouchstart())},this.cursorPositionLayer.addEventListener("touchstart",this.cursorPositionLayerTouchStartHandler,!1),this.rotateDivEl.removeEventListener("touchstart",this.rotateDivElTouchStartHandler,!1),this.rotateDivElTouchStartHandler=function(t){if(t.stopPropagation(),t.cancelable&&t.preventDefault(),e.listener.checkAccessible("Element::Rotate::*",e.elements)){e.isInRotateMode=!0,e._hideScaleElement(),e.execOnStartCallback();var r=L.cursorLayerImages.rotateCursorImgSrc2;e.rotateDivEl.style.cursor="url(".concat(r,") 11 11, auto");var i=e._getEventPageXY(t);e.rotateAction(t,i.clientX,i.clientY)}},this.rotateDivEl.addEventListener("touchstart",this.rotateDivElTouchStartHandler,!1);var s=this.directionElTouchStartHandler;this.directionElTouchStartHandler=function(t){e.listener.checkAccessible("Element::Scale::*",e.elements)&&(e.execOnStartCallback(),e.moveScaleAction(t,t.target))},this.eightDirectionEl.forEach((function(t){t.onmousedown=null,t.onmouseover=null,t.removeEventListener("touchstart",s,{capture:!1}),t.addEventListener("touchstart",e.directionElTouchStartHandler,{capture:!1,passive:!0}),t.onmousedown=function(r){r.stopPropagation(),r.cancelable&&r.preventDefault(),e.listener.checkAccessible("Element::Scale::*",e.elements)&&(e.execOnStartCallback(),e.moveScaleAction(r,t))};var r=function(t){return(t+360)%360};t.onmouseover=function(i){var o=Ft(e.cursorPositionLayer,"rotate")||0;t===e.topCenterScaleEl?o=r(o):t===e.rightTopScaleEl?o=r(o+45):t===e.rightCenterScaleEl?o=r(o+90):t===e.rightBottomScaleEl?o=r(o+135):t===e.bottomCenterScaleEl?o=r(o+180):t===e.leftBottomScaleEl?o=r(o+225):t===e.leftCenterScaleEl?o=r(o+270):t===e.leftTopScaleEl&&(o=r(o+315)),t.style.cursor=e.calcCursorStyle(o)}}))},t.prototype.moveScaleAction=function(t,e){var r=this;t.stopPropagation(),t.cancelable&&t.preventDefault();var i=0,o=0,n=this._getEventPageXY(t);i=n.pageX,o=n.pageY;var a=!0;if(this.hasMouseUp=!1,-1e6!==i||-1e6!==o){this.container.onmousemove=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault(),a&&(a=!1,requestAnimationFrame((function(){if(a=!0,!r.hasMouseUp){var n=r._doMove(t,e,i,o);i=n.startX,o=n.startY}})))},this.container.onmouseleave=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault(),r.hasMouseUp=!0,r.execOnEndCallback(),r.container.removeEventListener("touchmove",s,!1),r.container.removeEventListener("touchend",l,!1),r.container.removeEventListener("touchcancel",c,!1),r.container.onmousemove=null,r.container.onmouseleave=null,r.container.onmouseup=null,i=0,o=0},this.container.onmouseup=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault(),r.hasMouseUp=!0,r.execOnEndCallback(),r.container.removeEventListener("touchmove",s,!1),r.container.removeEventListener("touchend",l,!1),r.container.removeEventListener("touchcancel",c,!1),r.container.onmousemove=null,r.container.onmouseleave=null,r.container.onmouseup=null,i=0,o=0};var s=function(t){if(t.stopPropagation(),t.cancelable&&t.preventDefault(),r._getEventPageXY(t).isLeave)r.isTouchDown=!1,r.touchId=null,r.container.removeEventListener("touchmove",s,!1),r.container.removeEventListener("touchend",l,!1),r.container.removeEventListener("touchcancel",c,!1),r.container.onmousemove=null,r.container.onmouseleave=null,r.container.onmouseup=null,i=0,o=0,r.execOnEndCallback(),r.listener.ontouchend&&r.listener.ontouchend();else{var n=r._doMove(t,e,i,o);i=n.startX,o=n.startY}},l=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault();var e=r._getEventPageXY(t);-1e6===e.pageX&&-1e6===e.pageY||(r.isTouchDown=!1,r.touchId=null,r.container.removeEventListener("touchmove",s,!1),r.container.removeEventListener("touchend",l,!1),r.container.removeEventListener("touchcancel",c,!1),r.container.onmousemove=null,r.container.onmouseleave=null,r.container.onmouseup=null,i=0,o=0,r.execOnEndCallback(),r.listener.ontouchend&&r.listener.ontouchend())},c=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault();var e=r._getEventPageXY(t);-1e6===e.pageX&&-1e6===e.pageY||(r.isTouchDown=!1,r.touchId=null,r.container.removeEventListener("touchmove",s,!1),r.container.removeEventListener("touchend",l,!1),r.container.removeEventListener("touchcancel",c,!1),r.container.onmousemove=null,r.container.onmouseleave=null,r.container.onmouseup=null,i=0,o=0,r.execOnEndCallback(),r.listener.ontouchcancel&&r.listener.ontouchcancel())};this.container.addEventListener("touchmove",s,!1),this.container.addEventListener("touchend",l,!1),this.container.addEventListener("touchcancel",c,!1)}},t.prototype._calcScale=function(t,e,r){var i=function(t,e,r,i){return Math.sqrt((t-r)*(t-r)+(e-i)*(e-i))},o=function(t,e,r,i){var o={x:r-t,y:i-e},n=Math.sqrt(o.x*o.x+o.y*o.y);return o.x=o.x/n,o.y=o.y/n,o},n=function(t,e){var r=Math.cos(e),i=Math.sin(e);return{x:t.x*r-t.y*i,y:t.x*i+t.y*r}},a=function(t,e,r,i){return{x:t+r.x*i,y:e+r.y*i}},s=function(t,e,r,i,o,n){var a=[r-t,i-e],s=[o-t,n-e];return(a[0]*s[0]+a[1]*s[1])/(Math.sqrt(a[0]*a[0]+a[1]*a[1])*Math.sqrt(s[0]*s[0]+s[1]*s[1]))},l=null,c=null,h=null;switch(t){case this.leftTopScaleEl:l=this.rightBottomScaleEl,c=this.rightTopScaleEl,h=this.leftBottomScaleEl;break;case this.rightTopScaleEl:l=this.leftBottomScaleEl,c=this.rightBottomScaleEl,h=this.leftTopScaleEl;break;case this.leftBottomScaleEl:l=this.rightTopScaleEl,c=this.leftTopScaleEl,h=this.rightBottomScaleEl;break;case this.rightBottomScaleEl:l=this.leftTopScaleEl,c=this.leftBottomScaleEl,h=this.rightTopScaleEl;break;case this.leftCenterScaleEl:l=this.rightCenterScaleEl;break;case this.rightCenterScaleEl:l=this.leftCenterScaleEl;break;case this.topCenterScaleEl:l=this.bottomCenterScaleEl;break;case this.bottomCenterScaleEl:l=this.topCenterScaleEl}var u,d,p,f,g,m,y,v=t.getBoundingClientRect(),_=v.x/this.containerScale,E=v.y/this.containerScale,T=l?l.getBoundingClientRect():{x:0,y:0},b=T.x/this.containerScale,S=T.y/this.containerScale;if(t===this.leftTopScaleEl||t===this.rightTopScaleEl||t===this.leftBottomScaleEl||t===this.rightBottomScaleEl){var x=c?c.getBoundingClientRect():{x:0,y:0},w=x.x/this.containerScale,O=x.y/this.containerScale,I=h?h.getBoundingClientRect():{x:0,y:0},A=I.x/this.containerScale,D=I.y/this.containerScale,C=s(b,S,w,O,e,r),P=s(b,S,A,D,e,r);if(C<0||P<0)return{width:1,height:1};var L=(d=b,p=S,f=w,g=O,m=_,y=E,Math.acos(s(d,p,f,g,m,y))),M=i(b,S,e,r),R=o(b,S,e,r),N=a(b,S,n(R,-L),M*Math.cos(L)),B=N.x,k=N.y,F=a(b,S,n(R,-Math.PI/2+L),M*Math.sin(L)),U=F.x,H=F.y,G=i(b,S,w,O),q=i(b,S,A,D);return{width:i(b,S,B,k)/G,height:i(b,S,U,H)/q}}return t===this.leftCenterScaleEl||t===this.rightCenterScaleEl?s(b,S,_,E,e,r)<0?{width:1,height:1}:(G=i(b,S,_,E),{width:i(b,S,(u=a(b,S,o(b,S,_,E),M=i(b,S,e,r))).x,u.y)/G,height:1}):s(b,S,_,E,e,r)<0?{width:1,height:1}:(q=i(b,S,_,E),{width:1,height:i(b,S,(u=a(b,S,o(b,S,_,E),M=i(b,S,e,r))).x,u.y)/q})},t.prototype._doMove=function(t,e,r,i){var o,n,a,s,l=this;if(t.cancelable&&t.preventDefault(),t.stopPropagation(),!this.canMove&&-1===e.className.indexOf("tiw-drag__dir"))return{startX:r,startY:i};var c=this._getEventPageXY(t);if(-1e6===c.pageX&&-1e6===c.pageY)return{startX:r,startY:i};if(e===this.cursorPositionLayer)this.listener.checkAccessible("Element::Move::*",this.elements)&&(this.setSize(0,0),this.setPosition(e,c.pageX-r,c.pageY-i));else if(this.listener.checkAccessible("Element::Scale::*",this.elements)){var h=this._calcScale(e,c.pageX,c.pageY);(this.borderWidth<=9&&h.width<1||this.borderHeight<=9&&h.height<1)&&(h.width=1,h.height=1),this.setPositionSize(e,h.width,h.height)}return r=c.pageX,i=c.pageY,null===(n=(o=this.listener).onmousemove)||void 0===n||n.call(o,this.elements),null===(s=(a=this.listener).needToRender)||void 0===s||s.call(a,this.elements),requestAnimationFrame((function(){l._showSelectLayer(),l.listener.fireElementPosition&&l.listener.fireElementPosition(l.elements)})),{startX:r,startY:i}},t.prototype.rotateAction=function(t,e,r){var i=this,o=t.currentTarget.getBoundingClientRect();this.container.onmousemove=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault(),i.isInRotateMode=!0;var n=i._calcRotateDeg(t,o,e,r);i.elementRotate(n),i.cursorPositionLayer.style.cursor=i.rotateDivEl.style.cursor},this.container.onmouseleave=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault(),i.isInRotateMode=!1,i.container.removeEventListener("touchmove",n,!1),i.container.removeEventListener("touchend",a,!1),i.container.removeEventListener("touchcancel",s,!1),i.container.onmousemove=null,i.container.onmouseleave=null,i.container.onmouseup=null,i.showSelectLayer(),i.cursorPositionLayer.style.cursor="move"},this.container.onmouseup=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault(),i.isInRotateMode=!1,i.execOnEndCallback(),i.container.removeEventListener("touchmove",n,!1),i.container.removeEventListener("touchend",a,!1),i.container.removeEventListener("touchcancel",s,!1),i.container.onmousemove=null,i.container.onmouseleave=null,i.container.onmouseup=null,i.showSelectLayer(),i.cursorPositionLayer.style.cursor="move"};var n=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault(),i.isInRotateMode=!0;var n=i._calcRotateDeg(t,o,e,r);i.elementRotate(n),i.cursorPositionLayer.style.cursor=i.rotateDivEl.style.cursor},a=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault();var e=i._getEventPageXY(t);-1e6===e.pageX&&-1e6===e.pageY||(i.isTouchDown=!1,i.touchId=null,i.isInRotateMode=!1,i.container.removeEventListener("touchmove",n,!1),i.container.removeEventListener("touchend",a,!1),i.container.removeEventListener("touchcancel",s,!1),i.container.onmousemove=null,i.container.onmouseleave=null,i.container.onmouseup=null,i.execOnEndCallback(),i.listener.ontouchend&&i.listener.ontouchend(),i.showSelectLayer())},s=function(t){t.stopPropagation(),t.cancelable&&t.preventDefault();var e=i._getEventPageXY(t);-1e6===e.pageX&&-1e6===e.pageY||(i.isTouchDown=!1,i.touchId=null,i.isInRotateMode=!1,i.container.removeEventListener("touchmove",n,!1),i.container.removeEventListener("touchend",a,!1),i.container.removeEventListener("touchcancel",s,!1),i.container.onmousemove=null,i.container.onmouseleave=null,i.container.onmouseup=null,i.execOnEndCallback(),i.listener.ontouchcancel&&i.listener.ontouchcancel(),i.showSelectLayer())};this.container.addEventListener("touchmove",n,!1),this.container.addEventListener("touchend",a,!1),this.container.addEventListener("touchcancel",s,!1)},t.prototype._rotatePoint=function(t,e,r){r||(r={x:0,y:0});var i=e*(Math.PI/180),o=Math.sin(i),n=Math.cos(i);return{x:(t.x-r.x)*n-(t.y-r.y)*o+r.x,y:(t.x-r.x)*o+(t.y-r.y)*n+r.y}},t.prototype._scalePoint=function(t,e,r){return r||(r={x:0,y:0}),{x:(t.x-r.x)*e.x+r.x,y:(t.y-r.y)*e.y+r.y}},t.prototype._translatePoint=function(t,e){return{x:t.x+e.x,y:t.y+e.y}},t.prototype.elementRotate=function(t){var e=this;if(this.cursorPositionLayer){0==this.left&&0==this.top&&(this.left=Ft(this.cursorPositionLayer,"x")||0,this.top=Ft(this.cursorPositionLayer,"y")||0);var r={x:this.borderLeft+this.borderWidth/2,y:this.borderTop+this.borderHeight/2},i=t-this.deg;this.elements.forEach((function(t){var o=(t.deg+i+360)%360,n=t.getRealSize(),a={x:n.left+n.width/2,y:n.top+n.height/2},s=e._rotatePoint(a,i,r);t.setPosition(s.x-a.x,s.y-a.y),t.setRotate(o)})),this.deg=t,this.listener.onmousemove&&this.listener.onmousemove(this.elements),this.listener.needToRender&&this.listener.needToRender(this.elements),this.listener.fireElementPosition&&this.listener.fireElementPosition(this.elements)}},t.prototype.setPositionSize=function(t,e,r){var i=this,o=this.borderLeft+this.borderWidth,n=this.borderTop+this.borderHeight;this.elements.forEach((function(a){var s,l,c,h,u=a.getRealSize(),d={x:e,y:r};if(i.elements.length>1){if(i.borderLeft<=6&&(t===i.leftTopScaleEl||t===i.leftCenterScaleEl||t===i.leftBottomScaleEl)&&e>=1)return;if(i.borderTop<=6&&(t===i.leftTopScaleEl||t===i.topCenterScaleEl||t===i.rightTopScaleEl)&&r>=1)return;if(a.boardWidth-o<=6&&(t===i.rightTopScaleEl||t===i.rightCenterScaleEl||t===i.rightBottomScaleEl)&&e>=1)return;if(a.boardHeight-n<=6&&(t===i.leftBottomScaleEl||t===i.bottomCenterScaleEl||t===i.rightBottomScaleEl)&&r>=1)return;var p={x:u.left,y:u.top};p=i._rotatePoint(p,a.deg,{x:u.left+u.width/2,y:u.top+u.height/2}),p=i._scalePoint(p,d,{x:i.borderLeft,y:i.borderTop}),t!==i.leftTopScaleEl&&t!==i.leftCenterScaleEl&&t!==i.leftBottomScaleEl||(p.x+=i.borderWidth*(1-d.x)),t!==i.leftTopScaleEl&&t!==i.topCenterScaleEl&&t!==i.rightTopScaleEl||(p.y+=i.borderHeight*(1-d.y));var f={x:u.width,y:u.height};f=i._rotatePoint(f,a.deg),f=i._scalePoint(f,d),p=i._rotatePoint(p,-a.deg,{x:p.x+f.x/2,y:p.y+f.y/2}),f=i._rotatePoint(f,-a.deg),d.x=f.x/u.width,d.y=f.y/u.height,s=f.x-u.width,l=f.y-u.height,c=p.x-u.left,h=p.y-u.top}else{s=u.width*(d.x-1),l=u.height*(d.y-1);var g="";t===i.leftTopScaleEl?g="RIGHT_BOTTOM":t===i.rightTopScaleEl?g="LEFT_BOTTOM":t===i.leftBottomScaleEl?g="RIGHT_TOP":t===i.rightBottomScaleEl?g="LEFT_TOP":t===i.leftCenterScaleEl?g="RIGHT_TOP":t===i.rightCenterScaleEl?g="LEFT_TOP":t===i.topCenterScaleEl?g="LEFT_BOTTOM":t===i.bottomCenterScaleEl&&(g="LEFT_TOP");var m={LEFT_TOP:{x:u.left,y:u.top},RIGHT_TOP:{x:u.left+u.width,y:u.top},RIGHT_BOTTOM:{x:u.left+u.width,y:u.top+u.height},LEFT_BOTTOM:{x:u.left,y:u.top+u.height},MIDDLE:{x:u.left+u.width/2,y:u.top+u.height/2}},y=i._calcRotateXY(a.deg,m[g],m.MIDDLE);u.width+=s,u.height+=l;var v={LEFT_TOP:{x:u.left,y:u.top},RIGHT_TOP:{x:u.left+u.width,y:u.top},RIGHT_BOTTOM:{x:u.left+u.width,y:u.top+u.height},LEFT_BOTTOM:{x:u.left,y:u.top+u.height},MIDDLE:{x:u.left+u.width/2,y:u.top+u.height/2}},_=i._calcRotateXY(a.deg,v[g],v.MIDDLE);c=y.x-_.x,h=y.y-_.y}a.setSize(s,l,d.x,d.y)||a.setPosition(c,h)}))},t.prototype.setPosition=function(t,e,r){var i=this;void 0===e&&(e=0),void 0===r&&(r=0);var o=this.borderLeft+this.borderWidth,n=this.borderTop+this.borderHeight;1!==this.elements.length||"imageElement"!==this.elements[0].type?this.elements.forEach((function(t){e<=0&&i.borderLeft+e<=8&&(e=8-i.borderLeft),r<=0&&i.borderTop+r<=8&&(r=8-i.borderTop),t.boardWidth-o-e<=8&&e>=0&&(e=t.boardWidth-o-8),t.boardHeight-n-r<=8&&r>=0&&(r=t.boardHeight-n-8),t.setPosition(e,r)})):this.elements[0].setPosition(e,r)},t.prototype.setSize=function(t,e){this.elements.forEach((function(r){r.setSize(t,e)}))},t.prototype._showSelectLayer=function(){for(var t=1e4,e=1e4,r=0,i=0,o=0,n=this.elements.length;o<n;o++){var a=this.elements[o];if(1==this.elements.length){var s=a.getRealSize();t=Math.min(t,s.left),e=Math.min(e,s.top),r=Math.max(r,s.left+s.width),i=Math.max(i,s.top+s.height)}else{var l=a.rectArea;t=Math.min(t,l.minX*a.boardWidth/1e4),e=Math.min(e,l.minY*a.boardHeight/1e4),r=Math.max(r,l.maxX*a.boardWidth/1e4),i=Math.max(i,l.maxY*a.boardHeight/1e4)}}r-=t,i-=e,this.borderWidth=r,this.borderHeight=i,this.borderLeft=t,this.borderTop=e;var c;c=1===this.elements.length?"rotate(".concat(this.elements[0].deg,"deg)"):"rotate(".concat(this.deg,"deg)"),this.left=t,this.top=e,this.cursorPositionLayer.style.visibility="visible",this.cursorPositionLayer.style.width=Math.ceil(r)+"px",this.cursorPositionLayer.style.height=Math.ceil(i)+"px",this.cursorPositionLayer.style.transform="translateX(".concat(t,"px) translateY(").concat(e,"px) ").concat(c),this.cursorPositionLayer.style.webkitTransform="translateX(".concat(t,"px) translateY(").concat(e,"px) ").concat(c)},t.prototype.hideSelectLayer=function(){this.deg=0,this.cursorPositionLayer.style.visibility="hidden"},t.prototype.setListener=function(t){this.listener=t},t.prototype._getEventPageXY=function(t){if(t.changedTouches){var e=null;if(null==this.touchId)this.touchId=t.changedTouches[0].identifier,e=t.changedTouches[0];else{for(var r=0,i=t.changedTouches.length;r<i;r++){var o=t.changedTouches[r];if(this.touchId===o.identifier){e=o;break}}e||(e={pageX:-1e6,pageY:-1e6,clientX:0,clientY:0});var n=document.elementFromPoint(e.pageX,e.pageY);e&&!this.container.contains(n)&&(e.isLeave=!0)}return{pageX:e.pageX/this.containerScale,pageY:e.pageY/this.containerScale,clientX:e.clientX,clientY:e.clientY,isLeave:e.isLeave||!1}}return{pageX:t.pageX/this.containerScale,pageY:t.pageY/this.containerScale,clientX:t.clientX,clientY:t.clientY,isLeave:!1}},t.prototype._calcRotateDeg=function(t,e,r,i){var o=this._getEventPageXY(t),n=e.left+e.width/2+(o.clientX-r),a=e.top+e.height/2+(o.clientY-i),s=this.cursorPositionLayer.getBoundingClientRect(),l=s.left+s.width/2,c=s.top+s.height/2,h=Math.atan2(c-a,n-l)/(Math.PI/180)-90;return(h=-h)<0&&(h=360+h),h=parseFloat(h.toFixed(2)),Number(h||0)},t.prototype._hideScaleElement=function(){var t=this;this.eightDirectionEl.forEach((function(e){t._showElement(e,!1)}))},t.prototype._showElement=function(t,e){t.style.display,t&&(t.style.display=e?"block":"none")},t.prototype._calcRotateXY=function(t,e,r){var i=t*(Math.PI/180);return{x:(e.x-r.x)*Math.cos(i)-(e.y-r.y)*Math.sin(i)+r.x,y:(e.x-r.x)*Math.sin(i)+(e.y-r.y)*Math.cos(i)+r.y}},t.prototype.setScaleElementStyle=function(t){this.eightDirectionEl.forEach((function(e){e.style.backgroundColor=t.color}))},t.prototype.setRotateElementStyle=function(t){this.lineDiv.style.backgroundColor=t.color,this.rotateDivEl.style.borderColor=t.color},t.prototype.setBorderStyle=function(t){this.cursorPositionLayer.style.border=t.border},t.prototype.setOperator=function(t){if(t){var e=t.title,r=t.style;if(this.operatorDiv.style.visibility=e?"visible":"hidden",this.operatorDiv.textContent!==e&&(this.operatorDiv.textContent=e),e&&r&&N(r)){var i=JSON.stringify(r);if(this.prevTitleStyle===i)return;this.prevTitleStyle=i;var o="",n=gt()?8:12,a=Math.max(r.size||n,n);o+="font-size:".concat(a,"px;");var s=r.color;o+="color:".concat(s,";");var l=r.style;l===Jn.TEDU_BOARD_TEXT_STYLE_NORMAL?(o+="font-style: normal;",o+="font-weight: normal;"):l===Jn.TEDU_BOARD_TEXT_STYLE_BOLD?(o+="font-style: normal;",o+="font-weight: bold;"):l===Jn.TEDU_BOARD_TEXT_STYLE_ITALIC?(o+="font-style: italic;",o+="font-weight: normal;"):l===Jn.TEDU_BOARD_TEXT_STYLE_BOLD_ITALIC&&(o+="font-style: italic;",o+="font-weight: bold;"),this.operatorDiv.setAttribute("style",o);var c=r.position,h=this.operatorDiv.clientHeight+4;switch(c){case 0:o+="left:0;",o+="top:".concat(-h,"px;");break;case 1:o+="right:0;",o+="top:".concat(-h,"px;");break;case 2:o+="right:0;",o+="bottom:".concat(-h,"px;");break;case 3:o+="left:0;",o+="bottom:".concat(-h,"px;")}this.operatorDiv.setAttribute("style",o)}}else this.operatorDiv.style.visibility="hidden"},t.prototype.execOnStartCallback=function(){this.listener.onstart&&this.listener.onstart(this.elements)},t.prototype.execOnEndCallback=function(){var t=this;requestAnimationFrame((function(){t.listener.onend&&t.listener.onend(t.elements)}))},t.prototype.destroy=function(){this.cursorPositionLayer&&(this.cursorPositionLayer.remove(),this.cursorPositionLayer=null)},t}(),Tc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),bc=function(t){function e(e,r){var i=t.call(this,e)||this;return i.isNeedDraw=!0,i.emojiReg=/[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF][\u200D|\uFE0F]|[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF]|[0-9|*|#]\uFE0F\u20E3|[0-9|#]\u20E3|[\u203C-\u3299]\uFE0F\u200D|[\u203C-\u3299]\uFE0F|[\u2122-\u2B55]|\u303D|[\A9|\AE]\u3030|\uA9|\uAE|\u3030/gi,i.boardId=r.boardId,i.lineHeight=1,i.measureTextElement=document.querySelector('[data-font="'.concat(r.typeFace.split(",")[0],'"]'))||document.querySelector('[data-font="customFontFamily"]'),i.dpr=window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||1,i.getToolType=r.getToolType,i.eventConfig={},i.fontSize=0,i.fontScale=0,i.originFontScale=0,i.maxWidth=0,i.maxHeight=0,i.textItem=null,i.containerWidth=0,i.containerHeight=0,i.boardWidth=0,i.boardHeight=0,i.compositionLock=!1,i.isNeedDraw=r.isNeedDraw,i.valueBeforeInput="",i.selectionStartBeforeInput=0,i}return Tc(e,t),e.prototype.createElement=function(t){this.textContainer=t,this.dom=document.createElement("textarea"),this.dom.setAttribute("spellcheck","false"),t.appendChild(this.dom),this.initStyle()},e.prototype.initStyle=function(){this.dom&&(Object.assign(this.dom.style,{position:"absolute","z-index":9,"box-sizing":"content-box",outline:"none",resize:"none","word-break":"break-all",overflow:"hidden",background:"transparent","line-height":this.lineHeight,border:"1px dotted transparent","font-family":"customFontFamily",margin:0,padding:0,"white-space":"pre","border-radius":0}),11!==this.getToolType()&&Object.assign(this.dom.style,{"pointer-events":"none"}))},e.prototype.initEvent=function(t){var e=this;if(this.dom){this.eventConfig=t,this.dom.removeEventListener("touchstart",this.domTouchStartHandler,!1),this.dom.removeEventListener("touchmove",this.domTouchMoveHandler,!1),this.dom.removeEventListener("touchend",this.domTouchStartHandler,!1),this.dom.removeEventListener("touchcancel",this.domTouchStartHandler,!1);var r=!0;this.domTouchStartHandler=function(t){t.stopPropagation(),r=!0},this.domTouchMoveHandler=function(t){t.stopPropagation()},this.domTouchEndHandler=function(t){t.stopPropagation()},this.domTouchCancelHandler=function(t){t.stopPropagation()},this.dom.addEventListener("touchstart",this.domTouchStartHandler,!1),this.dom.addEventListener("touchmove",this.domTouchMoveHandler,!1),this.dom.addEventListener("touchend",this.domTouchStartHandler,!1),this.dom.addEventListener("touchcancel",this.domTouchStartHandler,!1),this.dom.onmousedown=function(t){t.stopPropagation(),r=!0},this.dom.onmousemove=function(t){t.stopPropagation()},this.dom.onmouseup=function(t){t.stopPropagation()},this.dom.onmouseleave=function(t){t.stopPropagation()},this.dom.onfocus=null,this.dom.onfocus=function(i){if(r)if(e.isBlured=!1,11==e.getToolType()){e.initStyle();var o=e._calcShowFullText(),n=o.scale,a=o.dragOffsetX,s=o.dragOffsetY;e.showBorder(!0),t.onfocus&&t.onfocus(e,a,s,n);var l=e._calcShowFullText(),c=l.scale,h=l.dragOffsetX,u=l.dragOffsetY;n===c&&a===h&&s===u||t.onfocus&&t.onfocus(e,h,u,c,!0),e.setSize()}else e.dom&&e.dom.blur();else e.dom.blur()},this.compositionLock=!1;var i=function(){e.compositionLock=!0};this.dom.removeEventListener("compositionstart",i),this.dom.addEventListener("compositionstart",i);var o=function(){yt()?setTimeout((function(){e.newSmartPaintText()}),0):e.newSmartPaintText()};this.dom.removeEventListener("compositionend",o),this.dom.addEventListener("compositionend",o);var n=function(){e.selectionStartBeforeInput=yt()?e.dom.selectionEnd:e.dom.selectionStart};this.dom.removeEventListener("beforeinput",n),this.dom.addEventListener("beforeinput",n),this.dom.oninput=null,this.dom.oninput=function(t){if(e.isBlured)e.dom.value=e.textItem.text;else{var r=e.dom.value;if(e.settingConfig.getElementOpAuth("text").disableUseEmoji&&r.match(e.emojiReg)&&(r=r.replace(e.emojiReg,""),e.dom.value=r,e.eventConfig&&e.eventConfig.onemoji&&e.eventConfig.onemoji()),e.compositionLock){if(-1===r.indexOf("\n\f")&&-1===r.indexOf("\n")){e.setSize(r);var i=e.dom.style.maxWidth,o=e.dom.style.width,n=e.dom.style.height,a=parseFloat(i),s=parseFloat(o);if(s>a){var l=Math.ceil(s/a),c=n;e.dom.style.height=parseFloat(c)*l+"px"}}}else e.newSmartPaintText()}},this.dom.onblur=null,this.dom.onblur=function(){e.isBlured||e.blur(),r=!1}}},e.prototype.newSmartPaintText=function(){var t=this;if(this.dom){var e=yt()?this.dom.selectionEnd:this.dom.selectionStart,r=0,i=JSON.parse(JSON.stringify(this.dom.value));if(i.indexOf("\n\f")>-1){var o=new RegExp("\n\f","g");i=i.replace(o,(function(t,i){return i<e&&(r+="\n\f".length),""}))}for(var n=e-=r,a=this.dom.style.maxWidth,s=parseFloat(a),l=this.dom.style.maxHeight,c=parseFloat(l),h=this.fontSize,u=this.fontSize*this.lineHeight,d="",p=0,f=0,g=u,m=function(t){p=t,g+=u},y=0;y<i.length;y++){var v=i[y];if("\n"!==v){var _=/[^\x00-\xff]/g.test(v)?h:h/2;if(p+=_,f=Math.max(f,p),p>s){if(m(_),g>=c){this.eventConfig.onlimit&&this.eventConfig.onlimit(),d=this.valueBeforeInput,e=this.selectionStartBeforeInput;break}d+="".concat("\n\f").concat(v),y<n&&(e+="\n\f".length)}else d+=v}else{if(m(0),g>=c){this.eventConfig.onlimit&&this.eventConfig.onlimit(),d=this.valueBeforeInput,e=this.selectionStartBeforeInput;break}d+=v}}this.dom.style.width="".concat(f,"px"),this.dom.style.height="".concat(g,"px"),this.dom.value=d,this.valueBeforeInput=d,this.dom.setSelectionRange?(this.dom.setSelectionRange(e,e),requestAnimationFrame((function(){t.dom.setSelectionRange(e,e)}))):(this.dom.selectionStart=e,this.dom.selectionEnd=e);var E=this._calcShowFullText(),T=E.scale,b=E.dragOffsetX,S=E.dragOffsetY;this.eventConfig.oninput&&this.eventConfig.oninput(this,b,S,T);var x=this._calcShowFullText(),w=x.scale,O=x.dragOffsetX,I=x.dragOffsetY;T===w&&b===O&&S===I||this.eventConfig.oninput&&this.eventConfig.oninput(this,O,I,w),this.compositionLock=!1}},e.prototype.setTextItem=function(t){this.dom&&(this.dom.id="tic-textarea__".concat(t.belongSeq),this.compositionLock||encodeURI(escape(this.dom.value))===encodeURI(escape(t.text))||(this.dom.value=t.text,this.valueBeforeInput=t.text),this.textItem=t,this.setTextStyle())},e.prototype.setFontSize=function(t){this.dom&&this.measureTextElement&&(this.fontSize=t,this.dom.style.fontSize=t+"px",this.dom.style.minWidth=this.fontSize+"px",this.dom.style.minHeight=this.fontSize+"px",this.dom.style.lineHeight=String(this.lineHeight),this.measureTextElement.style.fontSize=(this.fontSize/this.dpr).toFixed(4)+"px",this.measureTextElement.style.lineHeight=(this.fontSize*this.lineHeight/this.dpr).toFixed(4)+"px")},e.prototype.setMaxSize=function(){var t,e,r=(t=this.boardWidth,this.containerWidth,e=this.boardHeight,this.containerHeight,{distanceX:t-this.textItem.location.x/1e4*t,distanceY:e-this.textItem.location.y/1e4*e}),i=r.distanceX,o=r.distanceY;this.maxWidth=i-pn()-dn(),this.maxHeight=o-pn()-dn(),this.dom&&(this.dom.style.maxWidth=this.maxWidth+"px",this.dom.style.maxHeight=this.maxHeight+"px")},e.prototype.setPosition=function(t,e){this.dom&&(this.dom.style.left=t+"px",this.dom.style.top=e+"px")},e.prototype.showBorder=function(t){this.dom&&(this.dom.style.border="1px dashed ".concat(t?Ss.textComponent.border.color:"transparent"))},e.prototype.focus=function(){var t=this.isAllowShowInput();return t?this.dom&&this.dom.focus():this.remove(),t},e.prototype.blur=function(){this.showBorder(!1),""!==this.dom.value&&""!==this.dom.value.trim()||(this.textItem.show=!1,this.remove()),this.isNeedDraw||(this.dom.value=""),this.eventConfig.onblur&&this.eventConfig.onblur(this),this.setSize(),this.isBlured=!0,this.dom.blur()},e.prototype.setFontScale=function(t){if(this.dom&&this.measureTextElement){this.textItem.setBoardSize(this.boardWidth,this.boardHeight);var e=this.textItem.deg,r=this.textItem.scaleY,i=this.textItem.pointTransformer(this.textItem.location),o=(i.x-this.textItem.location.x)/1e4*this.boardWidth,n=(i.y-this.textItem.location.y)/1e4*this.boardHeight;this.originFontScale=t,t*=r,this.fontScale=t,this.dom.style.transformOrigin="0 0",this.dom.style.transform="translate(".concat(o,"px, ").concat(n,"px) rotate(").concat(e,"deg) scale(").concat(t,")"),this.dom.style.webkitTransformOrigin="0 0",this.dom.style.webkitTransform="translate(".concat(o,"px, ").concat(n,"px) rotate(").concat(e,"deg) scale(").concat(t,")"),this.dom.style.maxWidth=this.maxWidth/t+"px",this.dom.style.maxHeight=this.maxHeight/t+"px",this.measureTextElement.style.transformOrigin="0 0",this.measureTextElement.style.transform="translate(".concat(o,"px, ").concat(n,"px) rotate(").concat(e,"deg) scale(").concat(t,")"),this.measureTextElement.style.webkitTransformOrigin="0 0",this.measureTextElement.style.webkitTransform="translate(".concat(o,"px, ").concat(n,"px) rotate(").concat(e,"deg) scale(").concat(t,")")}},e.prototype.setTextStyle=function(){if(this.dom){var t={color:this.textItem.color};this.lineHeight=this.textItem.lineHeight;var e=this.textItem.fontStyle;e===Jn.TEDU_BOARD_TEXT_STYLE_NORMAL?(t.fontStyle="normal",t.fontWeight="normal"):e===Jn.TEDU_BOARD_TEXT_STYLE_BOLD?(t.fontStyle="normal",t.fontWeight="bold"):e===Jn.TEDU_BOARD_TEXT_STYLE_ITALIC?(t.fontStyle="italic",t.fontWeight="normal"):e===Jn.TEDU_BOARD_TEXT_STYLE_BOLD_ITALIC&&(t.fontStyle="italic",t.fontWeight="bold");var r=this.textItem.typeFace;t["font-family"]=r,Object.assign(this.dom.style,t)}},e.prototype.setSize=function(t){if(void 0===t&&(t=""),this.dom&&this.measureTextElement){var e,r;"\n"==(t=t||this.dom.value).substr(t.length-1)?this.measureTextElement.textContent=t+" ":this.measureTextElement.textContent=t;var i=window.getComputedStyle(this.measureTextElement);e=mt()?parseFloat(this.getMeasureTextToolComputedStyle("width","",i))+6+"px":this.getMeasureTextToolComputedStyle("width","px",i),r=this.getMeasureTextToolComputedStyle("height","px",i);var o=this.dom.style.width,n=this.dom.style.height;o!=e&&(this.dom.style.width=e),n!=r&&(this.dom.style.height=r),this.textItem.textWidth=(pn()+dn()+parseFloat(e))/this.boardWidth*1e4*this.fontScale,this.textItem.textHeight=(pn()+dn()+parseFloat(r))/this.boardHeight*1e4*this.fontScale,this.eventConfig&&this.eventConfig.onresize&&this.eventConfig.onresize(this)}},e.prototype.remove=function(){var t=this;setTimeout((function(){t.dom&&t.dom.remove()}),0)},e.prototype.getMeasureTextToolComputedStyle=function(t,e,r){if(!this.measureTextElement)return"";r=r||window.getComputedStyle(this.measureTextElement);var i=parseFloat(r[t]),o=parseFloat(r.fontSize),n=parseFloat(r.lineHeight);return"width"===t?o>parseFloat((this.fontSize/this.dpr).toFixed(4))&&o>=12||(i=12*i/o):"height"===t?i=n*(this.measureTextElement.textContent||"").split("\n").length*this.dpr:i*=this.dpr,i=Math.ceil(i),e?"".concat(i).concat(e):"".concat(i)},e.prototype.setBoardContainerSize=function(t,e,r,i){this.boardWidth=t,this.containerWidth=e,this.boardHeight=r,this.containerHeight=i},e.prototype._calcShowFullText=function(){if(!this.dom||!this.textContainer)return{scale:1,dragOffsetX:0,dragOffsetY:0};var t,e,r,i,o,n,a,s,l,c,h=this.textContainer.style.left,u=this.textContainer.style.top,d=this.dom.style.width,p=this.dom.style.height,f=(t=this.boardWidth,e=this.containerWidth,r=this.boardHeight,i=this.containerHeight,o=parseFloat(h),n=parseFloat(u),a=this.textItem.location.x,s=this.textItem.location.y,l=0,c=0,t<e?(l=t-a/1e4*t,c=r-s/1e4*r):(l=(t-e)/2+(50-o)*t/100+e-a/1e4*t,c=(r-i)/2+(50-n)*r/100+i-s/1e4*r),{distanceX:l,distanceY:c}),g=f.distanceX,m=f.distanceY,y=function(t,e,r,i,o,n,a,s){var l=0,c=0;return t<e?(l=a/1e4*t,c=s/1e4*r):(l=a/1e4*t-(t-e)/2-(50-o)*t/100,c=s/1e4*r-(r-i)/2-(50-n)*r/100),{distanceX:l,distanceY:c}}(this.boardWidth,this.containerWidth,this.boardHeight,this.containerHeight,parseFloat(h),parseFloat(u),this.textItem.location.x,this.textItem.location.y),v=y.distanceX,_=y.distanceY,E=parseFloat(d)*this.fontScale+12*this.fontScale,T=parseFloat(p)*this.fontScale+12*this.fontScale,b=0,S=0,x=0,w=0;return E>this.containerWidth?x=(E+12*this.fontScale)/this.containerWidth:b=v<0?(v-12*this.fontScale)/this.boardWidth*100:g<E?(E-g)/this.boardWidth*100:0,T>this.containerHeight?w=(T+12*this.fontScale)/this.containerHeight:S=_<0?(_-12*this.fontScale)/this.boardHeight*100:m<T?(T-m)/this.boardHeight*100:0,{scale:x>0&&w>0?Math.max(x,w):0==x&&0==w?0:Math.max(x,w),dragOffsetX:b,dragOffsetY:S}},e.prototype.isAllowShowInput=function(){var t=this.fontScale*this.fontSize;return!(this.maxHeight-2<=t||this.maxWidth-2<=2*t)},e}(X),Sc=function(t,e,r,i,o,n){void 0===r&&(r=M.RATIO),void 0===i&&(i=M.SCALE),void 0===o&&(o=M.TOP),void 0===n&&(n=M.LEFT);var a=xt(r,M.RATIO),s=a.ratioWidth,l=a.ratioHeight,c=t/s,h=e/l,u=Math.min(c,h);this.ratioWidth=s,this.ratioHeight=l,this.scale=i,this.top=o,this.left=n,this.ratio=r,this.width=u*s,this.height=u*l},xc=function(){function t(t,e){this.scrollEnable=!0,this.container=t,this.scrollEventCallback=e,this.horizontalScrollLeft=0,this.verticalScrollTop=0,this.initElement()}return t.prototype.scrollToScrollBar=function(t,e){this.horizontalScrollLeft=t,this.verticalScrollTop=e,this.horizontalScrollBarWrap.scrollTo(t,0),this.verticalScrollBarWrap.scrollTo(0,e)},t.prototype.setScrollBarSize=function(t,e,r,i){this.horizontalScrollBarWrap.style.width=Math.floor(r)+"px",this.verticalScrollBarWrap.style.height=Math.floor(i)+"px",this.horizontalScrollBar.style.width=Math.floor(t)+"px",this.verticalScrollBar.style.height=Math.floor(e)+"px"},t.prototype.initElement=function(){var t=this;this.verticalScrollBarWrap=document.createElement("div"),this.verticalScrollBarWrap.className="tiw-scroll-vertical__wrap",this.verticalScrollBar=document.createElement("div"),this.verticalScrollBar.className="tiw-scroll-vertical",this.verticalScrollBarWrap.appendChild(this.verticalScrollBar),this.horizontalScrollBarWrap=document.createElement("div"),this.horizontalScrollBarWrap.className="tiw-scroll-horizontal__wrap",this.horizontalScrollBar=document.createElement("div"),this.horizontalScrollBar.className="tiw-scroll-horizontal",this.horizontalScrollBarWrap.appendChild(this.horizontalScrollBar),this.container.appendChild(this.verticalScrollBarWrap),this.container.appendChild(this.horizontalScrollBarWrap),this.verticalScrollBarWrap.addEventListener("scroll",Qt((function(e){t.scrollEnable&&(Math.ceil(t.horizontalScrollLeft)===Math.ceil(t.horizontalScrollBarWrap.scrollLeft)&&Math.ceil(t.verticalScrollTop)===Math.ceil(t.verticalScrollBarWrap.scrollTop)||t.scrollEventCallback&&t.scrollEventCallback(t.horizontalScrollBarWrap.scrollLeft,t.verticalScrollBarWrap.scrollTop))}),200)),this.horizontalScrollBarWrap.addEventListener("scroll",Qt((function(e){t.scrollEnable&&(Math.ceil(t.horizontalScrollLeft)===Math.ceil(t.horizontalScrollBarWrap.scrollLeft)&&Math.ceil(t.verticalScrollTop)===Math.ceil(t.verticalScrollBarWrap.scrollTop)||t.scrollEventCallback&&t.scrollEventCallback(t.horizontalScrollBarWrap.scrollLeft,t.verticalScrollBarWrap.scrollTop))}),200))},t.prototype.disableScroll=function(){this.scrollEnable=!1,this.verticalScrollBarWrap.classList.add("disable-scroll"),this.horizontalScrollBarWrap.classList.add("disable-scroll")},t.prototype.enableScroll=function(){this.scrollEnable=!0,this.verticalScrollBarWrap.classList.remove("disable-scroll"),this.horizontalScrollBarWrap.classList.remove("disable-scroll")},t.prototype.enablePointerEvent=function(){this.verticalScrollBarWrap.classList.remove("pointer-none"),this.horizontalScrollBarWrap.classList.remove("pointer-none")},t.prototype.disablePointerEvent=function(){this.verticalScrollBarWrap.classList.add("pointer-none"),this.horizontalScrollBarWrap.classList.add("pointer-none")},t.prototype.showScrollBar=function(){this.verticalScrollBarWrap.classList.remove("hidden"),this.horizontalScrollBarWrap.classList.remove("hidden")},t.prototype.hideScrollBar=function(){this.verticalScrollBarWrap.classList.add("hidden"),this.horizontalScrollBarWrap.classList.add("hidden")},t}(),wc=function(){function t(t,e){this.initElement(t,e),this.prevTitleStyle=""}return t.prototype.initElement=function(t,e){this.cursorWrap=document.createElement("div"),this.cursorWrap.dataset.user=e.user,this.cursorWrap.className="tic-board_laser-item",this.imgEl=document.createElement("img"),this.imgEl.className="tic-board_laser-item-img",this.titleEl=document.createElement("span"),this.titleEl.className="tic-board_laser-item-title",this.cursorWrap.appendChild(this.titleEl),this.cursorWrap.appendChild(this.imgEl),t.appendChild(this.cursorWrap)},t.prototype.move=function(t){var e=t.systemCursorEnable,r=t.isOwner,i=t.titleStyle,o=void 0===i?{}:i,n=t.scale,a=void 0===n?1:n,s=t.color,l=void 0===s?"":s,c=t.type,h=t.eraserSize,u=t.offsetX,d=t.offsetY,p=t.cursorUrl,f=t.cursorTitle,g=void 0===f?"":f,m=t.translateX,y=void 0===m?-1e4:m,v=t.translateY,_=void 0===v?-1e4:v;if(this.cursorWrap){(p=p.replace("var(--brush-color)",l).replace(escape("var(--brush-color)"),l))!==this.imgEl.src&&(this.imgEl.src=p);var E=this.imgEl.classList.contains("tiw-hide"),T=h/a,b=2*T,S=c===Xa.TEDU_BOARD_TOOL_TYPE_ERASER?"; width: ".concat(b,"px; height: ").concat(b,"px"):"";if(S&&(this.imgEl.setAttribute("style",S),y=y+u-T,_=_+d-T),e&&r){if(E||this.imgEl.classList.add("tiw-hide"),!g)return}else E&&this.imgEl.classList.remove("tiw-hide");r&&!o.displaySelf&&(g=""),this.titleEl.textContent!==g&&(this.titleEl.textContent=g);var x="translate(".concat(y,"px, ").concat(_,"px) scale(").concat(a,")");if(this.cursorWrap.setAttribute("style","transform: ".concat(x,"; -webkit-transform: ").concat(x)),g&&o&&N(o)){var w=JSON.stringify(o);if(this.prevTitleStyle===w)return;this.prevTitleStyle=w;var O="",I=gt()?8:12;o.size*a<I?I/=a:I=o.size||I,O+="font-size:".concat(I,"px;");var A=o.color;O+="color:".concat(A,";");var D=o.style;D===Jn.TEDU_BOARD_TEXT_STYLE_NORMAL?(O+="font-style: normal;",O+="font-weight: normal;"):D===Jn.TEDU_BOARD_TEXT_STYLE_BOLD?(O+="font-style: normal;",O+="font-weight: bold;"):D===Jn.TEDU_BOARD_TEXT_STYLE_ITALIC?(O+="font-style: italic;",O+="font-weight: normal;"):D===Jn.TEDU_BOARD_TEXT_STYLE_BOLD_ITALIC&&(O+="font-style: italic;",O+="font-weight: bold;"),this.titleEl.setAttribute("style",O);var C=o.position,P=this.titleEl.clientWidth,L=this.titleEl.clientHeight;switch(C){case 0:O+="left:".concat(-P,"px;"),O+="top:".concat(-L,"px;");break;case 1:O+="right:".concat(-P,"px;"),O+="top:".concat(-L,"px;");break;case 2:O+="right:".concat(-P,"px;"),O+="bottom:".concat(-L,"px;");break;case 3:O+="left:".concat(-P,"px;"),O+="bottom:".concat(-L,"px;")}this.titleEl.setAttribute("style",O)}}},t.prototype.remove=function(){this.cursorWrap&&this.cursorWrap.remove()},t}(),Oc=function(){function t(t){this.domNode=t.domNode,this.style=t.style||{},this.attribute=t.attribute||{},this.ctx=this.domNode.getContext("2d")}return t.prototype.setAttribute=function(t,e){return void 0===e&&(e=""),void 0===this.attribute&&(this.attribute={}),this.attribute[t]=e,this},t.prototype.setStyle=function(t,e,r){return void 0===e&&(e=""),void 0===r&&(r=!1),this.style[t]={value:e,priority:r},this},t.prototype.render=function(){var t=this.attribute;for(var e in t)""===t[e]&&this.domNode.removeAttribute(e),this.domNode.setAttribute(e,t[e]);this.attribute={};var r=this.style;for(var e in r)this.domNode.style.setProperty(e,r[e].value,r[e].priority?"important":"");this.style={}},t.prototype.remove=function(){},t.prototype.removeGraffiti=function(){},t.prototype.getCanvasContext=function(){return this.ctx},t}(),Ic={TEDU_BOARD_TEXT_COMPONENT_STATUS_INSUFFICIENT_SPACE:1,TEDU_BOARD_TEXT_COMPONENT_STATUS_WORD_LIMIT:2,TEDU_BOARD_TEXT_COMPONENT_CANNOT_USE_EMOJI:3},Ac=function(){function t(){this._data=new Map}return t.prototype.getDataByTouchId=function(t){t+="";var e=this._data.get(t);return e||(e={isTouchType:"mouse",onoff:!1,startx:-10,starty:-10,oldx:-10,oldy:-10,cpx:-10,cpy:-10,preRaserTimestamp:Wt.getTimeStamp(),raserCount:0,ignoreRaserCount:0,inCanvas:!1,isTouchUp:!0,autoFitTimer:0,drawLineTimer:0,preSpeed:0,preWidth:0,pointCount:0,ignorePointCount:0,hasOptimizeStart:!1,hasOptimizeEnd:!0,preLineTimestamp:0,preLinePoint:{},referenceMathTool:{}},this._data.set(t,e)),e},t.prototype.setDataByTouchId=function(){},t}(),Dc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Cc=function(t){function e(e,r){var i=t.call(this,e)||this;return i.store=r,i}return Dc(e,t),e}(X),Pc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Lc=function(t){function e(e,r){return t.call(this,e,r)||this}return Pc(e,t),e.prototype.start=function(t,e,r,i,o,n){void 0===i&&(i=!1),void 0===o&&(o=!1);var a=this.seqUtil.getSeq(),s=Wt.getTimeStamp(),l=this.teduToolType.isHighLighterToolType()?this.store.highlighterColor:this.store.color,c=n||this.store.getThin(),h=this.store.getLineTransparent(),u=this.store.getCurrentBoard(),d=fs.createElement(this.instanceKey,this.identifier,{action:M.PROTOCOL_ACTION.LINE_START_ACTION,color:l,thin:c,x:e,y:r,w:c,writing:i,show:!0,visible:!0,lineTransparent:h,seq:a,belongSeq:a,time:s,timestamp:s,boardId:u,originBelongSeq:a,originSeq:a,highlighter:o,lockElement:!1},"v2");if(d.drawIndex=1,d.setBorder(e,r),d.setBoardSize(this.store.boardWidth,this.store.boardHeight),h&&(this.store.collectErasePointForLocal={x:e,y:r}),this.store.stashTempElementData.set(t,d),this.store.saveDrawingButNotReportData(u,d),this.store.renderHandler.addToRenderMap(d.ID,new ms(d)),this.store.seqLineMap[a]=d,this.store.tiwData.addElement(u,this.identifier,d),this.store.tiwData.insertOperation(u,new gn(this.identifier,{seq:d.seq,type:rc.LINE})),this.store.lineFitMode===xs.NONE||this.store.enableLineAutoFit){var p={action:M.PROTOCOL_ACTION.LINE_START_ACTION,color:Y(d.color),scale:100,thin:d.thin,time:s,timestamp:s,seq:d.seq,belongSeq:d.belongSeq,x:e,y:r,lineTransparent:h,w:d.thin,writing:i?1:0,boardId:d.boardId,highlighter:d.highlighter,title:this.store.toolTypePenTitleStyle.title,style:this.store.toolTypePenTitleStyle.style,touchId:t,version:d.version};this.store.addRealtimeData(p)}},e.prototype.moving=function(t,e,r,i){var o,n,a=this.store.stashTempElementData.get(t),s=this.store.getLineTransparent();if(s){var l=[],c=this.store.piecewiseErasureSize/this.store.boardWidth*1e4,h={x:e,y:r},u=this.store.insertEraserPoint([this.store.collectErasePointForLocal,h],this.store.piecewiseErasureSize);2===u.length&&u[0].x===u[1].x&&u[0].y===u[1].y&&(u.length=1);try{for(var d=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(u),p=d.next();!p.done;p=d.next()){var f=p.value;l=l.concat(this.store.eraserImpactCheck(!0,f.x,f.y,c))}}catch(t){o={error:t}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(o)throw o.error}}l=l.filter((function(t,e,r){return r.findIndex((function(e){return e.seq===t.seq}))===e})),this.store.collectErasePointForLocal=h,l.length>0&&this.store.reportEraserData(this.store.getCurrentBoard(),l,Bo.DELETE,!0,Xa.TEDU_BOARD_TOOL_TYPE_ERASER)}if(!a){var g=this.teduToolType.isPenToolType()&&this.store.isHandwritingEnable(),m=this.teduToolType.isHighLighterToolType();this.start(t,e,r,g,m),a=this.store.stashTempElementData.get(t)}a.setBorder(e,r);var y=this.seqUtil.getSeq(),v=Wt.getTimeStamp(),_=this.store.getCurrentBoard(),E=null,T=a.getPoints();if(T.length>=2){var b=T[T.length-1],S=(b.x+e)/2,x=(b.y+r)/2,w=i;E={action:M.PROTOCOL_ACTION.LINE_MOVE_ACTION,x:S,y:x,w:w,lineTransparent:s,seq:y,originSeq:y,timestamp:v,middle:!0},a.addPoint(E)}y=this.seqUtil.getSeq(),v=Wt.getTimeStamp();var O={action:M.PROTOCOL_ACTION.LINE_MOVE_ACTION,x:e,y:r,w:i,lineTransparent:s,seq:y,timestamp:v,originSeq:y};if(a.addPoint(O),a.drawIndex=a.getPoints().length,this.store.saveDrawingButNotReportData(_,a),this.store.lineFitMode===xs.NONE||this.store.enableLineAutoFit){var I={action:M.PROTOCOL_ACTION.LINE_MOVE_ACTION,seq:y,belongSeq:a.belongSeq,x:e,y:r,w:i,lineTransparent:s,timestamp:v,boardId:a.boardId,midPoint:E,version:a.version,highlighter:a.highlighter,touchId:t};this.store.addRealtimeData(I)}},e.prototype.end=function(t,e,r,i,o,n){void 0===o&&(o=!1),void 0===n&&(n=!1);var a=this.store.stashTempElementData.get(t),s=this.store.getLineTransparent();if(!a){var l=this.teduToolType.isPenToolType()&&this.store.isHandwritingEnable(),c=this.teduToolType.isHighLighterToolType();this.start(t,e,r,l,c),a=this.store.stashTempElementData.get(t)}var h=this.store.getCurrentBoard();if("line"===a.type){a.setBorder(e,r);var u=this.seqUtil.getSeq(),d=Wt.getTimeStamp(),p={action:M.PROTOCOL_ACTION.LINE_END_ACTION,x:e,y:r,w:M.MIN_LINE_WIDTH||i||this.store.getThin(),lineTransparent:s,seq:u,timestamp:d,originSeq:u,version:a.version};if(a.addPoint(p),a.endSeq=u,a.drawIndex=a.getPoints().length,this.store.lineFitMode===xs.NONE||this.store.enableLineAutoFit&&!n){var f={action:M.PROTOCOL_ACTION.LINE_END_ACTION,belongSeq:a.belongSeq,seq:u,x:e,y:r,w:M.MIN_LINE_WIDTH||i||this.store.getThin(),timestamp:d,boardId:a.boardId,highlighter:a.highlighter,touchId:t};this.store.addRealtimeData(f),this.store.report.reportAddLine(a.getReportDataForHistory(!0))}else{var g=Is.createElement(this.instanceKey,this.identifier,{belongSeq:this.seqUtil.getSeq(),boardId:h,show:!0,visible:!0,color:a.color,thin:a.thin,lockElement:!1});g.setBoardSize(this.store.boardWidth,this.store.boardHeight),g.genFitCurve(a.getPoints(),this.store.lineFitMode);var m={action:M.PROTOCOL_ACTION.ERASER_ACTION,display:0,visible:1,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),x:0,y:0,lines:[{seq:a.belongSeq,uid:this.identifier}]};this.store.renderHandler.removerFromRenderMap(a.ID),delete this.store.seqLineMap[a.belongSeq],this.store.addRealtimeData(m),this.store.renderHandler.addToRenderMap(g.ID,new Ds(g)),this.store.tiwData.removeElement(a.belongSeq),this.store.tiwData.undoOperation(h),this.store.tiwData.addElement(h,this.identifier,g),this.store.tiwData.insertOperation(h,new gn(this.identifier,{seq:g.belongSeq,type:rc.ELEMENT})),this.store.setNeedDraw(!0),this.store.addRealtimeData(g.getRealTimeData()),this.store.report.reportElement(g.getReportData())}this.store.deleteDrawingButNotReportData(h)}else this.store.deleteDrawingButNotReportData(h)},e.prototype.leave=function(t,e,r,i){this.end(t,e,r,i)},e}(Cc),Mc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Rc=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.reportHistoryThrottle=$t((function(t){r.report.reportAddText(t)}),500,!0),i}return Mc(e,t),e.prototype.start=function(t,e){var r=this,i=this.seqUtil.getSeq(),o=null,n=!1,a=this.store.getCurrentBoard();try{var s=this.store.tiwData.getElementsByBoardId(a),l={seq:0,index:-1};if(s.forEach((function(i,o){if("inputtext"===i.type&&i.show&&i.user===r.identifier){var n=5/r.store.boardWidth*1e4,a=5/r.store.boardHeight*1e4,s=i.location.x-n,c=i.location.y-a,h=i.location.x+i.textWidth+n,u=i.location.y+i.textHeight+a;t>=s&&t<=h&&e>=c&&e<=u&&i.belongSeq>l.seq&&(l={seq:i.belongSeq,index:o})}})),l.index>-1){var c=this.store.tiwData.removeElement(l.seq);c.show=!0,o=c}}catch(t){}return o||(n=!0,(o=new Wa(this.instanceKey,{belongSeq:i,user:this.identifier,boardId:a,x:t,y:e,show:!0,visible:!0,lockElement:!1})).text=this.store.nextInputObj.text,o.color=this.store.getTextColor(),o.textSize=this.store.getTextSize(),o.typeFace=this.store.getTextFontFamily(),o.fontStyle=this.store.getTextFontStyle(),o.lineHeight=this.store.getTextLineHeight()),this.store.tiwData.addElement(a,this.identifier,o),this.store.tiwData.isOperationExistTextElement(a,o.belongSeq)||(this.store.tiwData.insertOperation(a,new gn(this.identifier,{seq:o.belongSeq,type:rc.TEXT})),this.store.fireCanRedoAndUndo()),clearInterval(this.store.textInputTask),this.store.textInputTask=0,this.store.lastInputActionData=null,{inputText:o,isNewItem:n}},e.prototype.inputting=function(t,e,r,i,o){var n=this,a=this.seqUtil.getSeq(),s=t.boardId||this.store.getCurrentBoard();if(e){e.text=r,e.seq=a,e.textWidth=i/this.store.boardWidth*1e4,e.textHeight=o/this.store.boardHeight*1e4,e.setBorder();var l={action:M.PROTOCOL_ACTION.INPUT_TEXT_ACTION,seq:a,belongSeq:e.belongSeq,color:Y(e.color),scale:100,typeFace:e.typeFace,textSize:Math.floor(e.textSize),fontStyle:e.fontStyle,time:Wt.getTimeStamp(),x:e.location.x,y:e.location.y,text:encodeURI(escape(r)),textWidth:e.textWidth,textHeight:e.textHeight,lineHeight:e.lineHeight};this.store.realTimeData=this.store.realTimeData.filter((function(t){return t.action!==M.PROTOCOL_ACTION.INPUT_TEXT_ACTION||t.belongSeq!==e.belongSeq})),this.store.addRealtimeData(l),this.reportHistoryThrottle(e.getReportDataForHistory(!0)),this.store.lastInputActionData=l,function(t){n.store.textInputTask||(n.store.textInputTask=window.setInterval((function(){if(t!=n.store.getCurrentBoard())return clearInterval(n.store.textInputTask),void(n.store.textInputTask=0);var e=n.store.lastInputActionData;if(!e)return clearInterval(n.store.textInputTask),void(n.store.textInputTask=0);n.store.realTimeData=n.store.realTimeData.filter((function(t){return t.action!==M.PROTOCOL_ACTION.INPUT_TEXT_ACTION||t.belongSeq!==e.belongSeq})),e.seq=n.seqUtil.getSeq(),n.store.addRealtimeData(e)}),3e3))}(s)}},e.prototype.draw=function(t,e,r,i,o,n){void 0===n&&(n=!1);var a=this.store;clearInterval(a.textInputTask),a.textInputTask=0,a.lastInputActionData=null;var s=t.boardId||a.getCurrentBoard();if(!n&&!r&&!r.trim()){var l=a.tiwData;return l.removeOperation(s,e.belongSeq),l.removeElement(e.belongSeq),void a.fireCanRedoAndUndo()}if(e){var c=this.seqUtil.getSeq();e.seq=c,e.text=r,e.show=!0,e.textWidth=i/a.boardWidth*1e4,e.textHeight=o/a.boardHeight*1e4,e.setBorder(),a.report.reportAddText(e.getReportDataForHistory(!0));var h={action:M.PROTOCOL_ACTION.INPUT_TEXT_ACTION,seq:e.seq,belongSeq:e.belongSeq,color:Y(e.color),scale:100,typeFace:e.typeFace,textSize:Math.floor(e.textSize),fontStyle:e.fontStyle,time:Wt.getTimeStamp(),x:e.location.x,y:e.location.y,text:encodeURI(escape(r)),textWidth:e.textWidth,textHeight:e.textHeight,lineHeight:e.lineHeight};a.sendRequest(s,[h]),a.setNeedDraw(!0)}},e.prototype.clearTask=function(t){var e=t.boardId||this.store.getCurrentBoard(),r=t.textItem.belongSeq;this.store.tiwData.removeOperation(e,r),clearInterval(this.store.textInputTask),this.store.textInputTask=0,this.store.lastInputActionData=null},e}(Cc),Nc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Bc=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},kc=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},Fc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Nc(e,t),e.prototype._eraser=function(t,e,r,i){var o,n;void 0===i&&(i=!1);var a=this.store;i&&(a.eraseLayerCount=0);var s=[],l=a.piecewiseErasureSize,c=l/a.boardWidth*1e4;if(0===a.eraserMode){var h={x:e,y:r},u=a.insertEraserPoint([a.collectErasePointForLocal,h],l);2===u.length&&u[0].x===u[1].x&&u[0].y===u[1].y&&(u.length=1);try{for(var d=Bc(u),p=d.next();!p.done;p=d.next()){var f=p.value;s=s.concat(a.eraserImpactCheck(t,f.x,f.y,c))}}catch(t){o={error:t}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(o)throw o.error}}s=s.filter((function(t,e,r){return r.findIndex((function(e){return e.seq===t.seq}))===e})),a.collectErasePointForLocal=h}else s=a.eraserImpactCheck(t,e,r,c);return s},e.prototype._collectEraserTrackData=function(t,e,r){var i=this,o=this.store,n=o.tiwData.getElementsByBoardId(o.getCurrentBoard()),a=o.piecewiseErasureSize,s=a/o.boardWidth*1e4;if(n&&n.length){var l=o.collectUserClipPoint;l.push({x:e,y:r});var c={},h=!1;n.forEach((function(t){if(t.isLocked())i.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENT_IS_LOCKED,t.getElementId());else if(!t.lineTransparent&&t.show&&"line"===t.type&&t.getPoints()[t.getPoints().length-1].action===M.PROTOCOL_ACTION.LINE_END_ACTION&&"v2"===t.version){var e=i.permissionHandler.filter("Element::Delete::*",[{creator:t.user}]);c["".concat(t.belongSeq)]=e,e||(h=!0)}})),l.length>=5&&(o.addRealtimeData({action:M.PROTOCOL_ACTION.POINT_ERASER_ACTION,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),boardId:o.getCurrentBoard(),type:2,radius:s,points:l,permissionMap:h?c:void 0}),o.collectUserClipPoint=[l[l.length-1]]);var u=o.collectClipPointForLocal;if(u.push({x:e,y:r}),clearTimeout(o.piecewiseTask),!(t||u.length>=5))return void(o.piecewiseTask=window.setTimeout((function(){o.piecewiseErasure(o.insertEraserPoint(u,a),a,c),o.collectClipPointForLocal=[u[u.length-1]],o.setNeedDraw(!0),o.addRealtimeData({action:M.PROTOCOL_ACTION.POINT_ERASER_ACTION,time:Wt.getTimeStamp(),seq:i.seqUtil.getSeq(),boardId:o.getCurrentBoard(),type:2,radius:s,points:l,permissionMap:h?c:void 0}),o.collectUserClipPoint=[l[l.length-1]]}),1e3));o.piecewiseErasure(o.insertEraserPoint(u,a),a,c),o.collectClipPointForLocal=[u[u.length-1]],o.setNeedDraw(!0)}},e.prototype.start=function(t,e,r){void 0===r&&(r=!1);var i=this.store;if(0===i.eraserMode){i.collectErasePointForLocal={x:t,y:e};var o=this._eraser(!0,t,e,r);i.reportEraserData(i.getCurrentBoard(),o,Bo.DELETE,!0,Xa.TEDU_BOARD_TOOL_TYPE_ERASER)}else i.collectUserClipPoint=[{x:t,y:e}],i.collectClipPointForLocal=[{x:t,y:e}]},e.prototype.move=function(t,e,r){void 0===r&&(r=!1);var i=this.store;if(0===i.eraserMode){var o=this._eraser(!1,t,e,r);i.reportEraserData(i.getCurrentBoard(),o,Bo.DELETE,!0,Xa.TEDU_BOARD_TOOL_TYPE_ERASER)}else{if((o=this._eraser(!1,t,e,r)).length){var n=i.splitLineData.get("0");n||(n=[]);var a={points:[],lineModel:{show:!1,belongSeq:0},hideLines:o};n=n.concat(a),i.splitLineData.set("0",n)}this._collectEraserTrackData(!1,t,e)}},e.prototype.end=function(t,e){var r,i,o=this,n=this.store;if(1===n.eraserMode){this._collectEraserTrackData(!0,t,e),n.collectUserClipPoint=[];var a=[],s=[],l={},c=[],h=[],u=function(t,e){var r=[],i=null;if("0"!==t){if(!(i=n.findLineByBelongSeq(n.getCurrentBoard(),t)))return n.splitLineData.delete(t),"continue";c.push({uid:i.user,seq:i.belongSeq})}if(e.forEach((function(e){var i=e.points,n=e.lineModel,a=e.hideLines;if(s=s.concat(a),"0"!==t)if(n.show){h.push({uid:o.identifier,seq:n.belongSeq});var c={belongSeq:n.belongSeq,originPoint:{headPointSeq:0,tailPointSeq:0},fittingPoint:{headPoint:{},headCtrlPoint:{},tailCtrlPoint:{},tailPoint:{}}};i.forEach((function(t,e){if(t.isOrigin&&t.originSeq){var r=c.originPoint;r.headPointSeq||(r.headPointSeq=t.originSeq),r.tailPointSeq=t.originSeq}else{var o=c.fittingPoint;0===e?(o.headPoint=t,o.headCtrlPoint=i[e+1]||{}):e===i.length-1&&(2===e&&o.headCtrlPoint.timestamp||(o.tailCtrlPoint=i[e-1]||{}),o.tailPoint=t)}var a=n.getPoints();a[e].originSeq=a[e].seq})),r.push(c),s=s.concat(a),n.originBelongSeq=n.belongSeq}else l[n.belongSeq]=!0})),i&&r.length){var u=lt(JSON.stringify(r));a.push({boardId:n.getCurrentBoard(),uid:i.user,seq:Number(t),baseX:i.x,baseY:i.y,ratioX:n.boardWidth,ratioY:n.boardHeight,rectWidth:i.width,rectHeight:i.height,compressLines:u})}n.splitLineData.delete(t)};try{for(var d=Bc(n.splitLineData),p=d.next();!p.done;p=d.next()){var f=kc(p.value,2);u(f[0],f[1])}}catch(t){r={error:t}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}var g=n.tiwData;if(g.removeElementsByFilter(n.getCurrentBoard(),this.identifier,(function(t){return!l[t]})),a.length){n.addRealtimeData({action:M.PROTOCOL_ACTION.SPLIT_LINE_ACTION,time:Wt.getTimeStamp(),seq:this.seqUtil.getSeq(),data:a});var m=[];a.forEach((function(t){m.push({type:"splitLine",content:t})})),n.report.reportSplitLine(m)}s.length&&(c=c.concat(s),n.reportEraserData(n.getCurrentBoard(),s,Bo.DELETE,!1,Xa.TEDU_BOARD_TOOL_TYPE_ERASER)),n.setNeedDraw(!0),(c.length||h.length)&&(g.insertOperation(n.getCurrentBoard(),new gn(this.identifier,{seq:{origin:c,final:h},type:rc.PIECEWISE_ERASER})),n.fireCanRedoAndUndo())}},e}(Cc),Uc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Hc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Uc(e,t),e.prototype.end=function(t,e,r){void 0===r&&(r="mouse");var i=this.store;i.beforeMoveType="pointselect";var o=!1,n="",a="finger"!==r?i.getThin()/2:i.getThin(),s=i.getCurrentBoard(),l=i.tiwData.getElementsByBoardId(s);if(s!==M.COMMON_DEFAULT_BOARD){var c=i.filterWatermarkElement();l.unshift.apply(l,function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))}([],function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}(c),!1))}else l.sort((function(t){return[Ta.TEDU_BOARD_ELEMENT_WATERMARK].includes(t.subType)?-1:0}));for(var h=l.length-1;h>=0;h--){var u=l[h];if(this.permissionHandler.filter("Element::Select::*",[{creator:u.user}],!1)&&!u.lineTransparent)if("line"===u.type&&u.show){if(u.impactCheck(t,e,2*a)){n=u.user,o=!0,u.select=!0,i.selectedList=[u];break}}else if("graph"===u.type&&u.show){if(i.renderHandler.getRender(u.ID).impactCheck(t,e,a,i.boardWidth,i.boardHeight)){n=u.user,o=!0,u.select=!0,i.selectedList=[u];break}}else if("inputtext"===u.type&&u.show&&u.text){if(u.impactCheck(t,e,a)){n=u.user,o=!0,u.select=!0,i.selectedList=[u];break}}else if("imageElement"===u.type&&u.show){if(u.pointImpactCheck([t,e])){n=u.user,o=!0,i.selectedList=[u];break}}else if("element"===u.type&&u.show)if(u.subType===Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ARC){if(i.renderHandler.getRender(u.ID).impactCheck(t,e,a,i.boardWidth,i.boardHeight)){n=u.user,o=!0,u.select=!0,i.selectedList=[u];break}}else if(u.pointImpactCheck([t,e])){n=u.user,o=!0,i.selectedList=[u];break}}if(o){var d=i.toolTypeTitleStyleMap[Xa.TEDU_BOARD_TOOL_TYPE_RECT_SELECT];d&&(d.operatorId=n,d.title=i.getUserInfo(n,"nickname")),i.setNeedDraw(!0),i.fireElementPosition(i.selectedList,!1,-1)}},e}(Cc),Gc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),qc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gc(e,t),e.prototype.start=function(t,e){var r=this.store;r.beforeMoveType="select",r.selectModel.startInfo={x:t,y:e},r.selectModel.location={x:t,y:e},r.selectModel.user=this.identifier},e.prototype.draw=function(t,e){var r=this.store;r.selectModel.show=!0,r.selectModel.location={x:t,y:e},r.setNeedDraw(!0)},e.prototype.end=function(t,e,r,i){var o=t>r?t:r,n=e>i?e:i,a=t+r-o,s=e+i-n,l="",c=this.store,h=c.getCurrentBoard(),u=c.tiwData.getElementsByBoardId(h);if(h!==M.COMMON_DEFAULT_BOARD){var d=c.filterWatermarkElement();u.unshift.apply(u,function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))}([],function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}(d),!1))}else u.sort((function(t){return[Ta.TEDU_BOARD_ELEMENT_WATERMARK].includes(t.subType)?-1:0}));for(var p=c.selectedList,f=u.length-1;f>=0;f--){var g=u[f],m=this.permissionHandler.filter("Element::Select::*",[{creator:g.user}],!1);if(!g.lineTransparent&&m&&g.show){if("inputtext"===g.type&&!g.text)continue;var y=g.rectArea;y&&o>=y.maxX&&n>=y.maxY&&a<=y.minX&&s<=y.minY&&(l=g.user,g.select=!0,p.push(g))}}if(p.length>0){var v=c.toolTypeTitleStyleMap[Xa.TEDU_BOARD_TOOL_TYPE_RECT_SELECT];v&&(v.operatorId=1===p.length?l:"",v.title=1===p.length?c.getUserInfo(l,"nickname"):"")}c.selectModel.show=!1,c.setNeedDraw(!0),p.length&&c.fireElementPosition(p,!1,-1)},e}(Cc),Wc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Yc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Wc(e,t),e.prototype.beforeStart=function(t,e){var r=this.store;if(0===r.selectedList.length)return!1;if(!this.permissionHandler.filter("Element::Move::*",[{operator:this.identifier}],!1))return r.cancelSelect(),!1;var i=!1,o=r.selectArea;return t>o.x&&t<o.x+o.width&&e>o.y&&e<o.y+o.height&&(i=!0),!!i||(r.cancelSelect(),!1)},e.prototype.start=function(t,e){},e.prototype.draw=function(t,e,r,i){this.store.selectModel.succeedSelect=!0},e.prototype.end=function(){this.store.setNeedDraw(!0)},e}(Cc),zc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),jc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zc(e,t),e.prototype.start=function(t,e,r,i,o){void 0===i&&(i=this.teduToolType.toolType);var n=this.teduToolType.getTextTypeByGraphToolType(i),a=this.store,s=a.getCurrentBoard(),l=Object.assign({},a.lineStyle);-1===o?this.teduToolType.isGraphSolid()&&(l.fillType=Qa.SOLID):1!==o&&2!==o||(l={lineType:1===o?mn.TEDU_BOARD_LINE_TYPE_SOLID:mn.TEDU_BOARD_LINE_TYPE_DOTTED,startArrowType:At.TEDU_BOARD_ARROW_TYPE_NONE,endArrowType:At.TEDU_BOARD_ARROW_TYPE_NONE,fillType:Qa.NONE});var c=ss.createElement(this.instanceKey,this.identifier,{graph:n,color:a.getColor(),thin:a.getThin(),beginPoint:{x:e,y:r,seq:this.seqUtil.getSeq()},endPoint:{x:e,y:r,seq:this.seqUtil.getSeq()},show:!0,visible:!0,boardId:s,style:l,lockElement:!1,erasable:!0,solid:!1});c.setBoardSize(a.boardWidth,a.boardHeight);var h=qn.createElement(c);a.renderHandler.addToRenderMap(c.ID,h),"circle"!==c.graph&&"oval"!==c.graph||a.ovalDrawMode!==Qn.TEDU_BOARD_OVAL_DRAW_MODE_FIX_CENTER||(a.ovalCenterPoint[t]=Object.assign({},c.startPoint)),a.seq=c.seq,a.stashTempElementData.set(t,c);var u=a.tiwData;u.addElement(s,this.identifier,c),u.insertOperation(s,new gn(this.identifier,{seq:c.startPoint.seq,type:rc.GRAPH})),a.graphStartPoint[t]={x:e,y:r},a.graphEndPoint[t]={x:e,y:r},a.needGraphSync[t]=!0},e.prototype.moving=function(t,e,r){var i={line:M.PROTOCOL_ACTION.GRAPH_LINE_ACTION,oval:M.PROTOCOL_ACTION.GRAPH_CIRCLE_ACTION,circle:M.PROTOCOL_ACTION.GRAPH_CIRCLE_ACTION,rect:M.PROTOCOL_ACTION.GRAPH_RECT_ACTION,square:M.PROTOCOL_ACTION.GRAPH_RECT_ACTION,"right-triangle":M.PROTOCOL_ACTION.GRAPH_RIGHT_TRIANGLE_ACTION,"isosceles-triangle":M.PROTOCOL_ACTION.GRAPH_ISOSCELES_TRIANGLE_ACTION,parallelogram:M.PROTOCOL_ACTION.GRAPH_PARALLELOPGRAM_ACTION,cube:M.PROTOCOL_ACTION.GRAPH_CUBE_ACTION,cylinder:M.PROTOCOL_ACTION.GRAPH_CYLINDER_ACTION,cone:M.PROTOCOL_ACTION.GRAPH_CONE_ACTION,coordinate:M.PROTOCOL_ACTION.GRAPH_COORDINATE_ACTION},o=function(t,e){t.x=e.x,t.y=e.y},n=this.store,a=n.stashTempElementData.get(t);n.graphEndPoint[t]={x:e,y:r},n.isDrawing=!0,"circle"!==a.graph&&"oval"!==a.graph||n.ovalDrawMode!==Qn.TEDU_BOARD_OVAL_DRAW_MODE_FIX_CENTER||(n.graphStartPoint[t].x=2*n.ovalCenterPoint[t].x-e,n.graphStartPoint[t].y=2*n.ovalCenterPoint[t].y-r);var s=n.graphEndPoint[t];if(o(a.startPoint,n.graphStartPoint[t]),o(a.endPoint,n.graphEndPoint[t]),["square","circle"].includes(a.graph)?("square"===a.graph&&n.squareFix(a),"circle"===a.graph&&n.circleFix(t,a),o(s,a.endPoint),n.graphFix(a)):"line"===a.graph||n.graphFix(a),n.needGraphSync[t]){n.needGraphSync[t]=!1;var l=this.seqUtil.getSeq(),c=Wt.getTimeStamp(),h=n.toolTypeTitleStyleMap[this.teduToolType.toolType]||{style:{},title:""};n.graphSyncTimer[t]=requestAnimationFrame((function(){n.needGraphSync[t]=!0;var e={touchId:t,action:i[a.graph],seq:l,time:c,color:Y(n.getColor()),scale:100,thin:n.getThin(),beginPoint:{x:a.startPoint.x,y:a.startPoint.y,seq:a.startPoint.seq},endPoint:{x:a.endPoint.x,y:a.endPoint.y,seq:a.endPoint.seq},toolStyle:h.style,toolTitle:h.title,style:{},fillRect:0,subAction:{},syncPosition:{}};n.styleSynced[t]||(e.style=a.style);var r=1*a.solid;11===e.action&&(e.fillRect=r),12===e.action&&(e.fillRect=r),e.subAction=e.action,e.action=M.PROTOCOL_ACTION.REALTIME_SYNC_GRAPH_ACTION,e.syncPosition=s,n.addRealtimeData(e)}))}return n.setNeedDraw(!0),a},e.prototype.end=function(t,e,r){var i={line:M.PROTOCOL_ACTION.GRAPH_LINE_ACTION,oval:M.PROTOCOL_ACTION.GRAPH_CIRCLE_ACTION,circle:M.PROTOCOL_ACTION.GRAPH_CIRCLE_ACTION,rect:M.PROTOCOL_ACTION.GRAPH_RECT_ACTION,square:M.PROTOCOL_ACTION.GRAPH_RECT_ACTION,"right-triangle":M.PROTOCOL_ACTION.GRAPH_RIGHT_TRIANGLE_ACTION,"isosceles-triangle":M.PROTOCOL_ACTION.GRAPH_ISOSCELES_TRIANGLE_ACTION,parallelogram:M.PROTOCOL_ACTION.GRAPH_PARALLELOPGRAM_ACTION,cube:M.PROTOCOL_ACTION.GRAPH_CUBE_ACTION,cylinder:M.PROTOCOL_ACTION.GRAPH_CYLINDER_ACTION,cone:M.PROTOCOL_ACTION.GRAPH_CONE_ACTION,coordinate:M.PROTOCOL_ACTION.GRAPH_COORDINATE_ACTION},o=function(t,e){t.x=e.x,t.y=e.y},n=this.store;cancelAnimationFrame(n.graphSyncTimer[t]),n.needGraphSync[t]=!1,n.isDrawing=!1;var a=n.stashTempElementData.get(t);if(n.graphEndPoint[t]={x:e,y:r},"line"!==a.graph&&Lt(n.graphStartPoint[t].x,n.graphStartPoint[t].y,n.graphEndPoint[t].x,n.graphEndPoint[t].y)<1){n.graphStartPoint[t].x-=80/n.boardWidth*1e4,n.graphStartPoint[t].y-=80/n.boardHeight*1e4,n.graphEndPoint[t].x+=80/n.boardWidth*1e4,n.graphEndPoint[t].y+=80/n.boardHeight*1e4;var s=0,l=0;n.graphStartPoint[t].x<0&&(s=-n.graphStartPoint[t].x+n.getThin()),n.graphStartPoint[t].y<0&&(l=-n.graphStartPoint[t].y+n.getThin()),n.graphEndPoint[t].x>1e4&&(s=1e4-n.graphEndPoint[t].x-n.getThin()),n.graphEndPoint[t].y>1e4&&(l=1e4-n.graphEndPoint[t].y-n.getThin()),s&&(n.graphStartPoint[t].x+=s,n.graphEndPoint[t].x+=s),l&&(n.graphStartPoint[t].y+=l,n.graphEndPoint[t].y+=l)}o(a.startPoint,n.graphStartPoint[t]),o(a.endPoint,n.graphEndPoint[t]),["square","circle"].includes(a.graph)?("square"===a.graph&&(n.squareFix(a),a.graph="rect"),"circle"===a.graph&&(n.circleFix(t,a),a.graph="oval"),n.graphFix(a)):"line"===a.graph||n.graphFix(a),a.setBorder(),n.setNeedDraw(!0),n.beforeToolType!=n.initTypeConstant&&(n.setType(n.beforeToolType),n.beforeToolType=n.initTypeConstant);var c={touchId:t,action:i[a.graph],seq:this.seqUtil.getSeq(),time:Wt.getTimeStamp(),color:Y(n.getColor()),scale:100,thin:n.getThin(),beginPoint:{x:a.startPoint.x,y:a.startPoint.y,seq:a.startPoint.seq},endPoint:{x:a.endPoint.x,y:a.endPoint.y,seq:a.endPoint.seq},style:{},fillRect:0};n.styleSynced[t]||(c.style=a.style);var h=1*a.solid;11===c.action&&(c.fillRect=h),12===c.action&&(c.fillRect=h),n.addRealtimeData(c),n.report.reportGraphData(a.getReportDataForHistory(!0));var u=n.tiwData.getElementsByUserId(n.getCurrentBoard(),this.identifier),d=u[u.length-1];return this.event.fireAddElementEvent({id:String(d.belongSeq),type:Ta.TEDU_BOARD_ELEMENT_GEOMETRY,userData:""}),a},e.prototype.leave=function(t,e,r){return this.end(t,e,r)},e}(Cc),Vc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Xc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Vc(e,t),e.prototype.start=function(t){},e.prototype.draw=function(t,e,r){var i=t.getElementsByClassName("tx_board_canvas_box")[0],o=this.store,n=e/o.boardWidth*100,a=r/o.boardHeight*100,s=o.computeMoveRange(o.boardWidth,o.boardHeight,o.containerWidth,o.containerHeight),l=s.maxLeft,c=s.minLeft,h=s.maxTop,u=s.minTop,d=+i.style.left.replace("%","")+n;d=Math.min(l,Math.max(c,d)),i.style.left=d+"%";var p=+i.style.top.replace("%","")+a;p=Math.min(h,Math.max(u,p)),i.style.top=p+"%";var f=i.getAttribute("style")||"";-1===f.indexOf("-webkit-transform")&&(f+="-webkit-transform: translateX(-50%) translateY(-50%);"),i.setAttribute("style",f),d=+d.toFixed(1),p=+p.toFixed(1),o.setBoardOffset(d,p),this.event._fireBoardScrollEvent({trigger:"interaction"})},e.prototype.scrollEventDraw=function(t,e,r){var i=this;t.style.left=e+"%",t.style.top=r+"%";var o=t.getAttribute("style")||"";-1===o.indexOf("-webkit-transform")&&(o+="-webkit-transform: translateX(-50%) translateY(-50%);"),t.setAttribute("style",o);var n=!0,a=this.store.getCurrentBoard(),s=this.store.dragDataList.getDragData(a);s?s.xOffset===e&&s.yOffset===r?n=!1:this.store.dragDataList.updateDragData(a,{xOffset:e,yOffset:r}):this.store.dragDataList.addDragData(a,new Kn(this.seqUtil,{scale:this.store.getBoardScale(),xOffset:e,yOffset:r})),this.event._fireBoardScrollEvent({trigger:"interaction"}),n&&this.store.isDrawEnable()&&(clearTimeout(this.store.dragScrollTimer),this.store.dragScrollTimer=window.setTimeout((function(){i.store.addRealtimeData(i.store.dragDataList.getDragData(a).getRealTimeData()),i.store.report.reportDrag(Object.assign(i.store.dragDataList.getDragData(a).getReportData(),{boardId:a,type:"scrollEvent",extra:{devicePixelRatio:window.devicePixelRatio}}))}),400))},e.prototype.scaleDraw=function(t,e){if(e.length){var r,i=this.store.dragDataList.getDragData(this.store.getCurrentBoard());i||(i=new Kn(this.seqUtil,{scale:M.SCALE,xOffset:50,yOffset:50}),this.store.dragDataList.addDragData(this.store.getCurrentBoard(),i)),r=~~(t*e[e.length-1]),r=Math.max(this.settingConfig.minBoardScale,Math.min(this.settingConfig.maxBoardScale,r)),i.scale=r,this.store.setNeedDraw(!0),this.event._fireBoardScrollEvent({trigger:"interaction"})}},e.prototype.end=function(t){void 0===t&&(t=this.store.getCurrentBoard()),this.store.report.reportDrag(Object.assign(this.store.dragDataList.getDragData(t).getReportData(),{boardId:this.store.getCurrentBoard(),type:"operator_mouse_end"}))},e.prototype.touchEnd=function(t,e,r){if(void 0===t&&(t=this.store.getCurrentBoard()),void 0===r&&(r=!0),e.length){if(r){var i=this.store.dragDataList.getDragData(t);this.store.setBoardScale(i.scale)}}else this.store.report.reportDrag(Object.assign(this.store.dragDataList.getDragData(t).getReportData(),{boardId:t,type:"operator_touchend"}))},e.prototype.over=function(){var t=this;clearTimeout(this.store.dragMouseOverTimer),this.store.dragMouseOverTimer=window.setTimeout((function(){t.store.report.reportDrag(Object.assign(t.store.dragDataList.getDragData(t.store.getCurrentBoard()).getReportData(),{boardId:t.store.getCurrentBoard(),type:"operator_mouse_over"}))}),400)},e}(Cc),Jc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Kc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jc(e,t),e.prototype.start=function(t,e){var r=this.store.customGraphData;r.url?this.store.addCustomGraphElement({url:r.url,userData:r.userData,erasable:r.erasable,show:!1,visible:!1,x:t,y:e}):this.event.fireWarningEvent($.TEDU_BOARD_WARNING_CUSTOM_GRAPH_URL_NON_EXISTS,"The url of the custom graphic does not exist")},e.prototype.draw=function(t,e,r,i){if(this.store.customGraphData.url){var o=this.store.tiwData.getLatestElementByUserId(this.store.getCurrentBoard(),this.identifier);(r<t||i<e)&&o.setXY(Math.min(r,t),Math.min(i,e)),o.setWidthHeight(Math.abs(r-t),Math.abs(i-e)),Math.abs(o.realWidth*o.scaleX)>=4&&Math.abs(o.realHeight*o.scaleY)>=4?o.show=!0:o.show=!1,o.visible=!0,this.store.setNeedDraw(!0)}},e.prototype.end=function(){var t=this.store;if(t.customGraphData.url){var e=t.tiwData.getElementsByUserId(t.getCurrentBoard(),this.identifier),r=e[e.length-1];r.show?(r.visible=!0,t.setNeedDraw(!0),t.addRealtimeData(r.getRealTimeData()),t.report.reportElement(r.getReportData()),this.event.fireAddElementEvent({id:String(r.belongSeq),type:Ta.TEDU_BOARD_ELEMENT_CUSTOM_GRAPH,userData:r.userData})):t.tiwData.removeElement(r.belongSeq)}},e}(Cc),Zc={TEDU_BOARD_VIDEO_STATUS_ERROR:1,TEDU_BOARD_VIDEO_STATUS_LOADING:2,TEDU_BOARD_VIDEO_STATUS_LOADED:3,TEDU_BOARD_VIDEO_STATUS_PLAYED:4,TEDU_BOARD_VIDEO_STATUS_TIMEUPDATE:5,TEDU_BOARD_VIDEO_STATUS_PAUSED:6,TEDU_BOARD_VIDEO_STATUS_SEEKED:7,TEDU_BOARD_VIDEO_STATUS_ENDED:8,TEDU_BOARD_VIDEO_STATUS_WAITING:9,TEDU_BOARD_VIDEO_STATUS_PLAYING:10},Qc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),$c=function(t){function e(e,r,i){var o=t.call(this,e)||this;return o.isResetVideoProgress=!1,o.syncVideoStatusTimer=0,o.isShowVideoControl=!0,o.board=r,o.store=i,o.isSyncVideoStatus=!0,o._enableVideoControl(),o.syncVideoStatusTimer=0,o._initTiwEvent(),o._initVideoStatus(),o}return Qc(e,t),e.prototype._initTiwEvent=function(){var t=this;this.event.on(tt.TEB_BOARD_PERMISSION_CHANGED,(function(){t._enableVideoControl()}))},e.prototype._isOperationPermissions=function(){return this.permissionHandler.filter("File::Update::Video",void 0,!1)},e.prototype._initVideoStatus=function(){this.videoStatus={fid:"",url:"",format:M.VIDEO_FORMAT.MP4,duration:0,extParam:{},isCreated:!1,isLoaded:!1,initEventFired:!1,currentStatus:M.VIDEO_STATUS.PAUSE,preStatus:-1,preProgress:0,waitingTime:0,isWaiting:!1,isError:!1,actions:{create:M.VIDEO_ACTION.EXCEPTIOIN,play:M.VIDEO_ACTION.EXCEPTIOIN,pause:M.VIDEO_ACTION.EXCEPTIOIN,seek:M.VIDEO_ACTION.EXCEPTIOIN},actionTimes:{create:0,seek:0,pause:0,play:0},tryTimes:{create:0,seek:0,pause:0,play:0,duration:0},isFixed:{seekTimes:0,create:!0,play:!0,seek:!0,pause:!0}}},e.prototype.renderVideo=function(t){var e,r,i,o,n=this;if(this.videoStatus){var a=t.fid,s=t.type,l=t.downloadURL,c=s===M.FILE_TYPE.VODFILE&&null!=l,h=(s===M.FILE_TYPE.VOD||s===M.FILE_TYPE.LIVE)&&null!=l;if(c||h){var u=t.status||0,d=t.progress||0;if(this.videoStatus.isCreated&&(u===M.VIDEO_STATUS.PLAY||this.isResetVideoProgress)){this.isResetVideoProgress=!1;var p=d,f=Wt.getTimeStamp();d=Math.floor((f-t.timestamp)/1e3+d),Math.floor(p)!=Math.floor(d)&&this.logger.reportInfo(this.loggerModuleName,"video_fix_progress",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,before:p,beforeTime:t.timestamp,after:d,currentTime:f,volume:parseFloat((null===(r=null===(e=this.videoPlayer)||void 0===e?void 0:e.volume)||void 0===r?void 0:r.call(e).toFixed(2))||-1)})}},ea.ONLY_ONLINE)}if(this.videoStatus.fid!=a)if(this.resetVideoStatus(),this.stopSyncVideoStatus(),h){if(this.videoUrlChecker)return;var g=t.downloadURL;this.videoUrlChecker=new sn({domainMap:this.store.getDomainMap(),accessibleDomains:this.store.getAccessibleDomains()}),this.videoUrlChecker.runVideo(g,5e3,(function(t){n.videoUrlChecker=null,t?n.store.addAccessibleDomain(t):t=g,n.videoStatus.fid=a,n.videoStatus.url=t,n.videoStatus.format=n.getVideoFormat(t),n.videoStatus.actions.create=M.VIDEO_ACTION.PASSIVE,n.createVideo(a,t)}))}else c&&(this.videoStatus.fid=a,this.videoStatus.url=l,this.videoStatus.actions.create=M.VIDEO_ACTION.PASSIVE,"true"===this.splitVodVideoOption(l).hasExt||this.createVodVideo(a,l));else this.board.videoDiv.style.display="block",this.videoPlayer&&(this.videoPlayer.width(this.board.width),this.videoPlayer.height(this.board.height));if(!window.WeixinJSBridge&&!this.videoStatus.isCreated)return;if(this.videoStatus.preStatus===u&&Math.floor(this.videoStatus.preProgress)===Math.floor(d))return;if(0===this.videoStatus.duration){if(this.logger.reportInfo(this.loggerModuleName,"video_get_duration",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url})}},ea.ONLY_ONLINE),this.videoStatus.duration=this.videoPlayer.duration()||0,0===this.videoStatus.duration)return void setTimeout((function(){n.videoStatus.tryTimes.duration++,n.videoStatus.tryTimes.duration>M.VIDEO_ACTION_TRYTIMES?(n.videoStatus.tryTimes.duration=0,n.videoStatus.duration=n.videoPlayer.duration()||0,n.videoStatus.duration||n.videoError(-9)):n.store.setNeedDraw()}),1e3*Math.pow(2,this.videoStatus.tryTimes.duration));this.videoStatus.tryTimes.duration=0}u===M.VIDEO_STATUS.PLAY&&Math.floor(d)>=Math.floor(this.videoStatus.duration)&&(d=Math.floor(this.videoStatus.duration),u=M.VIDEO_STATUS.PAUSE,this.logger.reportInfo(this.loggerModuleName,"video_fix_progress",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:d,volume:parseFloat((null===(o=null===(i=this.videoPlayer)||void 0===i?void 0:i.volume)||void 0===o?void 0:o.call(i).toFixed(2))||-1)})}},ea.ONLY_ONLINE)),this.updateVideoStatus(u,d)}else this.videoUrlChecker&&(this.videoUrlChecker.cancelChecker(),this.videoUrlChecker=null),this.videoPlayer&&(this.board.videoDiv.style.display="none",this.videoStatus.actions.pause=M.VIDEO_ACTION.PASSIVE,this.videoPlayer.pause()),this.resetVideoStatus()}},e.prototype.addVideoFile=function(t,e,r){var i=this;void 0===e&&(e=""),void 0===r&&(r=!0),this.board.inputBlur();var o="#".concat(Wt.getTimeStamp()),n=this.store.isFileUrlExist(t);if(n){var a=this.board.getFileInfo(n);return o=a.fid,setTimeout((function(){i.event.fireWarningEvent($.TEDU_BOARD_WARNING_VIDEO_ALREADY_EXISTS,o),i.logger.reportInfo(i.loggerModuleName,"video_already_exists",{param:{fileId:o,extraInfo:t}},ea.ONLY_ONLINE)}),0),o}var s=t;return new sn({domainMap:this.store.getDomainMap(),accessibleDomains:this.store.getAccessibleDomains()}).runVideo(s,5e3,(function(t){t?i.store.addAccessibleDomain(t):t=s,i.resetVideoStatus(),i.stopSyncVideoStatus(),i.store.addVideoFile(o,s,i.board.boardBaseWidth,i.board.boardBaseHeight,M.FILE_TYPE.VOD,e,r,i.identifier).then((function(){i.videoStatus.fid=o,i.videoStatus.url=t,i.videoStatus.format=i.getVideoFormat(t),i.videoStatus.actions.create=M.VIDEO_ACTION.API,i.switchFilePauseVideo(),i.createVideo(o,t)})).catch((function(){}))})),o},e.prototype.addVODFile=function(t,e,r){var i=this;this.board.inputBlur();var o="#".concat(Wt.getTimeStamp()),n="".concat(t,"_").concat(e,"_").concat(null!=r?"true":"false"),a=this.store.isFileUrlExist(n);if(a){var s=this.board.getFileInfo(a);return o=s.fid,setTimeout((function(){i.event.fireWarningEvent($.TEDU_BOARD_WARNING_VIDEO_ALREADY_EXISTS,o),i.logger.reportInfo(i.loggerModuleName,"video_already_exists",{param:{fileId:o,extraInfo:n}},ea.ONLY_ONLINE)}),0),o}return this.resetVideoStatus(),this.stopSyncVideoStatus(),this.videoStatus.fid=o,this.videoStatus.url=n,this.videoStatus.extParam=r,this.videoStatus.actions.create=M.VIDEO_ACTION.API,this.store.addVideoFile(o,n,this.board.boardBaseWidth,this.board.boardBaseHeight,M.FILE_TYPE.VODFILE,"",!0,this.identifier).catch((function(){})),this.createVodVideo(o,n,r),o},e.prototype.resetVideoStatus=function(){var t,e,r;this._initVideoStatus(),this.videoPlayer&&(this.videoPlayer.reset(),this.resetVideoTag(),this.resetVideoJSControl(),null===(r=null===(e=null===(t=this.videoPlayer.controlBar)||void 0===t?void 0:t.progressControl)||void 0===e?void 0:e.seekBar)||void 0===r||r.update())},e.prototype.stopSyncVideoStatus=function(){this.syncVideoStatusTimer&&clearInterval(this.syncVideoStatusTimer),this.logger.reportInfo(this.loggerModuleName,"stop_video_sync_timer",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url})}},ea.ONLY_ONLINE)},e.prototype.getVideoFormat=function(t){var e=(t=t.split("?")[0]).split(":"),r=M.VIDEO_FORMAT.NONE;return 0!=e.length&&"rtmp"===e[0].toLocaleLowerCase()?r=M.VIDEO_FORMAT.RTMP:0!=(e=t.split(".")).length&&(r="m3u8"===(r=e[e.length-1].toLocaleLowerCase())?M.VIDEO_FORMAT.M3U8:"flv"===r?M.VIDEO_FORMAT.FLV:"mp4"===r?M.VIDEO_FORMAT.MP4:M.VIDEO_FORMAT.NONE),r},e.prototype.getVideoType=function(t){var e=this.getVideoFormat(t);return e===M.VIDEO_FORMAT.MP4?M.FILE_TYPE.VOD:e===M.VIDEO_FORMAT.M3U8||e===M.VIDEO_FORMAT.RTMP||e===M.VIDEO_FORMAT.FLV?M.FILE_TYPE.LIVE:M.FILE_TYPE.VOD},e.prototype.createVideo=function(t,e){var r=this;this.logger.reportInfo(this.loggerModuleName,"video_cors",{param:{fileId:t,extraInfo:JSON.stringify({url:e})}},ea.ONLY_ONLINE),this.store.request.corsGet(e,(function(){r.innerCreateVideo(t,e,!0)}),(function(){r.innerCreateVideo(t,e,!1)}))},e.prototype.innerCreateVideo=function(t,e,r){this.logger.reportInfo(this.loggerModuleName,"create_video",{param:{fileId:t,extraInfo:JSON.stringify({url:e,corss:r})}},ea.ONLY_ONLINE);var i=this.board.width,o=this.board.height;this._setVideoElementStyle(!0),this.event.fireVideoStatusChangedEvent({fileId:t,status:Zc.TEDU_BOARD_VIDEO_STATUS_LOADING,progress:0,duration:0});var n=this,a=function(){var t=this;setTimeout((function(){window.WeixinJSBridge.invoke("getNetworkType",{},(function(){n.videoStatus.actions.play=M.VIDEO_ACTION.PASSIVE,n.videoPlayer.play()}),!1);var e=Wt.getTimeStamp(),r=t.videoStatus;r.actionTimes.play=e;var i=setInterval((function(){t&&r.actionTimes.play===e&&r.currentStatus!==M.VIDEO_STATUS.PLAY?(t.logger.reportInfo(t.loggerModuleName,"create_play_miss_callback",{param:{fileId:r.fid,extraInfo:JSON.stringify({url:r.url,try:r.tryTimes.play})}},ea.ONLY_ONLINE),r.tryTimes.play++,r.tryTimes.play>=M.VIDEO_ACTION_TRYTIMES?(r.tryTimes.play=0,t.videoError(-3),clearInterval(i)):window.WeixinJSBridge?window.WeixinJSBridge.invoke("getNetworkType",{},(function(t){n.videoStatus.actions.play=M.VIDEO_ACTION.PASSIVE,n.videoPlayer.play()}),!1):(r.actions.play=M.VIDEO_ACTION.PASSIVE,t.videoPlayer.play())):clearInterval(i)}),2e3)}),500)};if(this.videoTag){r?this.videoTag.setAttribute("crossOrigin","Anonymous"):this.videoTag.removeAttribute("crossOrigin"),this.videoTag.setAttribute("data-fid",t);var s=this.getVideoFormat(e),l={src:e};s||(l.type="video/mp4"),this.videoPlayer.src([l]),this.videoPlayer.load(),gt()&&window.WeixinJSBridge&&a.apply(this),this.videoPlayer.width(i),this.videoPlayer.height(o)}else{if(!Rh.hasVideoPermission())return;if(this.videoTag=Rh.videoPermissionDiv.getElementsByTagName("video")[0],r?this.videoTag.setAttribute("crossOrigin","Anonymous"):this.videoTag.removeAttribute("crossOrigin"),this.videoTag.setAttribute("data-fid",t),this.videoTag.addEventListener("mousedown",(function(t){t.stopPropagation()})),this.videoTag.addEventListener("touchstart",(function(t){t.stopPropagation()})),this.videoTag.pause(),!this.videoTag)return void this.logger.reportInfo(this.loggerModuleName,"no_auth_video",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url})}},ea.ONLY_ONLINE);var c=Math.floor(1e6*Math.random());this.videoTag.id="tic_video_".concat(c),this.board.videoDiv.appendChild(this.videoTag),this.videoPlayer=window.videojs(this.videoTag.id,{width:i,height:o,preload:"metadata"},(function(){this.tech_&&this.tech_.off("dblclick"),n.resetVideoJSControl(),n.videoTag=n.board.videoDiv.getElementsByTagName("video")[0];var t=n.getVideoFormat(e),r={src:e};t||(r.type="video/mp4"),this.src([r]),this.on("loadstart",(function(){})),this.on("loadedmetadata",(function(){n.videoMetaDataLoaded(),n.videoStatus.isLoaded||n.videoCreated()})),this.on("loadeddata",(function(){})),n.videoTag.addEventListener("canplay",(function(t){var e=!1,r=t.target.videoWidth/t.target.videoHeight,i=n.board.width/n.board.height;Math.abs(r-i)<.8&&(e=!0),_t()&&n.videoTag&&e?n.videoTag.setAttribute("style","object-fit: fill; object-position: center;"):n.videoTag.setAttribute("style","height:100%; width:100%;")})),this.on("canplay",(function(){n.videoStatus&&n.logger.reportInfo(n.loggerModuleName,"video_canplay",{param:{fileId:n.videoStatus.fid,extraInfo:JSON.stringify({url:n.videoStatus.url,duration:this.duration()})}},ea.ONLY_ONLINE)})),this.on("durationchange",(function(){var t,e;n.videoStatus&&n.videoStatus.fid&&n.videoStatus.url&&n.logger.reportInfo(n.loggerModuleName,"video_durationchange",{param:{fileId:n.videoStatus.fid,extraInfo:JSON.stringify({url:n.videoStatus.url,duration:this.duration(),volume:parseFloat((null===(e=null===(t=this.videoPlayer)||void 0===t?void 0:t.volume)||void 0===e?void 0:e.call(t).toFixed(2))||-1)})}},ea.ONLY_ONLINE)})),this.on("play",(function(){n.videoStatus.currentStatus=M.VIDEO_STATUS.PLAY,n.videoPlayed()})),this.on("pause",(function(){n.videoStatus.currentStatus=M.VIDEO_STATUS.PAUSE,n.videoPaused()})),this.on("ended",(function(){n.videoEnded()})),this.on("seeked",(function(){n.videoSeeked()})),this.on("timeupdate",(function(){n.videoTimeUpdate()})),this.on("waiting",(function(){n.videoWaiting()})),this.on("playing",(function(){n.videoStatus.currentStatus=M.VIDEO_STATUS.PLAY,n.videoPlaying()})),this.on("error",(function(){n.videoError(-2)})),n.videoPlayer.load(),gt()&&window.WeixinJSBridge&&a.apply(n)}))}},e.prototype.splitVodVideoOption=function(t){var e=t.split("_");return 3!=e.length?{appId:0,vodId:0,hasExt:"false"}:{appId:e[0],vodId:e[1],hasExt:e[2]}},e.prototype.createVodVideo=function(t,e,r){var o=this;void 0===r&&(r=null),this.videoPlayer&&(this.videoPlayer.dispose(),this.videoPlayer=null);var n=this.board.width,a=this.board.height;this._setVideoElementStyle(!1);var s=document.createElement("video"),l="tic_video_".concat(Wt.getTimeStamp());_t()?s.setAttribute("style","object-fit: fill; object-position: center;"):s.setAttribute("style","width:100%; height:100%"),s.setAttribute("id",l),this.board.videoDiv.appendChild(s),this.event.fireVideoStatusChangedEvent({fileId:t,status:Zc.TEDU_BOARD_VIDEO_STATUS_LOADING,progress:0,duration:0});var c=this.splitVodVideoOption(e),h={appID:c.appId,fileID:c.vodId,width:n,height:a};if(r)for(var u in r)h[u]=r[u];this.videoPlayer=new window.TCPlayer(l,h),this.videoPlayer.on("error",(function(){o.event.fireVideoStatusChangedEvent({fileId:t,status:Zc.TEDU_BOARD_VIDEO_STATUS_ERROR,progress:0,duration:0})})),this.videoPlayer.on("loadstart",(function(){var t=o.board.container.getElementsByTagName("video")[0];t&&(t.setAttribute("x5-video-player-type","h5-page"),t.setAttribute("controlsList","nodownload"),t.setAttribute("disablePictureInPicture",""),o.removeTCPlayerControl())})),this.videoPlayer.on("loadedmetadata",(function(){o.videoMetaDataLoaded()})),this.videoPlayer.on("play",(function(){o.videoPlayed(),gt()&&(o.videoStatus.isCreated||setTimeout((function(){window.WeixinJSBridge||gt()&&"ios"!=i.PLATFORM.toLowerCase()&&"android"!=i.PLATFORM.toLowerCase()||o.videoPlayer.mute(!1),o.videoCreated()}),500))})),this.videoPlayer.on("pause",(function(){o.videoPaused()})),this.videoPlayer.on("ended",(function(){o.videoEnded()})),this.videoPlayer.on("seeked",(function(){o.videoSeeked()})),this.videoPlayer.on("seeking",(function(){var t;_t()&&(t=navigator.userAgent.toLowerCase(),/tbs/i.test(t))&&o.videoSeeked()})),this.videoPlayer.on("timeupdate",(function(){o.videoTimeUpdate()})),this.videoPlayer.on("loadeddata",(function(){gt()||o.videoCreated()}))},e.prototype.setVODExtParam=function(t,e){this.videoStatus.fid===t&&(this.videoStatus.extParam=e,this.createVodVideo(t,this.videoStatus.url,e))},e.prototype.videoError=function(t){if(this.videoStatus&&(this.videoPlayer.errorDisplay&&this.videoPlayer.errorDisplay.hide(),this.videoStatus.fid)){this.videoStatus.isError=!0,this.fireVideoErrorStatusEvent();var e=this.videoPlayer.error(),r=0,i="",o=0,n=0;if(this.videoTag){o=this.videoTag.readyState,n=this.videoTag.networkState;var a=this.videoTag.error;a&&(r=a.code,i=a.message)}if(e){var s=e.code,l=e.message,c=e.status;this.logger.reportInfo(this.loggerModuleName,"video_error",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,code:s,message:l,status:c,from:t,readyState:o,networkState:n,videoElementErrorCode:r,videoElementErrorMessage:i})}},ea.ONLY_ONLINE)}else this.logger.reportInfo(this.loggerModuleName,"video_error",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,status:Zc.TEDU_BOARD_VIDEO_STATUS_ERROR,from:t,readyState:o,networkState:n,videoElementErrorCode:r,videoElementErrorMessage:i})}},ea.ONLY_ONLINE);this.videoStatus.url&&this.store.networkSniffer(this.videoStatus.url)}},e.prototype.updateVideoStatus=function(t,e){var r,i,o,n,a=this;if(this.videoStatus)if(this.board.hidden&&gt())this.logger.reportInfo(this.loggerModuleName,"ignore_video_update",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:e,status:t,duration:this.videoStatus.duration})}},ea.ONLY_ONLINE);else{var s=!1;if(t===this.videoStatus.preStatus?1e3*Math.abs(parseInt(this.videoPlayer.currentTime())-parseInt(e))>M.SYNC_VIDEO_STATUS_PRECISION&&(s=!0):1e3*Math.abs(parseInt(this.videoPlayer.currentTime())-parseInt(e))>0?s=!0:gt()&&0===this.videoPlayer.currentTime()&&0===e&&(e=.01,s=!0),s){var l=Wt.getTimeStamp();this.videoStatus.actionTimes.seek=l,this.videoStatus.actions.seek=M.VIDEO_ACTION.PASSIVE,this.videoPlayer.currentTime(e),setTimeout((function(){a&&a.videoStatus.actionTimes.seek===l&&(a.logger.reportInfo(a.loggerModuleName,"seek_miss_callback",{param:{fileId:a.videoStatus.fid,extraInfo:JSON.stringify({url:a.videoStatus.url,progress:e,duration:a.videoStatus.duration,try:a.videoStatus.tryTimes.seek})}},ea.ONLY_ONLINE),a.videoStatus.tryTimes.seek++,1===a.videoStatus.tryTimes.seek&&(a.videoStatus.actions.play=M.VIDEO_ACTION.SEEK_FIXED,a.videoPlayer.play()),a.videoStatus.tryTimes.seek>=M.VIDEO_ACTION_TRYTIMES?(a.videoStatus.tryTimes.seek=0,a.videoError(-5)):a.store.setNeedDraw())}),2e3),this.logger.reportInfo(this.loggerModuleName,"video_status_update_seek",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:e,duration:this.videoStatus.duration,volume:parseFloat((null===(i=null===(r=this.videoPlayer)||void 0===r?void 0:r.volume)||void 0===i?void 0:i.call(r).toFixed(2))||-1)})}},ea.ONLY_ONLINE)}else{var c=this.board.videoDiv.getElementsByTagName("video")[0],h=c&&c.paused,u=!h,d=null,p=Wt.getTimeStamp();t===M.VIDEO_STATUS.STOP&&u?(this.videoStatus.actionTimes.pause=p,this.videoStatus.actions.pause=M.VIDEO_ACTION.PASSIVE,this.videoPlayer.pause(),setTimeout((function(){a&&a.videoStatus.actionTimes.pause===p&&(a.logger.reportInfo(a.loggerModuleName,"stop_miss_callback",{param:{fileId:a.videoStatus.fid,extraInfo:JSON.stringify({url:a.videoStatus.url,progress:e,duration:a.videoStatus.duration,try:a.videoStatus.tryTimes.pause})}},ea.ONLY_ONLINE),a.videoStatus.tryTimes.pause++,a.videoStatus.tryTimes.pause>=M.VIDEO_ACTION_TRYTIMES?(a.videoStatus.tryTimes.pause=0,a.videoError(-6)):a.store.setNeedDraw())}),2e3),d="video_status_update_stop"):t===M.VIDEO_STATUS.PLAY&&h?(this.videoStatus.actionTimes.play=p,this.videoStatus.actions.play=M.VIDEO_ACTION.PASSIVE,this.videoPlayer.play().then((function(){}),(function(){a.videoPlayer.play().then((function(){}),(function(){}))})),setTimeout((function(){a&&a.videoStatus.actionTimes.play===p&&(a.logger.reportInfo(a.loggerModuleName,"play_miss_callback",{param:{fileId:a.videoStatus.fid,extraInfo:JSON.stringify({url:a.videoStatus.url,progress:e,duration:a.videoStatus.duration,try:a.videoStatus.tryTimes.play})}},ea.ONLY_ONLINE),a.videoStatus.tryTimes.play++,a.videoStatus.tryTimes.play>=M.VIDEO_ACTION_TRYTIMES?(a.videoStatus.tryTimes.play=0,a.videoError(-7)):a.store.setNeedDraw())}),2e3),d="video_status_update_play"):t===M.VIDEO_STATUS.PAUSE&&u?(this.videoStatus.actionTimes.pause=p,this.videoStatus.actions.pause=M.VIDEO_ACTION.PASSIVE,this.videoPlayer.pause(),this.videoStatus.actionTimes.seek=p,this.videoStatus.actions.seek=M.VIDEO_ACTION.PASSIVE,this.videoPlayer.currentTime(e),setTimeout((function(){a&&a.videoStatus.actionTimes.pause===p&&(a.logger.reportInfo(a.loggerModuleName,"pause_miss_callback",{param:{fileId:a.videoStatus.fid,extraInfo:JSON.stringify({url:a.videoStatus.url,progress:e,duration:a.videoStatus.duration,try:a.videoStatus.tryTimes.pause})}},ea.ONLY_ONLINE),a.videoStatus.tryTimes.pause++,a.videoStatus.tryTimes.pause>=M.VIDEO_ACTION_TRYTIMES?(a.videoStatus.tryTimes.pause=0,a.videoError(-8)):a.store.setNeedDraw())}),2e3),d="video_status_update_pause"):t===M.VIDEO_STATUS.PAUSE&&(this.videoStatus.initEventFired||(this.videoStatus.initEventFired=!0,this.event.fireVideoStatusChangedEvent({fileId:this.videoStatus.fid,status:Zc.TEDU_BOARD_VIDEO_STATUS_PAUSED,progress:e,duration:this.videoStatus.duration,volume:parseFloat((null===(n=null===(o=this.videoPlayer)||void 0===o?void 0:o.volume)||void 0===n?void 0:n.call(o).toFixed(2))||-1)})))}null!=d&&this.logger.reportInfo(this.loggerModuleName,d,{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:e,duration:this.videoStatus.duration})}},ea.ONLY_ONLINE)}},e.prototype.resetVideoTag=function(){var t=this;this.videoTag=this.board.videoDiv.getElementsByTagName("video")[0],this.videoTag&&(this.videoTag.setAttribute("x5-video-player-type","h5-page"),this.videoTag.setAttribute("controlsList","nodownload nofullscreen"),this.videoTag.setAttribute("disablePictureInPicture","disablePictureInPicture"),this.videoTag.setAttribute("webkit-playsinline","webkit-playsinline"),this.videoTag.setAttribute("playsinline","playsinline"),_t()?this.videoTag.setAttribute("style","object-fit: fill; object-position: center;"):this.videoTag.setAttribute("style","height:100%; width:100%;"),this.videoTag.addEventListener("mousedown",(function(t){t.stopPropagation()})),this.videoTag.addEventListener("touchstart",(function(t){t.stopPropagation()})),this.videoTag.addEventListener("canplay",(function(e){var r=!1,i=e.target.videoWidth/e.target.videoHeight,o=t.board.width/t.board.height;Math.abs(i-o)<.8&&(r=!0),_t()&&t.videoTag&&r?t.videoTag.setAttribute("style","object-fit: fill; object-position: center;"):t.videoTag.setAttribute("style","height:100%; width:100%;")})))},e.prototype.resetVideoJSControl=function(){this.videoPlayer&&(this.videoPlayer.bigPlayButton&&this.videoPlayer.bigPlayButton.hide(),this.videoPlayer.controlBar&&(this.videoPlayer.controlBar.addClass("tiw-vjs-control-bar"),this.videoPlayer.controlBar.liveDisplay&&this.videoPlayer.controlBar.liveDisplay.hide(),this.videoPlayer.controlBar.seekToLive&&this.videoPlayer.controlBar.seekToLive.hide(),this.videoPlayer.controlBar.fullscreenToggle&&this.videoPlayer.controlBar.fullscreenToggle.hide(),this.videoPlayer.controlBar.pictureInPictureToggle&&this.videoPlayer.controlBar.pictureInPictureToggle.hide(),this.videoPlayer.errorDisplay&&this.videoPlayer.errorDisplay.hide()))},e.prototype.videoMetaDataLoaded=function(){this.logger.reportInfo(this.loggerModuleName,"video_metadata_loaded",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url})}},ea.ONLY_ONLINE)},e.prototype.videoWaiting=function(){if(this.videoStatus&&this.videoStatus.isLoaded){this.videoStatus.waitingTime=Wt.getTimeStamp(),this.videoStatus.isWaiting=!0,this.logger.reportInfo(this.loggerModuleName,"video_waiting",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url})}},ea.ONLY_ONLINE);var t=this.videoPlayer.currentTime()||0,e=this.videoPlayer.duration()||0;this.event.fireVideoStatusChangedEvent({fileId:this.videoStatus.fid,status:Zc.TEDU_BOARD_VIDEO_STATUS_WAITING,progress:t,duration:e})}},e.prototype.videoPlaying=function(){var t,e,r,i;if(this.videoStatus&&this.videoStatus.isWaiting){this.videoStatus.isWaiting=!1;var o=Wt.getTimeStamp()-this.videoStatus.waitingTime;this.logger.reportInfo(this.loggerModuleName,"video_playing",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,cost:o,volume:parseFloat((null===(e=null===(t=this.videoPlayer)||void 0===t?void 0:t.volume)||void 0===e?void 0:e.call(t).toFixed(2))||-1)})}},ea.ONLY_ONLINE);var n=this.videoPlayer.currentTime()||0,a=this.videoPlayer.duration()||0;this.event.fireVideoStatusChangedEvent({fileId:this.videoStatus.fid,status:Zc.TEDU_BOARD_VIDEO_STATUS_PLAYING,progress:n,duration:a,volume:parseFloat((null===(i=null===(r=this.videoPlayer)||void 0===r?void 0:r.volume)||void 0===i?void 0:i.call(r).toFixed(2))||-1)})}},e.prototype.videoCreated=function(){if(this.videoStatus)if(""!==this.videoStatus.fid){if(this.isShowVideoControl||this.videoStatus.actions.create!==M.VIDEO_ACTION.EXCEPTIOIN){if(1!=this.videoStatus.isCreated){this._setVideoElementStyle(!0),this.showVideoControl(this.isShowVideoControl);var t=this.videoPlayer.duration()||0,e=this.videoStatus.fid;this.videoStatus.duration=t,this.videoStatus.actions.create,M.VIDEO_ACTION.PASSIVE,this.videoStatus.isCreated=!0,this.logger.reportInfo(this.loggerModuleName,"video_created",{param:{fileId:e,extraInfo:JSON.stringify({url:this.videoStatus.url,duration:t})}},ea.ONLY_ONLINE);var r=this.board.getFileInfo(this.videoStatus.fid),i=0;if(r){i=r.progress;var o=Wt.getTimeStamp();r.status===M.VIDEO_STATUS.PLAY&&(i=Math.floor((o-r.timestamp)/1e3+i))}this.store.updateVideo(e,r.status,i,!1),this.store.setNeedDraw(),r.status===M.VIDEO_STATUS.PAUSE&&this.videoStatus.preStatus===M.VIDEO_STATUS.PLAY&&(this.videoStatus.isFixed.pause=!1),r.status===M.VIDEO_STATUS.PLAY&&this.videoStatus.preStatus===M.VIDEO_STATUS.PAUSE&&(this.videoStatus.isFixed.play=!1),Math.floor(r.progress)!=Math.floor(this.videoStatus.preProgress)&&(this.videoStatus.isFixed.seek=!1),this.videoStatus.isFixed.play&&this.videoStatus.isFixed.pause&&this.videoStatus.isFixed.seek&&this.videoLoaded()}}else this.logger.reportInfo(this.loggerModuleName,"video_created_exception",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,isShowVideoControl:this.isShowVideoControl,videoAction:this.videoStatus.actions.create})}},ea.ONLY_ONLINE),this.store.setNeedDraw();this.videoStatus.actions.create=M.VIDEO_ACTION.EXCEPTIOIN}else this.logger.reportInfo(this.loggerModuleName,"video_created_null",{param:{}},ea.ONLY_ONLINE)},e.prototype.videoPaused=function(){var t,e,r,i,o,n;if(this.videoStatus){if(this.videoStatus.preStatus=M.VIDEO_STATUS.PAUSE,this.isShowVideoControl||this.videoStatus.actions.pause!==M.VIDEO_ACTION.EXCEPTIOIN){this.videoStatus.actionTimes.pause=0,this.videoStatus.tryTimes.pause=0,this.videoStatus.actionTimes.play=0,this.videoStatus.tryTimes.play=0;var a=this.board.container.querySelector("div.tx_board_canvas_box");if(a&&a.parentNode)if(this.videoStatus.isCreated){var s=this.videoPlayer.currentTime()||0,l=this.videoPlayer.duration()||0;if(0===s&&0===l)this.store.setNeedDraw(),this.logger.reportInfo(this.loggerModuleName,"video_paused_error",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:s,duration:l})}},ea.ONLY_ONLINE);else{var c=this.videoStatus.fid,h=this.isSyncVideoStatus;this.videoStatus.actions.pause===M.VIDEO_ACTION.PASSIVE&&(h=!1);var u=M.VIDEO_STATUS.PAUSE;this.store.updateVideo(c,u,s,h),this.store.setNeedDraw(),this.videoStatus.isFixed.pause?(this.logger.reportInfo(this.loggerModuleName,"video_paused",{param:{fileId:c,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:s,duration:l,needSync:h,action_pause_status:this.videoStatus.actions.pause,volume:parseFloat((null===(i=null===(r=this.videoPlayer)||void 0===r?void 0:r.volume)||void 0===i?void 0:i.call(r).toFixed(2))||-1)})}},ea.ONLY_ONLINE),this.event.fireVideoStatusChangedEvent({fileId:c,status:Zc.TEDU_BOARD_VIDEO_STATUS_PAUSED,progress:s,duration:l,volume:parseFloat((null===(n=null===(o=this.videoPlayer)||void 0===o?void 0:o.volume)||void 0===n?void 0:n.call(o).toFixed(2))||-1)})):(this.videoStatus.isFixed.pause=!0,this.logger.reportInfo(this.loggerModuleName,"video_paused_fixed",{param:{fileId:c,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:s,duration:l,volume:parseFloat((null===(e=null===(t=this.videoPlayer)||void 0===t?void 0:t.volume)||void 0===e?void 0:e.call(t).toFixed(2))||-1)})}},ea.ONLY_ONLINE),this.videoStatus.isFixed.play&&this.videoStatus.isFixed.pause&&this.videoStatus.isFixed.seek&&this.videoLoaded())}}else this.store.setNeedDraw()}else this.logger.reportInfo(this.loggerModuleName,"video_paused_exception",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,isShowVideoControl:this.isShowVideoControl,videoAction:this.videoStatus.actions.pause})}},ea.ONLY_ONLINE),this.store.setNeedDraw();this.videoStatus.actions.pause=M.VIDEO_ACTION.EXCEPTIOIN}},e.prototype.videoTimeUpdate=function(){var t,e;if((!this.board.hidden||!gt())&&this.videoStatus)if(""!==this.videoStatus.fid){if(this.videoStatus.isFixed.play&&this.videoStatus.isFixed.pause&&this.videoStatus.isFixed.seek&&this.videoStatus.preStatus===M.VIDEO_STATUS.PLAY){var r=this.videoStatus.fid,i=this.videoStatus.duration,o=this.videoPlayer.currentTime()||0;this.event.fireVideoStatusChangedEvent({fileId:r,status:Zc.TEDU_BOARD_VIDEO_STATUS_TIMEUPDATE,progress:o,duration:i,volume:parseFloat((null===(e=null===(t=this.videoPlayer)||void 0===t?void 0:t.volume)||void 0===e?void 0:e.call(t).toFixed(2))||-1)})}}else this.logger.reportInfo(this.loggerModuleName,"video_videoTimeUpdate_null",{param:{}},ea.ONLY_ONLINE)},e.prototype.videoEnded=function(){var t,e,r,i;if(this.videoStatus){var o=this.videoStatus.fid,n=this.videoPlayer.duration()||0;this.event.fireVideoStatusChangedEvent({fileId:o,status:Zc.TEDU_BOARD_VIDEO_STATUS_ENDED,progress:n,duration:n,volume:parseFloat((null===(e=null===(t=this.videoPlayer)||void 0===t?void 0:t.volume)||void 0===e?void 0:e.call(t).toFixed(2))||-1)}),this.videoStatus.preProgress=n,this.videoStatus.preStatus=M.VIDEO_STATUS.STOP,this.logger.reportInfo(this.loggerModuleName,"video_ended",{param:{fileId:o,extraInfo:JSON.stringify({url:this.videoStatus.url,needSync:!1,volume:parseFloat((null===(i=null===(r=this.videoPlayer)||void 0===r?void 0:r.volume)||void 0===i?void 0:i.call(r).toFixed(2))||-1)})}},ea.ONLY_ONLINE),this.store.updateVideo(o,M.VIDEO_STATUS.STOP,n,!1)}},e.prototype.videoSeeked=function(){var t,e,r,i,o,n;if(this.videoStatus){if(this.isShowVideoControl||this.videoStatus.actions.seek!==M.VIDEO_ACTION.EXCEPTIOIN)if(this.videoStatus.actionTimes.seek=0,this.videoStatus.tryTimes.seek=0,this.videoStatus.isCreated){var a=this.videoPlayer.currentTime()||0,s=this.videoPlayer.duration()||0;if(0===parseInt(a)&&0===s)this.store.setNeedDraw(),this.logger.reportInfo(this.loggerModuleName,"video_seeked_error",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:a,duration:s})}},ea.ONLY_ONLINE);else if(0!==parseInt(a)||this.videoStatus.isFixed.seek){var l=this.videoStatus.fid;this.videoStatus.preProgress=a;var c=this.isSyncVideoStatus;if(this.videoStatus.actions.seek===M.VIDEO_ACTION.PASSIVE&&(c=!1),gt()&&this.videoStatus.actions.seek===M.VIDEO_ACTION.PASSIVE&&.01===a||this.store.updateVideo(l,-1,a,c),this.store.setNeedDraw(),this.videoStatus.isFixed.seek){if(this.logger.reportInfo(this.loggerModuleName,"video_seeked",{param:{fileId:l,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:a,duration:s,needSync:c,action_seek_status:this.videoStatus.actions.seek,volume:parseFloat((null===(i=null===(r=this.videoPlayer)||void 0===r?void 0:r.volume)||void 0===i?void 0:i.call(r).toFixed(2))||-1)})}},ea.ONLY_ONLINE),gt()&&.01===a)return;this.event.fireVideoStatusChangedEvent({fileId:l,status:Zc.TEDU_BOARD_VIDEO_STATUS_SEEKED,progress:a,duration:s,volume:parseFloat((null===(n=null===(o=this.videoPlayer)||void 0===o?void 0:o.volume)||void 0===n?void 0:n.call(o).toFixed(2))||-1)})}else this.videoStatus.isFixed.seek=!0,this.logger.reportInfo(this.loggerModuleName,"video_seeked_fixed",{param:{fileId:l,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:a,duration:s,volume:parseFloat((null===(e=null===(t=this.videoPlayer)||void 0===t?void 0:t.volume)||void 0===e?void 0:e.call(t).toFixed(2))||-1)})}},ea.ONLY_ONLINE),this.videoStatus.isFixed.play&&this.videoStatus.isFixed.pause&&this.videoStatus.isFixed.seek&&this.videoLoaded()}else this.videoStatus.isFixed.seekTimes<2?(this.videoStatus.isFixed.seekTimes++,this.store.setNeedDraw(),this.logger.reportInfo(this.loggerModuleName,"video_seeked_error",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:a,duration:s})}},ea.ONLY_ONLINE)):this.videoError(-1)}else this.store.setNeedDraw();else this.logger.reportInfo(this.loggerModuleName,"video_seeked_exception",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,isShowVideoControl:this.isShowVideoControl,videoAction:this.videoStatus.actions.seek})}},ea.ONLY_ONLINE),this.store.setNeedDraw();this.videoStatus.actions.seek=M.VIDEO_ACTION.EXCEPTIOIN}},e.prototype.videoPlayed=function(){var t,e,r,i,o,n,a;if(this.videoStatus){if(""===this.videoStatus.fid)return this.logger.reportInfo(this.loggerModuleName,"video_played_null",{param:{}},ea.ONLY_ONLINE),this.videoStatus.actions.pause=M.VIDEO_ACTION.PASSIVE,void this.videoPlayer.pause();if(this.videoStatus.actions.play===M.VIDEO_ACTION.SEEK_FIXED){var s=this.videoStatus.preStatus;if(-1===s&&(s=null!==(t=this.board.getFileInfo(this.board.getCurrentFile()).status)&&void 0!==t?t:M.VIDEO_STATUS.PAUSE),s===M.VIDEO_STATUS.PAUSE||s===M.VIDEO_STATUS.STOP)return this.videoStatus.actions.pause=M.VIDEO_ACTION.PASSIVE,this.videoPlayer.pause(),void(this.videoStatus.actions.play=M.VIDEO_ACTION.EXCEPTIOIN)}if(this.videoStatus.preStatus=M.VIDEO_STATUS.PLAY,this.isShowVideoControl||this.videoStatus.actions.play!==M.VIDEO_ACTION.EXCEPTIOIN)if(this.videoStatus.actionTimes.play=0,this.videoStatus.tryTimes.play=0,this.videoStatus.actionTimes.pause=0,this.videoStatus.tryTimes.pause=0,this.videoStatus.isCreated){var l=this.videoPlayer.currentTime()||0,c=this.videoPlayer.duration()||0;if(0===l&&0===c)this.store.setNeedDraw(),this.logger.reportInfo(this.loggerModuleName,"video_played_error",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:l,duration:c})}},ea.ONLY_ONLINE);else{var h=this.videoStatus.fid,u=this.isSyncVideoStatus;this.videoStatus.actions.play!==M.VIDEO_ACTION.PASSIVE&&this.videoStatus.actions.play!==M.VIDEO_ACTION.SEEK_FIXED||(u=!1);var d=M.VIDEO_STATUS.PLAY;this.store.updateVideo(h,d,l,u),this.store.setNeedDraw(),this.videoStatus.isFixed.play?(this.logger.reportInfo(this.loggerModuleName,"video_played",{param:{fileId:h,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:l,duration:c,needSync:u,action_play_status:this.videoStatus.actions.play,volume:parseFloat((null===(o=null===(i=this.videoPlayer)||void 0===i?void 0:i.volume)||void 0===o?void 0:o.call(i).toFixed(2))||-1)})}},ea.ONLY_ONLINE),this.event.fireVideoStatusChangedEvent({fileId:h,status:Zc.TEDU_BOARD_VIDEO_STATUS_PLAYED,progress:l,duration:c,volume:parseFloat((null===(a=null===(n=this.videoPlayer)||void 0===n?void 0:n.volume)||void 0===a?void 0:a.call(n).toFixed(2))||-1)})):(this.videoStatus.isFixed.play=!0,this.logger.reportInfo(this.loggerModuleName,"video_played_fixed",{param:{fileId:h,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:l,duration:c,volume:parseFloat((null===(r=null===(e=this.videoPlayer)||void 0===e?void 0:e.volume)||void 0===r?void 0:r.call(e).toFixed(2))||-1)})}},ea.ONLY_ONLINE),this.videoStatus.isFixed.play&&this.videoStatus.isFixed.pause&&this.videoStatus.isFixed.seek&&this.videoLoaded())}}else this.store.setNeedDraw();else this.logger.reportInfo(this.loggerModuleName,"video_played_exception",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,isShowVideoControl:this.isShowVideoControl,videoAction:this.videoStatus.actions.play})}},ea.ONLY_ONLINE),this.store.setNeedDraw();this.videoStatus.actions.play=M.VIDEO_ACTION.EXCEPTIOIN}},e.prototype.videoLoaded=function(){var t,e,r,i,o;if(this.videoStatus){if(this.videoPlayer.controlBar&&this.videoPlayer.controlBar.playToggle){var n=this.videoPlayer.controlBar.playToggle;if(0!=this.videoStatus.duration&&Math.floor(this.videoStatus.preProgress)===Math.floor(this.videoStatus.duration))n.hasClass("vjs-ended")||n.toggleClass("vjs-ended");else{var a=this.videoStatus.preStatus;-1===a&&(a=null!==(t=this.board.getFileInfo(this.board.getCurrentFile()).status)&&void 0!==t?t:M.VIDEO_STATUS.PAUSE),a===M.VIDEO_STATUS.PAUSE||a===M.VIDEO_STATUS.STOP?n.hasClass("vjs-playing")&&n.toggleClass("vjs-playing"):n.hasClass("vjs-playing")||n.toggleClass("vjs-playing")}}this.videoStatus.isLoaded=!0;var s=this.videoPlayer.currentTime()||0,l=this.videoPlayer.duration()||0;this.logger.reportInfo(this.loggerModuleName,"video_loaded",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,progress:s,duration:l,volume:parseFloat((null===(r=null===(e=this.videoPlayer)||void 0===e?void 0:e.volume)||void 0===r?void 0:r.call(e).toFixed(2))||-1)})}},ea.ONLY_ONLINE),this.event.fireVideoStatusChangedEvent({fileId:this.videoStatus.fid,status:Zc.TEDU_BOARD_VIDEO_STATUS_LOADED,progress:s,duration:l,volume:parseFloat((null===(o=null===(i=this.videoPlayer)||void 0===i?void 0:i.volume)||void 0===o?void 0:o.call(i).toFixed(2))||-1)})}},e.prototype.removeTCPlayerControl=function(){this.resetVideoJSControl()},e.prototype.showVideoControl=function(t){t?this.permissionHandler.setInterceptor(["File::Update::Video"],["operator/"+this.identifier]):this.permissionHandler.setInterceptor(["File::Update::Video"],["operator/"])},e.prototype._enableVideoControl=function(){this.isShowVideoControl=this._isOperationPermissions(),this.videoPlayer&&this.videoPlayer.controls(this.isShowVideoControl)},e.prototype.setSyncVideoStatusEnable=function(t,e){var r=this;if(void 0===e&&(e=!1),t&&e){var i=this.board.getFileInfo();i&&i.fileType===Cl.VIDEO_FILE?this.store.request.getFileInfo({fid:i.fid},(function(e){if(e&&0===e.error_code){var i=JSON.parse(e.content),o=Wt.getTimeStamp(),n=Math.floor((o-i.timestamp)/1e3+i.progress);r.seekVideo(n),i.status===M.VIDEO_STATUS.STOP?r.pauseVideo():i.status===M.VIDEO_STATUS.PLAY?r.playVideo():i.status===M.VIDEO_STATUS.PAUSE&&r.pauseVideo()}setTimeout((function(){r.isSyncVideoStatus=t}),500)}),(function(){r.isSyncVideoStatus=t})):this.isSyncVideoStatus=t}else this.isSyncVideoStatus=t},e.prototype.playVideo=function(){this.videoStatus.isError&&this.fireVideoErrorStatusEvent(),this.videoStatus.actions.play=M.VIDEO_ACTION.API,this.videoPlayer&&this.videoPlayer.play(),this.logger.reportInfo(this.loggerModuleName,"play_video",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url})}},ea.ONLY_ONLINE)},e.prototype.pauseVideo=function(){this.videoStatus.isError&&this.fireVideoErrorStatusEvent(),this.videoStatus.actions.pause=M.VIDEO_ACTION.API,this.videoPlayer&&this.videoPlayer.pause(),this.logger.reportInfo(this.loggerModuleName,"pause_video",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url})}},ea.ONLY_ONLINE)},e.prototype.seekVideo=function(t){this.videoStatus.isError&&this.fireVideoErrorStatusEvent(),this.videoStatus.actions.seek=M.VIDEO_ACTION.API,this.videoPlayer&&this.videoPlayer.currentTime(t),this.logger.reportInfo(this.loggerModuleName,"seek_video",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url})}},ea.ONLY_ONLINE)},e.prototype.muteVideo=function(t){this.videoStatus.isError&&this.fireVideoErrorStatusEvent(),this.videoTag&&(this.videoTag.muted=t),this.logger.reportInfo(this.loggerModuleName,"mute_video",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url})}},ea.ONLY_ONLINE)},e.prototype.resetVideoProgress=function(){this.videoStatus.isError&&this.fireVideoErrorStatusEvent(),this.isResetVideoProgress=!0,this.store.setNeedDraw(!0),this.logger.reportInfo(this.loggerModuleName,"reset_video_progress",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url})}},ea.ONLY_ONLINE)},e.prototype.startSyncVideoStatus=function(t){var e=this;this.videoStatus&&this.videoStatus.isCreated&&(this.syncVideoStatusTimer&&(clearInterval(this.syncVideoStatusTimer),this.syncVideoStatusTimer=0),this.syncVideoStatusTimer=window.setInterval((function(){e.store.updateVideo(e.videoStatus.fid,e.videoStatus.preStatus,e.videoPlayer.currentTime())}),1e3*t),this.logger.reportInfo(this.loggerModuleName,"start_video_sync_timer",{param:{fileId:this.videoStatus.fid,extraInfo:JSON.stringify({url:this.videoStatus.url,interval:t})}},ea.ONLY_ONLINE))},e.prototype.switchFilePauseVideo=function(){var t,e,r=this.videoStatus.fid;if(r){var i=this.board.getFileInfo(r).status;if(i===M.VIDEO_STATUS.PAUSE||i===M.VIDEO_STATUS.STOP)return;var o=this.videoPlayer.currentTime()||0,n=this.videoPlayer.duration()||0,a=M.VIDEO_STATUS.PAUSE;this.store.updateVideo(r,a,o,!0),this.event.fireVideoStatusChangedEvent({fileId:r,status:Zc.TEDU_BOARD_VIDEO_STATUS_PAUSED,progress:o,duration:n,volume:parseFloat((null===(e=null===(t=this.videoPlayer)||void 0===t?void 0:t.volume)||void 0===e?void 0:e.call(t).toFixed(2))||-1)})}},e.prototype._setVideoElementStyle=function(t){var e=t?"block":"none",r=this.board.width,i=this.board.height;if(this.board.videoDiv){var o=this.board.videoDiv.style.left,n=this.board.videoDiv.style.top;this.board.videoDiv.setAttribute("style","z-index:20; position:absolute; top:".concat(n,"; left:").concat(o,"; \n      height:").concat(i,"px; width:").concat(r,"px; display:").concat(e,";outline:none;\n      -webkit-transform: translateX(-50%) translateY(-50%) !important;\n      transform: translateX(-50%) translateY(-50%) !important;"))}},e.prototype.fireVideoErrorStatusEvent=function(){this.event.fireVideoStatusChangedEvent({fileId:this.videoStatus.fid,status:Zc.TEDU_BOARD_VIDEO_STATUS_ERROR,progress:0,duration:0})},e.prototype.destroy=function(){this.videoUrlChecker&&this.videoUrlChecker.cancelChecker(),this.videoUrlChecker=null,this.syncVideoStatusTimer&&clearInterval(this.syncVideoStatusTimer),this.videoPlayer&&this.videoPlayer.reset(),this.videoPlayer=null},e}(X),th=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),eh=function(t){function e(e,r){var i=t.call(this,e)||this;return i.board=r,i}return th(e,t),e.prototype.render=function(t){t?this.board.bgDiv.setAttribute("style","z-index:4 !important;position:absolute !important; top:0 !important; left:0 !important;background-color:".concat(t," !important;width:").concat(this.board.width,"px !important;height:").concat(this.board.height,"px !important;")):this.board.bgDiv.setAttribute("style","z-index:4 !important;position:absolute !important; top:0 !important; left:0 !important;")},e}(X),rh={TEDU_BOARD_BACKGROUND_H5_STATUS_LOADING:1,TEDU_BOARD_BACKGROUND_H5_STATUS_LOAD_FINISH:2},ih=function(){function t(t){void 0===t&&(t=""),this.src=t,this.dom=null,this.isRepeatLoad=!1}return t.prototype.createElement=function(t,e,r){var i=this.remove(t,e);i?(this.dom=i,this.isRepeatLoad=!0):(this.isRepeatLoad=!1,this.dom=document.createElement("iframe"),this.dom.classList.add("tic_board_h5_bg"),this.dom.setAttribute("style","display: none; border: none; position: absolute; top: 0; left: 0; z-index: 5"),this.dom.scrolling="no",this.dom.setAttribute("allow","autoplay"),this.dom.onload=function(){r&&r(this.src)},this.dom.src=e,t.appendChild(this.dom))},t.prototype.render=function(t){this.isRepeatLoad||t&&t(),this.dom&&(this.dom.style.display="block")},t.prototype.layout=function(t,e){this.dom&&(this.dom.width="".concat(t),this.dom.height="".concat(e))},t.prototype.remove=function(t,e){void 0===e&&(e="");for(var r=null,i=t.getElementsByClassName("tic_board_h5_bg"),o=0,n=i.length;o<n;o++){var a=i[o],s=a.getAttribute("src");!e||s!==e&&s!==encodeURI(e)?a.remove():r=a}return r},t}(),oh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),nh=function(t){function e(e,r,i){var o=t.call(this,e)||this;return o.checkImageStatusTask=0,o.imageExifCacheMap={},o.board=r,o.store=i,o.imageExifCacheMap={},o.backgroundIFrameManager=new ih,o._initBackgroundLoadStatus(),o}return oh(e,t),e.prototype._initBackgroundLoadStatus=function(){this.boardImageLoadStatus={background:{boardId:"",url:"",status:null,startLoadTime:0}}},e.prototype.render=function(t){var e=this;if(!t||!t.url||!t.show)return this._displayImage(),clearTimeout(this.checkImageStatusTask),clearTimeout(this.board.pregressTask),this.resetBackgroundImage(),void this.removeBackgroundIframe();var r=t.url,i=t.mode,o=t.type,n=t.show;r=L.replaceAssetsProtocol(r);var a=this,s=this.board.getCurrentBoard(),l=this.boardImageLoadStatus.background,c=!0,h=!1;if(l.boardId!=s||decodeURI(r)!==decodeURI(l.url)?("start"===l.status&&(this.event.fireImageStatusChangedEvent($n.TEDU_BOARD_IMAGE_STATUS_LOAD_CANCEL,{currentBoardId:l.boardId,imgUrl:l.url,currentImgUrl:""}),l.status="cancel",this.cancelTransitionImage(0),clearTimeout(this.board.pregressTask),this.board.progress.style.display="none",this.logger.reportInfo(this.loggerModuleName,"load_cancel_img",{cost:Wt.getTimeStamp()-l.startLoadTime,param:{boardId:l.boardId,extraInfo:JSON.stringify({image_url:l.url,boardid:l.boardId,currentSrc:""})}},ea.ONLY_ONLINE)),a.board.img.src&&(this.transitionImage=a.board.img.cloneNode()),this._displayImage(),l.boardId=s,l.status=null,l.url="",h=!0,this.bgImgUrlChecker&&(this.bgImgUrlChecker.cancelChecker(),this.bgImgUrlChecker=null)):"cancel"!==l.status&&"timeout"!==l.status&&"start"!==l.status||(c=!1),r&&n)if(o===M.BACKGROUND_TYPE.IMAGE){if(!c)return;var u=i||Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,d=a.board.img.getAttribute("originSrc")||"",p=r!==d&&encodeURI(r)!==d&&decodeURI(r)!==decodeURI(d);navigator.userAgent.toLocaleLowerCase().indexOf("iphone os 8")>-1&&decodeURI(r)===decodeURI(d).replace(/([&?])imgtime=\d+_imgtime/g,"")&&(p=!1),h&&(p=!0);var f=function(e,r){var i=this;void 0===e&&(e=!1),void 0===r&&(r=null);var o=function(t,r,o,n){void 0===o&&(o=0),void 0===n&&(n=!1),i.style.visibility="hidden";var s=a.board,l=s.width/s.height>t/r;l?(i.setAttribute("height",s.height),i.setAttribute("style",s.genStyles(u,l,o,n?1:i.naturalHeight/r,!0)),i.removeAttribute("width")):(i.setAttribute("width",s.width),i.setAttribute("style",s.genStyles(u,l,o,n?1:i.naturalWidth/t,!0)),i.removeAttribute("height")),e&&(i.style.visibility="visible")},n=function(t,e,r){var n=Math.abs(Math.cos(e/180*Math.PI))*i.naturalWidth+Math.abs(Math.sin(e/180*Math.PI))*i.naturalHeight,s=Math.abs(Math.sin(e/180*Math.PI))*i.naturalWidth+Math.abs(Math.cos(e/180*Math.PI))*i.naturalHeight;t?1===t?o(n,s,0+e):3===t?o(n,s,180+e):6===t?o(s,n,90+e):8===t&&o(s,n,-90+e):o(n,s,e,!0),a.logger.reportInfo(a.loggerModuleName,"get_img_exif",{cost:Wt.getTimeStamp()-v,param:{boardId:a.board.getCurrentBoard(),extraInfo:JSON.stringify({image_url:i.src,boardid:a.board.getCurrentBoard(),orientation:t,message:r})}},ea.ONLY_ONLINE)},s=Tt();if("Chrome"===s[0]&&bt(s[1],"81")<0){var l=this.src,c=a.imageExifCacheMap;c.hasOwnProperty(l)&&-1!==c[l]?(n(c[l],t.angle,"success"),r&&r()):ft(l,a.store.getImageTimeout(),(function(e,i){var o=e.Orientation,a=F(o)?1:o;c[l]=a,n(-1===a?1:a,t.angle,i),r&&r()}))}else t.angle?(o(Math.abs(Math.cos(t.angle/180*Math.PI))*this.naturalWidth+Math.abs(Math.sin(t.angle/180*Math.PI))*this.naturalHeight,Math.abs(Math.sin(t.angle/180*Math.PI))*this.naturalWidth+Math.abs(Math.cos(t.angle/180*Math.PI))*this.naturalHeight,t.angle,!1),r&&r()):(o(this.naturalWidth,this.naturalHeight,0,!0),r&&r())},g=function(t){return/os [89]/i.test(navigator.userAgent.toLocaleLowerCase())?t.indexOf("?")>-1?t+"&imgtime="+Date.now()+"_imgtime":t+"?imgtime="+Date.now()+"_imgtime":t},m=function(t){var e=a.board.img.getAttribute("originSrc")||"",r=oe(t),i=oe(e),o=a.store.getDomainMap()[i];if(o){var n=[i].concat(o),s=n.indexOf(r);t=t.replace(r,n[(s+1)%n.length])}return t},y=function(t){void 0===t&&(t=0),l.status="start",l.boardId=s,l.url=r,clearTimeout(e.checkImageStatusTask);var i=e.board;e.checkImageStatusTask=window.setTimeout((function(){var r=i,o=r.img;if("start"===l.status){if(t<3){var n=o.src;if(!n)return;var s=ne(n,"try");return s=m(s),o.removeAttribute("src"),a._loadingBackgroundImage(s,!0),a.store.networkSniffer(s,"get",5e3),void y(t+1)}e.event.fireImageStatusChangedEvent($n.TEDU_BOARD_IMAGE_STATUS_LOAD_TIMEOUT,{currentBoardId:l.boardId,imgUrl:l.url,currentImgUrl:""}),e._displayImage(),l.status="timeout",clearTimeout(r.pregressTask),r.progress.style.display="none",a.logger.reportInfo(a.loggerModuleName,"load_timeout_img",{cost:Wt.getTimeStamp()-v,param:{boardId:l.boardId,extraInfo:JSON.stringify({image_url:l.url,boardid:l.boardId,currentSrc:""})}},ea.ONLY_ONLINE),o.removeAttribute("src"),a.store.networkSniffer(l.url,"get",5e3)}}),1e3*e.store.getImageTimeout()*(t+1)),i.preloadTriggered=!0,clearTimeout(i.pregressTask),i.pregressTask=window.setTimeout((function(){e.store.isProgressEnable()&&(i.progress.style.display="block")}),M.PROGRESS_SHOW_DELAY)};if(p){var v=Wt.getTimeStamp();if(this.board.img.onload=function(){clearTimeout(a.checkImageStatusTask),l.status="loaded",f.call(a.board.img,!0,(function(){a.board.progress.style.display="none"})),a.board.img.onload=null,clearTimeout(a.board.pregressTask),a.cancelTransitionImage(0),a.event.fireImageStatusChangedEvent($n.TEDU_BOARD_IMAGE_STATUS_LOAD_DONE,{currentBoardId:a.board.getCurrentBoard(),imgUrl:r,currentImgUrl:""}),a.logger.reportInfo(a.loggerModuleName,"load_succ_img",{cost:Wt.getTimeStamp()-v,param:{boardId:a.board.getCurrentBoard(),extraInfo:JSON.stringify({image_url:a.board.img.src,boardid:a.board.getCurrentBoard(),currentSrc:""})}},ea.ONLY_ONLINE),a.store.preloadBoard()},a.board.img.onerror=function(){clearTimeout(a.checkImageStatusTask),l.status="error";var e,i,o,n=(e=a.board.img.currentSrc||a.board.img.src,i=new RegExp("".concat("try","=(\\d)"),"i"),(o=e.match(i))&&parseInt(o[1])||0);a.cancelTransitionImage(0),n>2?(a.board.img.style.visibility="hidden",a.board.img.onerror=null,clearTimeout(a.board.pregressTask),a.board.progress.style.display="none",a.event.fireImageStatusChangedEvent($n.TEDU_BOARD_IMAGE_STATUS_LOAD_ERROR,{currentBoardId:a.board.getCurrentBoard(),imgUrl:r,currentImgUrl:""}),a.logger.reportInfo(a.loggerModuleName,"load_error_img",{cost:Wt.getTimeStamp()-v,param:{boardId:a.board.getCurrentBoard(),extraInfo:JSON.stringify({image_url:r,boardid:a.board.getCurrentBoard(),currentSrc:""})}},ea.ONLY_ONLINE),a.store.networkSniffer(t.url,"get",5e3)):setTimeout((function(){var t=a.board.img.currentSrc||a.board.img.src;if(t){var e=ne(t,"try");e=m(e),a.board.img.removeAttribute("src"),a._loadingBackgroundImage(e,!0),y(n+1)}}),2e3),a.store.preloadBoard()},a.event.fireImageStatusChangedEvent($n.TEDU_BOARD_IMAGE_STATUS_LOADING,{currentBoardId:a.board.getCurrentBoard(),imgUrl:r,currentImgUrl:""}),this.transitionImage){var _=a.board.boardBox.querySelectorAll(".tic_board_img_bg");_.length>1&&_.forEach((function(t,e){e>0&&t.remove()})),a.board.boardBox.appendChild(this.transitionImage),a.cancelTransitionImage(400)}a.board.progress.style.display="block",a.board.img.style.visibility="hidden",a.board.img.setAttribute("originSrc",r);var E=this.board.boardBackgroundCacheMap[s];if(E&&E.url===r&&this.store.checkDomainAccessible(E.actualUrl)){var T=E.actualUrl;T=T.replace(/([&?])imgtime=\d+_imgtime/g,""),this._loadingBackgroundImage(g(T),!1),y()}else{if(this.bgImgUrlChecker)return;var b=g(r);this.bgImgUrlChecker=new sn({domainMap:this.store.getDomainMap(),accessibleDomains:this.store.getAccessibleDomains()}),this.bgImgUrlChecker.runImage(b,1e3*this.store.getImageTimeout(),(function(t){e.bgImgUrlChecker=null,t?e.store.addAccessibleDomain(t):t=b;var i=e.store.getCurrentBoardData(),o=e.store.getCurrentBoard(),n=i.backgroundPic.url;L.replaceAssetsProtocol(n)===r&&(e._loadingBackgroundImage(t,!1),e.board.boardBackgroundCacheMap[o]={url:r,actualUrl:t},y())}))}}else f.call(a.board.img,L.replaceAssetsProtocol(this.store.getCurrentBoardData().backgroundPic.url)===r);a.board.preloadTriggered=!0,a.removeBackgroundIframe()}else this._displayImage(),this.backgroundIFrameManager.createElement(this.board.boardBox,r,(function(t){t&&(a.event.fireH5BackgroundStatusChangedEvent(rh.TEDU_BOARD_BACKGROUND_H5_STATUS_LOAD_FINISH,{currentBoardId:a.board.getCurrentBoard(),url:t}),a.logger.reportInfo(a.loggerModuleName,"h5background_load_done",{cost:Wt.getTimeStamp()-v,param:{boardId:a.board.getCurrentBoard(),extraInfo:JSON.stringify({type:"H5_Background",url:t})}},ea.ONLY_ONLINE)),clearTimeout(a.board.pregressTask),a.board.progress.style.display="none",a.store.preloadBoard()})),this.backgroundIFrameManager.layout(a.board.width,a.board.height),this.backgroundIFrameManager.render((function(){e.board.preloadTriggered=!0,clearTimeout(e.board.pregressTask),e.board.pregressTask=window.setTimeout((function(){e.store.isProgressEnable()&&(e.board.progress.style.display="block")}),M.PROGRESS_SHOW_DELAY),e.event.fireH5BackgroundStatusChangedEvent(rh.TEDU_BOARD_BACKGROUND_H5_STATUS_LOADING,{currentBoardId:e.board.getCurrentBoard(),url:r}),a.logger.reportInfo(a.loggerModuleName,"h5background_start_load",{cost:Wt.getTimeStamp()-v,param:{boardId:a.board.getCurrentBoard(),extraInfo:JSON.stringify({type:"H5_Background",url:r})}},ea.ONLY_ONLINE)}))},e.prototype._loadingBackgroundImage=function(t,e){this.board.img.src=t,t&&this.logger.reportInfo(this.loggerModuleName,e?"load_try_img":"start_load_img",{param:{boardId:this.board.getCurrentBoard(),extraInfo:JSON.stringify({image_url:t,boardid:this.board.getCurrentBoard(),currentSrc:""})}},ea.ONLY_ONLINE)},e.prototype._displayImage=function(){var t=this.board.img;t.removeAttribute("src"),t.removeAttribute("width"),t.removeAttribute("height"),t.style.visibility="hidden"},e.prototype.resetBackgroundImage=function(){this.board.img&&(this._initBackgroundLoadStatus(),this.board.img.removeAttribute("originSrc"),this.board.img.removeAttribute("src"))},e.prototype.removeBackgroundIframe=function(){this.backgroundIFrameManager.remove(this.board.boardBox)},e.prototype.cancelTransitionImage=function(t){var e=this;void 0===t&&(t=400);var r=function(){e.transitionImage&&(e.transitionImage.removeAttribute("src"),e.transitionImage.removeAttribute("width"),e.transitionImage.removeAttribute("height"),e.transitionImage.remove())};t>0?setTimeout(r,t):r()},e.prototype.destroy=function(){this.cancelTransitionImage(),this.bgImgUrlChecker&&this.bgImgUrlChecker.cancelChecker(),this.bgImgUrlChecker=null},e}(X),ah={TEDU_BOARD_H5_PPT_STATUS_LOADING:1,TEDU_BOARD_H5_PPT_STATUS_LOADED:2,TEDU_BOARD_H5_PPT_STATUS_CANCEL:3,TEDU_BOARD_H5_PPT_STATUS_TIMEOUT:4,TEDU_BOARD_H5_PPT_STATUS_RESOURCES_LOADING_ERROR:5,TEDU_BOARD_H5_PPT_STATUS_RUNTIME_ERROR:6,TEDU_BOARD_H5_PPT_STATUS_ADD_TIMEOUT:7,TEDU_BOARD_H5_PPT_STATUS_IMAGE_ABNORMAL:8,TEDU_BOARD_H5_PPT_STATUS_INTERNAL_RESOURCES_LOADING_TIMEOUT:9},sh={TEDU_BOARD_H5_PPT_MEDIA_STATUS_PLAY:1,TEDU_BOARD_H5_PPT_MEDIA_STATUS_PAUSE:2,TEDU_BOARD_H5_PPT_MEDIA_STATUS_AUTHORITY_REQUEST:4,TEDU_BOARD_H5_PPT_MEDIA_STATUS_AUTHORITY_DONE:5},lh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ch=function(){return(ch=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},hh=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function a(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},uh=function(t,e){var r,i,o,n,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},dh=function(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(r[i[o]]=t[i[o]])}return r},ph=function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},fh=function(t){function e(e,r,i){var o=t.call(this,e)||this;return o.taskIdTitleMap={},o.addFileNeedSwitchMap={},o.pingIndex=0,o.pongIndex=0,o.heartbeat=0,o.forceRefresh=!1,o.timeOutTimes=0,o.oldPageIndex=-1,o.board=r,o.store=i,o.taskIdTitleMap={},o.addFileNeedSwitchMap={},o.resetPPTStatus(),o.initOnWindowMessage(),o}return lh(e,t),e.prototype.initHeartbeat=function(){var t=this;this.pingIndex=0,this.pongIndex=0,clearTimeout(this.heartbeat),this.heartbeat=window.setTimeout((function(){if(t.pongIndex!==t.pingIndex){var e=t.getFileInfo(t.checkH5PPTStatus.fid),r={fid:t.checkH5PPTStatus.fid,message:"ppt heartbeat timeout"};t._reportLog("runtime_error",t.checkH5PPTStatus.fid,ch({url:e.downloadURL,status:t.checkH5PPTStatus.status},r))}t.pingIndex++,jn.ping(t.board.iframeDOM,t.seqUtil.getSeq(),{index:t.pingIndex})}),1e3)},e.prototype.initOnWindowMessage=function(){var t=this,e=function(t){var e=t.playstate,r=t.currentTime,i=t.currentTimestamp,o=r;if(1===e){var n=Wt.getTimeStamp();o=Math.floor((n-i)/1e3+r)}return o};this.teduEventListener.addEventListener(window,"message",(function(r){if(r.data){var i=r.data.module,o=r.data.cmd,n=r.data.data,a=r.data.uniqBid;if((F(a)||U(a)||a==t.instanceKey)&&nn===i){var s=void 0;switch(o){case"init":var l="";try{var c=JSON.parse(n);l=c.url;var h=c.title,u=c.count,d=c.width,p=c.height,f=c.slideStepData,g=c.remarks,m=c.invisiblePageIndexList,y=re(decodeURIComponent(l)),v=y.fid;if(!v)return;var _=y.originUrl;if(1===t.checkH5PPTStatus.status&&t.checkH5PPTStatus.fid===v){t.checkH5PPTStatus.status=2,clearTimeout(t.checkH5PPTStatus.task),t.checkH5PPTStatus.task=0,t.initHeartbeat(),t.event.fireH5pptStatusChangedEvent(ah.TEDU_BOARD_H5_PPT_STATUS_LOADED,{fid:v,message:""});var E=t.getFileInfo(v),T=E.currentPageIndex,b=E.pptMediaPlaybackStatus,S=void 0===b?{}:b;if(S[T]){var x=S[T],w=x.video,O=x.audio;w&&Object.keys(w).forEach((function(r){var i=w[r],o=i.playstate,n=i.currentTime,a=i.currentTimestamp,s={id:r,type:"video",playstate:o,currentTime:e({playstate:o,currentTime:n,currentTimestamp:a})};jn.pptMediaAction(t.board.iframeDOM,t.seqUtil.getSeq(),ch({},s))})),O&&Object.keys(O).forEach((function(r){var i=O[r],o=i.playstate,n=i.currentTime,a=i.currentTimestamp,s={id:r,type:"audio",playstate:o,currentTime:e({playstate:o,currentTime:n,currentTimestamp:a})};jn.pptMediaAction(t.board.iframeDOM,t.seqUtil.getSeq(),ch({},s))}))}}var I=v.replace("#","");h=t.taskIdTitleMap[I]||h;var A=document.querySelector("#preiframe-"+I);if(A&&A.remove(),(s=t.store.getFileInfo(v))&&s.fid)jn.setFid(t.board.iframeDOM,s.fid);else{if(!t.board.isRenderFace){_&&_.indexOf("?")>-1&&(_=_.substring(0,_.indexOf("?")));var D=t.addFileNeedSwitchMap[v];t.store.addH5PPTFile(v,_,h,u,d,p,!0,D,t.identifier).catch((function(){})),D&&t.board.renderVideoFile.switchFilePauseVideo()}jn.setFid(t.board.iframeDOM,v),s=t.store.getFileInfo(v)}s&&(s.slideStepData=f,s.invisiblePageIndexList=m),t.board.pptRemarks[v]||(t.board.pptRemarks[v]=g),t._reportLog("iframe_cmd_init",v,{status:t.checkH5PPTStatus.status,retryTimes:t.checkH5PPTStatus.retryTimes,title:h,count:u,url:l,width:d,height:p,slideStepData:f,pptRemarks:g.length}),s&&s.slideStepData&&t.event.fireGotoStepEvent(s.currentPageStep,s.slideStepData[s.currentPageIndex])}catch(e){t._reportLog("iframe_cmd_init","",{url:l,status:t.checkH5PPTStatus.status,retryTimes:t.checkH5PPTStatus.retryTimes,stack:e.stack,message:e.message})}break;case"pong":t.pongIndex=n.index;break;case"slideStepChangeEvent":var C=t.store.getH5PPTOperator(n.fid,n.slideIndex,n.stepIndex);C||(C=t.identifier),t.store.switchH5Board(n,C),t.store.deleteH5PPTOperator(n.fid,n.slideIndex,n.stepIndex),(s=t.getFileInfo(n.fid))&&s.slideStepData&&t.event.fireGotoStepEvent(n.stepIndex,s.slideStepData[n.slideIndex+""]),t.forceRefresh=!1,t.oldPageIndex!=n.slideIndex&&(t.oldPageIndex=n.slideIndex,t.store.downGradeH5PPtMap.get(n.fid)&&t.event.fireH5PPtDownGradeInernalOperatorEvent(n.fid,n.slideIndex));break;case"assets_loading_error":if(s=t.getFileInfo(n.fid),(1===t.checkH5PPTStatus.status||2===t.checkH5PPTStatus.status)&&t.checkH5PPTStatus.fid===n.fid){var P=n.message||"";if(P.indexOf("control.js")>-1||P.indexOf("player.js")>-1){var L=P.substring(0,P.indexOf(".js")+3);t.store.networkSniffer(L,"get",1e4)}else if(t.board.progress.style.display="none",t.timeOutTimes++,0!=t.board.option.config.h5PPTDownGradeTimeoutTimes&&t.timeOutTimes>=t.board.option.config.h5PPTDownGradeTimeoutTimes){var M=s.currentPageIndex;t.event.fireH5PPtDownGradeWaringEvent(n.fid,M),t.timeOutTimes=0;break}t.checkH5PPTStatus.retryTimes>2?(t._reportLog("assets_loading_error",n.fid,ch({url:s.downloadURL,status:t.checkH5PPTStatus.status,retryTimes:t.checkH5PPTStatus.retryTimes},n)),t.event.fireH5pptStatusChangedEvent(ah.TEDU_BOARD_H5_PPT_STATUS_RESOURCES_LOADING_ERROR,n),t.checkH5PPTStatus.status=5,t.checkH5PPTStatus.retryTimes=0,t.resetPPTIframe(),t.board.progress.style.display="none"):(t.checkH5PPTStatus.status=5,++t.checkH5PPTStatus.retryTimes,t.board.refresh(!1))}break;case"control_init":t.board.progress.style.display="none";break;case"assets_loading_timeout":if(s=t.getFileInfo(n.fid),t._reportLog("assets_loading_timeout",n.fid,ch({url:s.downloadURL,status:t.checkH5PPTStatus.status,retryTimes:t.checkH5PPTStatus.retryTimes},n)),(1===t.checkH5PPTStatus.status||2===t.checkH5PPTStatus.status)&&t.checkH5PPTStatus.fid===n.fid){if(t.timeOutTimes++,0!=t.board.option.config.h5PPTDownGradeTimeoutTimes&&t.timeOutTimes>=t.board.option.config.h5PPTDownGradeTimeoutTimes){t.board.progress.style.display="none",M=s.currentPageIndex,t.event.fireH5PPtDownGradeWaringEvent(n.fid,M),t.timeOutTimes=0;break}t.event.fireH5pptStatusChangedEvent(ah.TEDU_BOARD_H5_PPT_STATUS_TIMEOUT,n),t.checkH5PPTStatus.status=4,t.resetPPTIframe()}break;case"assets_ppt_internal_loading_timeout":if(s=t.getFileInfo(n.fid),t._reportLog("assets_ppt_internal_loading_timeout",n.fid,ch({url:s.downloadURL,status:t.checkH5PPTStatus.status,retryTimes:t.checkH5PPTStatus.retryTimes},n)),(1===t.checkH5PPTStatus.status||2===t.checkH5PPTStatus.status)&&t.checkH5PPTStatus.fid===n.fid){if(t.timeOutTimes++,0!=t.board.option.config.h5PPTDownGradeTimeoutTimes&&t.timeOutTimes>=t.board.option.config.h5PPTDownGradeTimeoutTimes){t.board.progress.style.display="none",M=s.currentPageIndex,t.event.fireH5PPtDownGradeWaringEvent(n.fid,M),t.timeOutTimes=0;break}t.event.fireH5pptStatusChangedEvent(ah.TEDU_BOARD_H5_PPT_STATUS_INTERNAL_RESOURCES_LOADING_TIMEOUT,n),t.checkH5PPTStatus.status=4,t.resetPPTIframe(),t.board.progress.style.display="none"}break;case"runtime_error":s=t.getFileInfo(n.fid),t._reportLog("runtime_error",n.fid,ch({url:s.downloadURL,status:t.checkH5PPTStatus.status,retryTimes:t.checkH5PPTStatus.retryTimes},n)),1!==t.checkH5PPTStatus.status&&2!==t.checkH5PPTStatus.status||t.checkH5PPTStatus.fid!==n.fid||(t.event.fireH5pptStatusChangedEvent(ah.TEDU_BOARD_H5_PPT_STATUS_RUNTIME_ERROR,n),t.checkH5PPTStatus.status=6,t.board.progress.style.display="none");break;case"ppt_action":t._reportLog("ppt_action",n.fid,n),t.store.pptAction(n);break;case"ppt_media_play":t._reportLog("ppt_media_play",n.fid,n),t.store.pptMediaAction(n);break;case"ppt_media_status":var R=n.fid,N=n.id,B=n.playstate,k=dh(n,["fid","id","playstate"]);t._reportLog("ppt_media_status",n.fid,n);var H=k.type,G=k.slideIndex;t.updateMediaInfo({fid:R,mediaID:N,type:H,slideIndex:G}),t.event.fireH5pptMediaStatusChangedEvent(ch({fileId:R,mediaId:N,status:B},k));break;case"ppt_change_style":if(t._reportLog("ppt_change_style",n.fid,n),t.sendVideoRequestAuthorityEvent(n),_t()&&Et()){if(0===n.styleState)t.board.mouseType=t.teduToolType.toolType;else if(1===n.styleState)t.store.setType(t.board.mouseType);else if(2===n.styleState)break;t.board.androidWeiXinChangeH5PointerEvent(n.styleState,!0)}break;case"image_dimensions_abnormal":if(t.timeOutTimes++,0!=t.board.option.config.h5PPTDownGradeTimeoutTimes&&t.timeOutTimes>=t.board.option.config.h5PPTDownGradeTimeoutTimes){M=(s=t.getFileInfo(n.fid)).currentPageIndex,t.event.fireH5PPtDownGradeWaringEvent(n.fid,M),t.timeOutTimes=0;break}t._reportLog("ppt_image_dimensions_abnormal",n.fid,n),t.event.fireH5pptStatusChangedEvent(ah.TEDU_BOARD_H5_PPT_STATUS_IMAGE_ABNORMAL,{fid:n.fid,message:n.url});break;case"ppt_media_status_new":var q=n.fid,W=n.id,Y=n.playstate,z=dh(n,["fid","id","playstate"]);t.event.fireH5pptMediaStatusChangedEvent(ch({fileId:q,mediaId:W,status:Y},z));break;case"playVideoError":t.event.fireH5pptMediaPlayError(n),t._reportLog("playVideoError",n.fid,n)}}}}))},e.prototype.sendVideoRequestAuthorityEvent=function(t){if((_t()&&Et()||mt())&&(1===t.styleState||2===t.styleState)){var e=2===t.styleState?sh.TEDU_BOARD_H5_PPT_MEDIA_STATUS_AUTHORITY_REQUEST:sh.TEDU_BOARD_H5_PPT_MEDIA_STATUS_AUTHORITY_DONE,r=t.fid,i=t.id,o=t.currentTime;this.event.fireH5pptMediaStatusChangedEvent({fileId:r,mediaId:i,status:e,currentTime:o})}},e.prototype.getFileInfo=function(t){return this.board.getFileInfo(t)},e.prototype.getCurrentFile=function(){return this.board.getCurrentFile()},e.prototype.getCurrentBoard=function(){return this.board.getCurrentBoard()},e.prototype.render=function(t,e){var r,i;return void 0===e&&(e=!1),hh(this,void 0,void 0,(function(){var o,n,a,s,l,c,h,u,d,p,f,g,m,y,v,_,E=this;return uh(this,(function(T){switch(T.label){case 0:if(o=t.type||M.FILE_TYPE.IMG,n="",n="test000111"==this.identifier?"https://ppt2h5-1400127140.qcloudtiw.com/gs0nfrlkcoqk4dq41ulc/index.html":t.downloadURL,a=t.currentPageIndex,s=t.currentPageStep,l=t.fid,this.settingConfig.isDiscussionGroupMode&&(c=this.store.getDiscussionGroupIdByUserId(this.identifier),h=c.length)){if(u=this.store.getDiscussionGroupInfoById(c[0]),h>1)for(d=u.getUpdateTimestamp(),p=1;p<h;p++)f=this.store.getDiscussionGroupInfoById(c[p]),(g=f.getUpdateTimestamp())>d&&(d=g,u=f);l=Ot(u.getCurrentBoard()),(m=this.getFileInfo(l))&&(o=m.type||M.FILE_TYPE.IMG,n=m.downloadURL||"",t=m,a=u.currentPage,s=u.currentStep)}return o!=M.FILE_TYPE.H5PPT||l&&l!=this.checkH5PPTStatus.fid?(1===this.checkH5PPTStatus.status&&(this._reportLog("ppt_status_cancel",this.checkH5PPTStatus.fid,{fid:this.checkH5PPTStatus.fid,url:n,status:this.checkH5PPTStatus.status,retryTimes:this.checkH5PPTStatus.retryTimes}),this.event.fireH5pptStatusChangedEvent(ah.TEDU_BOARD_H5_PPT_STATUS_CANCEL,{fid:this.checkH5PPTStatus.fid,message:""}),this.checkH5PPTStatus.status=3),clearTimeout(this.checkH5PPTStatus.task),clearTimeout(this.heartbeat),this.pptUrlChecker&&(this.pptUrlChecker.cancelChecker(),this.pptUrlChecker=null),(null===(r=this.board.iframeDOM)||void 0===r?void 0:r.src)&&this.resetPPTIframe(),[4,bs.destroy()]):[3,2];case 1:T.sent(),this.checkH5PPTStatus.fid="",this.checkH5PPTStatus.status=0,this.checkH5PPTStatus.task=0,this.checkH5PPTStatus.retryTimes=0,T.label=2;case 2:return this.getCurrentFile()==M.COMMON_GROUP?[3,9]:(y=this.board.iframeDOM.getAttribute("originSrc")||"",o===M.FILE_TYPE.H5PPT&&n?"WPS"!==q(t.downloadURL)?[3,3]:(this.board.transcodeEl.style.zIndex="8",this.board.iframeDOM.style.zIndex="7",this.board.isRenderFace=e,this.board.preloadTriggered=!0,this.renderCosTranscode(t),[3,5]):[3,6]);case 3:return[4,bs.destroy()];case 4:if(T.sent(),this.board.transcodeEl.style.zIndex="7",this.board.iframeDOM.style.zIndex="8",void 0,v=y&&y.indexOf("?")>-1?y.substring(0,y.indexOf("?")):y,_="",_=n.indexOf("?")>-1?n.substring(0,n.indexOf("?")):n,_=L.replaceAssetsProtocol(_),v!=_){if(this.pptUrlChecker)return[2];this.pptUrlChecker=new sn({domainMap:this.store.getDomainMap(),accessibleDomains:this.store.getAccessibleDomains()}),this.board.progress.style.display="block",this.pptUrlChecker.run(_,3e3,(function(t){E.pptUrlChecker=null,t?E.store.addAccessibleDomain(t):t=_,(E.checkH5PPTStatus.fid!==l||(1!==E.checkH5PPTStatus.status||0!==E.checkH5PPTStatus.retryTimes)&&2!==E.checkH5PPTStatus.status&&3!==E.checkH5PPTStatus.status)&&(E.store.downGradeH5PPtMap.get(E.checkH5PPTStatus.fid)||(E.board.iframeDOM.removeAttribute("src"),E.board.iframeDOM.removeAttribute("originSrc"),t+="".concat(t.includes("?")?"&":"?","page=").concat(a,"&step=").concat(s,"&fid=").concat(encodeURIComponent(l)),E.forceRefresh&&(t+="&ts=".concat(Wt.getTimeStamp())),t+="&originUrl=".concat(encodeURIComponent(_),"&uniqBid=").concat(E.instanceKey),E.forceRefresh&&(t+="&ts=".concat(Wt.getTimeStamp())),E.board.iframeDOM.setAttribute("src",t),E.board.iframeDOM.setAttribute("originSrc",_),E.board.iframeDOM.isLoaded=!1,E._reportLog("iframe_start_load",l,{url:t,status:E.checkH5PPTStatus.status,retryTimes:E.checkH5PPTStatus.retryTimes}),0===E.checkH5PPTStatus.status&&E.event.fireH5pptStatusChangedEvent(ah.TEDU_BOARD_H5_PPT_STATUS_LOADING,{fid:l,message:""}),E.checkH5PPTStatus.fid=l,E.checkH5PPTStatus.status=1,clearTimeout(E.checkH5PPTStatus.task),clearTimeout(E.heartbeat),function(e){var r=1e3*E.board.option.config.h5PPTLoadTimeout*(E.checkH5PPTStatus.retryTimes+1);E.checkH5PPTStatus.task=window.setTimeout((function(){1===E.checkH5PPTStatus.status&&E.checkH5PPTStatus.fid===e&&(E.checkH5PPTStatus.retryTimes>2?(E._reportLog("ppt_status_timeout",e,{url:t,status:E.checkH5PPTStatus.status,retryTimes:E.checkH5PPTStatus.retryTimes}),E.event.fireH5pptStatusChangedEvent(ah.TEDU_BOARD_H5_PPT_STATUS_TIMEOUT,{fid:e,message:"ppt loading timeout"}),E.checkH5PPTStatus.status=4,E.checkH5PPTStatus.retryTimes=0,E.resetPPTIframe(),E.board.progress.style.display="none"):(++E.checkH5PPTStatus.retryTimes,E.board.refresh(!1)),E.store.networkSniffer(t,"get",5e3))}),r)}(l),E.board.isRenderFace=e,E.board.preloadTriggered=!0))}))}T.label=5;case 5:return[3,8];case 6:return this.resetPPTIframe(),clearTimeout(this.checkH5PPTStatus.task),clearTimeout(this.heartbeat),this.checkH5PPTStatus.fid="",this.checkH5PPTStatus.status=0,this.checkH5PPTStatus.task=0,this.checkH5PPTStatus.retryTimes=0,this.timeOutTimes=0,[4,bs.destroy()];case 7:T.sent(),T.label=8;case 8:return[3,11];case 9:return(null===(i=this.board.iframeDOM)||void 0===i?void 0:i.src)&&this.resetPPTIframe(),clearTimeout(this.checkH5PPTStatus.task),clearTimeout(this.heartbeat),this.checkH5PPTStatus.fid="",this.checkH5PPTStatus.status=0,this.checkH5PPTStatus.task=0,this.checkH5PPTStatus.retryTimes=0,[4,bs.destroy()];case 10:T.sent(),T.label=11;case 11:return[2]}}))}))},e.prototype.renderCosTranscode=function(t){return hh(this,void 0,void 0,(function(){var e,r,i,o=this;return uh(this,(function(n){switch(n.label){case 0:return e=t.fid,r=t.type,i=t.downloadURL,this.board.isRenderFace||bs.instance&&bs.instance.originUrl===i?[2]:r===M.FILE_TYPE.H5PPT&&i?[4,bs.destroy()]:[3,2];case 1:return n.sent(),this.checkH5PPTStatus.status=1,this.checkH5PPTStatus.fid=e,this.checkH5PPTStatus.task=0,this.checkH5PPTStatus.retryTimes=0,bs.getInstance({sdkAppId:0,userId:0,version:"",progressBarUrl:"",url:i,fid:e,fileInfo:t,logger:this.logger,slideStepChangeCallback:function(e){var r=o.store.getH5PPTOperator(e.fid,e.slideIndex,e.stepIndex);r||(r=o.identifier),o.store.switchH5Board(e,r),o.store.deleteH5PPTOperator(e.fid,e.slideIndex,e.stepIndex),(t=o.getFileInfo(e.fid))&&t.slideStepData&&o.event.fireGotoStepEvent(e.stepIndex,t.slideStepData[e.slideIndex+""])},triggerPlayEventCallback:function(t){o._reportLog("ppt_action",t.fid,ch({type:"triggerPlayEvent"},t)),o.store.wpsPptAction(t,"triggerPlayEvent")},slideMediaChangedCallback:function(t){o._reportLog("ppt_action",t.fid,ch({type:"slideMediaChanged"},t)),o.store.wpsPptAction(t,"slideMediaChanged")},slideMediaStatusChangedCallback:function(t){var r=t.isMediaPlay?sh.TEDU_BOARD_H5_PPT_MEDIA_STATUS_PLAY:sh.TEDU_BOARD_H5_PPT_MEDIA_STATUS_PAUSE,i=t.id,n=t.currentTime;o.event.fireH5pptMediaStatusChangedEvent({fileId:e,mediaId:i,status:r,currentTime:n})},onReady:function(t){1===o.checkH5PPTStatus.status&&o.checkH5PPTStatus.fid===t.fid&&(o.checkH5PPTStatus.status=2,o.checkH5PPTStatus.task=0,o.checkH5PPTStatus.retryTimes=0,o.event.fireH5pptStatusChangedEvent(ah.TEDU_BOARD_H5_PPT_STATUS_LOADED,{fid:t.fid,message:""}))}},this.board.transcodeEl,this.instanceKey),[3,4];case 2:return[4,bs.destroy()];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},e.prototype.addH5PPTFile=function(t,e,r){var i=this;this._reportLog("addH5PPTFile","",{url:t,title:e,needSwitch:r}),this.board.inputBlur();var o="#".concat(Wt.getTimeStamp());this.addFileNeedSwitchMap[o]=null==r||r;var n=this.store.isFileUrlExist(t);if(n){t&&t.indexOf("?")>-1&&(t=t.substring(0,t.indexOf("?")));var a=this.getFileInfo(n);return o=a.fid,setTimeout((function(){i.event.fireWarningEvent($.TEDU_BOARD_WARNING_H5PPT_ALREADY_EXISTS,o),i._reportLog("h5ppt_already_exists",o,{url:t})}),0),o}var s=t=L.replaceAssetsProtocol(t),l=o.replace("#","");return this.taskIdTitleMap[l]=e,new sn({domainMap:this.store.getDomainMap(),accessibleDomains:this.store.getAccessibleDomains()}).run(s,1e3*this.board.option.config.h5PPTLoadTimeout,(function(t){var e;t?i.store.addAccessibleDomain(t):t=s,t+="".concat(t.includes("?")?"&":"?","page=0&step=0&fid=").concat(encodeURIComponent(o),"&originUrl=").concat(encodeURIComponent(s),"&uniqBid=").concat(i.instanceKey),(e=document.createElement("iframe")).id="preiframe-".concat(l),e.setAttribute("class","tx_board_pre_iframe"),e.setAttribute("style","position:fixed;visibility:hidden;width:0px;height:0px;border:none;"),document.body.appendChild(e),i.board.isRenderFace=!1,i._reportLog("iframe_pre_start_load",o,{url:t});var r=i,n=null,a=function(r){if(void 0===r&&(r=0),r>2)return clearTimeout(n),e.removeAttribute("src"),void setTimeout((function(){i.event.fireH5pptStatusChangedEvent(ah.TEDU_BOARD_H5_PPT_STATUS_ADD_TIMEOUT,o),i._reportLog("h5_ppt_add_fail",o,{boardId:i.getCurrentBoard(),fileId:o,extraInfo:t})}),0);var s=t.indexOf("?")>-1?"&":"?";n=setTimeout((function(){e.setAttribute("src",t+s+"try=".concat(r+1)),a(r+1)}),1e4*(r+1))};e.onload=function(){clearTimeout(n),""===e.src||e.src&&(jn.init(e,r.seqUtil.getSeq(),{isFirstLoad:!0,loadTimeout:1e3*i.board.option.config.h5PPTLoadTimeout,resourceTimeout:1e3*i.board.option.config.h5PPTResourceTimeout,isForceRefresh:i.forceRefresh}),r._reportLog("iframe_pre_load_done",o,{url:e.src}))},e.setAttribute("src",t),a()})),o},e.prototype.pptIframeOnLoad=function(){var t=this.board.iframeDOM.src;if(t===M.ABOUTBLANK);else if(t){var e=re(decodeURIComponent(t)).fid;this._reportLog("iframe_load_done",e,{url:t,status:this.checkH5PPTStatus.status,retryTimes:this.checkH5PPTStatus.retryTimes}),this.store.setNeedDraw(!0),this.board.iframeDOM.isLoaded=!0,jn.init(this.board.iframeDOM,this.seqUtil.getSeq(),{isFirstLoad:!0,loadTimeout:1e3*this.board.option.config.h5PPTLoadTimeout,resourceTimeout:1e3*this.board.option.config.h5PPTResourceTimeout,isForceRefresh:this.forceRefresh}),this.board.progress.style.display="none"}this.store.preloadBoard()},e.prototype.resetPPTStatus=function(){this.checkH5PPTStatus={fid:"",status:0,task:0,retryTimes:0}},e.prototype.resetPPTIframe=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),(e||t)&&(this.timeOutTimes=0),this.forceRefresh=t;var r=this.board;r.iframeDOM&&r.iframeDOM.remove(),r.iframeDOM=an.createElement({sdkAppId:this.sdkAppId,userId:this.identifier,progressBarUrl:r.progressBarUrl,isLocalMode:r.option.enableLocalMode,domainBackup:this.store.getDomainMap()}),r.iframeDOM.id=String(this.seqUtil.getSeq()),this.store.setIframeDom(r.iframeDOM),r.iframeDOM.onload=this.pptIframeOnLoad.bind(this),r.boardBox.appendChild(r.iframeDOM)},e.prototype._reportLog=function(t,e,r){try{R(r.url)&&(r.url=L.reReplaceAssetsProtocol(r.url)),this.logger.reportInfo(this.loggerModuleName,t,{param:{boardId:this.getCurrentBoard(),fileId:e,extraInfo:JSON.stringify(r)}},ea.ONLY_ONLINE)}catch(t){}},e.prototype.operatorDownGradeFile=function(t,e,r){void 0===r&&(r=!1);var i=this.store.downGradeH5PPtMap.get(t)||!1;if(this.oldPageIndex,i){var o={seq:0,fid:t,slideIndex:e,stepIndex:0,resetStep:!0,usePrevNextStepMethod:2},n=this.store.getH5PPTOperator(o.fid,o.slideIndex,o.stepIndex);n||(n=this.identifier),this.store.switchH5Board(o,n,!0),this.store.deleteH5PPTOperator(o.fid,o.slideIndex,o.stepIndex),this.event.fireGotoStepEvent(0,1),this.forceRefresh=!1,(this.oldPageIndex!=o.slideIndex||r)&&(this.oldPageIndex=o.slideIndex,this.store.downGradeH5PPtMap.get(o.fid)&&this.event.fireH5PPtDownGradeInernalOperatorEvent(o.fid,o.slideIndex))}},e.prototype.cancelDownGradeFile=function(){this.timeOutTimes=0,this.oldPageIndex=-1},e.prototype.updateMediaInfo=function(t){var e,r,i=t.fid,o=t.mediaID,n=t.type,a=t.slideIndex,s=this.getFileInfo(),l=s.currentPageIndex,c=s.fid,h=s.pptMediaInfo,u=void 0===h?{}:h,d=s.pptSlideAudioMap,p=void 0===d?{}:d;if(i===c){var f=ch({},u),g="".concat(n,"IDList"),m={fid:i};if("video"===n)if(f[g]){if(f[g].includes(o))return;f[g]=ph(ph([],function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}(f[g]),!1),[o],!1)}else f[g]=[o];if("audio"===n){var y=null!==(r=p[a])&&void 0!==r?r:[];y.includes(o)||(y.push(o),m.pptSlideAudioMap=ch(ch({},p),((e={})[a]=y,e))),l===a&&(f[g]=y)}m.pptMediaInfo=ch({},f),this.store.updateFileInfo(m)}},e.prototype.destroy=function(){this.pptUrlChecker&&this.pptUrlChecker.cancelChecker(),this.pptUrlChecker=null},e}(X),gh=function(){function t(t){this.src=t,this.dom=null,this.isRepeatLoad=!1}return t.prototype.createElement=function(t,e,r,i){void 0===i&&(i=!1);var o=this.remove(t,e);o?(this.dom=o,this.isRepeatLoad=!0):(this.isRepeatLoad=!1,this.dom=document.createElement("iframe"),this.dom.classList.add("tic_board_h5_file"),this.dom.setAttribute("style","display: none; border: none; position: absolute; top: 0; left: 0; z-index: ".concat(i?6:25,";")),this.dom.src=e,this.dom.scrolling="auto",this.dom.onload=function(){r&&r()},t.appendChild(this.dom))},t.prototype.render=function(t){this.isRepeatLoad||t&&t(),this.dom&&(this.dom.style.display="block")},t.prototype.layout=function(t,e){this.dom&&(this.dom.width="".concat(t,"px"),this.dom.height="".concat(e,"px"))},t.prototype.remove=function(t,e){void 0===e&&(e="");for(var r=null,i=t.getElementsByClassName("tic_board_h5_file"),o=0,n=i.length;o<n;o++){var a=i[o],s=a.getAttribute("src");!e||s!=e&&s!=encodeURI(e)?a.remove():r=a}return r},t.prototype.removeAttribute=function(t){var e;null===(e=this.dom)||void 0===e||e.removeAttribute(t)},t.prototype.getAttribute=function(t){var e;return null===(e=this.dom)||void 0===e?void 0:e.getAttribute(t)},t.prototype.reset=function(){var t;if(this.dom){var e=this.dom.getAttribute("src");e&&(null===(t=this.dom)||void 0===t||t.setAttribute("src",e))}},t}(),mh={TEDU_BOARD_H5_FILE_STATUS_LOADING:1,TEDU_BOARD_H5_FILE_STATUS_LOADED:2},yh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),vh=function(t){function e(e,r,i){var o=t.call(this,e)||this;return o.board=r,o.store=i,o}return yh(e,t),e.prototype.render=function(t){var e=this,r=t.fid,i=t.type,o=t.downloadURL,n=!!t.h5FileEnableDraw;if(i===M.FILE_TYPE.H5FILE&&o){if(!this.h5Iframe||this.h5Iframe.src!=o){var a=this;this.h5Iframe&&(this.h5Iframe.remove(this.board.boardWrap),this.h5Iframe=null),this.h5Iframe=new gh(o),this.h5Iframe.createElement(this.board.boardWrap,o,(function(){o&&(a.event.fireH5FileStatusChangedEvent({fileId:r,status:mh.TEDU_BOARD_H5_FILE_STATUS_LOADED}),a.logger.reportInfo(a.loggerModuleName,"h5file_load_done",{param:{fileId:r,extraInfo:JSON.stringify({type:"H5_FILE",url:o})}},ea.ONLY_ONLINE))}),n);var s=this.board.boardWrap.clientWidth,l=this.board.boardWrap.clientHeight;this.h5Iframe.layout(s,l),this.h5Iframe.render((function(){e.event.fireH5FileStatusChangedEvent({fileId:r,status:mh.TEDU_BOARD_H5_FILE_STATUS_LOADING}),a.logger.reportInfo(a.loggerModuleName,"h5file_start_load",{param:{fileId:r,extraInfo:JSON.stringify({type:"H5_FILE",url:o})}},ea.ONLY_ONLINE)}))}}else this.h5Iframe&&(this.h5Iframe.remove(this.board.boardWrap),this.h5Iframe=null)},e.prototype.layout=function(t,e){var r;null===(r=this.h5Iframe)||void 0===r||r.layout(t,e)},e.prototype.resetH5IFrame=function(){this.h5Iframe&&this.h5Iframe.reset()},e}(X),_h=function(t){t.cancelable&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},Eh=r(181),Th=r.n(Eh),bh={START:1,END:0},Sh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),xh=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},wh=function(t){function e(e,r,i){var o=t.call(this,e)||this;return o.resizeTask=0,o.outsideMathTool=!1,o.board=r,o.store=i,o.zoomStatusMap={isShiftPressed:!1,isMouseDowned:!1,isMoved:!1,isWheeled:!1},o.isMoving=!1,o.selectToolType=0,o.isDragMoving=!1,o}return Sh(e,t),e.prototype.getFileInfo=function(t){return this.board.getFileInfo(t)},e.prototype.getCurrentFile=function(){return this.board.getCurrentFile()},e.prototype.getCurrentBoard=function(){return this.board.getCurrentBoard()},e.prototype.onKeyBoardEvent=function(){this.teduEventListener.addEventListener(document,"keydown",this.initKeyDownEvent.bind(this),!1),this.teduEventListener.addEventListener(document,"keyup",this.initKeyUpEvent.bind(this),!1)},e.prototype.initKeyDownEvent=function(t){if(16===t.keyCode||"Shift"===t.key)if(this.board._isZoomToolType())this.zoomStatusMap.isShiftPressed||(this.zoomStatusMap.isShiftPressed=!0,null!=this.board.scaleIcons.shrink&&(this.store.setCursorIcon(Xa.TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG,{cursor:"url",url:this.board.scaleIcons.shrink}),this.board.updateCursor()));else if(this.teduToolType.isGraphToolType()){if(!this.teduToolType.checkIfToolHasPermission(!0))return;var e=this.store.tiwData.getLatestElementByUserId(this.getCurrentBoard(),this.identifier);this.teduToolType.isRectToolType()?(this.board.setType(Xa.TEDU_BOARD_TOOL_TYPE_SQUARE),e&&"rect"===e.graph&&this.store.isDrawing&&(e.graph="square",e.endPoint=JSON.parse(JSON.stringify(this.store.graphEndPoint)),this.store.squareFix(e),this.store.setNeedDraw()),this.store.beforeToolType=Xa.TEDU_BOARD_TOOL_TYPE_RECT):this.teduToolType.isRectSolidToolType()?(this.board.setType(Xa.TEDU_BOARD_TOOL_TYPE_SQUARE_SOLID),e&&"rect"===e.graph&&this.store.isDrawing&&(e.graph="square",e.endPoint=JSON.parse(JSON.stringify(this.store.graphEndPoint)),this.store.squareFix(e),this.store.setNeedDraw()),this.store.beforeToolType=Xa.TEDU_BOARD_TOOL_TYPE_RECT_SOLID):this.teduToolType.isOvalToolType()?(this.board.setType(Xa.TEDU_BOARD_TOOL_TYPE_CIRCLE),e&&"oval"===e.graph&&this.store.isDrawing&&(e.graph="circle",e.endPoint=JSON.parse(JSON.stringify(this.store.graphEndPoint)),this.store.circleFix(M.MOUSE_TOUCH_ID,e),this.store.setNeedDraw()),this.store.beforeToolType=Xa.TEDU_BOARD_TOOL_TYPE_OVAL):this.teduToolType.isOvalSolidToolType()&&(this.board.setType(Xa.TEDU_BOARD_TOOL_TYPE_CIRCLE_SOLID),e&&"oval"===e.graph&&this.store.isDrawing&&(e.graph="circle",e.endPoint=JSON.parse(JSON.stringify(this.store.graphEndPoint)),this.store.circleFix(M.MOUSE_TOUCH_ID,e),this.store.setNeedDraw()),this.store.beforeToolType=Xa.TEDU_BOARD_TOOL_TYPE_OVAL_SOLID)}},e.prototype.initKeyUpEvent=function(t){if(16===t.keyCode||"Shift"===t.key)if(this.zoomStatusMap.isShiftPressed=!1,this.board._isZoomToolType())null!=this.board.scaleIcons.enlarge&&(this.store.setCursorIcon(Xa.TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG,{cursor:"url",url:this.board.scaleIcons.enlarge}),this.board.updateCursor()),this.board.scaleRatio=Math.abs(this.board.scaleRatio);else if(this.teduToolType.isGraphToolType()){if(!this.teduToolType.checkIfToolHasPermission(!1))return;if(this.store.beforeToolType!=this.store.initTypeConstant){var e=this.store.tiwData.getLatestElementByUserId(this.getCurrentBoard(),this.identifier);this.board.setType(this.store.beforeToolType),e&&"square"===e.graph&&this.store.isDrawing&&(e.graph="rect",e.endPoint=this.store.graphEndPoint,this.store.setNeedDraw()),e&&"circle"===e.graph&&this.store.isDrawing&&(e.graph="oval",e.endPoint=this.store.graphEndPoint,this.store.setNeedDraw()),this.store.beforeToolType=this.store.initTypeConstant}}},e.prototype.onVisibilityChange=function(){var t="visibilitychange";void 0!==document.hidden?t="visibilitychange":void 0!==document.mozHidden?t="mozvisibilitychange":void 0!==document.msHidden?t="msvisibilitychange":void 0!==document.webkitHidden&&(t="webkitvisibilitychange"),this.board.hidden=!1,this.teduEventListener.addEventListener(document,t,this._visibilityChange.bind(this))},e.prototype._visibilityChange=function(){"hidden"===document.visibilityState?(this.board.hidden=!0,this.store.setVisible(!1),this.logger.reportInfo(this.loggerModuleName,"move_background",{param:{}},ea.ONLY_ONLINE)):(this.board.hidden=!1,this.store.setVisible(!0),this.logger.reportInfo(this.loggerModuleName,"move_foreground",{param:{}},ea.ONLY_ONLINE),this.store.setNeedDraw(!0))},e.prototype.onWindowResize=function(){this.teduEventListener.addEventListener(window,"resize",this.windowResizeListener.bind(this))},e.prototype.windowResizeListener=function(){var t=this;this.resizeTask&&clearTimeout(this.resizeTask),this.resizeTask=window.setTimeout((function(){t.board.resize()}),50),this.board.reportContainerSize()},e.prototype.onWindowMessage=function(){this.teduEventListener.addEventListener(window,"message",this.windowMessageListener.bind(this),!1)},e.prototype.windowMessageListener=function(t){if(t.data){var e=t.data.module,r=t.data.cmd,i=t.data.data,o=t.data.uniqBid;if((F(o)||U(o)||o==this.instanceKey)&&on===e){var n=t.data.id;switch(r){case _a:this.store.h5WebAction(n,i)}}}},e.prototype.onMutationObserver=function(){MutationObserver&&this.board.container&&(this.containerMutationObserver=new MutationObserver(this.windowResizeListener.bind(this)),this.containerMutationObserver.observe(this.board.container,{attributes:!0,childList:!1,subtree:!1}))},e.prototype.onBoardDomEvent=function(){var t=this,e=function(){var e=t.board.interactionFlag.getDataByTouchId(M.MOUSE_TOUCH_ID);e.isTouchUp=!0,e.onoff=!1,t.board.updateCursor(),t.board.teduBoardScroll&&t.board.teduBoardScroll.enablePointerEvent()};this.teduEventListener.addEventListener(document.body,"mouseup",e.bind(this),!1),this.teduEventListener.addEventListener(window,"mouseup",e.bind(this),!1);var r=function(e){t.teduToolType.isEraserToolType()&&(t.store.eraseLayerCount=0);var r=e.target.classList;r.contains("tiw-scroll-vertical__wrap")||r.contains("tiw-scroll-horizontal__wrap")||t.board.teduBoardScroll&&t.board.teduBoardScroll.disablePointerEvent()};this.teduEventListener.addEventListener(document.body,"mousedown",r.bind(this),!0),this.teduEventListener.addEventListener(window,"mousedown",r.bind(this),!0),this.teduEventListener.addEventListener(window,"dblclick",function(e){var r=e.pageX,i=e.pageY,o=e.screenX,n=e.screenY,a=e.ctrlKey,s=e.shiftKey,l=e.altKey;t.logger.reportInfo(t.loggerModuleName,"dblclick",{param:{extraInfo:JSON.stringify({pageX:r,pageY:i,screenX:o,screenY:n,ctrlKey:a,shiftKey:s,altKey:l})}},ea.ONLY_ONLINE)}.bind(this),!0),this.teduEventListener.addEventListener(document.body,"touchstart",function(e){var r,i=e.targetTouches[0].target;i.classList.contains("tiw-scroll-vertical__wrap")||i.classList.contains("tiw-scroll-horizontal__wrap")||null===(r=t.board.teduBoardScroll)||void 0===r||r.disablePointerEvent()}.bind(this)),this.teduEventListener.addEventListener(document.body,"touchend",function(){var e;null===(e=t.board.teduBoardScroll)||void 0===e||e.enablePointerEvent()}.bind(this)),this.teduEventListener.addEventListener(this.board.boardWrap,"click",(function(e){if(_h(e),t.board.isDrawEnable()){var r=null,i=t.board.getEventLocation(e);i&&(r=i[M.MOUSE_TOUCH_ID],t.teduToolType.isMouseToolType()&&(t.settingConfig.mouseToolBehavior.turnPage.h5PPT?t._getPageAndStepPermission()&&jn.sendMouseEvent(t.board.iframeDOM,t.seqUtil.getSeq(),{type:e.type,x:r.x,y:r.y,touch:wt(e)}):!t.settingConfig.mouseToolBehavior.turnPage.h5PPT&&t.settingConfig.mouseToolBehavior.turnPage.audiovisual&&t._getPageAndStepPermission()&&jn.sendMouseEvent(t.board.iframeDOM,t.seqUtil.getSeq(),{type:e.type,x:r.x,y:r.y,touch:wt(e),turnPage:!1})))}}),!1);var i=null;this.teduEventListener.addEventListener(this.board.boardWrap,"wheel",(function(e){if(t.board._isZoomToolType()){if(!t.board.isDrawEnable())return;var r={};if(t.zoomStatusMap.isShiftPressed||e.shiftKey){if(t.board.enableScaleTool){if("number"==typeof e.wheelDeltaY){var o=function(){if(navigator.userAgent.toLowerCase().indexOf("macintosh")>-1)try{return document.createEvent("TouchEvent"),!1}catch(t){return!0}return!1}()?e.wheelDeltaX:e.wheelDeltaY,n=Math.floor(o/150*t.board.scaleRatio);t.board.focusScale(e,n),r={cursor:"url",url:n>0?t.board.scaleIcons.enlarge:t.board.scaleIcons.shrink}}t.store.setCursorIcon(Xa.TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG,r),t.board.updateCursor()}}else{if(t.settingConfig.isImageCursorEnable()||(r={cursor:"move",url:""}),i&&(clearTimeout(i),i=null),l=t.board.getCurrentBoard(),i=setTimeout((function(){!function(e){gt()?t.board.collectDragHandler.touchEnd(e,t.board.pinchScale,t.board.enableScaleTool):(t.board.collectDragHandler.end(e),t.board.enableScaleTool&&(r={cursor:"url",url:t.board.scaleIcons.enlarge},t.store.setCursorIcon(Xa.TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG,r),t.board.updateCursor()))}(l)}),200),e.shiftKey)return;var a=0,s=0;"number"==typeof e.wheelDeltaX&&0!==e.wheelDeltaX&&"number"==typeof e.wheelDeltaY&&0!==e.wheelDeltaY?(a=.6*e.wheelDeltaX,s=.6*e.wheelDeltaY):"number"==typeof e.wheelDeltaX&&0!==e.wheelDeltaX?a=.6*e.wheelDeltaX:e.altKey&&"number"==typeof e.wheelDeltaY&&0!==e.wheelDeltaY?a=.6*e.wheelDeltaY:"number"==typeof e.wheelDeltaY&&0!==e.wheelDeltaY&&(s=.6*e.wheelDeltaY),"number"!=typeof t.board.dragStartX&&(t.board.dragStartX=0,t.board.dragStartY=0),t.board.moveBoard(a,s),t.store.setCursorIcon(Xa.TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG,r),t.board.updateCursor()}}var l}),!1),this.teduEventListener.addEventListener(this.board.boardWrap,"mousedown",(function(e){t.board.interactionFlag.getDataByTouchId(M.MOUSE_TOUCH_ID).isTouchType="mouse";var r=t.board.getEventLocation(e);if(r){var i=r[M.MOUSE_TOUCH_ID];try{t.down(e,M.MOUSE_TOUCH_ID,i)}catch(e){t.board._reportEventException("mousedown",e)}}}),!1),this.teduEventListener.addEventListener(this.board.boardWrap,"mousemove",(function(e){t.board.interactionFlag.getDataByTouchId(M.MOUSE_TOUCH_ID).isTouchType="mouse";var r=t.board.getEventLocation(e);if(r){var i=r[M.MOUSE_TOUCH_ID];try{t.mouseMove(e,!1,M.MOUSE_TOUCH_ID,i)}catch(e){t.board._reportEventException("mousemove",e)}}}),!0),this.teduEventListener.addEventListener(this.board.boardWrap,"mouseup",(function(e){t.board.interactionFlag.getDataByTouchId(M.MOUSE_TOUCH_ID).isTouchType="mouse";var r=t.board.getEventLocation(e);if(r){var i=r[M.MOUSE_TOUCH_ID];try{t.up(e,M.MOUSE_TOUCH_ID,i)}catch(e){t.board._reportEventException("mouseup",e)}}}),!1),this.teduEventListener.addEventListener(this.board.boardWrap,"mouseleave",(function(e){t.board.interactionFlag.getDataByTouchId(M.MOUSE_TOUCH_ID).isTouchType="mouse";var r=t.board.getEventLocation(e);if(r){var i=r[M.MOUSE_TOUCH_ID];try{t.over(e,M.MOUSE_TOUCH_ID,i)}catch(e){t.board._reportEventException("mouseleave",e)}}}),!1),this.teduEventListener.addEventListener(document.body,"keydown",(function(e){t.board.interactionFlag.getDataByTouchId(M.MOUSE_TOUCH_ID).isTouchType="mouse",t.deleteContent(e)}),!1);var o=new Th.a(this.board.boardWrap,{}),n=null,a=null,s=new Set;o.on("touchStart",(function(e){if(!t.teduToolType.isMouseToolType()){var r=t.board.getEventLocation(e);r&&Object.keys(r).forEach((function(i){s.add(i),t.board.interactionFlag.getDataByTouchId(i).isTouchType="finger",t.board.pinchScale=[];var o=r[i];try{t.settingConfig.pinchToZoomEnable?(a||(a=e),clearTimeout(n),n=setTimeout((function(){n=null,t.down(a,i,o),a=null}),100)):t.down(e,i,o)}catch(e){t.board._reportEventException("touchStart",e)}}))}})),o.on("touchMove",(function(e){var r=t.board.getEventLocation(e);r&&Object.keys(r).forEach((function(i){if(s.has(i)){t.board.interactionFlag.getDataByTouchId(i).isTouchType="finger";var o=r[i];try{if(t.settingConfig.pinchToZoomEnable&&a&&!t.board.pinchScale.length&&(clearTimeout(n),t.down(a,i,o),a=null),o.x<0||o.x>1e4||o.y<0||o.y>1e4)return void t.up(e,i,o);t.mouseMove(e,!1,i,o)}catch(e){t.board._reportEventException("touchMove",e)}}}))})),o.on("touchEnd",(function(e){var r=t.board.getEventLocation(e);r&&Object.keys(r).forEach((function(i){s.delete(i),t.board.interactionFlag.getDataByTouchId(i).isTouchType="finger";var o=r[i];try{t.settingConfig.pinchToZoomEnable&&a&&!t.board.pinchScale.length&&(clearTimeout(n),t.down(a,i,o),a=null),t.up(e,i,o)}catch(e){t.board._reportEventException("touchEnd",e)}}))})),o.on("touchCancel",(function(e){var r=t.board.getEventLocation(e);r&&Object.keys(r).forEach((function(i){s.delete(i),t.board.interactionFlag.getDataByTouchId(i).isTouchType="finger";var o=r[i];try{t.settingConfig.pinchToZoomEnable&&a&&!t.board.pinchScale.length&&(clearTimeout(n),t.down(a,i,o),a=null),t.over(e,i,o)}catch(e){t.board._reportEventException("touchCancel",e)}}))})),o.on("pinch",(function(e){var r=t.board.getEventLocation(e);r&&Object.keys(r).forEach((function(i){t.board.interactionFlag.getDataByTouchId(i).isTouchType="finger";var o=r[i];if(!t.settingConfig.pinchToZoomEnable||t.board._isZoomToolType())t.board._isZoomToolType()&&t.board.pinchScale.push(e.zoom);else try{t.up(e,i,o),t.board.pinchScale.push(e.zoom),t.down(e,i,o)}catch(e){t.board._reportEventException("pinch",e)}}))})),o.on("singleTap",(function(e){if(t.teduToolType.isMouseToolType()){var r=null,i=t.board.getEventLocation(e);i&&Object.keys(i).forEach((function(o){r=i[o],_h(e),t.board.isDrawEnable()&&t.teduToolType.isMouseToolType()&&t.settingConfig.mouseToolBehavior.turnPage.h5PPT&&jn.sendMouseEvent(t.board.iframeDOM,t.seqUtil.getSeq(),{type:"click",x:r.x,y:r.y,touch:wt(e)})}))}}))},e.prototype.down=function(t,e,r){var i,o=this,n=this.board.viewContainer.getCanvasContext(),a=this.store.getColor(),s=this.store.getThin(),l=this.board.interactionFlag.getDataByTouchId(e),c=this;if(_h(t),clearTimeout(l.drawLineTimer),clearTimeout(l.autoFitTimer),this.board.multiTouch||"finger"!==l.isTouchType||this.store.collectRaserData().end(M.MOUSE_TOUCH_ID,-1e5,-1e5,this.teduToolType.toolType,!1),this.board.isDrawEnable())if(this.teduToolType.checkIfToolHasPermission(!0)){if(!Ht(t)||Gt(t)){var h=!1;this.outsideMathTool=!0;var u={x:r.ox,y:r.oy};if(this.store.getMathTool().forEach((function(e){e.show&&e.getBoardId()===o.board.getCurrentBoard()&&e.checkInContainer(u,t.target)&&(h=!0,o.outsideMathTool=!1)})),h)return this.store.hideLaserData(),l.inCanvas=!1,void(l.onoff=!1);var d=this.getFileInfo(this.getCurrentFile());if(d){if(G(d.type,d.h5FileEnableDraw)){var p=!1;if((this.teduToolType.isPointSelectToolType()||this.teduToolType.isRectSelectToolType())&&this.store.tiwData.getAllElements().forEach((function(t){t.subType===Ta.TEDU_BOARD_ELEMENT_AUDIO&&t.show&&t.pointImpactCheck([r.x,r.y])&&(p=!0)})),!p)return}if(this.zoomStatusMap.isMoved=!1,this.zoomStatusMap.isWheeled=!1,this.zoomStatusMap.isMouseDowned=!0,l.inCanvas=!0,l.onoff=!0,l.isTouchUp=!1,this.teduToolType.isMouseToolType()){if(d.type===M.FILE_TYPE.H5PPT)return void(this.settingConfig.mouseToolBehavior.turnPage.h5PPT?jn.sendMouseEvent(this.board.iframeDOM,this.seqUtil.getSeq(),{type:t.type,x:r.x,y:r.y,touch:wt(t)}):!this.settingConfig.mouseToolBehavior.turnPage.h5PPT&&this.settingConfig.mouseToolBehavior.turnPage.audiovisual&&this._getPageAndStepPermission()&&jn.sendMouseEvent(this.board.iframeDOM,this.seqUtil.getSeq(),{type:t.type,x:r.x,y:r.y,touch:wt(t),turnPage:!1}));if(d.fid===M.COMMON_GROUP)return void(this.settingConfig.mouseToolBehavior.turnPage.whiteBoard&&this.board.nextBoard());if(d.type===M.FILE_TYPE.IMG)return void(this.settingConfig.mouseToolBehavior.turnPage.imgPPT&&this.board.nextBoard());if(d.type===M.FILE_TYPE.IMAGESFILE)return void(this.settingConfig.mouseToolBehavior.turnPage.imgFile&&this.board.nextBoard())}if(this.teduToolType.isGraphAndGraffitiToolType()&&this.store.resetOperation(),l.cpx=-10,l.cpy=-10,l.oldx=l.startx=r.x,l.oldy=l.starty=r.y,this.board.dragStartX=r.clientX,this.board.dragStartY=r.clientY,this.teduToolType.isPenToolType()){var f=xh(this.findRecentMathToolElement(r.ox,r.oy),4),g=f[0],m=f[1],y=f[2],v=f[3];if(g){l.referenceMathTool[e]={needCorrect:!0,referenceElement:g,referenceLine:m,deltaX:y,deltaY:v};var _=this.board.getEventLocation(t);if(!_)return;r=_[e],l.oldx=l.startx=r.x,l.oldy=l.starty=r.y,this.board.dragStartX=r.clientX,this.board.dragStartY=r.clientY}else l.referenceMathTool[e]={needCorrect:!1,referenceElement:null,referenceLine:null,deltaX:0,deltaY:0}}var E=l.startx,T=l.starty,b=this.teduToolType;if(b.isPenToolType()||this.teduToolType.isHighLighterToolType()){St()?l.preLineTimestamp=Wt.getTimeStamp():l.preLineTimestamp=t.timeStamp||Wt.getTimeStamp(),l.preLinePoint={x:E,y:T},l.preSpeed=0,l.preWidth=s,l.pointCount=0,l.ignorePointCount=0,l.hasOptimizeStart=!1,l.hasOptimizeEnd=!0,this.store.collectRaserData().start(e,E,T,this.teduToolType.toolType),this.board.updateCursor(),this.store.cancelSelect();var S=l.referenceMathTool[e];if(this.event.fireDrawStatusChanged(bh.START),null==S?void 0:S.needCorrect)this.board.collectGraphHandler.start(e,E,T,Xa.TEDU_BOARD_TOOL_TYPE_LINE,S.referenceElement.lineType);else if(this.teduToolType.isHighLighterToolType())this.board.collectLineHandler.start(e,E,T,!1,!0),this.store.setNeedDraw(!0);else{this.board.collectLineHandler.start(e,E,T,this.store.isHandwritingEnable(),!1);var x=this.store.stashTempElementData.get(e);this.store.isHandwritingEnable()||ms.drawByCanvasRealTime(n,{newx:E,newy:T,color:a,thin:s,lineTransparent:x.lineTransparent,width:this.board.width,height:this.board.height,minLineWidth:this.board.minLineWidth,isOver:!1,isDot:!0,isNeedDraw:this.store.getShowGraffiti()})}}else if(b.isEraserToolType())if(this.store.cancelSelect(),2===this.store.eraserMode){this.store.setLineTransparent(!0);var w=Math.ceil(1e4*this.store.piecewiseErasureSize/this.board.height*2);this.board.collectLineHandler.start(e,E,T,!1,!0,w)}else this.board.collectEraserHandler.start(E,T,!0);else if(b.isLaserToolType());else if(b.isRectSelectToolType())this.selectToolType=1,this.board.collectMoverHandler.beforeStart(E,T)?this.isMoving=!0:(this.store.cancelSelect(),this.board.collectRectSelectHandler.start(E,T));else if(b.isPointSelectToolType())this.selectToolType=0,this.board.collectMoverHandler.beforeStart(E,T)&&(this.isMoving=!0);else if(b.isTextInputToolType()){var O;if(l.inCanvas=!1,l.onoff=!1,l.isTouchUp=!0,1===this.board.textInputStatus)return(O=this.board.textAreaFocusBlurStatus.focus)&&O.dom&&O.dom.blur(),void(this.board.textInputStatus=0);var I=void 0,A=r.ox,D=r.oy,C=r.x,P=r.y,L=A,R=D,N=this.store.getTextSize()/1e4*c.board.height/12,B=this.store.getTextSize(),k=this.board.collectTextInputHandler.start(C,Math.max(0,Math.min(P-B/2,1e4-B))),F=k.inputText,U=k.isNewItem;!U&&F.text?(null===(i=this.board.container)||void 0===i?void 0:i.querySelector("#tic-textarea__".concat(F.belongSeq)))&&(I=this.store.textAreaComponentMap[F.belongSeq]):(I=new bc(this.instanceKey,{boardId:this.getCurrentBoard(),getToolType:this.board.getToolType.bind(this),typeFace:this.store.getTextFontFamily(),isNeedDraw:this.store.getShowGraffiti()})).createElement(this.board.textAreaBox),I.initEvent({onfocus:function(t,e,r,i,o){void 0===o&&(o=!1);var n=t.textItem.text;if(t.textItem.isLocked())return t.dom.blur(),void(o||c.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENT_IS_LOCKED,t.textItem.getElementId()));if(c.store.isDrawEnable()&&c.permissionHandler.filter(n?"Element::Update::Text":"Element::Add::Text",[{creator:t.textItem.user}])){var a=t.textItem.belongSeq,s=t.dom&&t.dom.value,l=t.dom&&t.dom.style.left,h=t.dom&&t.dom.style.top,u=!!s;t.dom.setAttribute("has-origin-text",+u),c.board.textAreaFocusBlurStatus.focus=t,c.board.textInputStatus=1,c.store.updateDragDataFromTextTool(e,r,i),c.store.setNeedDraw(!0),o&&(c.board.mobileTempTextAreaComponent=t,c.event.fireTextElementStatusChangedEvent({status:"focus",id:String(a),value:s,left:parseFloat(l),top:parseFloat(h)}))}else t.dom.blur()},oninput:function(t,e,r,i){c.board.textInputStatus=1;var o=t.dom.value;c.board.collectTextInputHandler.inputting(t,t.textItem,o,t.dom.clientWidth+12,t.dom.clientHeight),c.store.updateDragDataFromTextTool(e,r,i),c.store.setNeedDraw(!0)},onblur:function(t){c.board.textAreaFocusBlurStatus.focus===t&&(c.board.textAreaFocusBlurStatus.focus=null),c.board.textInputStatus=0,c.store.cancelSelect();var e="",r=0;if(t.dom){var i=t.textItem.belongSeq,o=t.dom&&t.dom.style.left,n=t.dom&&t.dom.style.top;e=t.dom.value,r=+t.dom.getAttribute("has-origin-text"),t.isBlured||c.event.fireTextElementStatusChangedEvent({status:"blur",id:String(i),value:e,left:parseFloat(o),top:parseFloat(n)})}e?c.board.collectTextInputHandler.draw(t,t.textItem,e,t.dom.clientWidth+12,t.dom.clientHeight,!!r):r?(c.board.collectTextInputHandler.draw(t,t.textItem,e,t.dom.clientWidth+12,t.dom.clientHeight,!!r),delete c.store.textAreaComponentMap[t.textItem.belongSeq]):(delete c.store.textAreaComponentMap[t.textItem.belongSeq],c.board.collectTextInputHandler.clearTask(t)),t.textItem&&t.textItem.setBorder()},onresize:function(t){if(t.textItem){var e=t.textItem;t.textItem.setBorder(),t.setPosition(e.location.x/1e4*c.board.width,e.location.y/1e4*c.board.height),t.setMaxSize(),t.setFontScale(t.originFontScale)}},onlimit:function(){c.event.fireTextElementWarningEvent({code:Ic.TEDU_BOARD_TEXT_COMPONENT_STATUS_WORD_LIMIT,message:"the maximum word limit has been reached, unable to continue typing"})},onemoji:function(){c.event.fireTextElementWarningEvent({code:Ic.TEDU_BOARD_TEXT_COMPONENT_CANNOT_USE_EMOJI,message:"emoji input has been disabled"})}}),c.store.textAreaComponentMap[F.belongSeq]=I,U&&I&&(F.setBoardSize(this.board.width,this.board.height),I.setBoardContainerSize(this.board.width,this.board.container.offsetWidth,this.board.height,this.board.container.offsetHeight),I.setTextItem(F),I.setPosition(L,R),I.setFontSize(12),I.setMaxSize(),I.setFontScale(N),I.setSize(),I.focus()||(delete this.store.textAreaComponentMap[I.textItem.belongSeq],this.board.collectTextInputHandler.clearTask(I),this.store.tiwData.removeElement(F.belongSeq),this.event.fireTextElementWarningEvent({code:Ic.TEDU_BOARD_TEXT_COMPONENT_STATUS_INSUFFICIENT_SPACE,message:"not enough space to display the text component"})),!1===this.store.nextInputObj.keepFocus&&this.board.inputBlur())}else b.isGraphToolType()?(this.store.cancelSelect(),this.board.collectGraphHandler.start(e,E,T,this.teduToolType.toolType,-1)):this.board._isZoomToolType()?gt()?this.board.beforePinchScale=this.board.getBoardScale():(this.store.cancelSelect(),this.board.collectDragHandler.start(t)):b.isCustomGraphToolType()&&this.board.collectCustomGraphHandler.start(E,T);!0===this.isMoving&&this.board.collectMoverHandler.beforeStart(E,T)&&(this.isMoving=!0,this.board.collectMoverHandler.start(E,T))}}}else this.teduToolType.isTextInputToolType()&&1===this.board.textInputStatus&&((O=this.board.textAreaFocusBlurStatus.focus)&&O.dom&&O.dom.blur(),this.board.textInputStatus=0)},e.prototype.mouseMove=function(t,e,r,i){var o=this;void 0===e&&(e=!1);var n=this.store.getColor(),a=this.store.getThin(),s=this.board.viewContainer.getCanvasContext(),l=this.teduToolType,c=i.x,h=i.y;if(this.teduToolType.isTextInputToolType()){if(this.settingConfig.isImageCursorEnable()){var u=this.board.interactionFlag.getDataByTouchId(r);this.store.collectRaserData().draw(r,c,h,l.toolType,u.onoff,!1)}}else{_h(t);var d=this.teduToolType.checkIfToolHasPermission(!1);if(this.board.isDrawEnable()&&d&&(!Ht(t)||Gt(t))){var p=!1,f={x:i.ox,y:i.oy},g=this.board.interactionFlag.getDataByTouchId(r);if(this.store.getMathTool().forEach((function(e){e.getBoardId()===o.board.getCurrentBoard()&&(g.onoff&&o.outsideMathTool?e.updatePointerEventsAndCursor("none","inherit"):e.show&&e.checkInContainer(f,t.target)?(p=!0,e.updatePointerEventsAndCursor("auto")):e.updatePointerEventsAndCursor("none"))})),p)this.store.hideLaserData();else if(l.isMouseToolType())this.settingConfig.mouseToolBehavior.turnPage.h5PPT&&this._getPageAndStepPermission()&&jn.sendMouseEvent(this.board.iframeDOM,this.seqUtil.getSeq(),{type:t.type,x:c,y:h,touch:wt(t)}),this.settingConfig.isImageCursorEnable()&&this.store.collectRaserData().draw(r,c,h,l.toolType,g.onoff,!1);else{var m=this.getFileInfo(this.getCurrentFile());if(m&&!G(m.type,m.h5FileEnableDraw)){var y=i.clientX,v=i.clientY;if(g.onoff){if(l.isPenToolType()||l.isHighLighterToolType()){clearTimeout(g.drawLineTimer);var _=!1;(Math.abs(c-g.oldx)>10||Math.abs(h-g.oldy)>10)&&(_=!0),e||(g.drawLineTimer=setTimeout((function(){var e=t instanceof MouseEvent?new MouseEvent(t.type,t):new TouchEvent(t.type,t);o.mouseMove(e,!0,r,i)}),50));var E=null;try{if((E=this.store.stashTempElementData.get(r))&&!E.show)return this.over(t,r,i),void this.down(t,r,i)}catch(t){}if(!E)return;if(null===(N=g.referenceMathTool[r])||void 0===N?void 0:N.needCorrect)(B=this.board.collectGraphHandler.moving(r,c,h))&&N.referenceElement.setRealCmValue(B.getCmSize());else{var T=this.store.getPenFitSetting(),b=T.isAuto,S=T.delay;if(b&&_&&(clearTimeout(g.autoFitTimer),g.autoFitTimer=setTimeout((function(){o.board.collectLineHandler.end(r,c,h,a,o.store.isHandwritingEnable(),!0),o.store.fireCanRedoAndUndo(),g.isTouchUp=!0,g.onoff=!1,g.inCanvas=!1,"finger"===g.isTouchType&&o.store.collectRaserData().end(r,c,h,o.teduToolType.toolType,"finger"!==g.isTouchType)}),S)),l.isPenToolType()&&this.store.isHandwritingEnable())if(1===E.getPoints().length){var x=.236*(c-g.oldx)+g.oldx,w=.236*(h-g.oldy)+g.oldy;c=.618*(c-g.oldx)+g.oldx,h=.618*(h-g.oldy)+g.oldy,g.cpx=x,g.cpy=w,this.board.collectLineHandler.moving(r,x,w,a),this.lineOptimization(c,h,t,r)}else this.lineOptimization(c,h,t,r);else{var O=St()?Wt.getTimeStamp():t.timeStamp||Wt.getTimeStamp();if(g.pointCount++,this.board.enableLineOptimization){var I=g.preLinePoint;e&&(M=E.getPoints()).length>2&&(I=M[M.length-2]);var A=I.x-c,D=I.y-h,C=Math.sqrt(A*A+D*D);if(O-g.preLineTimestamp<16.7||C<5)return void g.ignorePointCount++}if(1===E.getPoints().length){x=.236*(c-g.oldx)+g.oldx,w=.236*(h-g.oldy)+g.oldy,c=.618*(c-g.oldx)+g.oldx,h=.618*(h-g.oldy)+g.oldy,g.cpx=x,g.cpy=w;var P=(g.cpx+c)/2,L=(g.cpy+h)/2;this.teduToolType.teduToolType.isPenToolType()&&ms.drawByCanvasRealTime(s,{oldx:g.oldx,oldy:g.oldy,cpx:g.cpx,cpy:g.cpy,lineTransparent:E.lineTransparent,endx:P,endy:L,color:n,thin:a,width:this.board.width,height:this.board.height,minLineWidth:this.board.minLineWidth,isNeedDraw:this.store.getShowGraffiti()}),g.oldx=P,g.oldy=L,this.board.collectLineHandler.moving(r,x,w,a)}g.preLineTimestamp=O,g.preLinePoint={x:c,y:h},this.board.collectLineHandler.moving(r,c,h,a),l.isHighLighterToolType()?this.store.setNeedDraw(!0):(g.cpx>=0&&g.cpy>=0&&(P=(g.cpx+c)/2,L=(g.cpy+h)/2,ms.drawByCanvasRealTime(s,{oldx:g.oldx,oldy:g.oldy,cpx:g.cpx,cpy:g.cpy,lineTransparent:E.lineTransparent,endx:P,endy:L,color:n,thin:a,width:this.board.width,height:this.board.height,minLineWidth:this.board.minLineWidth,isNeedDraw:this.store.getShowGraffiti()}),g.oldx=P,g.oldy=L),g.cpx=c,g.cpy=h)}}}else if(l.isEraserToolType())if(2===this.store.eraserMode){var M,R=Math.ceil(1e4*this.store.piecewiseErasureSize/this.board.height*2);E=null;try{if((E=this.store.stashTempElementData.get(r))&&!E.show)return this.over(t,r,i),void this.down(t,r,i)}catch(t){}if(!E)return;if(O=St()?Wt.getTimeStamp():t.timeStamp||Wt.getTimeStamp(),g.pointCount++,this.board.enableLineOptimization)if(I=g.preLinePoint,e&&(M=E.getPoints()).length>2&&(I=M[M.length-2]),A=I.x-c,D=I.y-h,C=Math.sqrt(A*A+D*D),O-g.preLineTimestamp<16.7||C<5)return void g.ignorePointCount++;1===E.getPoints().length&&(x=.236*(c-g.oldx)+g.oldx,w=.236*(h-g.oldy)+g.oldy,c=.618*(c-g.oldx)+g.oldx,h=.618*(h-g.oldy)+g.oldy,g.cpx=x,g.cpy=w,P=(g.cpx+c)/2,L=(g.cpy+h)/2,this.teduToolType.teduToolType.isPenToolType()&&ms.drawByCanvasRealTime(s,{oldx:g.oldx,oldy:g.oldy,cpx:g.cpx,cpy:g.cpy,lineTransparent:E.lineTransparent,endx:P,endy:L,color:n,thin:R,width:this.board.width,height:this.board.height,minLineWidth:this.board.minLineWidth,isNeedDraw:this.store.getShowGraffiti()}),g.oldx=P,g.oldy=L,this.board.collectLineHandler.moving(r,x,w,R)),g.preLineTimestamp=O,g.preLinePoint={x:c,y:h},this.board.collectLineHandler.moving(r,c,h,R),g.cpx>=0&&g.cpy>=0&&(P=(g.cpx+c)/2,L=(g.cpy+h)/2,ms.drawByCanvasRealTime(s,{oldx:g.oldx,oldy:g.oldy,cpx:g.cpx,cpy:g.cpy,lineTransparent:E.lineTransparent,endx:P,endy:L,color:n,thin:R,width:this.board.width,height:this.board.height,minLineWidth:this.board.minLineWidth,isNeedDraw:this.store.getShowGraffiti()}),g.oldx=P,g.oldy=L),g.cpx=c,g.cpy=h}else this.board.collectEraserHandler.move(c,h);else if(l.isRectSelectToolType()&&!this.isMoving||l.isPointSelectToolType()&&1===this.selectToolType)if(Math.abs(this.board.dragStartX-y)>1||Math.abs(this.board.dragStartY-v)>1){if(!g.inCanvas)return;this.board.collectRectSelectHandler.draw(c,h),this.selectToolType=1}else this.selectToolType=0;else if(l.isPointSelectToolType()&&!this.isMoving||l.isRectSelectToolType()&&0===this.selectToolType){if(Math.abs(this.board.dragStartX-y)>1||Math.abs(this.board.dragStartY-v)>1){if(!g.inCanvas)return;this.selectToolType=1,this.board.collectRectSelectHandler.start(c,h)}}else if(l.isGraphToolType()){var N,B=this.board.collectGraphHandler.moving(r,c,h);(null===(N=g.referenceMathTool[r])||void 0===N?void 0:N.needCorrect)&&B&&l.isGraphLineToolType()&&N.referenceElement.setRealCmValue(B.getCmSize())}else this.board._isZoomToolType()?(!1!==this.board.enableScaleTool||this.settingConfig.isImageCursorEnable()||(this.store.setCursorIcon(Xa.TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG,{cursor:"move",url:""}),this.board.updateCursor()),(Math.abs(this.board.dragStartX-y)>1||Math.abs(this.board.dragStartY-v)>1)&&(this.settingConfig.isImageCursorEnable()||(this.store.setCursorIcon(Xa.TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG,{cursor:"move",url:""}),this.board.updateCursor()),this.isDragMoving=!0,gt()&&this.board.pinchScale.length&&(this.settingConfig.pinchToZoomEnable||this.board.enableScaleTool)?this.board.collectDragHandler.scaleDraw(this.board.beforePinchScale,this.board.pinchScale):(this.board.collectDragHandler.draw(this.board.boardWrap,y-this.board.dragStartX,v-this.board.dragStartY),this.board.dragStartX=y,this.board.dragStartY=v,this.store.setNeedDraw(!0)))):l.isCustomGraphToolType()&&this.board.collectCustomGraphHandler.draw(g.startx,g.starty,c,h);this.isMoving&&(this.board.collectMoverHandler.draw(c,h,g.oldx,g.oldy),g.oldx=c,g.oldy=h)}else(l.isPenToolType()||l.isEraserToolType())&&this.board.updateCursor(),g.isTouchUp||l.isPenToolType()&&this.down(t,r,i);if(l.isLaserToolType()||l.isPenToolType()||l.isHighLighterToolType()||l.isEraserToolType()){var k=this.board.isRaserValid(r)&&((l.isPenToolType()||l.isHighLighterToolType())&&(this.store.lineFitMode===xs.NONE||this.store.enableLineAutoFit)||l.isLaserToolType());this.store.collectRaserData().draw(r,c,h,l.toolType,g.onoff,k)}else this.settingConfig.isImageCursorEnable()&&this.store.collectRaserData().draw(r,c,h,l.toolType,g.onoff,!1)}}}}},e.prototype.up=function(t,e,r){var i=this,o=this.store.getColor(),n=this.store.getThin(),a=this.teduToolType,s=this.board.viewContainer.getCanvasContext();_h(t);var l=this.board.interactionFlag.getDataByTouchId(e);clearTimeout(l.drawLineTimer),clearTimeout(l.autoFitTimer),this.zoomStatusMap.isMouseDowned=!1;var c=this.teduToolType.checkIfToolHasPermission(!1);if(this.board.isDrawEnable()&&c){if(!Ht(t)||Gt(t)){var h=this.getFileInfo(this.getCurrentFile());if(h){if(G(h.type,h.h5FileEnableDraw)){var u=!1;if((this.teduToolType.isPointSelectToolType()||this.teduToolType.isRectSelectToolType())&&this.store.tiwData.getAllElements().forEach((function(t){t.subType===Ta.TEDU_BOARD_ELEMENT_AUDIO&&t.show&&t.pointImpactCheck([r.x,r.y])&&(u=!0)})),!u)return this.board.collectPointSelectHandler.end(r.x,r.y,l.isTouchType),void this.store.cancelSelect()}if(this.store.getMathTool().forEach((function(t,e){t.getBoardId()===i.board.getCurrentBoard()&&t.updatePointerEventsAndCursor("auto","auto")})),this.outsideMathTool=!0,l.isTouchUp=!0,l.onoff=!1,a.isMouseToolType())this.settingConfig.mouseToolBehavior.turnPage.h5PPT?jn.sendMouseEvent(this.board.iframeDOM,this.seqUtil.getSeq(),{type:t.type,x:r.x,y:r.y,touch:wt(t)}):!this.settingConfig.mouseToolBehavior.turnPage.h5PPT&&this.settingConfig.mouseToolBehavior.turnPage.audiovisual&&this._getPageAndStepPermission()&&jn.sendMouseEvent(this.board.iframeDOM,this.seqUtil.getSeq(),{type:t.type,x:r.x,y:r.y,touch:wt(t),turnPage:!1});else{var d=r.x,p=r.y,f=r.clientX,g=r.clientY;if(a.isPenToolType()||a.isHighLighterToolType()){if(!l.inCanvas)return void("finger"===l.isTouchType&&this.store.collectRaserData().end(e,d,p,this.teduToolType.toolType,"finger"!==l.isTouchType));var m=l.referenceMathTool[e];this.event.fireDrawStatusChanged(bh.END),(null==m?void 0:m.needCorrect)?(E=this.board.collectGraphHandler.end(e,d,p))&&m.referenceElement.setRealCmValue(E.getCmSize()):(1===(v=this.store.stashTempElementData.get(e)).getPoints().length&&(l.cpx=d,l.cpy=p),a.isPenToolType()&&this.store.isHandwritingEnable()?(l.hasOptimizeEnd=!1,this.lineOptimization(d,p,t,e)):(this.board.collectLineHandler.end(e,d,p,n,!1),a.isHighLighterToolType()?this.store.setNeedDraw(!0):ms.drawByCanvasRealTime(s,{newx:d,newy:p,cpx:l.cpx,cpy:l.cpy,oldx:l.oldx,oldy:l.oldy,lineTransparent:v.lineTransparent,color:o,thin:n,width:this.board.width,height:this.board.height,minLineWidth:this.board.minLineWidth,isOver:!0,isNeedDraw:this.store.getShowGraffiti()}))),"finger"===l.isTouchType&&this.store.collectRaserData().end(e,d,p,a.toolType,"finger"!==l.isTouchType)}else if(a.isEraserToolType())if(2===this.store.eraserMode){var y=Math.ceil(1e4*this.store.piecewiseErasureSize/this.board.height*2);if(!l.inCanvas)return void("finger"===l.isTouchType&&this.store.collectRaserData().end(e,d,p,this.teduToolType.toolType,"finger"!==l.isTouchType));var v,_=l.referenceMathTool[e];this.event.fireDrawStatusChanged(bh.END),(null==_?void 0:_.needCorrect)?(E=this.board.collectGraphHandler.end(e,d,p))&&_.referenceElement.setRealCmValue(E.getCmSize()):(1===(v=this.store.stashTempElementData.get(e)).getPoints().length&&(l.cpx=d,l.cpy=p),a.isPenToolType()&&this.store.isHandwritingEnable()?(l.hasOptimizeEnd=!1,this.lineOptimization(d,p,t,e,!1,y)):(this.board.collectLineHandler.end(e,d,p,y,!1),a.isHighLighterToolType()?this.store.setNeedDraw(!0):ms.drawByCanvasRealTime(s,{newx:d,newy:p,cpx:l.cpx,cpy:l.cpy,oldx:l.oldx,oldy:l.oldy,lineTransparent:v.lineTransparent,color:o,thin:y,width:this.board.width,height:this.board.height,minLineWidth:this.board.minLineWidth,isOver:!0,isNeedDraw:this.store.getShowGraffiti()}))),"finger"===l.isTouchType&&this.store.collectRaserData().end(e,d,p,a.toolType,"finger"!==l.isTouchType)}else this.board.collectEraserHandler.end(d,p),"finger"===l.isTouchType&&this.store.collectRaserData().end(e,d,p,a.toolType,!1);else if(a.isLaserToolType())this.store.collectRaserData().end(e,d,p,a.toolType,!("finger"===l.isTouchType||a.isPenToolType()&&(this.store.lineFitMode!==xs.NONE||!this.store.enablePenAutoFit)));else if(a.isRectSelectToolType()&&!this.isMoving)if(1===this.selectToolType&&0===Math.abs(this.board.dragStartX-f)&&0===Math.abs(this.board.dragStartY-g)&&(this.selectToolType=0),1===this.selectToolType){if(!l.inCanvas)return;this.board.collectRectSelectHandler.end(l.startx,l.starty,d,p)}else this.board.collectPointSelectHandler.end(d,p,l.isTouchType);else if(a.isPointSelectToolType()&&!this.isMoving)if(1===this.selectToolType){if(!l.inCanvas)return;this.board.collectRectSelectHandler.end(l.startx,l.starty,d,p)}else this.board.collectPointSelectHandler.end(d,p,l.isTouchType);else if(a.isGraphToolType()){if(!l.inCanvas)return;var E=this.board.collectGraphHandler.end(e,d,p),T=l.referenceMathTool[e];(null==T?void 0:T.needCorrect)&&E&&a.isGraphLineToolType()&&T.referenceElement.setRealCmValue(E.getCmSize())}else this.board._isZoomToolType()?(this.isDragMoving?this.zoomStatusMap.isMoved=!0:this.zoomStatusMap.isMoved=!1,this.isDragMoving=!1,gt()?this.board.collectDragHandler.touchEnd(this.getCurrentBoard(),this.board.pinchScale):this.zoomStatusMap.isMoved?(this.board.collectDragHandler.end(),null!=this.board.scaleIcons.enlarge&&this.board.enableScaleTool&&(this.store.setCursorIcon(Xa.TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG,{cursor:"url",url:this.board.scaleIcons.enlarge}),this.board.updateCursor())):this.board.enableScaleTool&&(this.zoomStatusMap.isShiftPressed&&(this.board.scaleRatio=-Math.abs(this.board.scaleRatio)),this.board.focusScale(t,this.board.scaleRatio))):a.isCustomGraphToolType()&&this.board.collectCustomGraphHandler.end();var b=l.referenceMathTool[e];b&&(b.needCorrect=!1,b.referenceElement=null,b.referenceLine=null),this.isMoving&&(this.isMoving=!1,this.board.collectMoverHandler.end()),l.inCanvas=!1,this.store.fireCanRedoAndUndo()}}}}else this.store.collectRaserData().end(e,0,0,a.toolType,!1)},e.prototype.over=function(t,e,r){var i=this,o=this.store.getColor(),n=this.board.viewContainer.getCanvasContext();_h(t);var a=this.board.interactionFlag.getDataByTouchId(e);if(clearTimeout(a.drawLineTimer),clearTimeout(a.autoFitTimer),this.board.isDrawEnable()&&(!Ht(t)||Gt(t))){var s=this.getFileInfo(this.getCurrentFile());if(s&&!G(s.type,s.h5FileEnableDraw)){var l=this.teduToolType;this.store.getMathTool().forEach((function(t,e){t.getBoardId()===i.board.getCurrentBoard()&&t.updatePointerEventsAndCursor("auto","auto")})),this.outsideMathTool=!0;var c=r.x,h=r.y;if(l.isMouseToolType())return this.settingConfig.mouseToolBehavior.turnPage.h5PPT&&jn.sendMouseEvent(this.board.iframeDOM,this.seqUtil.getSeq(),{type:t.type,x:c,y:h,touch:wt(t)}),void(this.settingConfig.isImageCursorEnable()&&this.store.collectRaserData().over(e,l.toolType));if(!0===a.onoff){var u=void 0;if(l.isPenToolType()||l.isHighLighterToolType()){var d=a.referenceMathTool[e];if(null==d?void 0:d.needCorrect)(m=this.board.collectGraphHandler.leave(e,c,h))&&d.referenceElement.setRealCmValue(m.getCmSize());else{u=this.store.getThin(),c=qt(c,u),h=qt(h,u);var p=this.store.stashTempElementData.get(e);if(l.isPenToolType()&&this.store.isHandwritingEnable())1===p.getPoints().length&&(a.cpx=c,a.cpy=h),a.hasOptimizeEnd=!1,this.lineOptimization(c,h,t,e);else if(this.board.collectLineHandler.leave(e,c,h,u),l.isHighLighterToolType())this.store.setNeedDraw(!0);else{if(a.cpx>=0&&a.cpy>=0){var f=(a.cpx+c)/2,g=(a.cpy+h)/2;ms.drawByCanvasRealTime(n,{newx:c,newy:h,oldx:a.oldx,oldy:a.oldy,cpx:a.cpx,cpy:a.cpy,lineTransparent:p.lineTransparent,endx:f,endy:g,color:o,thin:u,width:this.board.width,height:this.board.height,minLineWidth:this.board.minLineWidth,isOver:!0,isNeedDraw:this.store.getShowGraffiti()}),a.oldx=f,a.oldy=g}a.cpx=c,a.cpy=h}}}else if(this.isMoving||!l.isRectSelectToolType()&&!l.isPointSelectToolType()){if(l.isGraphToolType()){u=this.store.getThin(),c=qt(c,u),h=qt(h,u);var m=this.board.collectGraphHandler.leave(e,c,h),y=a.referenceMathTool[e];(null==y?void 0:y.needCorrect)&&m&&l.isGraphLineToolType()&&y.referenceElement.setRealCmValue(m.getCmSize())}else if(this.board._isZoomToolType())gt()||this.board.collectDragHandler.over();else if(l.isCustomGraphToolType())this.board.collectCustomGraphHandler.end();else if(l.isEraserToolType())if(2===this.store.eraserMode){var v=Math.ceil(1e4*this.store.piecewiseErasureSize/this.board.height*2);this.board.collectLineHandler.leave(e,c,h,v)}else this.board.collectEraserHandler.end(c,h)}else{if(!a.inCanvas)return;this.board.collectRectSelectHandler.end(a.startx,a.starty,c,h)}this.isMoving&&(this.isMoving=!1,this.board.collectMoverHandler.end()),(l.isPenToolType()||l.isGraphToolType())&&(a.onoff=!1),this.store.fireCanRedoAndUndo()}else(l.isPenToolType()||l.isHighLighterToolType()||l.isEraserToolType())&&this.board.updateCursor();l.isLaserToolType()||l.isPenToolType()||l.isHighLighterToolType()||l.isEraserToolType()?(this.board.raserStatistic(e),this.store.collectRaserData().over(e,l.toolType)):this.settingConfig.isImageCursorEnable()&&this.store.collectRaserData().over(e,l.toolType),a.inCanvas=!1;var _=a.referenceMathTool[e];_&&(_.needCorrect=!1,_.referenceElement=null,_.referenceLine=null)}}},e.prototype.findRecentMathToolElement=function(t,e){var r=this,i=null,o=1/0,n=null,a=0,s=0,l=!1,c=gt()?40:20;if(this.store.getMathTool().forEach((function(a){if(a.show&&a.getBoardId()===r.board.getCurrentBoard()){var s=a.getCollisionArea();null==s||s.forEach((function(r,s){var l=Math.sqrt(Mt(t,e,r[0],r[1],r[2],r[3]));l<c&&l<o&&(i=a,o=l,n=r)})),l=!0}})),i&&n){var h=this.board.getBrushThin()*this.board.height/1e4/2,u=n[0],d=n[1],p=n[2],f=n[3],g=n[4],m=[p-u,f-d],y=Math.sqrt(Math.pow(m[0],2)+Math.pow(m[1],2));a=h*(m[0]*Math.cos(g)-m[1]*Math.sin(g))/y,s=h*(m[0]*Math.sin(g)+m[1]*Math.cos(g))/y}return[i,n,a,s,l]},e.prototype.deleteContent=function(t){this.board.isDrawEnable()&&(46!==t.keyCode&&"Delete"!==t.key&&8!==t.keyCode&&"Backspace"!==t.key||this.teduToolType.isSelectToolType()&&!this.isMoving&&(this.store.deleteSelectedData(ec.KEYBOARD),this.store.fireCanRedoAndUndo()))},e.prototype.lineOptimization=function(t,e,r,i,o,n){void 0===o&&(o=!1);var a=this.board.canvasCtx,s=n||this.store.getThin(),l=this.store.getColor(),c=this.board.interactionFlag.getDataByTouchId(i),h=t,u=e,d=St()?Wt.getTimeStamp():r.timeStamp||Wt.getTimeStamp(),p=c.preLinePoint.x-t,f=c.preLinePoint.y-e,g=Math.sqrt(p*p+f*f),m=d-c.preLineTimestamp;if(c.pointCount++,(m<16.7||g<5)&&c.hasOptimizeEnd)c.ignorePointCount++;else{var y=.1*g,v=g/m,_=s;0!=c.preSpeed&&(_=Math.min(c.preSpeed/v*s,s),Math.abs(c.preWidth-_)>y&&(_=c.preWidth<_?c.preWidth+y:c.preWidth-y)),_=Math.floor(_),a.save();var E=ms.lineOptimization(a,{newx:t,newy:e,oldx:c.oldx,oldy:c.oldy,cpx:c.cpx,cpy:c.cpy,curw:c.hasOptimizeEnd?_:M.MIN_LINE_WIDTH,prew:c.preWidth,thin:s,lineTransparent:o,hasOptimizeStart:c.hasOptimizeStart,hasOptimizeEnd:c.hasOptimizeEnd,divisorWidth:1e4/this.board.width,divisorHeight:1e4/this.board.height,color:l,minLineWidth:this.board.minLineWidth},"v1"),T=E.oldx,b=E.oldy,S=E.newx,x=E.newy;a.restore(),c.oldx=T,c.oldy=b,t=S,e=x,c.cpx=t,c.cpy=e,c.cpx>=0&&c.cpy>=0&&!c.hasOptimizeStart&&(c.hasOptimizeStart=!0),c.preLineTimestamp=d,c.preLinePoint={x:t,y:e},c.preSpeed=v,c.preWidth=_,c.hasOptimizeEnd?this.board.collectLineHandler.moving(i,t,e,_):(c.hasOptimizeEnd=!0,this.board.collectLineHandler.end(i,h,u,_,this.store.isHandwritingEnable()))}},e.prototype.destroy=function(){this.containerMutationObserver&&this.containerMutationObserver.disconnect(),this.containerMutationObserver=null},e.prototype._getPageAndStepPermission=function(){var t=xh(this.permissionHandler.filters(["Board::Switch::Step","Board::Switch::Page"],[[{operator:this.identifier}],[{operator:this.identifier}]]),2),e=t[0],r=t[1],i=!1;if(e&&!r){var o=this.board.getFileInfo(this.board.getCurrentFile());o.slideStepData[o.currentPageIndex]-1==o.currentPageStep&&(i=!0)}return!!r||!(!e||i)},e}(X),Oh={TEDU_BOARD_BACKGROUND_IMAGE:1,TEDU_BOARD_BACKGROUND_H5:2};function Ih(t){return t.then((function(t){return[null,t]})).catch((function(t){return[t,null]}))}var Ah=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},Dh=function(t){var e=document.querySelector("#".concat(t));null==e||e.remove()},Ch=function(t,e){for(var r=0,i=null,o=null;;){if(!(a=t.parentElement)||(i=a.getAttribute("slot"))){o=a;break}if(t=a,r++>20)break}var n=0;if(i&&o)for(;;){var a;if(!(a=o.parentElement))break;if(a.shadowRoot){var s=a.shadowRoot.querySelector('slot[name="'.concat(i,'"]'));if(s&&s.parentElement){var l=s.parentElement.getAttribute("style");l&&e.setAttribute("style",l+e.getAttribute("style"));break}}else o=a;if(n++>20)break}},Ph=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Lh=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},Mh=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Rh=function(t){function e(e,r){var i=t.call(this,e)||this;i.boardBackgroundCacheMap={},i.pptRemarks={},i.remoteIcons={},i.remoteCursorLayerMap={},i.drawLineMaxSeq={},i.textAreaFocusBlurStatus={},i.userTime={},i.needForRAF={},i.preloadTriggered=!1,i.pregressTask=0,i.pptH5LoadTask=0,i.piecewiseEnableHistoryStatus=!1,i.pinchToZoomEnableHistoryStatus=!1,i.stepTimeout=0,i.enableScaleTool=!0,i.canvasWidth=0,i.canvasHeight=0,i.option=i.formatInitParams(r);var o=i.option,n=o.config,a=o.userConfig,s=o.styleConfig,l=o.authConfig,c=o.customServerConfig;for(var h in i.setProxyServerMap(n.proxyServer),i.setCustomServerConfig(c),Ss.setCursorSize(s.cursorSize),Ss.setSelectBoxColor({color:s.selectBoxColor}),Ss.setSelectAnchorColor({color:s.selectAnchorColor}),i.settingConfig.setElementOpAuthConfig(l.elementOperationAuthority),i.settingConfig.setAutoHideRemoteCursor(l.isAutoHideRemoteCursor),i.settingConfig.setShowLocalOperator(l.showLocalOperator),i.settingConfig.setShowRemoteOperator(l.showRemoteOperator),i.settingConfig.setShowRemoteSelectBox(l.showRemoteSelectBox),i.settingConfig.setShowCursorOnTouch(l.showCursorOnTouch),i.settingConfig.setAutoHideRemoteCursorTimeout(n.autoHideRemoteCursorTimeout),i.settingConfig.setOfflineWarningTimeout(n.offlineWarningTimeout),i.settingConfig.setPinchToZoomEnable(l.pinchToZoomEnable),i.settingConfig.setScaleRange(n.scaleRange),i.settingConfig.setMouseToolBehavior(l.mouseToolBehavior),i.settingConfig.setCustomCursorIcon(l.customCursorIcon),i.settingConfig.setImageCursorEnable(l.imageCursorEnable),i.isCustomCursorIcon=l.customCursorIcon,l.mathGraphEnable&&K(L.mathGraphURL,(function(){}),!0),i.moveBoardObj={moveEnd:0,timeInterval:300},i.boardBackgroundCacheMap={},!1===l.enableScaleTool?i.enableScaleTool=!1:i.enableScaleTool=!0,i.container=document.getElementById(i.option.id),i.cacheImgNum=2,i.pinchScale=[],i.beforePinchScale,i.scaleRatio=10,i.scaleIcons={enlarge:L.zoomInIcon,shrink:L.zoomOutIcon},i.minLineWidth=s.minLineWidth||M.MIN_LINE_WIDTH,i.isRenderFace=!1,i.downGradeH5PPt=!1,l.progressEnable?i.progressBarUrl=n.progressBarUrl||L.defaultLoadingImage:i.progressBarUrl=L.defaultLoadingImage,i.store=new mc(e,i.option),i.collectLineHandler=new Lc(e,i.store),i.collectTextInputHandler=new Rc(e,i.store),i.collectEraserHandler=new Fc(e,i.store),i.collectPointSelectHandler=new Hc(e,i.store),i.collectRectSelectHandler=new qc(e,i.store),i.collectGraphHandler=new jc(e,i.store),i.collectMoverHandler=new Yc(e,i.store),i.collectDragHandler=new Xc(e,i.store),i.collectCustomGraphHandler=new Kc(e,i.store),i.renderVideoFile=new $c(e,i,i.store),i.renderBackgroundColor=new eh(e,i),i.renderBackgroundImageAndH5=new nh(e,i,i.store),i.renderH5PPT=new fh(e,i,i.store),i.renderH5File=new vh(e,i,i.store),i.listenerInteraction=new wh(e,i,i.store),i.setSyncFps(n.syncFps||5),a.nickname&&i.setUserInfo(a),l.formulaEnable&&i.store.loadMathJax(),l.remoteCursorVisible){var u=l.remoteCursorVisible[h];i.setRemoteCursorVisible(u,h)}return i.maxLaserSeq=0,i.textInputStatus=0,i.touchID=null,i.renderVideoFile.resetVideoStatus(),i.drawTimer=0,i.drawTimestamp=null,i.needForRAF={},i.drawFPS=1/60,i.userTime={},i.enableSyncTime=!1,i.compositionEvent=new _c,i.mobileTempTextAreaComponent=null,i.textAreaFocusBlurStatus={},i.boardBaseWidth=0,i.boardBaseHeight=0,i.globalLaserMap=new Map,i.enableLineOptimization=!0,i.fpsOptimization=!0,i.preDrawLineTimestamp=0,i.enableRaserOptimization=!0,i.preLayout={matrixScaleX:0,matrixScaleY:0,dpr:0,width:0,height:0,left:0,top:0,ratio:0,scale:0,horizontalScrollLeft:0,verticalScrollTop:0},i.preRenderCost=0,i.moveDragArea={minTop:0,maxTop:0,minLeft:0,maxLeft:0},i.drawLineMaxSeq={},i.laserCursorMap=new Map,i.watchCanvasMartixTask=0,i.remoteCursorLayerMap={},i.remoteIcons={},i.width=0,i.height=0,i.initTime=Date.now(),i.ownerNicknameVisible=!0,jn.startUnReadyCommandTask(),i.interactionFlag=new Ac,i.multiTouch=!1,i.stepTimeout=0,i.pptRemarks={},i.mouseType=Xa.TEDU_BOARD_TOOL_TYPE_MOUSE,i.snapshotRequestMap=new Map,i.container?(i.option.classId||i.logger.error(i.loggerModuleName,"","invalid classId parameter, classId range is 1 to 4294967295"),i.init(),i.initFont(),i.updateCursorIcons(),i.initRemoteCursorIcon(),i.initPermission(),i):(setTimeout((function(){i.event.fireErrorEvent(Xt.TEDU_BOARD_ERROR_INIT,"not found id:"+i.option.id+" Node")}),10),i)}return Ph(e,t),e.hasVideoPermission=function(){return!(!e.videoPermissionDiv||0==e.videoPermissionDiv.getElementsByTagName("video").length)},e.applyVideoPermission=function(t,r){if(void 0===t&&(t=10),e.hasVideoPermission())r&&r.reportInfo("Board","has_apply_video_permission",{param:{}},ea.ONLY_ONLINE);else{e.videoPermissionDiv=document.createElement("div"),e.videoPermissionDiv.id="board_permission_videos",e.videoPermissionDiv.style.display="none";for(var i=[],o=0;o<t;o++){var n=document.createElement("video");n.setAttribute("class","video-js"),n.setAttribute("x5-video-player-type","h5-page"),n.setAttribute("controlsList","nodownload nofullscreen"),n.setAttribute("disablePictureInPicture","disablePictureInPicture"),n.setAttribute("webkit-playsinline","webkit-playsinline"),n.setAttribute("playsinline","playsinline"),n.setAttribute("controls","controls"),n.setAttribute("style","height:100%; width:100%;"),e.videoPermissionDiv.appendChild(n),i.push(n)}document.body.appendChild(e.videoPermissionDiv),i.forEach((function(t){try{t.play().catch((function(){}))}catch(t){}})),r&&r.reportInfo("Board","apply_video_permission",{param:{extraInfo:JSON.stringify({count:t})}},ea.ONLY_ONLINE)}},e.prototype.formatInitParams=function(t){var e,r,o,n,a,s,l,c,h,u,d,p,f,g,m,y,v,_,E,T;return["ratio","drawEnable","textStyle","textSize","textColor","brushColor","brushThin","toolType","globalBackgroundColor","boardContentFitMode","dataSyncEnable","scale","preloadDepth","progressEnable","progressBarUrl","systemCursorEnable","enableScaleTool","proxyServer","syncFps"].forEach((function(e){return t.hasOwnProperty(e)&&void 0})),t.config||(t.config={}),t.userConfig||(t.userConfig={}),t.styleConfig||(t.styleConfig={}),t.authConfig||(t.authConfig={}),t.customServerConfig||(t.customServerConfig={}),"Linux"===i.getPlatform()?{cosData:t.cosData||{},newEnterId:t.newEnterId||0,tlsData:t.tlsData,event:t.event,logger:t.logger,uniqBid:t.uniqBid,id:t.id,classId:t.classId,sdkAppId:t.sdkAppId,userId:t.userId,userSig:t.userSig,enableLocalMode:t.enableLocalMode||!1,isTest:t.isTest||!1,config:{ratio:t.ratio||t.config.ratio||M.RATIO,scale:t.scale||t.config.scale||M.SCALE,toolType:null!==(r=null!==(e=t.toolType)&&void 0!==e?e:t.config.toolType)&&void 0!==r?r:Xa.TEDU_BOARD_TOOL_TYPE_PEN,boardContentFitMode:t.boardContentFitMode||t.config.boardContentFitMode||Xn.TEDU_BOARD_FILE_FIT_MODE_NONE,preloadDepth:t.preloadDepth||t.config.preloadDepth||5,proxyServer:t.proxyServer||t.config.proxyServer||"",syncFps:t.syncFps||t.config.syncFps||5,progressBarUrl:t.progressBarUrl||t.config.progressBarUrl||"",imageTimeout:t.imageTimeout||t.config.imageTimeout||M.IMAGE_TIMEOUT,h5PPTLoadTimeout:t.h5PPTLoadTimeout||t.config.h5PPTLoadTimeout||M.H5PPT_TIMEOUT,h5PPTResourceTimeout:t.h5PPTResourceTimeout||t.config.h5PPTResourceTimeout||M.H5PPT_TIMEOUT,autoHideRemoteCursorTimeout:t.config.autoHideRemoteCursorTimeout||2e3,offlineWarningTimeout:1e3*(t.config.offlineWarningTimeout||180),scaleRange:t.config.scaleRange||[M.MIN_SCALE,M.MAX_SCALE],h5PPTDownGradeTimeoutTimes:t.config.h5PPTDownGradeTimeoutTimes||0,laserDomId:t.config.laserDomId||null,containerScale:t.config.containerScale||1},userConfig:{nickname:t.userConfig.nickname||""},styleConfig:{minLineWidth:t.minLineWidth||t.styleConfig.minLineWidth||M.MIN_LINE_WIDTH,textFamily:M.TEXT_FONT_FAMILY,textStyle:t.textStyle||t.styleConfig.textStyle||Jn.TEDU_BOARD_TEXT_STYLE_NORMAL,textSize:t.textSize||t.styleConfig.textSize||320,textColor:t.textColor||t.styleConfig.textColor||"#000000",brushColor:t.brushColor||t.styleConfig.brushColor||"#ff0000",brushThin:t.brushThin||t.styleConfig.brushThin||100,globalBackgroundColor:t.globalBackgroundColor||t.styleConfig.globalBackgroundColor||"#ffffff",transparent:!1,selectBoxColor:t.selectBoxColor||t.styleConfig.selectBoxColor||"#ff0000",cursorSize:t.styleConfig.cursorSize||[-1/0,1/0],selectAnchorColor:t.styleConfig.selectAnchorColor||"#ff0000",globalBackgroundPic:t.styleConfig.globalBackgroundPic||{url:"",mode:Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,type:M.BACKGROUND_TYPE.IMAGE},highlighterColor:t.styleConfig.highlighterColor||M.HIGHLIGHTER_COLOR,scrollbarThumbColor:t.styleConfig.scrollbarThumbColor||"rgba(0,0,0,0.12)",scrollbarTrackColor:t.styleConfig.scrollbarTrackColor||"rgba(0,0,0,0.06)"},authConfig:{drawEnable:null===(n=null!==(o=t.drawEnable)&&void 0!==o?o:t.authConfig.drawEnable)||void 0===n||n,dataSyncEnable:null===(s=null!==(a=t.dataSyncEnable)&&void 0!==a?a:t.authConfig.dataSyncEnable)||void 0===s||s,progressEnable:t.progressEnable||t.authConfig.progressEnable||!1,systemCursorEnable:t.systemCursorEnable||t.authConfig.systemCursorEnable||!1,enableScaleTool:null===(c=null!==(l=t.enableScaleTool)&&void 0!==l?l:t.authConfig.enableScaleTool)||void 0===c||c,isAutoHideRemoteCursor:t.authConfig.isAutoHideRemoteCursor||!1,showRemoteSelectBox:t.authConfig.showRemoteSelectBox||!1,showLocalOperator:t.authConfig.showLocalOperator||!1,showRemoteOperator:t.authConfig.showRemoteOperator||!1,elementOperationAuthority:t.authConfig.elementOperationAuthority||{},mathGraphEnable:null!==(h=t.authConfig.mathGraphEnable)&&void 0!==h&&h,showCursorOnTouch:null===(u=t.authConfig.showCursorOnTouch)||void 0===u||u,pinchToZoomEnable:t.authConfig.pinchToZoomEnable||!1,mouseToolBehavior:t.authConfig.mouseToolBehavior||{},remoteCursorVisible:t.authConfig.remoteCursorVisible||{},customCursorIcon:t.authConfig.customCursorIcon||!1,imageCursorEnable:t.authConfig.imageCursorEnable||!1},customServerConfig:{serverHost:t.serverHost||t.customServerConfig.serverHost,serverPath:t.serverPath||t.customServerConfig.serverPath,resourceHost:t.resourceHost||t.customServerConfig.resourceHost,token:t.token||t.customServerConfig.token}}:{cosData:t.cosData||{},newEnterId:t.newEnterId||0,tlsData:t.tlsData,event:t.event,logger:t.logger,uniqBid:t.uniqBid,id:t.id,classId:t.classId,sdkAppId:t.sdkAppId,userId:t.userId,userSig:t.userSig,enableLocalMode:t.enableLocalMode||!1,isTest:t.isTest||!1,config:{ratio:t.config.ratio||t.ratio||M.RATIO,scale:t.config.scale||t.scale||M.SCALE,toolType:null!==(p=null!==(d=t.config.toolType)&&void 0!==d?d:t.toolType)&&void 0!==p?p:Xa.TEDU_BOARD_TOOL_TYPE_PEN,boardContentFitMode:t.config.boardContentFitMode||t.boardContentFitMode||Xn.TEDU_BOARD_FILE_FIT_MODE_NONE,preloadDepth:t.config.preloadDepth||t.preloadDepth||5,proxyServer:t.config.proxyServer||t.proxyServer||"",syncFps:t.config.syncFps||t.syncFps||5,progressBarUrl:t.config.progressBarUrl||t.progressBarUrl||"",imageTimeout:t.config.imageTimeout||t.imageTimeout||M.IMAGE_TIMEOUT,h5PPTLoadTimeout:t.config.h5PPTLoadTimeout||t.h5PPTLoadTimeout||M.H5PPT_TIMEOUT,h5PPTResourceTimeout:t.config.h5PPTResourceTimeout||t.h5PPTResourceTimeout||M.H5PPT_TIMEOUT,autoHideRemoteCursorTimeout:t.config.autoHideRemoteCursorTimeout||2e3,offlineWarningTimeout:1e3*(t.config.offlineWarningTimeout||180),scaleRange:t.config.scaleRange||[M.MIN_SCALE,M.MAX_SCALE],h5PPTDownGradeTimeoutTimes:t.config.h5PPTDownGradeTimeoutTimes||0,laserDomId:t.config.laserDomId||null,containerScale:t.config.containerScale||1},userConfig:{nickname:t.userConfig.nickname||""},styleConfig:{minLineWidth:t.styleConfig.minLineWidth||t.minLineWidth||M.MIN_LINE_WIDTH,textFamily:M.TEXT_FONT_FAMILY,textStyle:t.styleConfig.textStyle||t.textStyle||Jn.TEDU_BOARD_TEXT_STYLE_NORMAL,textSize:t.styleConfig.textSize||t.textSize||320,textColor:t.styleConfig.textColor||t.textColor||"#000000",brushColor:t.styleConfig.brushColor||t.brushColor||"#ff0000",brushThin:t.styleConfig.brushThin||t.brushThin||100,globalBackgroundColor:t.styleConfig.globalBackgroundColor||t.globalBackgroundColor||"#ffffff",transparent:!1,selectBoxColor:t.styleConfig.selectBoxColor||t.selectBoxColor||"#ff0000",cursorSize:t.styleConfig.cursorSize||[-1/0,1/0],selectAnchorColor:t.styleConfig.selectAnchorColor||"#ff0000",globalBackgroundPic:t.styleConfig.globalBackgroundPic||{url:"",mode:Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,type:M.BACKGROUND_TYPE.IMAGE},highlighterColor:t.styleConfig.highlighterColor||M.HIGHLIGHTER_COLOR,scrollbarThumbColor:t.styleConfig.scrollbarThumbColor||"rgba(0,0,0,0.12)",scrollbarTrackColor:t.styleConfig.scrollbarTrackColor||"rgba(0,0,0,0.06)"},authConfig:{drawEnable:null===(g=null!==(f=t.authConfig.drawEnable)&&void 0!==f?f:t.drawEnable)||void 0===g||g,dataSyncEnable:null===(y=null!==(m=t.authConfig.dataSyncEnable)&&void 0!==m?m:t.dataSyncEnable)||void 0===y||y,progressEnable:t.authConfig.progressEnable||t.progressEnable||!1,systemCursorEnable:t.authConfig.systemCursorEnable||t.systemCursorEnable||!1,enableScaleTool:null===(_=null!==(v=t.authConfig.enableScaleTool)&&void 0!==v?v:t.enableScaleTool)||void 0===_||_,isAutoHideRemoteCursor:t.authConfig.isAutoHideRemoteCursor||!1,showRemoteSelectBox:t.authConfig.showRemoteSelectBox||!1,showLocalOperator:t.authConfig.showLocalOperator||!1,showRemoteOperator:t.authConfig.showRemoteOperator||!1,elementOperationAuthority:t.authConfig.elementOperationAuthority||{},mathGraphEnable:null!==(E=t.authConfig.mathGraphEnable)&&void 0!==E&&E,showCursorOnTouch:null===(T=t.authConfig.showCursorOnTouch)||void 0===T||T,pinchToZoomEnable:t.authConfig.pinchToZoomEnable||!1,mouseToolBehavior:t.authConfig.mouseToolBehavior||{},formulaEnable:t.authConfig.formulaEnable||!1,remoteCursorVisible:t.authConfig.remoteCursorVisible||{},customCursorIcon:t.authConfig.customCursorIcon||!1,imageCursorEnable:t.authConfig.imageCursorEnable||!1},customServerConfig:{serverHost:t.customServerConfig.serverHost,serverPath:t.customServerConfig.serverPath,resourceHost:t.customServerConfig.resourceHost,token:t.customServerConfig.token}}},e.prototype.setScaleAnchor=function(t,e){var r=this;if(H(t)&&H(e)){var i,o=this.store.computeMoveRange(this.width,this.height,this.container.clientWidth,this.container.clientHeight),n=o.maxLeft,a=o.minLeft,s=o.maxTop,l=n-(n-a)*t,c=s-(s-o.minTop)*e;this.moveBoardObj.moveEnd&&(clearTimeout(this.moveBoardObj.moveEnd),this.moveBoardObj.moveEnd=0),i=this.getCurrentBoard(),r.moveBoardObj.moveEnd=window.setTimeout((function(){!function(t){r.store.setBoardOffset(l,c),gt()?r.collectDragHandler.touchEnd(t,r.pinchScale,r.enableScaleTool):r.collectDragHandler.end(t),r.store.setNeedDraw(!0),r.event._fireBoardScrollEvent({trigger:"api"})}(i)}),r.moveBoardObj.timeInterval)}},e.prototype.initPermission=function(){e.hasVideoPermission()?this.logger.reportInfo(this.loggerModuleName,"has_video_permission",{param:{}},ea.ONLY_ONLINE):(e.applyVideoPermission(10,this.logger),this.logger.reportInfo(this.loggerModuleName,"init_video_permission",{param:{}},ea.ONLY_ONLINE))},e.prototype.updateCursorIcons=function(){this.penIcon=new Image;var t=M.ICONS[1].url;t&&(this.penIcon.onerror=function(){this.src.indexOf("try=true")>-1||(-1===this.src.indexOf("?")?this.src=this.src+"?try=true":this.src=this.src+"&try=true")},this.penIcon.src=t),this.laserIcon=new Image;var e=M.ICONS[3].url;e&&(this.laserIcon.onerror=function(){this.src.indexOf("try=true")>-1||(-1===this.src.indexOf("?")?this.src=this.src+"?try=true":this.src=this.src+"&try=true")},this.laserIcon.src=e)},e.prototype.initRemoteCursorIcon=function(){var t=M.ICONS;for(var e in t){var r=t[e],i="3"===e?L.laserCursorIcon:L.penCursorIcon;if(Object.prototype.hasOwnProperty.call(r,"url")){var o=r.url||i;if(o&&(!this.remoteIcons[e]||this.remoteIcons[e].src!==o)){var n=new Image;n.onerror=function(){this.src.indexOf("try=true")>-1||(-1===this.src.indexOf("?")?this.src=this.src+"?try=true":this.src=this.src+"&try=true")},n.src=o,this.remoteIcons[e]=n,"1"===e&&(this.remotePenIcon=this.remoteIcons[e]),"3"===e&&(this.remoteLaserIcon=this.remoteIcons[e])}}}},e.prototype.initMeasureTextElement=function(t){if(!document.querySelector('[data-font="'.concat(t,'"]'))){var e=document.createElement("div");e.classList.add("tic_measuretext__tool"),e.style.position="fixed",e.style.left="-10000px",e.style.fontFamily=t,e.style.visibility="hidden",e.style.boxSizing="content-box",e.style.display="inline-block",e.style.margin=0,e.style.padding=0,e.style.whiteSpace="pre",e.style.lineHeight=1,e.innerHTML="&nbsp;",e.dataset.font=t,document.body.appendChild(e)}},e.prototype.initFont=function(){this.addTextFontFamily("customFontFamily",L.fontUrl)},e.prototype.startWatchCanvasMartixChange=function(){var t=this;this.canvasCtx.getTransform&&(this.watchCanvasMartixTask=window.setInterval((function(){var e=t.canvasCtx.getTransform(),r=e.a,i=e.d;r===t.preLayout.matrixScaleX&&i===t.preLayout.matrixScaleY||(t.store.setNeedDraw(!0),0!==t.preLayout.matrixScaleX&&0!==t.preLayout.matrixScaleY&&t.logger.reportInfo(t.loggerModuleName,"martix-change",{param:{extraInfo:JSON.stringify({devicePixelRatio:window.devicePixelRatio,new:{matrixScaleX:r,matrixScaleY:i},old:{matrixScaleX:t.preLayout.matrixScaleX,matrixScaleY:t.preLayout.matrixScaleY}})}},ea.ONLY_ONLINE))}),500))},e.prototype.resize=function(){var t=this.option&&document.getElementById(this.option.id);t&&this.container!=t&&(this.container=t),this.store.setNeedDraw(!0)},e.prototype.getEventLocation=function(t,e,r){var i=this;void 0===e&&(e=!1),void 0===r&&(r=!0);var o,n,a=this.store.getContainerScale(),s={},l=this.boardBox;(r||F(this.boardBoxOffset))&&(this.boardBoxOffset=l.getBoundingClientRect());var c=function(t,e,r,o,n){var a;return e=(a=Lh(i.mathToolCorrectData(t,e,r),2))[0],r=a[1],{touchId:t+"",x:parseInt(e/i.width*1e4+""),y:parseInt(r/i.height*1e4+""),ox:parseInt(e+""),oy:parseInt(r+""),clientX:parseInt(o+""),clientY:parseInt(n+"")}},h=this.boardBoxOffset,u=l.ownerDocument.defaultView;if(t.changedTouches&&!e)if(this.multiTouch){f=0;for(var d=t.changedTouches.length;f<d;f++)g=(m=t.changedTouches[f]).identifier+"",o=m.pageX-h.left-u.pageXOffset,n=m.pageY-h.top-u.pageYOffset,s[g]=c(g,o,n,m.clientX,m.clientY)}else{var p=null;if("touchstart"===t.type){if(null!==this.touchID&&1!==t.touches.length)return null;this.touchID=t.changedTouches[0].identifier,p=t.changedTouches[0]}else if("touchmove"===t.type){for(var f=0;f<t.changedTouches.length;f++)if(t.changedTouches[f].identifier===this.touchID){p=t.changedTouches[f];break}if(!p)return null}else if("touchend"===t.type||"touchcancel"===t.type){for(f=0;f<t.changedTouches.length;f++)if(t.changedTouches[f].identifier===this.touchID){p=t.changedTouches[f];break}if(!p&&0!==t.touches.length)return null;this.touchID=null}if(!p)return null;var g=p.identifier+"";o=(p.pageX-h.left-u.pageXOffset)/a,n=(p.pageY-h.top-u.pageYOffset)/a,s[g]=c(g,o,n,p.clientX,p.clientY)}else{var m,y=void 0,v=void 0;e?(o=((m=t.changedTouches[0]).pageX-h.left-u.pageXOffset)/a,n=(m.pageY-h.top-u.pageYOffset)/a,y=m.clientX,v=m.clientY):(o=(t.pageX-h.left-u.pageXOffset)/a,n=(t.pageY-h.top-u.pageYOffset)/a,y=t.clientX,v=t.clientY),s[M.MOUSE_TOUCH_ID]=c(M.MOUSE_TOUCH_ID,o,n,y,v)}return s},e.prototype.draw=function(){if(this.store.getCurrentBoard()){var t=this.store.getCurrentBoardData(),e=this.store.filterGlobalElement(),r=t.data.concat(e),i=t.backgroundPic,o=this.layout();o&&(this.store.setPartDraw(!0),this.store.setLaserDraw(!0));var n=this.isH5PPTCosTrans();this.enableH5PointerEvent(this.getToolType()===Xa.TEDU_BOARD_TOOL_TYPE_MOUSE&&n);var a=this.viewContainer.getCanvasContext();(this.store.getPartDraw()||this.store.getNeedDraw())&&a.clearRect(-5,-5,this.width+10,this.height+10),this.preloadTriggered=!1;var s=this.getFileInfo(this.getCurrentFile());if(s){if(this.store.getNeedDraw()&&(this.renderVideoFile.renderVideo(s),this.renderH5PPT.render(s),this.renderH5File.render(s),this.renderBackgroundImageAndH5.render(i),this.renderBackgroundColor.render(t.backgroundColor),this.renderMathTool(t.mathToolData)),this.drawData(r,a),o){var l=this.store.getSelectList();l.length&&this.store.fireElementPosition(l,!1,-1)}this.preloadTriggered||this.store.preloadBoard()}}},e.prototype.drawFace=function(){if(this.logger.reportInfo(this.loggerModuleName,"render_first_frame",{cost:Date.now()-this.initTime,param:{}},ea.ONLY_ONLINE),this.store.getCurrentBoard()){var t=this.store.getFaceData();if(t.fileInfo&&this.layout(t.fileInfo)){var e=this.viewContainer.getCanvasContext();e.clearRect(-5,-5,this.width+10,this.height+10),this.preloadTriggered=!1,this.renderH5PPT.render(t.fileInfo,!0),this.renderBackgroundImageAndH5.render(t.currentPic),this.renderBackgroundColor.render(t.backgroundColor),this.drawData(t.data,e),this.preloadTriggered||this.store.preloadBoard()}}},e.prototype.genStyles=function(t,e,r,i,o){void 0===r&&(r=0),void 0===i&&(i=1),void 0===o&&(o=!1);var n,a,s,l="position: absolute;",c="transform: translateX(-50%) rotate(".concat(r,"deg) scale(").concat(i,"); -webkit-transform: translateX(-50%) rotate(").concat(r,"deg) scale(").concat(i,");"),h="transform: translateY(-50%) rotate(".concat(r,"deg) scale(").concat(i,"); -webkit-transform: translateY(-50%) rotate(").concat(r,"deg) scale(").concat(i,");"),u="z-index: 5;";if(e)switch(a=c,t){case Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER:case Ma.TEDU_BOARD_IMAGE_FIT_MODE_TOP:case Ma.TEDU_BOARD_IMAGE_FIT_MODE_BOTTOM:n="top: 0; left: 50%;",s="".concat(l," ").concat(u," ").concat(n," ").concat(a);break;case Ma.TEDU_BOARD_IMAGE_FIT_MODE_LEFT:n="top: 0; left: 0;",s="".concat(l," ").concat(u," ").concat(n);break;case Ma.TEDU_BOARD_IMAGE_FIT_MODE_RIGHT:n="top: 0; right: 0;",s="".concat(l," ").concat(u," ").concat(n);break;default:n="top: 0; left: 50%;",s="".concat(l," ").concat(u," ").concat(n," ").concat(a)}else switch(a=h,t){case Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER:case Ma.TEDU_BOARD_IMAGE_FIT_MODE_LEFT:case Ma.TEDU_BOARD_IMAGE_FIT_MODE_RIGHT:n="top: 50%; left: 0;",s="".concat(l," ").concat(u," ").concat(n," ").concat(a);break;case Ma.TEDU_BOARD_IMAGE_FIT_MODE_TOP:n="top: 0; left: 0;",s="".concat(l," ").concat(u," ").concat(n);break;case Ma.TEDU_BOARD_IMAGE_FIT_MODE_BOTTOM:n="bottom: 0; left: 0;",s="".concat(l," ").concat(u," ").concat(n);break;default:n="top: 50%; left: 0;",s="".concat(l," ").concat(u," ").concat(n," ").concat(a)}return o&&(s=s.replace(/;/gi," !important;")),"".concat("visibility: hidden;"," ").concat(s)},e.prototype.cacheBackgroundImageAndH5=function(){for(var t=this.getCurrentFile(),e=this.getBoardInfoList(t),r=0,i=this.store.getCurrentBoard(),o=0;o<e.length;++o)if(e[o].boardId===i){r=o;break}for(o=r-this.cacheImgNum;o<=r+this.cacheImgNum;++o)if(!(o<0||o>=e.length)){var n=e[o];n.backgroundUrl&&this.boardBackgroundCacheMap[n.boardId]&&this.boardBackgroundCacheMap[n.boardId].url===n.backgroundUrl||(Z(n.backgroundUrl),this.boardBackgroundCacheMap[n.boardId]={url:n.backgroundUrl,actualUrl:n.backgroundUrl})}},e.prototype.setVODExtParam=function(t,e){this.renderVideoFile.setVODExtParam(t,e)},e.prototype.showVideoControl=function(t){this.renderVideoFile.showVideoControl(t)},e.prototype.playVideo=function(){this.renderVideoFile.playVideo()},e.prototype.pauseVideo=function(){this.renderVideoFile.pauseVideo()},e.prototype.seekVideo=function(t){this.renderVideoFile.seekVideo(t)},e.prototype.muteVideo=function(t){this.renderVideoFile.muteVideo(t)},e.prototype.resetVideoProgress=function(){this.renderVideoFile.resetVideoProgress()},e.prototype.setSyncVideoStatusEnable=function(t,e){this.renderVideoFile.setSyncVideoStatusEnable(t,e)},e.prototype.startSyncVideoStatus=function(t){void 0===t&&(t=M.SYNC_VIDEO_STATUS_INTERVAL),this.renderVideoFile.startSyncVideoStatus(t)},e.prototype.stopSyncVideoStatus=function(){this.renderVideoFile.stopSyncVideoStatus()},e.prototype.setSyncAudioStatusEnable=function(t){this.store.setSyncAudioStatusEnable(t)},e.prototype.playAudio=function(t){var e=this;this.logger.reportInfo(this.loggerModuleName,"playAudio",{param:{boardId:this.getCurrentBoard(),extraInfo:JSON.stringify({elementId:t})}},ea.ONLY_ONLINE);var r=this.store.tiwData.getElementByElementId(t);null!=r&&r.isElementDisplay()&&r.play((function(t){if(0===t&&e.store.isSyncAudioStatus){var i=r.getRealTimeData(),o=r.getReportData();e.store.addRealtimeData(i),e.store.reportElement(o)}}))},e.prototype.pauseAudio=function(t){var e=this;this.logger.reportInfo(this.loggerModuleName,"pauseAudio",{param:{boardId:this.getCurrentBoard(),extraInfo:JSON.stringify({elementId:t})}},ea.ONLY_ONLINE);var r=this.store.tiwData.getElementByElementId(t);null!=r&&r.isElementDisplay()&&r.pause((function(t){if(0===t&&e.store.isSyncAudioStatus){var i=r.getRealTimeData(),o=r.getReportData();e.store.addRealtimeData(i),e.store.reportElement(o)}}))},e.prototype.seekAudio=function(t,e){var r=this;this.logger.reportInfo(this.loggerModuleName,"seekAudio",{param:{boardId:this.getCurrentBoard(),extraInfo:JSON.stringify({elementId:t,time:e})}},ea.ONLY_ONLINE);var i=this.store.tiwData.getElementByElementId(t);null!=i&&i.isElementDisplay()&&i.seek(e,(function(t){if(0===t&&r.store.isSyncAudioStatus){var e=i.getRealTimeData(),o=i.getReportData();r.store.addRealtimeData(e),r.store.reportElement(o)}}))},e.prototype.muteAudio=function(t,e){this.logger.reportInfo(this.loggerModuleName,"muteAudio",{param:{boardId:this.getCurrentBoard(),extraInfo:JSON.stringify({elementId:t,muted:e})}},ea.ONLY_ONLINE);var r=this.store.tiwData.getElementByElementId(t);null!=r&&r.isElementDisplay()&&r.mute(e)},e.prototype.setAudioVolume=function(t,e){this.logger.reportInfo(this.loggerModuleName,"setAudioVolume",{param:{boardId:this.getCurrentBoard(),extraInfo:JSON.stringify({elementId:t,volume:e})}},ea.ONLY_ONLINE);var r=this.store.tiwData.getElementByElementId(t);null!=r&&r.isElementDisplay()&&r.setVolume(e)},e.prototype.getAudioVolume=function(t){var e=this.store.tiwData.getElementByElementId(t);return null!=e&&e.isElementDisplay()?e.getVolume():0},e.prototype.drawData=function(t,e){var r=this;if(this.store.getShowGraffiti()){var i=this,o=this.store.getNeedDraw(),n=this.store.getPartDraw();if(this.store.getLaserDraw()||o){var a=!1;Object.entries(this.store.laserDataMap).forEach((function(t){var e=Lh(t,2),i=e[0],n=e[1],s=n.length;if(s>0){var l=void 0;o?(l=n[s-1],r.store.laserDataMap[i]=[],r.store.pushLaserData(l),n=r.store.laserDataMap[i]):(l=1===s?n[0]:n.shift()).ignore&&(l=null),l&&r.drawLaser(l),!a&&n.length&&1!=s&&(a=!0)}})),a&&setTimeout((function(){r.store&&r.store.setLaserDraw(!0)}),0)}if(o||this.store.getIncreasingDraw()||n){var s=[];t.forEach((function(t){if("line"===t.type&&t.isElementDisplay())i.drawLine(e,t);else if("raser"===t.type&&t.status);else if("graph"===t.type&&t.isElementDisplay())(o||n)&&(t.needToRender=!0),i.drawGraph(t,e);else if("inputtext"===t.type)s.push("tic-textarea__".concat(t.belongSeq)),r.renderTextTool(t);else if("imageElement"===t.type)r.renderImageElement(t);else if("element"===t.type)if(t.subType===Ta.TEDU_BOARD_ELEMENT_H5)r.renderH5WebElement(t);else if(t.subType===Ta.TEDU_BOARD_ELEMENT_CUSTOM_GRAPH)r.renderCustomGraph(t);else if(t.subType===Ta.TEDU_BOARD_ELEMENT_AUDIO||t.subType===Ta.TEDU_BOARD_ELEMENT_GLOBAL_AUDIO)r.renderAudio(t);else if(t.subType===Ta.TEDU_BOARD_ELEMENT_MAGIC_LINE&&t.isElementDisplay()){(o||n)&&(t.needToRender=!0);var a=r.store.renderHandler.getRender(t.ID);null==a||a.renderTo(e,{width:i.width,height:i.height,minLineWidth:i.minLineWidth})}else if(t.subType===Ta.TEDU_BOARD_ELEMENT_MATH_BOARD)r.renderJsxGraphElement(t);else if(t.subType===Ta.TEDU_BOARD_ELEMENT_FORMULA)r.renderFormulaElement(t);else if(t.subType===Ta.TEDU_BOARD_ELEMENT_GRAFFITI_GRAPH_ARC&&t.isElementDisplay()){(o||n)&&(t.needToRender=!0);var l=r.store.renderHandler.getRender(t.ID);null==l||l.renderTo(e,{width:i.width,height:i.height,minLineWidth:i.minLineWidth})}else t.subType===Ta.TEDU_BOARD_ELEMENT_WATERMARK&&r.renderWatermark(t)})),function(t,e){for(var r=t.length,i=0;i<r;i++){var o=t[i];e(o)&&o.remove()}}(this.textAreaBox.querySelectorAll("textarea"),(function(t){return!s.includes(t.getAttribute("id"))}))}var l=this.store.renderHandler.getRender("select"),c=i.store.getSelectList();if(c.length>0){for(var h=[],u=0,d=c.length;u<d;u++){var p=c[u];"imageElement"!==p.type&&"element"!==p.type&&"line"!==p.type&&"graph"!==p.type&&"inputtext"!==p.type||h.push(p)}if(h.length){var f=this.store.toolTypeTitleStyleMap[Xa.TEDU_BOARD_TOOL_TYPE_RECT_SELECT];f&&((f=JSON.parse(JSON.stringify(f))).style.size=(f.style.size||200)*this.height/1e4,f.style.displaySelf||f.operatorId!==this.identifier||(f.title="")),this.cursorLayerWrap.style.display="block",this.cursorLayerWrap.style.zIndex="120",this.teduBoardCursorLayer.setOperator(f),this.teduBoardCursorLayer.showSelectLayer(h)}else this.cursorLayerWrap.style.display="none",this.teduBoardCursorLayer.hideSelectLayer();this.store.selectModel.show=!0;var g=i.store.getSelectArea();this.store.selectModel.startInfo={x:g.x,y:g.y},this.store.selectModel.location={x:g.x+g.width,y:g.y+g.height}}else this.cursorLayerWrap.style.display="none",this.teduBoardCursorLayer.hideSelectLayer();var m=i.store.getRemoteSelectListMap();Object.keys(m).length>0&&Object.keys(m).forEach((function(t){for(var e=m[t],o=[],n=0,a=e.length;n<a;n++){var s=e[n];"imageElement"!==s.type&&"element"!==s.type&&"line"!==s.type&&"graph"!==s.type&&"inputtext"!==s.type||o.push(s)}if(o.length)if(r.cursorLayerRemoteWrap.style.display="block",r.cursorLayerRemoteWrap.style.zIndex="99",r.settingConfig.showRemoteSelectBox){var l=r.store.toolTypeTitleStyleMap[Xa.TEDU_BOARD_TOOL_TYPE_RECT_SELECT];if(l&&((l=JSON.parse(JSON.stringify(l))).style.size=(l.style.size||200)/1e4*r.height,l.title=r.store.getUserInfo(t,"nickname")),r.remoteCursorLayerMap[t])clearTimeout(r.remoteCursorLayerMap[t].timer);else{r.remoteCursorLayerMap[t]={};var c=new Ec(r.cursorLayerRemoteWrap,{checkAccessible:function(){return!1}},{readonly:!0,showOperator:r.settingConfig.showRemoteOperator,containerScale:r.store.getContainerScale()});c.setBorderStyle(Ss.remoteCursorLayer.getBorder()),r.remoteCursorLayerMap[t].layer=c}r.remoteCursorLayerMap[t].layer.setOperator(l),r.remoteCursorLayerMap[t].layer.showSelectLayer(o),i.store.clearRemoteSelectList(t),r.remoteCursorLayerMap[t].timer=setTimeout((function(){r.remoteCursorLayerMap[t]&&(r.remoteCursorLayerMap[t].layer&&r.remoteCursorLayerMap[t].layer.destroy(),delete r.remoteCursorLayerMap[t],Object.keys(r.remoteCursorLayerMap).length||(r.cursorLayerRemoteWrap.style.display="none"))}),2e3)}else i.store.clearRemoteSelectList(t)})),null==l||l.renderTo(e,{width:i.width,height:i.height,minLineWidth:i.minLineWidth}),this.removeImageElement(),this.removeCustomGraph(),this.removeTextTool(),this.removeH5WebElement(),this._removeRenderedElement()}},e.prototype._removeRenderedElement=function(){this.store.removeRenderedElement()},e.prototype.renderImageElement=function(t){t.isElementDisplay()?(this.store.imageElementMapData[""+t.belongSeq]=t,t.setBoardSize(this.width,this.height),null==t||t.renderTo(this.imageElementWrap,this.logger,this.event)):(t.remove(),delete this.store.imageElementMapData[""+t.belongSeq])},e.prototype.removeImageElement=function(t){void 0===t&&(t=!1);var e=this.getCurrentBoard();for(var r in this.store.imageElementMapData){var i=this.store.imageElementMapData[r];(t&&i.boardId===e||!t&&i.boardId!=e)&&(i.remove(),delete this.store.imageElementMapData[""+i.belongSeq])}},e.prototype.renderJsxGraphElement=function(t){t.isElementDisplay()?(t.setBoardSize(this.width,this.height),null==t||t.renderTo(this.jsxgraphElementWrap,this.teduToolType.isMouseToolType()&&this.isDrawEnable())):t.remove()},e.prototype.renderFormulaElement=function(t){t.isElementDisplay()?(t.setBoardSize(this.width,this.height),null==t||t.renderTo(this.imageElementWrap)):t.remove()},e.prototype.renderTextTool=function(t){var e=this;if(t.isElementDisplay()){var r=void 0,i=this.container.querySelector("#tic-textarea__".concat(t.belongSeq)),o=t.textSize/1e4*this.height/12;i?r=this.store.textAreaComponentMap[t.belongSeq]:((r=new bc(this.instanceKey,{boardId:this.getCurrentBoard(),getToolType:this.getToolType.bind(this),typeFace:t.typeFace,isNeedDraw:this.store.getShowGraffiti()})).createElement(this.textAreaBox),r.initEvent({onfocus:function(t,r,i,o,n){void 0===n&&(n=!1);var a=t.textItem.text;if(t.textItem.isLocked())return t.dom.blur(),void(n||e.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENT_IS_LOCKED,t.textItem.getElementId()));if(e.store.isDrawEnable()&&e.permissionHandler.filter(a?"Element::Update::Text":"Element::Add::Text",[{creator:t.textItem.user}])){var s=t.textItem.belongSeq,l=t.dom&&t.dom.style.left,c=t.dom&&t.dom.style.top,h=t.dom&&t.dom.value,u=!!h;t.dom.setAttribute("has-origin-text",+u),e.textAreaFocusBlurStatus.focus=t,e.textInputStatus=1,e.store.updateDragDataFromTextTool(r,i,o),e.store.setNeedDraw(!0),n&&(e.mobileTempTextAreaComponent=t,e.event.fireTextElementStatusChangedEvent({status:"focus",id:String(s),value:h,left:parseFloat(l),top:parseFloat(c)}))}else t.dom.blur()},oninput:function(t,r,i,o){e.textInputStatus=1;var n=t.dom.value;e.collectTextInputHandler.inputting(t,t.textItem,n,t.dom.clientWidth,t.dom.clientHeight),e.store.updateDragDataFromTextTool(r,i,o),e.store.setNeedDraw(!0)},onblur:function(t){e.textAreaFocusBlurStatus.focus===t&&(e.textAreaFocusBlurStatus.focus=null),e.textInputStatus=0,e.store.cancelSelect();var r="",i=0;if(t.dom){var o=t.textItem.belongSeq,n=t.dom.style.left,a=t.dom.style.top;r=t.dom.value,i=+t.dom.getAttribute("has-origin-text"),t.isBlured||e.event.fireTextElementStatusChangedEvent({status:"blur",id:String(o),value:r,left:parseFloat(n),top:parseFloat(a)})}e.store.isDrawEnable()&&(r?e.collectTextInputHandler.draw(t,t.textItem,r,t.dom.clientWidth+12,t.dom.clientHeight,!!i):i?(e.collectTextInputHandler.draw(t,t.textItem,r,t.dom.clientWidth+12,t.dom.clientHeight,!!i),delete e.store.textAreaComponentMap[t.textItem.belongSeq]):(delete e.store.textAreaComponentMap[t.textItem.belongSeq],e.collectTextInputHandler.clearTask(t)),t.textItem&&t.textItem.setBorder())},onresize:function(t){if(t.textItem){var r=t.textItem;t.textItem.setBorder(),t.setPosition(r.location.x/1e4*e.width,r.location.y/1e4*e.height),t.setMaxSize(),t.setFontScale(t.originFontScale)}},onlimit:function(){e.event.fireTextElementWarningEvent({code:Ic.TEDU_BOARD_TEXT_COMPONENT_STATUS_WORD_LIMIT,message:"the maximum word limit has been reached, unable to continue typing"})},onemoji:function(){e.event.fireTextElementWarningEvent({code:Ic.TEDU_BOARD_TEXT_COMPONENT_CANNOT_USE_EMOJI,message:"emoji input has been disabled"})}})),this.store.textAreaComponentMap[t.belongSeq]=r,r&&(t.setBoardSize(this.width,this.height),r.setBoardContainerSize(this.width,this.container.offsetWidth,this.height,this.container.offsetHeight),r.setTextItem(t),r.setPosition(t.location.x/1e4*this.width,t.location.y/1e4*this.height),r.setFontSize(12),r.setMaxSize(),r.setFontScale(o),r.setSize())}else this.store.textAreaComponentMap[t.belongSeq]&&(this.store.textAreaComponentMap[t.belongSeq].dom.blur(),this.store.textAreaComponentMap[t.belongSeq].remove()),delete this.store.textAreaComponentMap[t.belongSeq]},e.prototype.removeTextTool=function(){var t=this.getCurrentBoard();for(var e in this.store.textAreaComponentMap){var r=this.store.textAreaComponentMap[e];r&&r.boardId!=t&&(this.textAreaFocusBlurStatus.focus===r&&r.dom&&r.dom.blur(),r.remove(),delete this.store.textAreaComponentMap[""+r.belongSeq])}},e.prototype.getBoardData=function(){return JSON.parse(JSON.stringify(this.store.getData()))},e.prototype.addHistory=function(t){this.store.addHistory(t)},e.prototype.addData=function(t){var e=this;if(R(t))try{t=JSON.parse(t)}catch(e){this.event.fireWarningEvent($.TEDU_BOARD_WARNING_SYNC_DATA_PARSE_FAILED,e.message+", "+t)}if(F(t.avsdk_time))if(F(t.value))this.event.fireWarningEvent($.TEDU_BOARD_WARNING_SYNC_DATA_PARSE_FAILED,"data.value is undefined, "+JSON.stringify(t));else try{if(this.enableSyncTime){var r=t.value.operator;this.checkUserTime(r),this.userTime[r].imTimeOffset=Wt.getTimeStamp()-t.timestamp;var i=this.userTime[r].avTimeOffset-this.userTime[r].imTimeOffset;i>100?setTimeout((function(){e.store&&e.store.addData(t)}),i):this.store.addData(t)}else this.store.addData(t)}catch(e){this.logger.reportInfo(this.loggerModuleName,"addData",{code:-1,stack:e.stack,message:e.message,param:{boardId:this.getCurrentBoard(),extraInfo:JSON.stringify({data:t,stack:e.stack,message:e.message})}},ea.ONLY_ONLINE)}},e.prototype.deleteBoard=function(t){void 0===t&&(t=this.store.getCurrentBoard()),this.logger.reportInfo(this.loggerModuleName,"deleteBoard",{param:{boardId:t}},ea.ONLY_NATIVE),this.inputBlur(),Ot(t)===M.COMMON_GROUP&&this.store.deleteBoard(t,"",this.identifier)},e.prototype.getBoardList=function(){return JSON.parse(JSON.stringify(this.store.getBoardList()))},e.prototype.getCurrentBoard=function(){return this.store.getCurrentBoard()},e.prototype.getCurrentFile=function(){return this.store.getCurrentFile()},e.prototype.addBoard=function(t){for(var e,r,i,o,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];this.inputBlur(),this.store.getCurrentFile()!=M.COMMON_GROUP&&this.store.switchFile(M.COMMON_GROUP,"",0,this.identifier);var s,l=!1;if(arguments.length<=1&&(N(t)||!t)){var c=Object.assign({url:"",mode:Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,type:Oh.TEDU_BOARD_BACKGROUND_IMAGE,remark:"",needSwitch:!0},t);e=c.url,r=c.mode,i=c.type,o=c.remark,l=c.needSwitch,s=c.index}else e=t,r=n[0],i=n[1],l=n[2],s=n[3],o="";var h=this.store.switchBoard("",l,this.identifier,s);return i===Oh.TEDU_BOARD_BACKGROUND_H5?this.setBackgroundH5(e,h):this.setBackgroundPic(h,e,r),o&&"string"==typeof h&&this.setBoardRemark(h,o),l||this.store.report.reportAddFile(this.getFileInfo()),h},e.prototype.switchBoard=function(t,e){var r=this;if(this.logger.reportInfo(this.loggerModuleName,"switchBoard",{param:{boardId:t,resetStep:e}},ea.ONLY_NATIVE),this.inputBlur(),-1===this.getBoardList().indexOf(t)&&(t=M.COMMON_DEFAULT_BOARD),t){var i=Ot(t),o=this.getFileInfo(i),n=this.getCurrentFile(),a=0;if(this.settingConfig.isDiscussionGroupMode){var s=this.store.getDiscussionGroupIdByUserId(this.identifier);if(s.length&&!this.store.discussionGroupMap.checkIfBoardInAnyGroup(s,t))return;var l=this.getBoardByGroup(i).indexOf(t);s.forEach((function(e){if(r.store.discussionGroupMap.checkIfBoardInGroup(e,t)){var i=r.store.discussionGroupMap.getGroupInfoByGroupId(e);i.setCurrentBoard(t),i.setCurrentStep(l===i.currentPage?i.currentStep:0),i.setCurrentPage(l),a=i.currentStep}}))}if(i!==n){var c=this.getBoardByGroup(i).indexOf(t);return void(this.settingConfig.isDiscussionGroupMode?this.switchFile(i,t,a,!0):this.switchFile(i,t,o&&c===o.currentPageIndex?o.currentPageStep:0,!0))}o.type===M.FILE_TYPE.H5PPT?(c=this.getBoardByGroup(i).indexOf(t),this.store.setH5PPTOperator(i,c,a,this.identifier),"WPS"===q(o.downloadURL)?bs.instance&&bs.instance.gotoSlide(c+1):(jn.gotoTimestampNew(this.iframeDOM,this.seqUtil.getSeq(),{slideIndex:c,resetStep:e,isPassive:!1}),this.store.downGradeH5PPtMap.get(i)&&this.renderH5PPT.operatorDownGradeFile(i,c))):(this.store.switchBoard(t,!0,this.identifier),this.cacheBackgroundImageAndH5())}},e.prototype.switchPage=function(t){return void 0===t&&(t=0),this.store.switchPage(t,this.identifier)},e.prototype.switchStep=function(t,e){var r=this;if(this.logger.reportInfo(this.loggerModuleName,"switchStep",{param:{boardId:t,step:e}},ea.ONLY_ONLINE),this.inputBlur(),-1===this.getBoardList().indexOf(t)&&(t=M.COMMON_DEFAULT_BOARD),t){var i=Ot(t),o=this.getFileInfo(i),n=this.getCurrentFile();if(this.settingConfig.isDiscussionGroupMode){var a=this.store.getDiscussionGroupIdByUserId(this.identifier);if(a.length&&!this.store.discussionGroupMap.checkIfBoardInAnyGroup(a,t))return;var s=this.getBoardByGroup(i).indexOf(t);a.forEach((function(i){if(r.store.discussionGroupMap.checkIfBoardInGroup(i,t)){var o=r.store.discussionGroupMap.getGroupInfoByGroupId(i);o.setCurrentBoard(t),o.setCurrentStep(e),o.setCurrentPage(s),o.currentStep}}))}if(i!==n)return this.settingConfig.isDiscussionGroupMode,void this.switchFile(i,t,e,!0);if(o.type===M.FILE_TYPE.H5PPT){var l=this.getBoardByGroup(i).indexOf(t);this.store.setH5PPTOperator(i,l,e,this.identifier),"WPS"===q(o.downloadURL)?bs.instance&&bs.instance.gotoSlideStep(l+1,e+1):jn.gotoTimestampNew(this.iframeDOM,this.seqUtil.getSeq(),{slideIndex:l,stepIndex:e,isPassive:!1})}else this.store.switchBoard(t,!0,this.identifier),this.cacheBackgroundImageAndH5()}},e.prototype.prevBoard=function(t){void 0===t&&(t=!1),this.inputBlur();var e=this.getFileInfo(this.getCurrentFile()),r=this.getBoardByGroup(this.getCurrentFile());e.currentPageIndex<1||(this.switchBoard(r[e.currentPageIndex-1],t),this.cacheBackgroundImageAndH5())},e.prototype.prevStep=function(){var t=this;if(0==this.stepTimeout){if(this.stepTimeout=window.setTimeout((function(){t.stepTimeout=0}),500),this._getPageAndStepPermission(!0)){var e=this.store.getFileInfo(this.store.getCurrentFile());if(e.type===M.FILE_TYPE.H5PPT){if(this.inputBlur(),this.store.downGradeH5PPtMap.get(e.fid)&&e.currentPageIndex-1>=0)return void this.renderH5PPT.operatorDownGradeFile(e.fid,e.currentPageIndex-1);var r=null;if(this.settingConfig.isDiscussionGroupMode){var i=this.store.getDiscussionGroupIdByUserId(this.identifier),o=i.length;if(o&&(r=this.store.getDiscussionGroupInfoById(i[0]),o>1))for(var n=r.getUpdateTimestamp(),a=1;a<o;a++){var s=this.store.getDiscussionGroupInfoById(i[a]),l=s.getUpdateTimestamp();l>n&&(n=l,r=s)}if(r&&r.currentStep<=0)return}"WPS"===q(e.downloadURL)?bs.instance&&bs.instance.gotoPreviousStep():this.settingConfig.isDiscussionGroupMode&&r?jn.gotoPreviousStep(this.iframeDOM,this.seqUtil.getSeq(),{currentPageIndex:r.currentPage,currentPageStep:r.currentStep}):jn.gotoPreviousStep(this.iframeDOM,this.seqUtil.getSeq(),{currentPageIndex:e.currentPageIndex,currentPageStep:e.currentPageStep})}else this.prevBoard()}}else this.event.fireWarningEvent($.TEDU_BOARD_WARNING_SEPT_RATE_LIMITING,"Your prev step action is too fast.")},e.prototype.nextBoard=function(t){void 0===t&&(t=!1),this.inputBlur();var e=this.getFileInfo(this.getCurrentFile()),r=this.getBoardByGroup(this.getCurrentFile());e.currentPageIndex<e.pageCount-1&&(this.switchBoard(r[e.currentPageIndex+1],t),this.cacheBackgroundImageAndH5())},e.prototype.nextStep=function(){var t=this;if(0==this.stepTimeout){if(this.stepTimeout=window.setTimeout((function(){t.stepTimeout=0}),500),this._getPageAndStepPermission(!1)){var e=this.store.getFileInfo(this.store.getCurrentFile());if(e.type===M.FILE_TYPE.H5PPT){if(this.inputBlur(),this.store.downGradeH5PPtMap.get(e.fid)){var r=this.getBoardByGroup(e.fid);return void(e.currentPageIndex+1<=r.length&&this.renderH5PPT.operatorDownGradeFile(e.fid,e.currentPageIndex+1))}if(this.settingConfig.isDiscussionGroupMode){var i=this.store.getDiscussionGroupIdByUserId(this.identifier),o=i.length,n=null;if(o&&(n=this.store.getDiscussionGroupInfoById(i[0]),o>1))for(var a=n.getUpdateTimestamp(),s=1;s<o;s++){var l=this.store.getDiscussionGroupInfoById(i[s]),c=l.getUpdateTimestamp();c>a&&(a=c,n=l)}if(n){var h;if(h="WPS"===q(e.downloadURL)?bs.instance.slideStepCount[n.currentPage]:e.slideStepData[n.currentPage],n.currentStep>=h-1)return}}"WPS"===q(e.downloadURL)?bs.instance&&bs.instance.gotoNextStep():jn.gotoNextStep(this.iframeDOM,this.seqUtil.getSeq(),{})}else this.nextBoard()}}else this.event.fireWarningEvent($.TEDU_BOARD_WARNING_SEPT_RATE_LIMITING,"Your next step action is too fast.")},e.prototype.setGlobalBackgroundColor=function(t){var e=W(t);this.getBackgroundColor()!==e&&this.store.setGlobalBackgroundColor(t)},e.prototype.setBackgroundColor=function(t){var e=W(t);this.getBackgroundColor()!==e&&this.store.setBackgroundColor(t)},e.prototype.setElementStyle=function(t,e,r){var i;void 0===r&&(r=0);var o=null;(o=r>0?this.container.querySelectorAll(t)[r]:".tic-board_laserwrap"===t&&this.option.config.laserDomId?null===(i=document.getElementById(this.option.config.laserDomId))||void 0===i?void 0:i.querySelector(".tic-board_laserwrap"):this.container.querySelector(t))&&Object.keys(e).forEach((function(t){"pointer-events"===t?o.style.setProperty(t,e[t]):o.style.setProperty(t,e[t],"important")}))},e.prototype.enableH5PointerEvent=function(t){void 0===t&&(t=!0),this.viewContainer.setStyle("pointer-events",t?"none":"auto"),this.viewContainer.render(),this.setElementStyle(".tic-board_laserwrap",{"pointer-events":t?"none":""}),this.setElementStyle(".tic_board__imagewrap",{"pointer-events":t?"none":""}),this.setElementStyle(".tic_board_textbox",{"pointer-events":t?"none":""}),this.setElementStyle(".tx_board_canvas_box",{"pointer-events":t?"none":""}),this.setElementStyle(".tic_iframe_H5",{"pointer-events":t?"none":""}),this.setElementStyle(".tic_board__transcode",{"pointer-events":t&&this.isDrawEnable()&&this.settingConfig.mouseToolBehavior.turnPage.h5PPT?"auto":"none"})},e.prototype.androidWeiXinChangeH5PointerEvent=function(t,e){void 0===e&&(e=!0),this.viewContainer.setStyle("pointer-events",e?"none":"auto"),this.viewContainer.render(),this.setElementStyle(".tic-board_laserwrap",{"pointer-events":e?"none":""}),this.setElementStyle(".tic_board__imagewrap",{"pointer-events":e?"none":""}),this.setElementStyle(".tic_board_textbox",{"pointer-events":e?"none":""}),this.setElementStyle(".tx_board_canvas_box",{"pointer-events":e?"none":""}),0===t?this.setElementStyle(".tic_iframe_H5",{"pointer-events":e?this.isDrawEnable()&&this.settingConfig.mouseToolBehavior.turnPage.h5PPT?"auto":"none":""}):1===t&&this.setElementStyle(".tic_iframe_H5",{"pointer-events":e?"none":""}),this.setElementStyle(".tic_board__transcode",{"pointer-events":e&&this.isDrawEnable()&&this.settingConfig.mouseToolBehavior.turnPage.h5PPT?"auto":"none"})},e.prototype.resetZIndex=function(){this.setElementStyle(".tx_board_canvas_wrap",{"z-index":0}),this.viewContainer.setStyle("z-index",10),this.viewContainer.render(),this.setElementStyle(".tic-board_laserwrap",{"z-index":40}),this.setElementStyle(".tic-board__audiowrap",{"z-index":50}),this.setElementStyle("#tic_video_wrap",{"z-index":20}),this.setElementStyle(".tic_board__imagewrap",{"z-index":7}),this.setElementStyle(".tic_board__mathgraphwrap",{"z-index":8}),this.setElementStyle(".tic_board_textbox",{"z-index":11}),this.setElementStyle(".tic_cursorlayer__wrap",{"z-index":0}),this.setElementStyle(".tiw_board_webview_wrap",{"z-index":8}),this.setElementStyle(".tx_board_canvas_box",{"z-index":0}),this.setElementStyle(".tic_board_bg_progress",{"z-index":200}),this.setElementStyle(".tic_board_img_bg",{"z-index":5}),this.setElementStyle(".tic_board_bg",{"z-index":4})},e.prototype.init=function(){var t,e=this;this.listenerInteraction.onKeyBoardEvent();try{t=document.querySelectorAll("#"+this.option.id).length}catch(e){t=-1}this.logger.reportInfo(this.loggerModuleName,"init",{param:{extraInfo:JSON.stringify({option:this.option,containerCount:t})}},ea.ONLY_ONLINE),this.reportContainerSize(),this.listenerInteraction.onVisibilityChange(),this.listenerInteraction.onWindowResize(),this.listenerInteraction.onWindowMessage(),this.listenerInteraction.onMutationObserver(),this.renderView(),this.startWatchCanvasMartixChange(),this.layout(),this.resetZIndex(),clearTimeout(this.pregressTask),this.pregressTask=window.setTimeout((function(){e.store.isProgressEnable()&&(e.progress.style.display="block")}),M.PROGRESS_SHOW_DELAY),this.event.on(tt.TEB_HISTROYDATA_SYNCCOMPLETED,(function(){clearTimeout(e.pregressTask),e.store.checkOffline()})),this.event.on(tt.TEB_ADDTRANSCODEFILE,(function(t){var r=e.getFileInfo(t);r&&(r.thumbUrls=e.getThumbnailImages(t))})),this.event.on("draw_laser",(function(t){var r,i=e.store.getLaserRecordId(t.user,t.touchId);t.action===M.PROTOCOL_ACTION.RASER_SHOW_ACTION&&t.location.x>=0&&t.location.y>=0||(e.needForRAF[i]=!0),(null===(r=e.needForRAF[i])||void 0===r||r)&&(e.needForRAF[i]=!1,requestAnimationFrame((function(){e.needForRAF[i]=!0,e.globalLaserMap.set(i,t)})))})),this.event.on("render_video",(function(t){var r=e.getFileInfo(t);e.renderVideoFile.renderVideo(r)})),this.event.on("TEB_DRAW_FACE",(function(){try{e.drawFace()}catch(t){t.stack,t.message}})),this.event.on("on_board_scroll",(function(t){var r=t.trigger,i=e.getBoardScroll(),o=i.scrollLeft,n=i.scrollTop,a=e.getBoardScale(),s=e.getCurrentBoard();e.event.fireBoardScrollChangedEvent({trigger:r,boardId:s,scrollLeft:o,scrollTop:n,scale:a})})),this.event.on(tt.TEB_BOARD_LINUX_FORCE_REFRESH,(function(){"Linux"===i.getPlatform()&&e.refresh(!0,!0,!0,!1)})),this.event.on(tt.TEB_H5PPT_DOWN_GRADE_INTERNAL_OPERATOR,(function(t,r){var i,o;try{for(var n=Mh(e.store.downGradePageIndexMap),a=n.next();!a.done;a=n.next()){var s=a.value;if(s.slideIndex==r&&s.fid==t)return}}catch(t){i={error:t}}finally{try{a&&!a.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}e.store.downGradePageIndexMap.push({slideIndex:r,fid:t});var l=e.getFileInfo(t);if(0==l.thumbUrls.length){var c=e.getThumbnailImages(t);l.thumbUrls=c}if(l.thumbUrls[r].length>0){e.downGradeH5PPt=!0;var h={left:"0px",top:"0px",width:e.width,height:e.height,downGrade:!0};e.addElement(Ta.TEDU_BOARD_ELEMENT_IMAGE,l.thumbUrls[r],h)}})),this.drawTimer=requestAnimationFrame((function(){e.render()})),this.addBackupDomain("https://res.qcloudtiw.com","https://tic-res-1259648581.cos.accelerate.myqcloud.com",1),this.addBackupDomain("https://res.qcloudtiw.com","https://tic-res-1259648581.cos.ap-shanghai.myqcloud.com",0)},e.prototype.render=function(){var t=this;try{(this.store.getNeedDraw()||this.store.getIncreasingDraw()||this.store.getPartDraw()||this.store.getLaserDraw())&&(this.draw(),this.store.setIncreasingDraw(!1),this.store.setPartDraw(!1),this.store.setNeedDraw(!1),this.store.setLaserDraw(!1)),this.globalLaserMap.size&&(this.getToolType()===Xa.TEDU_BOARD_TOOL_TYPE_PEN&&this.teduToolType.isEraserToolType()&&gt()&&!this.settingConfig.showCursorOnTouch||this.globalLaserMap.forEach((function(e,r){t.drawLaser(e),t.globalLaserMap.delete(r)})))}catch(t){}this.drawTimer=requestAnimationFrame((function(){t.render()}))},e.prototype.getDrawWidth=function(t,e,r,i,o,n){var a=t-r,s=e-i,l=Math.sqrt(a*a+s*s)/o;return n*((2-(l=l>2?2:l))/2)},e.prototype.reportContainerSize=function(){this.container&&this.logger.reportInfo(this.loggerModuleName,"resize",{param:{extraInfo:JSON.stringify({width:this.container.clientWidth,height:this.container.clientHeight,devicePixelRatio:window.devicePixelRatio})}},ea.ONLY_ONLINE)},e.prototype.getPPTRemarks=function(t,e){var r;return this.logger.reportInfo(this.loggerModuleName,"getPPTRemarks",{param:{fid:t,pageIndex:e}}),this.pptRemarks[t]?-1===e?this.pptRemarks[t]:e>=0&&e<=Object.keys(this.pptRemarks[t]).length?((r={})[e]=this.pptRemarks[t][e]||"",r):{}:{}},e.prototype.setRemoteCursorVisible=function(t,e){void 0===e&&(e="drawing"),this.store.setRemoteCursorVisible(t,e)},e.prototype.setColor=function(t){this.store.setColor(t)},e.prototype.setHighlighterColor=function(t){this.store.setHighlighterColor(t)},e.prototype.setThin=function(t){this.store.setThin(t)},e.prototype.setLineTransparent=function(t){this.store.setLineTransparent(t)},e.prototype.setTextSize=function(t){var e,r=this.textAreaFocusBlurStatus.focus;if(this.store.setTextSize(t),r){r.textItem.textSize=this.getTextSize();var i=this.getTextSize()/1e4*this.height/12;r.setFontScale(i),r.newSmartPaintText(),(null===(e=r.dom)||void 0===e?void 0:e.value)&&this.collectTextInputHandler.draw(r,r.textItem,r.dom.value,r.dom.clientWidth+12,r.dom.clientHeight)}},e.prototype.getTextSize=function(){return this.store.getTextSize()},e.prototype.setTextColor=function(t){var e,r=this.textAreaFocusBlurStatus.focus;this.store.setTextColor(t),r&&(r.textItem.color=this.getTextColor(),r.setTextStyle(),(null===(e=r.dom)||void 0===e?void 0:e.value)&&this.collectTextInputHandler.draw(r,r.textItem,r.dom.value,r.dom.clientWidth+12,r.dom.clientHeight))},e.prototype.getTextColor=function(){return this.store.getTextColor()},e.prototype.setType=function(t){this.inputBlur(),this.clearTextTask(),this.store.setType(t),this.store.setLineTransparent(!1);var e="none";this.teduToolType.isTextInputToolType()?(this.textAreaBox.style.zIndex="100",e="auto"):(this.textAreaBox.style.zIndex="11",e="none");for(var r=this.textAreaBox.getElementsByTagName("textarea"),i=0;i<r.length;i++)r[i].style.pointerEvents=e;this.updateCursor(),this.store.setNeedDraw(!0)},e.prototype.setNextTextInput=function(t,e){this.store.nextInputObj.text=t,this.store.nextInputObj.keepFocus=e},e.prototype.undo=function(){this.inputBlur(),this.store.undo()},e.prototype.canUndo=function(){return this.store.canUndo()},e.prototype.redo=function(){this.inputBlur(),this.store.redo()},e.prototype.canRedo=function(){return this.store.canRedo()},e.prototype.clear=function(t,e){this.inputBlur(),this.store.clear(t,e)},e.prototype.clearAll=function(){this.inputBlur(),this.store.clearAll(!1,this.identifier),this.videoDiv.style.display="none",this.renderVideoFile.resetVideoStatus(),this.textAreaBox.innerHTML="",this.imageElementWrap.innerHTML="",this.jsxgraphElementWrap.innerHTML="",this.webviewWrap.innerHTML="",this.watermarkWrap.innerHTML="",this.event.fireResetData()},e.prototype._setBackgroundImage=function(t,e){this.store._setBackgroundImage(t,e)},e.prototype._setBackgroundImageAngle=function(t){this.store._setBackgroundImageAngle(t)},e.prototype.setBackgroundPic=function(t,e,r){void 0===r&&(r=Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER),this.store.setBackgroundPic(t,e,r)},e.prototype.setBackgroundH5=function(t,e){this.store.setBackgroundH5(t,e)},e.prototype.updateCurrentFillMode=function(t){void 0===t&&(t=Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER),this.store.updateCurrentFillMode(t)},e.prototype.deleteBackgroundPic=function(t){this.store.deleteBackgroundPic(t)},e.prototype.clearGlobalBgColor=function(){this.store.clearGlobalBgColor()},e.prototype.cancelSelect=function(t){this.store.cancelSelect(t)},e.prototype.setDrawEnable=function(t){var e=this;this.store.setDrawEnable(t),this.teduBoardScroll&&t?this.teduBoardScroll.enableScroll():this.teduBoardScroll.disableScroll();var r=this.store.getCurrentBoardData();if(r&&B(r.data)){r.data.forEach((function(t){"element"===t.type&&(t.subType===Ta.TEDU_BOARD_ELEMENT_H5?e.renderH5WebElement(t):t.subType===Ta.TEDU_BOARD_ELEMENT_MATH_BOARD&&e.renderJsxGraphElement(t))}));var i=this.getToolType()===Xa.TEDU_BOARD_TOOL_TYPE_MOUSE&&this.isH5PPTCosTrans();this.setElementStyle(".tic_board__transcode",{"pointer-events":i&&t&&this.settingConfig.mouseToolBehavior.turnPage.h5PPT?"auto":"none"})}this.store.isDrawEnable()||this.inputBlur(),this.updateCursor()},e.prototype.setHandwritingEnable=function(t){this.store.setHandwritingEnable(t)},e.prototype.isHandwritingEnable=function(){return this.store.isHandwritingEnable()},e.prototype.addFile=function(t,e,r,i,o,n){return this.logger.reportInfo(this.loggerModuleName,"addFile",{param:{fid:t,downloadUrl:i,needSwitch:n}},ea.ONLY_NATIVE),this.inputBlur(),t=this.store.addFile(t,e,r,i,o,!0,M.FILE_TYPE.IMG,n,this.identifier),n&&this.renderVideoFile.switchFilePauseVideo(),t},e.prototype.addImagesFile=function(t,e,r){var i=this;this.logger.reportInfo(this.loggerModuleName,"addImagesFile",{param:{title:e,needSwitch:r}},ea.ONLY_NATIVE),this.inputBlur();var o="#".concat(Wt.getTimeStamp());e=e||"imagesfile_".concat(o);var n=JSON.stringify(t),a=(new Date).getTime(),s=lt(n),l=(new Date).getTime(),c=100*s.length/n.length,h=l-a;if(s&&s.length>M.IMAGESFILE_MAX_URL_LENGTH)return setTimeout((function(){i.event.fireWarningEvent($.TEDU_BOARD_WARNING_IMAGESFILE_TOO_LARGE,"please try to split into two or more files, or try to use shorter url."),i.logger.reportInfo(i.loggerModuleName,"images_file_url_too_large",{param:{extraInfo:JSON.stringify({urls:n,urls_len:n.length,compress_len:s.length,compress_ratio:c,elapse:h})}},ea.ONLY_ONLINE)}),0),"";var u=s,d=this.store.isFileUrlExist(u);if(d){var p=this.getFileInfo(d);return o=p.fid,setTimeout((function(){i.event.fireWarningEvent($.TEDU_BOARD_WARNING_IMAGESFILE_ALREADY_EXISTS,o),i.logger.reportInfo(i.loggerModuleName,"images_file_already_exists",{param:{boardId:i.getCurrentBoard(),fileId:o}},ea.ONLY_ONLINE)}),0),o}return this.store.addFile(o,t,e,u,M.RATIO,!1,M.FILE_TYPE.IMAGESFILE,r,this.identifier).then((function(t){r&&(i.cacheBackgroundImageAndH5(),i.renderVideoFile.switchFilePauseVideo()),i.logger.reportInfo(i.loggerModuleName,"add_images_file_start",{param:{fileId:t,extraInfo:JSON.stringify({urls:n,urls_len:n.length,compress_len:s.length,compress_ratio:c,elapse:h})}},ea.ONLY_ONLINE)}),(function(){})),o},e.prototype.addVideoFile=function(t,e,r){return void 0===e&&(e=""),void 0===r&&(r=!0),this.renderVideoFile.addVideoFile(t,e,r)},e.prototype.addVODFile=function(t,e,r){return this.renderVideoFile.addVODFile(t,e,r)},e.prototype.addH5File=function(t,e,r,i){var o=this;void 0===e&&(e=""),void 0===r&&(r=!0),void 0===i&&(i=!1),this.logger.reportInfo(this.loggerModuleName,"addH5File",{param:{url:t}},ea.ONLY_NATIVE),this.inputBlur();var n="#".concat(Wt.getTimeStamp()),a=this.store.isFileUrlExist(t);if(a){var s=this.getFileInfo(a);return n=s.fid,setTimeout((function(){o.event.fireWarningEvent($.TEDU_BOARD_WARNING_H5FILE_ALREADY_EXISTS,n),o.logger.reportInfo(o.loggerModuleName,"h5file_already_exists",{param:{fileId:n,extraInfo:t}},ea.ONLY_ONLINE)}),0),n}var l=this.boardWrap.clientWidth,c=this.boardWrap.clientHeight;return this.store.addH5File(n,t,l,c,e,r,this.identifier,i),this.renderVideoFile.switchFilePauseVideo(),n},e.prototype.deleteFile=function(t){return this.logger.reportInfo(this.loggerModuleName,"deleteFile",{param:{fid:t}},ea.ONLY_NATIVE),this.inputBlur(),this.store.deleteFile(t,this.identifier)},e.prototype.switchFile=function(t,e,r,i){var o=this;return void 0===i&&(i=!1),this.progress.style.display="none",new Promise((function(n,a){o.logger.reportInfo(o.loggerModuleName,"switchFile",{param:{fid:t,boardId:e,setpIndex:r}},ea.ONLY_NATIVE),o.settingConfig.isDiscussionGroupMode&&!i&&o.store.getDiscussionGroupIdByUserId(o.identifier).length||t&&t!=o.store.getCurrentFile()&&(clearTimeout(o.pptH5LoadTask),o.renderH5PPT.resetPPTIframe(!1,!0),bs.destroy(),o.renderBackgroundImageAndH5.removeBackgroundIframe(),o.pptH5LoadTask=window.setTimeout((function(){try{var i=o.store.switchFile(t,e,r,o.identifier);o.cacheBackgroundImageAndH5(),n(i)}catch(t){a(t)}}),50),o.renderVideoFile.switchFilePauseVideo())}))},e.prototype.getFileInfoList=function(){return this.store.getFileInfoList()},e.prototype.getGroup=function(){return this.store.getGroup()},e.prototype.getFileInfo=function(t){return void 0===t&&(t=this.getCurrentFile()),this.store.getFileInfo(t)},e.prototype.getBoardInfoList=function(t){return this.store.getBoardInfoList(t)},e.prototype.getBoardByGroup=function(t){return this.store.getBoardByGroup(t)},e.prototype.clearFileDraws=function(t){return this.inputBlur(),this.store.clearFileDraws(t)},e.prototype.needLayout=function(t,e,r,i,o,n,a,s,l){var c=!1;if(e=Math.ceil(e),r=Math.ceil(r),o=Math.ceil(o),i=Math.ceil(i),n=Math.ceil(n),t==this.preLayout.dpr&&e==this.preLayout.width&&r==this.preLayout.height&&o==this.preLayout.left&&i==this.preLayout.top&&n==this.preLayout.scale&&a==this.preLayout.ratio&&s==this.preLayout.horizontalScrollLeft&&l==this.preLayout.verticalScrollTop||(this.preLayout.dpr=t,this.preLayout.width=e,this.preLayout.height=r,this.preLayout.left=o,this.preLayout.top=i,this.preLayout.scale=n,this.preLayout.ratio=a,this.preLayout.horizontalScrollLeft=s,this.preLayout.verticalScrollTop=l,c=!0),this.canvasCtx.getTransform){var h=this.canvasCtx.getTransform(),u=h.a,d=h.d;u===this.preLayout.matrixScaleX&&d===this.preLayout.matrixScaleY||(this.preLayout.matrixScaleX=u,this.preLayout.matrixScaleY=d,c=!0)}if(c){var p=this.container.getBoundingClientRect(),f=this.boardWrap.getBoundingClientRect();p&&f&&this.logger.reportInfo(this.loggerModuleName,"layout",{param:{extraInfo:JSON.stringify({containerRect:p,boardRect:f})}},ea.ONLY_ONLINE)}return c},e.prototype.layout=function(t){var e;void 0===t&&(t=null);var r=this.container.clientWidth,i=this.container.clientHeight;if(0===r||0===i)return this.width=0,this.height=0,!1;var o=M.SCALE,n=M.LEFT,a=M.TOP,s=M.RATIO,l=new Sc(r,i,this.option.config.ratio,o,a,n);this.boardBaseHeight=l.height,this.boardBaseWidth=l.width,o=this.store.getBoardScale();var c=this.store.getDragData();c&&(n=c.xOffset,a=c.yOffset,o=c.scale),s=t&&t.ratio||this.store.getBoardRatio();var h,u,d,p,f=new Sc(r,i,s,o,a,n),g=f.width,m=f.height,y=f.ratioWidth,v=f.ratioHeight,_=0,E=0,T=g*o/100,b=m*o/100;this.width=Math.ceil(T),this.height=Math.ceil(b),this.width%2==1&&(this.width+=1),this.height%2==1&&(this.height+=1),_=this.width-T,E=this.height-b,this.store.setContainerSize(r,i),this.store.setBoardSize(this.width,this.height),this.width/this.height>r/i?(this.height>i?(d=50+Math.max(0,this.height-i)/2/this.height*100,p=50-Math.max(0,this.height-i)/2/this.height*100):(d=50,p=50),h=50+Math.max(0,this.width-r)/2/this.width*100,u=50-Math.max(0,this.width-r)/2/this.width*100):(d=50+Math.max(0,this.height-i)/2/this.height*100,p=50-Math.max(0,this.height-i)/2/this.height*100,this.width>r?(h=50+Math.max(0,this.width-r)/2/this.width*100,u=50-Math.max(0,this.width-r)/2/this.width*100):(h=50,u=50)),u=+u.toFixed(1),h=+h.toFixed(1),p=+p.toFixed(1),d=+d.toFixed(1),this.moveDragArea={minLeft:u,maxLeft:h,minTop:p,maxTop:d},n=Math.min(h,Math.max(u,n)),a=Math.min(d,Math.max(p,a)),c&&this.store.dragDataList.updateDragData(this.getCurrentBoard(),{xOffset:n,yOffset:a});var S,x,w=window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||1;r/i>this.width/this.height?(r>this.width?(S=this.width,x=this.width*v/y):r<this.width?(S=r,x=r*v/y):(S=this.width,x=this.height),_=0,E=Math.max(1,E)*v/y):(i>this.height?(S=this.height*y/v,x=this.height):i<this.height?(S=i*y/v,x=i):(S=this.width,x=this.height),E=0,_=Math.max(1,_)*y/v),this.canvasWidth=S,this.canvasHeight=x;var O=this.width*(n-50)/100,I=this.height*(a-50)/100,A=this.container.clientWidth,D=this.container.clientHeight,C=this.container.offsetWidth,P=this.container.offsetHeight,L=this.progress.style.display,R=this.boardBox.style.cursor,N=this.graphNode.style.cursor,B="position:relative !important;left: ".concat(A/2,"px !important;top: ").concat(D/2,"px !important;-webkit-transform: translateX(-50%) translateY(-50%) !important;transform: translateX(-50%) translateY(-50%) !important;overflow:hidden !important;width:").concat(this.width,"px !important;height:").concat(this.height,"px !important"),k="position:absolute !important;left: ".concat(n,"% !important;top:").concat(a,"% !important;-webkit-transform: translateX(-50%) translateY(-50%) !important;transform: translateX(-50%) translateY(-50%) !important;width:").concat(this.width,"px !important;height:").concat(this.height,"px !important;cursor:").concat(R,";"),F="z-index:200 !important; display:".concat(L,"; position:absolute !important;left: 50% !important;top: 50% !important;-webkit-transform: translateX(-50%) translateY(-50%) !important;transform: translateX(-50%) translateY(-50%) !important;overflow:hidden !important;"),U="z-index:10 !important;position:absolute !important;left:0 !important;top:0 !important;margin-left:".concat((this.width-S)/2,"px !important;margin-top:").concat((this.height-x)/2,"px !important;line-height:1 !important;width:").concat(S,"px !important;height:").concat(x,"px !important;cursor:").concat(N);if(o===M.SCALE){var H=this.container.getBoundingClientRect(),G=H.width,q=H.height,W=C-A,Y=P-D;this.teduBoardScroll.setScrollBarSize(G-W,q-Y,A,D),this.teduBoardScroll.disableScroll()}else{if(this.textInputStatus){var z=this.container.scrollLeft,j=this.container.scrollTop;z&&(this.container.scrollLeft=0),j&&(this.container.scrollTop=0)}this.teduBoardScroll.setScrollBarSize(this.width,this.height,A,D),this.teduBoardScroll.enableScroll()}d!=p||h!=u?(j=d!=p?(this.height-D)*(1-(a-p)/(d-p)):0,z=h!=u?(this.width-A)*(1-(n-u)/(h-u)):0,this.teduBoardScroll.scrollToScrollBar(z,j),this.store.setScrollDistance(z,j,A,D)):this.store.setScrollDistance(0,0,A,D);var V=this.needLayout(w,r,i,a,n,o,s,this.teduBoardScroll.horizontalScrollLeft,this.teduBoardScroll.verticalScrollTop);if(this.updateCursor(),this.canvasElement&&V){this.viewContainer.setAttribute("style",U),this.viewContainer.setAttribute("width",S*w),this.viewContainer.setAttribute("height",x*w),this.viewContainer.render();var X=this.viewContainer.getCanvasContext(),J=((S-g)/2-(o/100-1)*g/2+O)*w,K=((x-m)/2-(o/100-1)*m/2+I)*w;this.settingConfig.canvasTranslateX=_,this.settingConfig.canvasTranslateY=E,X.translate(J,K),X.scale(w,w)}return this.boardWrap&&this.boardWrap.setAttribute("style",B),this.boardBox&&this.boardBox.setAttribute("style",k),this.laserWrap&&this.laserWrap.setAttribute("style",k),this.audioWrap&&this.audioWrap.setAttribute("style",k),this.transcodeEl&&this.transcodeEl.setAttribute("style",k),this.webviewWrap&&this.webviewWrap.setAttribute("style",k+"z-index:8;pointer-events: none;"),null===(e=this.mathToolWrap)||void 0===e||e.setAttribute("style",k+"z-index:30;pointer-events: none;"),this.imageElementWrap&&this.imageElementWrap.setAttribute("style",k+"z-index:7;"),this.watermarkWrap&&this.watermarkWrap.setAttribute("style",k),this.jsxgraphElementWrap&&this.jsxgraphElementWrap.setAttribute("style",k+"z-index:8;pointer-events: none;"),this.cursorLayerWrap&&this.cursorLayerWrap.setAttribute("style",k+"z-index:0;user-select:none;-webkit-user-select:none; display: none"),this.cursorLayerRemoteWrap&&this.cursorLayerRemoteWrap.setAttribute("style",k+"z-index:0;user-select:none;-webkit-user-select:none; display: none; pointer-events: none"),this.textAreaBox&&this.textAreaBox.setAttribute("style",k+"z-index:".concat(11===this.getToolType()?100:11,";overflow:hidden;")),this.progress&&this.progress.setAttribute("style",F),this.bgDiv&&this.bgDiv.setAttribute("width",this.width+""),this.bgDiv&&this.bgDiv.setAttribute("height",this.height+""),this.iframeDOM&&this.iframeDOM.setAttribute("style","position: absolute !important;top: 0 !important;left: 0 !important;width:".concat(this.width,"px !important;height:").concat(this.height,"px !important;border:none !important;z-index:8 !important;")),(this.renderVideoFile.videoStatus.isCreated||this.renderVideoFile.videoStatus.isError)&&this.renderVideoFile._setVideoElementStyle(!0),this.videoDiv&&(this.videoDiv.style.left="".concat(n,"%"),this.videoDiv.style.top="".concat(a,"%")),this.renderH5File.layout(S,x),bs.instance&&bs.instance.resize(),V},e.prototype.drawLaser=function(t){this.maxLaserSeq=t.seq;var e=0,r=0,i=1,o=this.store.getLaserRecordId(t.user,t.touchId),n=this.laserCursorMap.get(o),a=this.store.getCursorIcons(),s=a[t.toolType];if(s||(s=a[Xa.TEDU_BOARD_TOOL_TYPE_PEN]),"url"!=s.cursor)return this.laserCursorMap.delete(o),void(n&&n.remove());if(t.action===M.PROTOCOL_ACTION.RASER_SHOW_ACTION&&t.location.x>=0&&t.location.y>=0){var l,c="";if(!(l=t.toolType===Xa.TEDU_BOARD_TOOL_TYPE_LASER?this.remoteLaserIcon:t.toolType===Xa.TEDU_BOARD_TOOL_TYPE_PEN?this.remotePenIcon:this.remoteIcons["".concat(t.toolType)]))return;c=l.src;var h=M.ICONS[Number(t.toolType)],u=l.naturalWidth,d=l.naturalHeight;e=h.offsetX||0,r=h.offsetY||0,n||(n=new wc(this.laserWrap,t),this.laserCursorMap.set(o,n));try{var p=this.store.getSystemCursorEnable(),f=t.user===this.option.userId;if(f&&p)e=Math.min(e,u),r=Math.min(r,d);else{var g=Ss.cursorSize;e=e*(i=Math.max(g[0],Math.min(g[1],this.boardBaseWidth*u/800))/u)+u*(1-i)/2,r=r*i+d*(1-i)/2}var m=t.location.x/1e4*this.width,y=t.location.y/1e4*this.height,v={size:(t.style.size||200)/1e4*this.height,position:t.style.position,color:t.style.color,style:t.style.style,displaySelf:t.style.displaySelf};v.size=(v.size||200)/1e4*this.height;var _=t.title;!f||this.ownerNicknameVisible&&!this.settingConfig.isImageCursorEnable()||(_=""),f&&this.isCustomCursorIcon&&(c="",_="",t.location.x>0&&t.location.y>0&&this.event.fireBoardCursorPositionEvent({x:t.location.x,y:t.location.y})),n.move({systemCursorEnable:p,isOwner:f,cursorUrl:c,laserTitle:_,style:v,translateX:m-e,translateY:y-r,scale:i,color:t.color,type:t.toolType,eraserSize:this.getEraserSize(),offsetX:e,offsetY:r})}catch(t){}}else this.laserCursorMap.delete(o),n&&n.remove()},e.prototype.drawLine=function(t,e){var r,i=this,o=null,n=!1;if(this.fpsOptimization&&!this.store.getNeedDraw()&&e.getPoints()[0].timestamp){var a=e.drawIndex;n=!0;var s=e.getPoints();if(this.store.getPartDraw()){(o=new fs(this.instanceKey,e.user,e,e.version)).lines=[],o.fullPoints=[];for(var l=0;l<a;l++)o.addPoint(s[l]);o.ID+="-increasing",o.touchId=e.touchId,o.setBoardSize(this.width,this.height),this.store.renderHandler.addToRenderMap(o.ID,new ms(o))}else{if(a===e.getPoints().length)return;(o=new fs(this.instanceKey,e.user,e,e.version)).lines=[],o.fullPoints=[],o.touchId=e.touchId,"v2"===e.version&&a>=1&&s[a].action!==M.PROTOCOL_ACTION.LINE_END_ACTION&&!s[a].middle&&a--,a-2>=0&&o.addPoint(s[a-2]),a-1>=0&&o.addPoint(s[a-1]),o.ID+="-increasing",o.setBoardSize(this.width,this.height),this.store.renderHandler.addToRenderMap(o.ID,new ms(o))}if(a<s.length){for(var c=Math.ceil((this.preRenderCost+1)/(.75*M.RENDER_INTERVAL));c>0&&a<s.length;){var h=s[a];o.addPoint(h),e.drawIndex=++a,"v2"===e.version&&s[a]&&s[a].action!==M.PROTOCOL_ACTION.LINE_END_ACTION&&(e.drawIndex=Math.min(++a,s.length)),c--}a<s.length&&setTimeout((function(){i.store.setIncreasingDraw(!0)}),0)}}else(o=e).drawIndex=e.getPoints().length;null===(r=this.store.renderHandler.getRender(o.ID))||void 0===r||r.renderTo(t,{width:this.width,height:this.height,minLineWidth:this.minLineWidth,onlyNew:n}),n&&this.store.renderHandler.removerFromRenderMap(o.ID);var u=e.user,d=e.touchId,p=this.store.getLaserRecordId(u,d),f=this.store.laserDataMap[p]||[],g=this.drawLineMaxSeq[p]||0,m=this.store.needDrawLaserSeq[p]||{};o.getPoints().forEach((function(t){var e=t.seq,r=m[e];r&&(e>g&&(i.drawLaser(r),g=e),delete m[e])})),this.drawLineMaxSeq[p]=g,f&&(this.store.laserDataMap[p]=f.filter((function(t){return!t||t.seq>=g}))),m&&Object.keys(m).forEach((function(t){t<=g&&delete m[t]}))},e.prototype.drawGraph=function(t,e){var r=this,i=this.store.renderHandler.getRender(t.ID);null==i||i.renderTo(e,{width:this.width,height:this.height,minLineWidth:this.minLineWidth});var o=t.user,n=this.store.graphDataMap[o],a=this.store.laserDataMap[o],s=t.startPoint.seq;if(n&&n[s]&&n[s].length){var l=n[s].shift();t.seq=l.seq,t.endPoint.x=l.endPoint.x,t.endPoint.y=l.endPoint.y,t.startPoint.x=l.startPoint.x,t.startPoint.y=l.startPoint.y,t.setBorder();var c=this.store._buildOnlyRaserData(o,l.laser);this.drawLaser(c),n[s]=n[s].filter((function(t){return t.seq>l.seq})),a&&(this.store.laserDataMap[o]=a.filter((function(t){return t.seq>l.seq}))),setTimeout((function(){r.store.setPartDraw(!0)}),0)}},e.prototype.isDrawEnable=function(){return this.store.isDrawEnable()},e.prototype.getGlobalBackgroundColor=function(){return this.store.getGlobalBackgroundColor()},e.prototype.getBackgroundColor=function(){return this.store.getBackgroundColor()},e.prototype.getToolType=function(){return this.teduToolType.toolType},e.prototype.getBrushColor=function(){return this.store.getColor()},e.prototype.getHighlighterColor=function(){return this.store.getHighlighterColor()},e.prototype.getBrushThin=function(){return this.store.getThin()},e.prototype.setDataSyncEnable=function(t){this.store.setDataSyncEnable(t)},e.prototype.isDataSyncEnable=function(){return this.store.isDataSyncEnable()},e.prototype.setTextFontFamily=function(t){t=t||"customFontFamily",this.store.setTextFontFamily(t),this.store.checkTextFontFamily(t)||this.addTextFontFamily(t)},e.prototype.getTextFontFamily=function(){return this.store.getTextFontFamily()},e.prototype.setTextFontStyle=function(t){this.store.setTextFontStyle(t)},e.prototype.getTextFontStyle=function(){return this.store.getTextFontStyle()},e.prototype.setTextLineHeight=function(t){this.store.setTextLineHeight(t)},e.prototype.getTextLineHeight=function(){return this.store.getTextLineHeight()},e.prototype.setCursorPosition=function(t){var e=parseInt(t.x/this.width*1e4+""),r=parseInt(t.y/this.height*1e4+"");this.store.collectRaserData().start("",e,r,this.getToolType()),this.store.collectRaserData().draw("",e,r,this.getToolType(),!0,!1),this.store.collectRaserData().end("",e,r,this.getToolType())},e.prototype.setBoardRatio=function(t){if(function(t){var e=!0;try{var r=t.split(":");2!=r.length?e=!1:0!=Number(r[0])&&0!=Number(r[1])||(e=!1)}catch(t){e=!1}return e}(t)){if(this.store.getBoardRatio()===t)return;this.inputBlur(),this.store.setBoardRatio(this.store.getCurrentBoard(),t),this.store.setNeedDraw(!0)}},e.prototype.getBoardRatio=function(){return this.store.getBoardRatio()||this.option.config.ratio},e.prototype.setBoardScale=function(t,e){void 0===e&&(e="userSetting"),this.inputBlur(),this.store.setBoardScale(t,e),this.store.setNeedDraw(!0)},e.prototype.getBoardScale=function(){return this.store.getBoardScale()},e.prototype.setBoardContentFitMode=function(t){this.store.setBoardContentFitMode(t)},e.prototype.getBoardContentFitMode=function(){return this.store.getBoardContentFitMode()},e.prototype.setGraphStyle=function(t){this.store.setGraphStyle(t)},e.prototype.getGraphStyle=function(){return this.store.getGraphStyle()},e.prototype.setOvalDrawMode=function(t){this.store.setOvalDrawMode(t)},e.prototype.getOvalDrawMode=function(){return this.store.getOvalDrawMode()},e.prototype.syncRemoteTime=function(t,e){this.enableSyncTime=!0,this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"syncRemoteTime",data:{userId:t,timestamp:e}})}},ea.ONLY_ONLINE),this.checkUserTime(t),this.userTime[t].avTimeOffset=Wt.getTimeStamp()-e},e.prototype.checkUserTime=function(t){this.userTime[t]||(this.userTime[t]={avTimeOffset:0,imTimeOffset:0})},e.prototype.getSyncTime=function(){return Wt.getTimeStamp()},e.prototype.updateCursor=function(){var t=this.graphNode;if(this.boardBox){var e=this.getToolType(),r=this.store.getCursorIcons()[e];if(e===Xa.TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG&&!1===this.enableScaleTool&&((r=JSON.parse(JSON.stringify(r))).cursor="move",r.url=""),r){var i="";if(r.hasOwnProperty("cursor"))if(this.settingConfig.isImageCursorEnable()||!this.store.getSystemCursorEnable()&&(1===e||2===e||3===e||19===e))i="url"===r.cursor&&r.url?this.isDrawEnable()||2===e?"url(".concat(L.noneCursorIcon,") 0 0, none"):"default":r.cursor;else if("url"===r.cursor){var o=r.url.replace("var(--brush-color)",this.store.color).replace(escape("var(--brush-color)"),this.store.color);i="url('".concat(o,"') ").concat(r.offsetX||0," ").concat(r.offsetY||0,", auto")}else i=r.cursor;if(i){var n=this.boardBox.style.cursor;n&&n.replace(/["']/g,"")===i.replace(/["']/g,"")||(this.boardBox.style.cursor="none",this.boardBox.style.cursor=i,this.boardBox.style.webkitTransform="translateX(-50%) translateY(-50%) !important",t.style.cursor="none",t.style.cursor=i,this.textAreaBox.style.cursor="none",this.textAreaBox.style.cursor=i)}}else this.boardBox.style.cursor="none",t.style.cursor="none",this.textAreaBox.style.cursor="none",this.boardBox.style.cursor="auto",t.style.cursor="auto",this.textAreaBox.style.cursor="auto"}},e.prototype.inputBlur=function(){if(1===this.textInputStatus){var t=this.textAreaFocusBlurStatus.focus;t&&t.dom&&t.dom.blur(),this.textInputStatus=0}},e.prototype.getThumbnailImages=function(t){var e=this.getFileInfo(t),r=[];if(e){if(e.fid===M.COMMON_GROUP)return r;var i=e.downloadURL;if(!i)return r;if(e.type===M.FILE_TYPE.H5FILE||e.type===M.FILE_TYPE.VOD||e.type===M.FILE_TYPE.LIVE)return r;if(e.type===M.FILE_TYPE.H5PPT)if("WPS"===q(e.downloadURL))for(var o=e.downloadURL,n=0;n<e.pageCount;n++)r.push("".concat(o,"&ci-process=doc-preview&page=").concat(n+1));else{if(o="",(s=i.match(".*/([0-9a-zA-Z-]+)_tiw/h5/.*"))&&s.length>1)o=i.substring(0,i.indexOf("_tiw/h5"))+"_tiw/thumbnail";else{var a=function(t){var e=t.match(".*/([0-9a-zA-Z-]+)_tiw/h5/.*");return e&&e.length>1?e[1]:t.substring(t.indexOf(".com/")+5,t.indexOf("/index.html"))}(i);o="".concat(L.THUMBNAIL_HOSTNAME,"/").concat(a)}for(n=0;n<e.pageCount;n++)r.push("".concat(o,"/").concat(n+1,".jpg"))}else if(i.endsWith("/")){var s;for(o="",o=(s=i.match(".*/([0-9a-zA-Z-]+)_tiw/(picutre|picture)/.*"))&&s.length>2?i.indexOf("_tiw/picutre")>-1?i.substring(0,i.indexOf("_tiw/picutre"))+"_tiw/thumbnail/":i.substring(0,i.indexOf("_tiw/picture"))+"_tiw/thumbnail/":i,n=0;n<e.pageCount;n++)r.push("".concat(o).concat(n+1,".jpg"))}else if(function(t){return t.indexOf("myqcloud.com")>-1&&t.indexOf("cos")>-1}(i)){var l=ee(i);for(n=0;n<e.pageCount;n++)r.push("".concat(l).concat(n+1))}return r}return[]},e.prototype.setCursorIcon=function(t,e){t===Xa.TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG&&(this.scaleIcons.enlarge=e.url),this.store.setCursorIcon(t,e),this.updateCursorIcons(),this.initRemoteCursorIcon()},e.prototype.setZoomCursorIcon=function(t,e){this.store.setZoomCursorIcon(t,e),this.scaleIcons.enlarge=t.url,this.scaleIcons.shrink=e.url,this.updateCursorIcons()},e.prototype.addAckData=function(t){this.store.addSendAckData(t)},e.prototype.syncAndReload=function(){this.store.syncAndReload()},e.prototype.refresh=function(t,e,r,i){var o=this;switch(void 0===t&&(t=!0),void 0===e&&(e=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),t&&this.renderH5PPT.resetPPTStatus(),this.renderH5PPT.resetPPTIframe(e),!e||r||i||(this.store.sendRefreshData(),this.logger.reportInfo(this.loggerModuleName,"send_force_refresh",{param:{extraInfo:JSON.stringify({platform:"web"})}},ea.ONLY_ONLINE)),this.renderBackgroundImageAndH5.resetBackgroundImage(),this.renderBackgroundImageAndH5.removeBackgroundIframe(),this.renderH5File.resetH5IFrame(),this.renderVideoFile.resetVideoStatus(),this.removeImageElement(!0),this.removeCustomGraph(!0),this._removeRenderedElement(),this.pregressTask=window.setTimeout((function(){o.store.isProgressEnable()&&(o.progress.style.display="block")}),M.PROGRESS_SHOW_DELAY),this.store.setNeedDraw(!0),this.event.fireRefreshEvent(),this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"refresh"})}},ea.ONLY_ONLINE),this.getFileInfo(this.getCurrentFile()).type){case M.FILE_TYPE.H5PPT:break;case M.FILE_TYPE.IMG:var n=this.store.getCurrentBoardData().backgroundPic;if(n&&n.url&&n.show)break;default:setTimeout((function(){o.progress&&(o.progress.style.display="none")}),200)}},e.prototype.snapshot=function(t){var e=this,r=L.html2canvasUrl,i=this.seqUtil.getSeq()+"";window.html2canvas?this.innerSnapshot(t,i):K(r,(function(){e.innerSnapshot(t,i)}))},e.prototype.innerSnapshot=function(t,e){var r=this,i="",o=!1;t&&(i=t.userData||"",o=t.full||!1);var n=this.snapshotRequestMap.get(e)||0;this.snapshotRequestMap.set(e,n+1),function(t,e,r,i,o,n){var a=this,s=window.html2canvas;return new Promise((function(l,c){return function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function a(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))}(a,void 0,void 0,(function(){var a,h,u,d,p,f,g,m,y,v,_,E,T,b,S,x,w,O,I,A,D,C,P,L,M,R,N,B,F,U,H,G,q,W,Y,z,j,V,X,J,K,Z,Q,$,tt,et,rt,it,ot;return function(t,e){var r,i,o,n,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}(this,(function(nt){switch(nt.label){case 0:if(!s)return[3,5];if(a=0,h=!1,s.onErrorCallback=function(t){h=!0,c({code:t})},s.onWarningCallback=function(t){a=t},u="clone-tiw-container-id_"+e,f=void 0,g=void 0,y=void 0,i){for(Dh(u),d=t.container.cloneNode(!0),p=d.querySelector(".tx_board_canvas_wrap"),f=d.querySelector(".tx_board_canvas_box"),m=d.querySelector("#tic_video_wrap"),g=d.querySelector(".tiw-sketch__canvas"),d.id=u,d.style.width=p.style.width,d.style.height=p.style.height,d.style.position="fixed",d.style.left="-1000000px",d.style.top="-1000000px",p.style.left="unset",p.style.top="unset",p.style.transform="unset",p.style.webkitTransform="unset",v=p.children,_=0,E=v.length;_<E;_++)"canvas"===(T=v.item(_)).tagName.toLowerCase()?(T.width=parseFloat(p.style.width),T.height=parseFloat(p.style.height)):(T.style.left="50%",T.style.top="50%");document.body.appendChild(d),k(n)&&n(g.getContext("2d")),null===(it=d.querySelector(".tiw-scroll-vertical__wrap"))||void 0===it||it.remove(),null===(ot=d.querySelector(".tiw-scroll-horizontal__wrap"))||void 0===ot||ot.remove()}else d=t.container,p=t.boardWrap,f=t.boardBox,m=t.videoDiv,g=t.canvasElement;return y=t.container.querySelector(".tiw_board_webview_wrap"),b=y.getBoundingClientRect(),S=[],x=[],w=[],O=["tic_board_textbox","tic_board__imagewrap","tic_cursorlayer__wrap","tic-board__audiowrap","tiw_watermark__wrap","tiw_board_mathtool_wrap"],I=!1,A=window.devicePixelRatio,D=0,C=0,P=0,L=0,M=0,R=0,N=0,B=0,F=d.clientWidth*A,U=d.clientHeight*A,(H=document.createElement("canvas")).width=F,H.height=U,G=H.getContext("2d"),[4,Ih(s(d,{allowTaint:!0,useCORS:!0,backgroundColor:null,logging:!1,onclone:function(t){var e=t.querySelector("#"+d.id);e&&(i||Ch(d,e))},ignoreElements:function(e){var r=e.tagName.toLocaleLowerCase();if("video"===r)return"none"!==m.style.display&&"none"!==e.style.display&&e.src&&x.push(e),!0;if("canvas"===r)return"none"!==e.style.display&&w.push(e),!0;if("iframe"===r){if("none"!==e.style.display&&e.src)if(i){var o="."+e.className.split(" ").join("."),n=t.container.querySelector(o);e.classList.contains("tic_iframe_H5")?n&&S.unshift(n):n&&S.push(n)}else e.classList.contains("tic_iframe_H5")?S.unshift(e):S.push(e);return!0}return"div"===r&&!!O.find((function(t){return e.className.indexOf(t)>-1}))&&(I=!0,!0)}}))];case 1:return q=Ah.apply(void 0,[nt.sent(),2]),W=q[0],Y=q[1],h?[2]:(W&&(Dh(u),c("snapshot fail:"+W.message)),G.drawImage(Y,0,0,F,U),D=(f.clientWidth-t.container.clientWidth)/2*A-(f.offsetLeft-f.clientWidth/2)*A,z=D,M=D<0?-D:0,D=D<0?0:D,C=(f.clientHeight-t.container.clientHeight)/2*A-(f.offsetTop-f.clientHeight/2)*A,j=C,R=C<0?-C:0,C=C<0?0:C,P=f.clientWidth>t.container.clientWidth?t.container.clientWidth:f.clientWidth,P*=A,L=f.clientHeight>t.container.clientHeight?t.container.clientHeight:f.clientHeight,N=P,B=L*=A,x.forEach((function(t){i?G.drawImage(t,0,0,F,U):G.drawImage(t,-z,-j,t.clientWidth*A,t.clientHeight*A)})),V=[],S.forEach((function(t){var e=new Promise((function(e,r){var i={ack:!1},o=function(r){if(r.data.data&&r.data.data.src===t.src)if(r.data.cmd===va)i.ack=!0,t.contentWindow.postMessage({module:on,cmd:Ea,data:{src:t.src}},"*");else if(r.data.cmd===Ea){window.removeEventListener("message",o);var n=r.data.data.dataUrl;if(t&&n){var a=new Image;a.onload=function(){e({iframe:t,image:a})},a.src=n}else e({iframe:t,image:null})}};window.addEventListener("message",o),t.contentWindow.postMessage({module:on,cmd:ya,data:{src:t.src}},"*"),setTimeout((function(){i.ack||(e({iframe:t,image:null}),window.removeEventListener("message",o))}),200)}));V.push(e)})),[4,Ih(Promise.all(V))]);case 2:return X=Ah.apply(void 0,[nt.sent(),2]),J=X[0],K=X[1],J&&(Dh(u),c("snapshot fail:"+J.message)),K.forEach((function(t){var e=t.iframe,r=t.image;if(e&&r){var n=0,a=0,s=0,l=0;if(e.classList.contains("tiw-board-iframe-el")){var c=o(e.dataset.belongSeq);if(c&&(n=c.rect.left,a=c.rect.top,s=c.rect.width,l=c.rect.height),i){var h=e.getBoundingClientRect();G.drawImage(r,h.left-b.left,h.top-b.top,s,l)}else G.drawImage(r,n,a,s,l)}else i?G.drawImage(r,0,0,F,U):G.drawImage(r,D,C,P,L,M,R,N,B)}})),I?[4,Ih(s(d,{allowTaint:!0,useCORS:!0,backgroundColor:null,logging:!1,onclone:function(t){var e=t.querySelector("#"+d.id);e&&(e.style.background="none",i||Ch(d,e)),t.querySelectorAll("textarea").forEach((function(t){var e=t.style.width,r=parseFloat(e);r>parseFloat(t.style.maxWidth)&&(t.style.maxWidth="".concat(r+12,"px"))}))},ignoreElements:function(t){var e,r,i=t.tagName.toLocaleLowerCase(),o=p.classList.item(0);return!(null===(r=null===(e=null==t?void 0:t.parentNode)||void 0===e?void 0:e.classList)||void 0===r||!r.contains(o)||"div"===i&&O.find((function(e){return t.className.indexOf(e)>-1})))}}))]:[3,4];case 3:if(Z=Ah.apply(void 0,[nt.sent(),2]),Q=Z[0],$=Z[1],Q)return Dh(u),c("snapshot fail:"+Q.message),[2];G.drawImage($,0,0,F,U),nt.label=4;case 4:return D=(g.clientWidth-d.clientWidth)/2*A,M=D<0?-D:0,D=D<0?0:D,C=(g.clientHeight-d.clientHeight)/2*A,R=C<0?-C:0,C=C<0?0:C,P=g.clientWidth>d.clientWidth?d.clientWidth:g.clientWidth,P*=A,L=g.clientHeight>d.clientHeight?d.clientHeight:g.clientHeight,N=P,B=L*=A,i?G.drawImage(g,0,0,F,U):G.drawImage(g,D,C,P,L,M,R,N,B),tt="",i?(et=Math.max(1,r/100),tt=function(t,e,r,i,o){var n=document.createElement("canvas");return n.width=r,n.height=i,n.getContext("2d").drawImage(o,t,e,r,i),n.toDataURL()}(0,0,F/et,U/et,H)):((rt=document.createElement("canvas")).width=N,rt.height=B,rt.getContext("2d").drawImage(H,M,R,N,B,0,0,N,B),tt=rt.toDataURL()),Dh(u),l({code:a,url:tt}),[3,6];case 5:c("load snapshot lib fail"),nt.label=6;case 6:return[2]}}))}))}))}({container:this.container,videoDiv:this.videoDiv,boardBox:this.boardBox,canvasElement:this.canvasElement,boardWrap:this.boardWrap},this.instanceKey,this.getBoardScale(),o,(function(t){return r.getElementById(t)}),(function(t){var e=r.store.getCurrentBoardData(),i=r.store.filterGlobalElement(),o=e.data.concat(i);r.store.setNeedDraw(!0),r.drawData(o,t)})).then((function(t){var e=t.url||"",o=t.code||0;r.logger.reportInfo(r.loggerModuleName,"snapshot",{param:{extraInfo:JSON.stringify({code:o,base64ImageLength:e.length,userData:i,errMsg:""})}},ea.ONLY_ONLINE),r.event.fireSnapshotEvent({code:o,image:e,userData:i})}),(function(o){var n=r.snapshotRequestMap.get(e)||0;n>3?r.event.fireSnapshotEvent({code:o,image:"",userData:i}):r.innerSnapshot(t,e),r.logger.reportInfo(r.loggerModuleName,"snapshot",{code:-1,param:{extraInfo:JSON.stringify({base64ImageLength:0,userData:i,code:o,tryTimes:n})}},ea.ONLY_ONLINE)}))},e.prototype.destroy=function(){this.logger.reportInfo(this.loggerModuleName,"destroy",{param:{extraInfo:JSON.stringify({module:"board-before"})}},ea.ONLY_ONLINE);try{this.renderVideoFile.destroy(),this.renderBackgroundImageAndH5.destroy(),this.renderH5PPT.destroy(),this.listenerInteraction.destroy(),bs.destroy(),this.store.destroy(),jn.stopUnReadyCommandTask()}catch(t){}finally{this.store=null,this.renderVideoFile=null,this.pregressTask&&clearTimeout(this.pregressTask),this.watchCanvasMartixTask&&clearInterval(this.watchCanvasMartixTask),window.cancelAnimationFrame(this.drawTimer),this.container&&(this.container.innerHTML=""),this.logger.reportInfo(this.loggerModuleName,"destroy",{param:{extraInfo:JSON.stringify({module:"board-after"})}},ea.ONLY_ONLINE)}},e.prototype.renderH5WebElement=function(t){this.store.tiwData.getElementByElementId(String(t.belongSeq))&&t.isElementDisplay()?(t.setBoardSize(this.width,this.height),null==t||t.renderTo(this.webviewWrap,this.teduToolType.isMouseToolType()&&this.isDrawEnable())):t.remove()},e.prototype.removeH5WebElement=function(){for(var t=this.webviewWrap.querySelectorAll(':not([data-bid="'.concat(this.getCurrentBoard(),'"])')),e=0;e<t.length;e++)t[e].remove();var r=this.webviewWrap.querySelectorAll('[data-bid="'.concat(this.getCurrentBoard(),'"]'));for(e=0;e<r.length;e++)this.store.tiwData.getElementByElementId(String(r[e].dataset.belongSeq))||r[e].remove();(r=this.webviewWrap.querySelectorAll('[data-bid="'.concat(this.getCurrentBoard(),'"]'))).length?this.webviewWrap.style.zIndex="8":this.webviewWrap.style.zIndex="auto"},e.prototype.renderCustomGraph=function(t){this.store.tiwData.getElementByElementId(String(t.belongSeq))&&t.isElementDisplay()?(this.store.customGraphMapData[""+t.belongSeq]=t,t.setBoardSizeScale(this.width,this.height),null==t||t.renderTo(this.imageElementWrap)):(t.remove(),delete this.store.customGraphMapData[""+t.belongSeq])},e.prototype.renderAudio=function(t){this.store.tiwData.getElementByElementId(String(t.belongSeq))&&(t.setBoardSize(this.width,this.height),null==t||t.renderTo(this.audioWrap))},e.prototype.addElement=function(t,e,r){return this.store.addElement(t,e,r)},e.prototype.removeElement=function(t){var e=this.store.removeElement(t);return e&&this.event.fireRemoveElementEvent([String(t)]),e},e.prototype.addTranscodeFile=function(t,e){var r=this;this.logger.reportInfo(this.loggerModuleName,"addTranscodeFile",{param:{extraInfo:JSON.stringify({result:t,needSwitch:e})}},ea.ONLY_ONLINE);var i="#".concat(Wt.getTimeStamp()),o=t.url.indexOf("for_tiw=1")>-1;if(t.pages&&0!==t.pages||o)if(t.url.endsWith("/")){var n=this.store.isFileUrlExist(t.url);if(n)return setTimeout((function(){r.event.fireWarningEvent($.TEDU_BOARD_WARNING_IMAGE_COURSEWARE_ALREADY_EXISTS,n),r.logger.reportInfo(r.loggerModuleName,"image_courseware_already_exists",{param:{boardId:r.getCurrentBoard(),fileId:n,extraInfo:t.url}},ea.ONLY_ONLINE)}),0),n;for(var a=[],s=0;s<t.pages;s++)a.push("".concat(t.url).concat(s+1,".jpg"));try{var l=t.resolution.split("x")[0],c=t.resolution.split("x")[1],h=Ct(l,c),u="".concat(l/h,":").concat(c/h);return this.addFile(i,a,t.title,t.url,u,e).catch((function(){})),i}catch(r){return this.addFile(i,a,t.title,t.url,null,e).catch((function(){})),i}}else{if(t.url.endsWith(".html"))return this.renderH5PPT.addH5PPTFile(t.url,t.title,e);if(o)return this.addPreviewDocFile({url:t.url,title:t.title},e)}},e.prototype.setFileScale=function(t,e){this.store.setFileScale(t,e)},e.prototype.getFileScale=function(t){return this.store.getFileScale(t)},e.prototype.webviewMouseExited=function(){this.boardBox.style.cursor="none",this.graphNode.style.cursor="none",this.textAreaBox.style.cursor="none",this.boardBox.style.cursor="auto",this.graphNode.style.cursor="auto",this.textAreaBox.style.cursor="auto",this.store.collectRaserData().over(M.MOUSE_TOUCH_ID,this.getToolType())},e.prototype.webviewMouseEntered=function(){this.updateCursor()},e.prototype.setSystemCursorEnable=function(t){this.store.setSystemCursorEnable(t)},e.prototype.setToolTypeTitle=function(t,e,r){this.store.setToolTypeTitle(t,e,r)},e.prototype.enableAudioControl=function(t){this.store.enableAudioControl(t)},e.prototype.getBoardElementList=function(t,e){return t=t||this.getCurrentBoard(),this.store.getBoardElementList(t,e)},e.prototype.setScaleToolRatio=function(t){var e=t;H(e)||(e=10),this.scaleRatio=e},e.prototype.setContainerScale=function(t){H(t)||(t=1),this.store.setContainerScale(t)},e.prototype.setDomainMap=function(t){this.store.setDomainMap(t)},e.prototype.getDomainMap=function(){return this.store.getDomainMap()},e.prototype.addBackupDomain=function(t,e,r){void 0===r&&(r=0),this.store.addBackupDomain(t,e,r)},e.prototype.removeBackupDomain=function(t,e){void 0===e&&(e=""),this.store.removeBackupDomain(t,e)},e.prototype.setProxyServerMap=function(t){var e,r,i,n,a=this;try{if(!t)return;var s=t;R(s)&&(s=JSON.parse(s));var l=Object.keys(L.PROXY_SERVER_MAP),c=Object.keys(s);if(s[o.ALL])try{for(var h=Mh(l),u=h.next();!u.done;u=h.next()){var d=u.value;L.setProxyServer(d,s[o.ALL])}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}try{for(var p=Mh(c),f=p.next();!f.done;f=p.next())d=f.value,l.includes(d)&&s[d]&&L.setProxyServer(d,s[d])}catch(t){i={error:t}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(i)throw i.error}}setTimeout((function(){a.logger.reportInfo(a.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"setProxyServer",data:{serverObj:t}})}},ea.ONLY_ONLINE)}),0)}catch(e){setTimeout((function(){a.logger.reportInfo(a.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"setProxyServer",data:{serverObj:t,error:e}})}},ea.ONLY_ONLINE)}),0)}},e.prototype.setEraseLayerLimit=function(t){void 0===t&&(t=0),this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"setEraseLayerLimit",data:{limit:t}})}},ea.ONLY_ONLINE),this.store.setEraseLayerLimit(t)},e.prototype.setEraseLayerType=function(t){void 0===t&&(t=[]),this.logger.reportInfo(this.loggerModuleName,"call_method",{param:{extraInfo:JSON.stringify({method:"setEraseLayerType",data:{typeArr:t}})}},ea.ONLY_ONLINE),this.store.setEraseLayerType(t)},e.prototype.setSyncFps=function(t){void 0===t&&(t=5),this.store.setSyncFps(t)},e.prototype.setTextValue=function(t,e){var r=parseInt(t),i=null,o=this.store.textAreaComponentMap[r];o?i=o:this.mobileTempTextAreaComponent&&this.mobileTempTextAreaComponent.textItem.belongSeq===r&&(i=this.mobileTempTextAreaComponent),i?(N(e)&&e.hasOwnProperty("value")&&(i.dom.value=e.value),i.newSmartPaintText(),i.blur(),o||(this.store.textAreaComponentMap[r]=i)):this.mobileTempTextAreaComponent&&this.mobileTempTextAreaComponent.remove(),this.mobileTempTextAreaComponent=null},e.prototype.setUserInfo=function(t){this.store.setUserInfo(t)},e.prototype.addPreviewDocFile=function(t,e){var r=this,i=t.url;i&&i.indexOf("?")>-1&&(i=i.substring(0,i.indexOf("?")));var o=this.store.isFileUrlExist(i);if(o)return setTimeout((function(){r.event.fireWarningEvent($.TEDU_BOARD_WARNING_H5PPT_ALREADY_EXISTS,o),r.logger.reportInfo(r.loggerModuleName,"h5ppt_already_exists",{param:{boardId:r.getCurrentBoard(),fileId:o,extraInfo:i}},ea.ONLY_ONLINE)}),0),o;var n=t.fid||"#".concat(Wt.getTimeStamp());return function(){return function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function a(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))}(this,void 0,void 0,(function(){var r,i;return function(t,e){var r,i,o,n,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}(this,(function(o){switch(o.label){case 0:return r=ae(t.url),[4,this.previewLoad(r,n)];case 1:return i=o.sent(),this.store.addH5PPTFile(n,r,t.title||n,i.slides,i.width,i.height,!0,e,this.identifier).catch((function(){})),[2]}}))}))}.apply(this),e&&this.renderVideoFile.switchFilePauseVideo(),n},e.prototype.previewLoad=function(t,e){return new Promise((function(r){var i=function(t){if(t.data){var n=R(t.data)?JSON.parse(t.data):t.data;"ppt-preload-response"===n.cmd&&n.data.fid===e&&(window.removeEventListener("message",i),o.remove(),o=null,r(n.data))}};window.addEventListener("message",i);var o=document.createElement("iframe"),n=cn(t)?"position: fixed; left: -100px; top: -100px;width: 100px; height: 100px; visibility: hidden":"position: fixed; left: 0; top: 0;width: 100px; height: 100px;";o.setAttribute("style",n),o.onload=function(){var r;null===(r=o.contentWindow)||void 0===r||r.postMessage(JSON.stringify({cmd:"ppt-preload-request",data:{url:t,fid:e}}),"*")},o.src=L.pptPreloaderURL,document.body.appendChild(o)}))},e.prototype.addSnapshotMark=function(){this.store.addSnapshotMark()},e.prototype.setPenAutoFittingMode=function(t){this.store.setPenAutoFittingMode(t)},e.prototype.setBoardRemark=function(t,e){this.store.setBoardRemark(t,e)},e.prototype.getBoardRemark=function(t){return void 0===t&&(t=""),this.store.getBoardRemark(t)},e.prototype.setMouseToolBehavior=function(t){this.settingConfig.setMouseToolBehavior(t);var e=this.isH5PPTCosTrans();this.enableH5PointerEvent(this.getToolType()===Xa.TEDU_BOARD_TOOL_TYPE_MOUSE&&e)},e.prototype.setMathGraphType=function(t){this.store.setMathGraphType(t)},e.prototype.setDiscussionGroupEnable=function(t){this.store.setDiscussionGroupEnable(t),this.settingConfig.isDiscussionGroupMode?(this.store.discussionGroupCurrentGroup=this.store.currentGroup,this.updateSwitchBoardInDiscussionGroupMode()):(this.store.currentGroup=this.store.discussionGroupCurrentGroup,this.switchBoard(this.getCurrentBoard(),!0))},e.prototype.getDiscussionGroupEnable=function(){return this.store.getDiscussionGroupEnable()},e.prototype.addDiscussionGroup=function(t,e,r,i,o){if(void 0===i&&(i=""),void 0===o&&(o=""),0!==e.length){var n=this.getBoardList(),a=e.filter((function(t){return n.includes(t)}));if(e.length===a.length){this.store.addDiscussionGroup(t,a,r,i,o);var s=this.store.checkIfUserInDiscussionGroup(t,this.identifier);if(this.settingConfig.isDiscussionGroupMode&&s){var l=this.store.getDiscussionGroupInfoById(t);this.switchBoard(l.currentBoardId,!0)}}else this.event.fireClassGroupStatusChangedEvent({enable:this.settingConfig.isDiscussionGroupMode,classGroupId:t,operationType:Al.ERROR,message:"board list contains invalid board which does not exist in file"})}else this.event.fireClassGroupStatusChangedEvent({enable:this.settingConfig.isDiscussionGroupMode,classGroupId:t,operationType:Al.ERROR,message:"group must contains at least one board"})},e.prototype.setDiscussionGroupTitle=function(t,e){this.store.setDiscussionGroupTitle(t,e)},e.prototype.resetDiscussionGroup=function(){this.store.resetDiscussionGroup(),this.settingConfig.isDiscussionGroupMode&&this.switchBoard(this.getCurrentBoard(),!0)},e.prototype.removeDiscussionGroup=function(t){if(this.store.discussionGroupMap.hasGroup(t)){var e=this.store.checkIfUserInDiscussionGroup(t,this.identifier);this.store.removeDiscussionGroup(t),this.settingConfig.isDiscussionGroupMode&&e&&this.updateSwitchBoardInDiscussionGroupMode()}},e.prototype.removeUserInDiscussionGroup=function(t,e){if(this.store.discussionGroupMap.hasGroup(t)){var r=this.store.checkIfUserInDiscussionGroup(t,this.identifier);this.store.removeUserInDiscussionGroup(t,e),this.settingConfig.isDiscussionGroupMode&&r&&e===this.identifier&&this.updateSwitchBoardInDiscussionGroupMode()}},e.prototype.addUserToDiscussionGroup=function(t,e){if(this.store.discussionGroupMap.hasGroup(t)){var r=this.store.checkIfUserInDiscussionGroup(t,this.identifier);this.store.addUserToDiscussionGroup(t,e),this.settingConfig.isDiscussionGroupMode&&!r&&e===this.identifier&&this.updateSwitchBoardInDiscussionGroupMode()}},e.prototype.removeBoardInDiscussionGroup=function(t,e){if(this.store.discussionGroupMap.hasGroup(t))if(this.store.getDiscussionGroupInfoById(t).getBoardSize()>=2){var r=this.store.checkIfUserInDiscussionGroup(t,this.identifier);this.store.removeBoardInDiscussionGroup(t,e),this.settingConfig.isDiscussionGroupMode&&r&&this.updateSwitchBoardInDiscussionGroupMode()}else this.event.fireClassGroupStatusChangedEvent({enable:this.settingConfig.isDiscussionGroupMode,classGroupId:t,operationType:Al.ERROR,message:"group must contains at least one board"})},e.prototype.addBoardToDiscussionGroup=function(t,e){if(this.store.discussionGroupMap.hasGroup(t)){if(!this.getBoardList().includes(e))return void this.event.fireClassGroupStatusChangedEvent({enable:this.settingConfig.isDiscussionGroupMode,classGroupId:t,operationType:Al.ERROR,message:"board list contains invalid board which does not exist in file"});var r=this.store.checkIfUserInDiscussionGroup(t,this.identifier);this.store.addBoardToDiscussionGroup(t,e),this.settingConfig.isDiscussionGroupMode&&r&&this.updateSwitchBoardInDiscussionGroupMode()}},e.prototype.getDiscussionGroupInfoByGroupId=function(t){var e=this.store.getDiscussionGroupInfoById(t);if(e){var r=e.getData(),i=r.discussionGroupId,o=function(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(r[i[o]]=t[i[o]])}return r}(r,["discussionGroupId"]);return o.classGroupId=i,o}return null},e.prototype.getDiscussionGroupIdByUserId=function(t){return this.store.getDiscussionGroupIdByUserId(t)},e.prototype.updateSwitchBoardInDiscussionGroupMode=function(){var t=this.store.getDiscussionGroupIdByUserId(this.identifier),e=t.length;if(e){var r=this.store.getDiscussionGroupInfoById(t[0]);if(e>1)for(var i=r.getUpdateTimestamp(),o=1;o<e;o++){var n=this.store.getDiscussionGroupInfoById(t[o]),a=n.getUpdateTimestamp();a>i&&(i=a,r=n)}this.store.discussionGroupCurrentGroup=this.store.currentGroup,this.switchBoard(r.currentBoardId,!0)}else this.store.currentGroup=this.store.discussionGroupCurrentGroup,this.switchBoard(this.getCurrentBoard(),!0)},e.prototype.getAllDiscussionGroupIds=function(){return this.store.getAllDiscussionGroupIds()},e.prototype.setLogLevel=function(t){this.settingConfig.setDisplayLogLevel(t)},e.prototype.setImageTimeout=function(t){this.store.setImageTimeout(t)},e.prototype.setScrollBarVisible=function(t){t?this.teduBoardScroll.showScrollBar():this.teduBoardScroll.hideScrollBar()},e.prototype.addTextFontFamily=function(t,e){var r=this;void 0===e&&(e=""),this.store.addTextFontFamily(t,e),this.initMeasureTextElement(t),this.store.initFont(e,(function(){var i;i=e?"@font-face {font-family: '".concat(t,"';src: url(").concat(e,") format('truetype');}"):"@font-face {font-family: '".concat(t,"';}");var o=document.createElement("style");o.type="text/css",o.innerHTML=i;var n=document.createElement("div");n.style.fontFamily="".concat(t),n.style.position="fixed",n.style.left="-10000px",n.style.width="1px",n.innerHTML="&nbsp;",document.body.appendChild(o),document.body.appendChild(n),o.onload=function(){setTimeout((function(){r.store&&r.store.setNeedDraw(!0)}),100),setTimeout((function(){r.store&&r.store.setNeedDraw(!0)}),2e3)}}))},e.prototype.setGlobalBackgroundPic=function(t,e,r){void 0===e&&(e=Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER),void 0===r&&(r=M.BACKGROUND_TYPE.IMAGE),this.store.setGlobalBackgroundPic(t,e,r),this.logger.reportInfo(this.loggerModuleName,"setGlobalBackgroundPic",{param:{extraInfo:JSON.stringify({url:t,position:e,type:r})}},ea.ONLY_ONLINE)},e.prototype.getGlobalBackgroundPic=function(){return this.store.getGlobalBackgroundPic()},e.prototype.getBoardScroll=function(){var t=this.store.computeMoveRange(this.width,this.height,this.container.clientWidth,this.container.clientHeight),e=t.maxLeft,r=t.minLeft,i=t.maxTop,o=t.minTop,n=this.store.getDragData();if(!n)return{scrollLeft:0,scrollTop:0};var a=1-(n.xOffset-r)/(e-r),s=1-(n.yOffset-o)/(i-o);return isNaN(a)&&(a=0),isNaN(s)&&(s=0),{scrollLeft:+a.toFixed(2),scrollTop:+s.toFixed(2)}},e.prototype.setPiecewiseErasureEnable=function(t){this.store.setPiecewiseErasureEnable(t),this.logger.reportInfo(this.loggerModuleName,"setPiecewiseErasureEnable",{param:{extraInfo:JSON.stringify({enable:t})}},ea.ONLY_ONLINE)},e.prototype.setEraserMode=function(t){this.store.setEraserMode(t)},e.prototype.isPiecewiseErasureEnable=function(){return this.store.isPiecewiseErasureEnable()},e.prototype.setEraserSize=function(t){this.store.setEraserSize(Math.max(t,1)),this.logger.reportInfo(this.loggerModuleName,"setEraserSize",{param:{extraInfo:JSON.stringify({size:t})}},ea.ONLY_ONLINE)},e.prototype.getEraserSize=function(){return this.store.getEraserSize()},e.prototype.soundMuteForPPT=function(t){jn.soundMute(this.iframeDOM,this.seqUtil.getSeq(),t)},e.prototype.setOwnerNickNameVisible=function(t){this.ownerNicknameVisible=t},e.prototype.useMathTool=function(t){this.setType(1),this.store.canAddMathTool(t)&&this.store.addMathTool(t)},e.prototype.renderMathTool=function(t){var e=this,r=this.store.getCurrentBoard();t.forEach((function(t){t.boardId===r?(t.setBoardSize(e.width,e.height),t.setBoardScale(e.getBoardScale()),t.render(e.mathToolWrap)):t.hideElement()}))},e.prototype.mathToolCorrectData=function(t,e,r){var i=e,o=r;t=String(t).valueOf();var n=this.interactionFlag.getDataByTouchId(t).referenceMathTool[t];if(null==n?void 0:n.needCorrect){var a=n.referenceLine[0],s=n.referenceLine[1],l=n.referenceLine[2],c=n.referenceLine[3],h=n.deltaX,u=n.deltaY;Math.abs(u)<Math.abs(h)?(o=r,i=(r-s)/(c-s)*(l-a)+a):(i=e,o=(e-a)/(l-a)*(c-s)+s),i+=h,o+=u}return[i,o]},e.prototype.enablePenAutoFit=function(t,e){void 0===e&&(e=2e3),this.store.enablePenAutoFit(t,e)},e.prototype.getElementById=function(t){var e=t+"";return this.store.getElementById(e)},e.prototype.updateElementById=function(t,e){var r=t+"";return this.store.updateElementById(r,e)},e.prototype._reportEventException=function(t,e){var r=e.message,i=e.stack;this.logger.reportInfo(this.loggerModuleName,"interaction",{code:-1,stack:i,message:r,param:{extraInfo:JSON.stringify({event:t,error:r,stack:i})}},ea.ONLY_ONLINE)},e.prototype.enableMultiTouch=function(t){t?(this.piecewiseEnableHistoryStatus=this.isPiecewiseErasureEnable(),this.pinchToZoomEnableHistoryStatus=this.settingConfig.pinchToZoomEnable,this.setPiecewiseErasureEnable(!1),this.settingConfig.setPinchToZoomEnable(!1)):(this.setPiecewiseErasureEnable(this.piecewiseEnableHistoryStatus),this.settingConfig.setPinchToZoomEnable(this.pinchToZoomEnableHistoryStatus)),this.multiTouch=t,this.logger.reportInfo(this.loggerModuleName,"enableMultiTouch",{param:{extraInfo:JSON.stringify({enable:t})}},ea.ONLY_ONLINE)},e.prototype.renderView=function(){var t=this,e=new vc(this.option.styleConfig);this.container.innerHTML='<div class="tx_board_canvas_wrap" oncontextmenu="return false;" onselectstart="return false;">'.concat(e.getTemplate(),"</div>"),this.boardWrap=this.container.getElementsByClassName("tx_board_canvas_wrap")[0],this.boardBox=this.container.getElementsByClassName("tx_board_canvas_box")[0],this.canvasElement=this.graphNode=this.container.getElementsByClassName("tiw-sketch__canvas")[0],this.canvasCtx=this.canvasElement.getContext("2d"),this.progress=this.container.getElementsByClassName("tic_board_bg_progress")[0],this.img=this.container.getElementsByClassName("tic_board_img_bg")[0],this.bgDiv=this.container.getElementsByClassName("tic_board_bg")[0],this.videoDiv=this.container.querySelector("#tic_video_wrap"),this.imageElementWrap=this.container.getElementsByClassName("tic_board__imagewrap")[0],this.jsxgraphElementWrap=this.container.getElementsByClassName("tic_board__mathgraphwrap")[0],this.cursorLayerWrap=this.container.getElementsByClassName("tic_cursorlayer__wrap")[0],this.cursorLayerRemoteWrap=this.container.getElementsByClassName("tic_cursorlayer_remote__wrap")[0],this.webviewWrap=this.container.getElementsByClassName("tiw_board_webview_wrap")[0],this.mathToolWrap=this.container.getElementsByClassName("tiw_board_mathtool_wrap")[0];var r=this.option.config.laserDomId?document.querySelector("#"+this.option.config.laserDomId):null;r&&(r.innerHTML='<div class="tic-board_laserwrap"></div>'),this.laserWrap=(r||this.container).getElementsByClassName("tic-board_laserwrap")[0],this.audioWrap=this.container.getElementsByClassName("tic-board__audiowrap")[0],this.transcodeEl=this.container.getElementsByClassName("tic_board__transcode")[0],this.watermarkWrap=this.container.getElementsByClassName("tiw_watermark__wrap")[0],this.watermarkWrap=this.container.getElementsByClassName("tiw_watermark__wrap")[0],this.watermarkWrap=this.container.getElementsByClassName("tiw_watermark__wrap")[0];var i={domNode:this.canvasElement};this.viewContainer=new Oc(i),this.progress.src=this.progressBarUrl,this.teduBoardCursorLayer=new Ec(this.cursorLayerWrap,{onmousemove:Qt((function(e){t.store.updateElements(e)}),200),ontouchstart:function(){null===t.touchID&&(t.touchID=0)},ontouchend:function(){t.touchID=null},ontouchcancel:function(){t.touchID=null},onend:function(e){t.store.updateElementOperationForPosition(e,!0),t.store.fireElementPosition(e,!0,lc.TEDU_BOARD_POSITION_CHANGE_END)},onstart:function(e){t.store.updateElementOperationForPosition(e),t.store.fireElementPosition(e,!0,lc.TEDU_BOARD_POSITION_CHANGE_START)},checkAccessible:function(e,r){var i=!1;if(r.forEach((function(e){e.isLocked()&&(i=!0,t.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENT_IS_LOCKED,e.getElementId()))})),i)return!1;var o=r.map((function(t){return{creator:t.user}}));return!!t.permissionHandler.filter("Element::Update::*",o)&&t.permissionHandler.filter(e,o)},needToRender:function(e){e.reduce((function(t,e){return t||e.needToRender}))&&t.store.setNeedDraw(!0)},fireElementPosition:function(e){t.store.fireElementPosition(e,!0,lc.TEDU_BOARD_POSITION_CHANGING)}},{readonly:!1,showOperator:this.settingConfig.showLocalOperator,containerScale:this.store.getContainerScale()}),this.teduBoardCursorLayer.setScaleElementStyle(Ss.localCursorLayer.getAnchor()),this.teduBoardCursorLayer.setRotateElementStyle(Ss.localCursorLayer.getRotate()),this.teduBoardCursorLayer.setBorderStyle(Ss.localCursorLayer.getBorder()),setTimeout((function(){t.renderH5PPT.resetPPTIframe()}),0),this.textAreaBox=this.container.getElementsByClassName("tic_board_textbox")[0],this.teduBoardScroll=new xc(this.container,(function(e,r,i){void 0===i&&(i={});var o=(1-e/(t.width-t.container.clientWidth))*(t.moveDragArea.maxLeft-t.moveDragArea.minLeft)+t.moveDragArea.minLeft,n=(1-r/(t.height-t.container.clientHeight))*(t.moveDragArea.maxTop-t.moveDragArea.minTop)+t.moveDragArea.minTop;o=+o.toFixed(1),n=+n.toFixed(1),t.collectDragHandler.scrollEventDraw(t.boardBox,o,n),t.store.setNeedDraw(!0)})),this.isDrawEnable()?this.teduBoardScroll.enableScroll():this.teduBoardScroll.disableScroll(),this.viewContainer.getCanvasContext().translate(.5,.5),this.store.setNeedDraw(!0),this.listenerInteraction.onBoardDomEvent()},e.prototype.moveBoard=function(t,e){"number"!=typeof this.dragStartX&&(this.dragStartX=0,this.dragStartY=0);var r=this.dragStartX+t,i=this.dragStartY+e;gt()&&this.pinchScale.length&&this.enableScaleTool?this.collectDragHandler.scaleDraw(this.beforePinchScale,this.pinchScale):(this.collectDragHandler.draw(this.boardWrap,r-this.dragStartX,i-this.dragStartY),this.dragStartX=r,this.dragStartY=i,this.store.setNeedDraw(!0))},e.prototype.focusScale=function(t,e){var r=t.currentTarget,i=this.container.clientWidth,o=0,n=0,a=parseInt(r.style.width),s=parseInt(r.style.height),l=i*s/a;a<=i?(o=t.offsetX,n=t.offsetY):(o=t.offsetX+(a-i)/2,n=t.offsetY+(s-l)/2);var c=o-a/2,h=n-s/2,u=o/a,d=n/s,p=this.getBoardScale();this.setBoardScale(p+e,"focusScale");var f,g,m=parseInt(r.style.width),y=parseInt(r.style.height);f=c-(m*u-m/2),g=h-(y*d-y/2),this.moveBoard(f,g),gt()?this.collectDragHandler.touchEnd(this.getCurrentBoard(),this.pinchScale,this.enableScaleTool):this.collectDragHandler.end()},e.prototype.isRaserValid=function(t){var e=this.interactionFlag.getDataByTouchId(t),r=Wt.getTimeStamp();return e.raserCount++,this.enableRaserOptimization&&r-e.preRaserTimestamp<20?(e.ignoreRaserCount++,!1):(e.preRaserTimestamp=r,!0)},e.prototype.raserStatistic=function(t){var e=this.interactionFlag.getDataByTouchId(t);e.raserCount=0,e.ignoreRaserCount=0},e.prototype._isZoomToolType=function(){return!!this.permissionHandler.filter("Board::Scale::*",[{operator:this.identifier}])&&(!(!this.settingConfig.pinchToZoomEnable||!this.pinchScale.length)||this.teduToolType.isZoomToolType())},e.prototype.isH5PPTCosTrans=function(){var t=this.getFileInfo(this.getCurrentFile()),e=!0;return t&&t.type===M.FILE_TYPE.H5PPT&&"WPS"===q(t.downloadURL)&&(e=this.permissionHandler.filter("Board::Switch::Page",[{operator:this.identifier}],!1)),e},e.prototype._getPageAndStepPermission=function(t){var e=this.permissionHandler.filter("Board::Switch::Step",[{operator:this.identifier}],!1),r=this.permissionHandler.filter("Board::Switch::Page",[{operator:this.identifier}],!1),i=!1;if(e&&!r){var o=this.getFileInfo(this.getCurrentFile()),n=o.slideStepData[o.currentPageIndex];t?0!=o.currentPageStep&&0!=n||(i=!0):n-1!=o.currentPageStep&&0!=n||(i=!0)}return!!r||!(!e||i)},e.prototype.enableShowGraffiti=function(t){if(this.store.enableShowGraffiti(t),!t)for(var e=this.textAreaBox.querySelectorAll("textarea"),r=0;r<e.length;r++)-1!=e[r].getAttribute("id").indexOf("tic-textarea__")&&e[r].remove()},e.prototype.setDisablePointerEvent=function(){var t,e;this.disablePointerEvent?null===(t=this.container)||void 0===t||t.classList.add("tiw-pointer-events_none"):null===(e=this.container)||void 0===e||e.classList.remove("tiw-pointer-events_none")},e.prototype.renderWatermark=function(t){t.setBoardSize(this.width,this.height),t.renderTo(this.watermarkWrap,this.getBoardRatio())},e.prototype.exportInLocalMode=function(t){return this.store.exportInLocalMode(t)},e.prototype.importInLocalMode=function(t,e){this.store.importInLocalMode(t,e,this.identifier)},e.prototype.getBoardClientSize=function(){return{clientWidth:Math.round(this.canvasWidth),clientHeight:Math.round(this.canvasHeight)}},e.prototype.getBackgroundImage=function(t,e){void 0===t&&(t=this.getCurrentBoard()),void 0===e&&(e=!1);var r=this.store.getBackgroundImage(t,e);return{angle:r?r.angle:0,url:r?r.url:"",mode:r?r.mode:Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER,type:r?r.type:M.BACKGROUND_TYPE.IMAGE}},e.prototype.exportSelectedElementsData=function(){return this.store.exportSelectedElementsData()},e.prototype.importElementsData=function(t,e){this.store.importElementsData(t,e)},e.prototype.setElementsDisplay=function(t,e,r){this.store.setElementsDisplay(t,e,r)},e.prototype.setCustomServerConfig=function(t){L.setPrivateEnvConfig(t)},e.prototype.lockElements=function(t,e){this.store.lockElements(t,e)},e.prototype.removeCustomGraph=function(t){void 0===t&&(t=!1);var e=this.getCurrentBoard();for(var r in this.store.customGraphMapData){var i=this.store.customGraphMapData[r];(t&&i.boardId===e||!t&&i.boardId!=e)&&(i.remove(),delete this.store.customGraphMapData[""+i.belongSeq])}},e.prototype.clearTextTask=function(){if(this.teduToolType.isTextInputToolType()&&this.store.textInputTask){this.logger.reportInfo(this.loggerModuleName,"textInputTaskException",{param:{}},ea.ONLY_NATIVE);var t=this.textAreaFocusBlurStatus.focus;t&&t.dom&&t.dom.blur(),clearInterval(this.store.textInputTask),this.store.textInputTask=0,this.store.lastInputActionData=null}},e.prototype.setH5PPTMediaPlaybackStatus=function(t,e,r){this.store.setH5PPTMediaPlaybackStatus(t,e,r)},e.prototype.autoSelectedElement=function(t){var e=this.store.tiwData.getElementByElementId(t);if(e){this.store.cancelSelect(),e.select=!0,this.store.selectedList=[e];var r=this.store.toolTypeTitleStyleMap[Xa.TEDU_BOARD_TOOL_TYPE_RECT_SELECT];r&&(r.operatorId=e.user,r.title=this.store.getUserInfo(e.user,"nickname")),this.store.setNeedDraw(!0),this.store.fireElementPosition(this.store.selectedList,!1,-1)}},e.prototype.setDownGradeEnable=function(t,e,r){var i=this;if(r)this.getThumbnailImages(t).length>0&&(this.store.downGradeH5PPtMap.set(t,r),this.renderH5PPT.operatorDownGradeFile(t,e,!0));else{this.store.downGradeH5PPtMap.set(t,r);for(var o=0;o<this.store.downGradePageIndexMap.length;o++)this.store.downGradePageIndexMap[o].fid==t&&this.store.downGradePageIndexMap.splice(o,1);this.store.downGradeElementMap.forEach((function(e,r){e==t&&i.removeElement(r),i.store.downGradeElementMap.delete(r)})),this.renderH5PPT.cancelDownGradeFile()}},e}(X),Nh={TEDU_BOARD_OPERATION_ALL:0,TEDU_BOARD_OPERATION_MOVE:1,TEDU_BOARD_OPERATION_DELETE:2,TEDU_BOARD_OPERATION_SCALE:3,TEDU_BOARD_OPERATION_ROTATE:4,TEDU_BOARD_OPERATION_SELECTED:5,TEDU_BOARD_OPERATION_ADD:6},Bh={MATH_EXPRESSION_PARSE_ERROR:-1},kh={MOVING:0,DRAWING:1},Fh=function(){function t(){this.eventDataMap=new Map}return t.prototype.addEventListener=function(t,e,r,i){var o="event_"+Math.ceil(1e5*Math.random());return this.eventDataMap.set(o,{source:t,eventName:e,listener:r,options:i}),t.addEventListener(e,r,i),o},t.prototype.removeEventListener=function(t){var e=this.eventDataMap.get(t);e&&(e.source.removeEventListener(e.eventName,e.listener,e.options),this.eventDataMap.delete(t))},t.prototype.removeAllEventListener=function(){this.eventDataMap.forEach((function(t){t.source.removeEventListener(t.eventName,t.listener,t.options)})),this.eventDataMap.clear()},t}(),Uh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Hh=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},Gh=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},qh=function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},Wh=function(t){function e(e){var r=t.call(this,e)||this;return r.throttleTimeMap={},r.interceptorMap=new Map,r}return Uh(e,t),e.prototype._cmdParser=function(t){var e=Hh(t.split("::"),3),r=e[0],i=e[1],o=void 0===i?"*":i,n=e[2];return[r,o,void 0===n?"*":n]},e.prototype._filterParser=function(t){var e,r,i=new Map;try{for(var o=Gh(t),n=o.next();!n.done;n=o.next()){var a=n.value,s=Hh(a.split("/"),2),l=s[0],c=s[1],h=new Set(c.split(",")),u=i.get(l);u?i.set(l,new Set(qh(qh([],Hh(u),!1),Hh(h),!1))):i.set(l,h)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return i},e.prototype._valid=function(t){var r=Hh(t,3),i=r[0],o=r[1],n=r[2];return"*"===i||"*"==o||!!(e.PermissionMap[i]&&e.PermissionMap[i][o]&&e.PermissionMap[i][o][n])},e.prototype._isExplicitPermission=function(t){var e=Hh(t,3),r=e[0],i=e[1];return e[2],"*"!==r&&"*"!=i},e.prototype._extractExplicitPermission=function(t){var r,i,o=[],n=[],a=[];o="*"===t[0]?Object.keys(e.PermissionMap):[t[0]],"*"===t[1]?o.forEach((function(t){n.push(Object.keys(e.PermissionMap[t]))})):o.forEach((function(e){n.push([t[1]])}));for(var s=0;s<o.length;s++)for(var l=0;l<n[s].length;l++)if("*"===t[2]){var c=Object.keys(e.PermissionMap[o[s]][n[s][l]]);try{for(var h=(r=void 0,Gh(c)),u=h.next();!u.done;u=h.next()){var d=u.value,p=[o[s],n[s][l],d];this._valid(p)&&a.push(p.join("::"))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}else p=[o[s],n[s][l],t[2]],this._valid(p)&&a.push(p.join("::"));return a},e.prototype.setInterceptor=function(t,e){var r=this,i=[],o=this._filterParser(e);t.forEach((function(t){var e=r._cmdParser(t);if(r._valid(e)){var o=r._extractExplicitPermission(e);i=i.concat(o)}})),i.forEach((function(t){var e=o;if(r.interceptorMap.has(t)){var i=r.interceptorMap.get(t);null==i||i.forEach((function(t,r){e.has(r)||e.set(r,t)}))}r.interceptorMap.set(t,e)}));var n={};o.forEach((function(t,e){n[e]=qh([],Hh(t),!1)})),this.reportPermission(),this.event.firePermissionChanged(i,n)},e.prototype.removeInterceptor=function(t){var e=this,r=[];t.forEach((function(t){var i=e._cmdParser(t);if(e._valid(i)){var o=e._extractExplicitPermission(i);r=r.concat(o)}})),r.forEach((function(t){e.interceptorMap.delete(t)})),this.reportPermission(),this.event.firePermissionChanged(r,null)},e.prototype.resetInterceptor=function(){this.interceptorMap.clear(),this.reportPermission()},e.prototype._getHighestAuthorityFilter=function(t){for(var e=t.concat([]),r=3,i="";r;){if(i=e.join("::"),this.interceptorMap.has(i))return this.interceptorMap.get(i);e[--r]="*"}},e.prototype._checkPermission=function(t,e){var r=this._cmdParser(t);if(!this._valid(r))return!0;this._isExplicitPermission(r);var i=this._getHighestAuthorityFilter(r),o=!0;return i&&i.forEach((function(t,r){var i,n,a,s,l,c;if(o&&!t.has("*"))if("*"===r)try{for(var h=Gh(e),u=h.next();!u.done;u=h.next()){var d=u.value;try{for(var p=(a=void 0,Gh(Object.keys(d))),f=p.next();!f.done;f=p.next()){var g=f.value;if(!F(d[g])&&!t.has(d[g])){o=!1;break}}}catch(t){a={error:t}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}if(!o)break}}catch(t){i={error:t}}finally{try{u&&!u.done&&(n=h.return)&&n.call(h)}finally{if(i)throw i.error}}else try{for(var m=Gh(e),y=m.next();!y.done;y=m.next())if(d=y.value,!F(d[r])&&!t.has(d[r])){o=!1;break}}catch(t){l={error:t}}finally{try{y&&!y.done&&(c=m.return)&&c.call(m)}finally{if(l)throw l.error}}})),o},e.prototype.getExplictPermissions=function(){return qh([],Hh(this.interceptorMap.keys()),!1)},e.prototype.filter=function(t,e,r){var i=this;void 0===r&&(r=!0),void 0===e?e=[{operator:this.identifier}]:e.forEach((function(t){var e;t.operator=null!==(e=t.operator)&&void 0!==e?e:i.identifier}));var o=this._checkPermission(t,e);if(r&&!o){this.throttleTimeMap[t]||(this.throttleTimeMap[t]=0);var n=Date.now();n-this.throttleTimeMap[t]>1e3&&(this.throttleTimeMap[t]=n,this.event.firePermissionDenied(t))}return o},e.prototype.filters=function(t,e){var r=this;e.forEach((function(t){t.forEach((function(t){var e;t.operator=null!==(e=t.operator)&&void 0!==e?e:r.identifier}))}));for(var i=[],o=0;o<t.length;o++)i.push(this._checkPermission(t[o],e[o]));return i},e.prototype.reportPermission=function(){var t={};this.interceptorMap.forEach((function(e,r){t[r]={},e.forEach((function(e,i){t[r][i]=qh([],Hh(e),!1)}))})),this.logger.reportInfo(this.loggerModuleName,"update_permission",{param:{extraInfo:JSON.stringify(t)}},ea.ONLY_ONLINE)},e.PermissionMap={Board:{Switch:{Page:!0,Step:!0,"*":!0},Update:{ContentFitMode:!0,Ratio:!0,"*":!0},Add:{"*":!0},Delete:{"*":!0},Clear:{"*":!0},Undo:{"*":!0},Redo:{"*":!0},Scale:{"*":!0}},File:{Add:{"*":!0},Delete:{"*":!0},Switch:{"*":!0},Update:{Scale:!0,Video:!0,"*":!0},Clear:{"*":!0}},Element:{Add:{Highlighter:!0,Pen:!0,Laser:!0,Text:!0,MathTool:!0,Graph:!0,CustomGraph:!0,"*":!0},Delete:{Audio:!0,MathTool:!0,"*":!0},Move:{"*":!0},Select:{"*":!0},Update:{Audio:!0,MathTool:!0,Text:!0,"*":!0},Scale:{"*":!0},Rotate:{"*":!0}},Background:{Update:{Frame:!0,Image:!0,Color:!0,"*":!0}},Instance:{Reset:{"*":!0}}},e}(X),Yh=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},zh=function(){function t(){this.isCustomCursorIcon=!1,this.isAutoHideRemoteCursor=!1,this.showRemoteSelectBox=!1,this.showLocalOperator=!1,this.showRemoteOperator=!1,this.showCursorOnTouch=!0,this.elementOpAuth={default:{disableRotate:!1,disableMove:!1,disableProportionScale:!1,disableArbitraryScale:!1},text:{disableRotate:!0,disableArbitraryScale:!0,disableUseEmoji:!1},formula:{disableArbitraryScale:!0},arc:{disableArbitraryScale:!0},watermark:{disableRotate:!0,disableArbitraryScale:!0},customGraph:{disableArbitraryScale:!0}},this.mouseToolBehavior={turnPage:{whiteBoard:!0,h5PPT:!0,imgPPT:!0,imgFile:!0,audiovisual:!1}},this.boardRatio={},this.fileRatio={},this.canvasTranslateX=0,this.canvasTranslateY=0,this.autoHideRemoteCursorTimeout=2e3,this.offlineWarningTimeout=18e4,this.pinchToZoomEnable=!1,this.minBoardScale=M.MIN_SCALE,this.maxBoardScale=M.MAX_SCALE,this.isDiscussionGroupMode=!1,this.displayLogLevel=0,this.imageCursorEnable=!1}return t.prototype.setCustomCursorIcon=function(t){this.isCustomCursorIcon=t},t.prototype.setAutoHideRemoteCursor=function(t){this.isAutoHideRemoteCursor=t},t.prototype.setShowRemoteSelectBox=function(t){this.showRemoteSelectBox=t},t.prototype.setShowLocalOperator=function(t){this.showLocalOperator=t},t.prototype.setShowRemoteOperator=function(t){this.showRemoteOperator=t},t.prototype.setShowCursorOnTouch=function(t){this.showCursorOnTouch=t},t.prototype.setAutoHideRemoteCursorTimeout=function(t){void 0===t&&(t=2e3),this.autoHideRemoteCursorTimeout=t},t.prototype.setOfflineWarningTimeout=function(t){void 0===t&&(t=18e4),this.offlineWarningTimeout=t},t.prototype.setPinchToZoomEnable=function(t){this.pinchToZoomEnable=t},t.prototype.setScaleRange=function(t){t.sort((function(t,e){return t-e}));var e=Yh(t,2),r=e[0],i=e[1];this.minBoardScale=r,this.maxBoardScale=i},t.prototype.setElementOpAuthConfig=function(t){for(var e in t)this.setElementOperationAuthority(e,t[e])},t.prototype.setElementOperationAuthority=function(t,e){this.elementOpAuth[t]||(this.elementOpAuth[t]=Object.assign({},this.elementOpAuth.default)),Object.assign(this.elementOpAuth[t],e)},t.prototype.getElementOpAuth=function(t){return Object.assign({},this.elementOpAuth.default,this.elementOpAuth[t]||{})},t.prototype.setFileRatio=function(t,e){void 0===t&&(t=M.COMMON_GROUP),void 0===e&&(e="16:9"),this.fileRatio[t]=e},t.prototype.setBoardRatio=function(t,e){void 0===t&&(t="default"),void 0===e&&(e="16:9"),this.boardRatio[t]=e},t.prototype.getBoardRatioRate=function(t){var e=this.getBoardRatio(t),r=Yh(e.split(":").map((function(t){return+t})),2);return r[0]/r[1]},t.prototype.getBoardRatio=function(t){var e,r=this.boardRatio[t];if(!r){var i=Ot(t);(r=this.fileRatio[i])||(r=null!==(e=this.boardRatio.default)&&void 0!==e?e:"16:9"),this.setBoardRatio(t,r)}return r},t.prototype.setMouseToolBehavior=function(t){var e,r,i,o,n,a,s,l,c,h,u,d,p,f,g,m,y,v,_,E;void 0===t&&(t={}),this.mouseToolBehavior={turnPage:{whiteBoard:null===(o=null!==(r=null===(e=t.turnPage)||void 0===e?void 0:e.whiteBoard)&&void 0!==r?r:null===(i=t.turnPage)||void 0===i?void 0:i.ALL)||void 0===o||o,h5PPT:null===(l=null!==(a=null===(n=t.turnPage)||void 0===n?void 0:n.h5PPT)&&void 0!==a?a:null===(s=t.turnPage)||void 0===s?void 0:s.ALL)||void 0===l||l,imgPPT:null===(d=null!==(h=null===(c=t.turnPage)||void 0===c?void 0:c.imgPPT)&&void 0!==h?h:null===(u=t.turnPage)||void 0===u?void 0:u.ALL)||void 0===d||d,imgFile:null===(m=null!==(f=null===(p=t.turnPage)||void 0===p?void 0:p.imgFile)&&void 0!==f?f:null===(g=t.turnPage)||void 0===g?void 0:g.ALL)||void 0===m||m,audiovisual:null===(E=null!==(v=null===(y=t.turnPage)||void 0===y?void 0:y.audiovisual)&&void 0!==v?v:null===(_=t.audiovisual)||void 0===_?void 0:_.ALL)||void 0===E||E}}},t.prototype.setIsDiscussionGroupMode=function(t){this.isDiscussionGroupMode=t},t.prototype.setDisplayLogLevel=function(t){this.displayLogLevel=t},t.prototype.clearBoardRatio=function(){this.boardRatio={},this.fileRatio={}},t.prototype.setImageCursorEnable=function(t){this.imageCursorEnable=t},t.prototype.isImageCursorEnable=function(){return this.imageCursorEnable},t}(),jh=r(182),Vh=r.n(jh),Xh=function(){function t(){this.seq=0}return t.prototype.getSeq=function(){var t=Math.floor(Wt.getCurrentTimeStamp()/1e3);return+new Vh.a(t>>>0<<15|32767&this.seq++,t>>>0>>17).toString()},t.prototype.setSeq=function(t){this.seq=t},t}(),Jh=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},Kh=function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))};function Zh(t){return function(e,r,i){var o=i.value,n=!1;return{configurable:!0,get:function(){var i=this;if(n||this===e.prototype||this.hasOwnProperty(r)||"function"!=typeof o)return o;var a=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return i.hasPermission=i.permissionHandler.filter(t,[{operator:i.identifier}]),o.bind(i).apply(void 0,Kh([],Jh(e),!1))}.bind(this);return n=!0,Object.defineProperty(this,r,{configurable:!0,get:function(){return a},set:function(t){o=t,delete this[r]}}),n=!1,a},set:function(t){o=t}}}}var Qh,$h=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),tu=function(t,e,r,i){var o,n=arguments.length,a=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(n<3?o(a):n>3?o(e,r,a):o(e,r))||a);return n>3&&a&&Object.defineProperty(e,r,a),a},eu=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function a(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},ru=function(t,e){var r,i,o,n,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},iu=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},ou=function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},nu=function(t){function e(e,r){var i=t.call(this,e)||this;return i.hasPermission=!1,i.board=new Rh(e,r),i}return $h(e,t),e.prototype.destroy=function(){this.board&&this.board.destroy(),this.board=null},e.prototype.addSyncData=function(t){this.board&&this.board.addData(t)},e.prototype.setDataSyncEnable=function(t){this.board.setDataSyncEnable(t)},e.prototype.isDataSyncEnable=function(){return this.board.isDataSyncEnable()},e.prototype.reset=function(){this._reportCallApi("reset"),this.hasPermission&&this.board.clearAll()},e.prototype.getSyncTime=function(){return this.board.getSyncTime()},e.prototype.syncRemoteTime=function(t,e){this.board.syncRemoteTime(t,e)},e.prototype.setDrawEnable=function(t){this.board.setDrawEnable(t)},e.prototype.isDrawEnable=function(){return this.board.isDrawEnable()},e.prototype.setGlobalBackgroundColor=function(t){this.hasPermission&&this.board.setGlobalBackgroundColor(t)},e.prototype.getGlobalBackgroundColor=function(){return this.board.getGlobalBackgroundColor()},e.prototype.setBackgroundColor=function(t){this.hasPermission&&this.board.setBackgroundColor(t)},e.prototype.getBackgroundColor=function(){return this.board.getBackgroundColor()},e.prototype.setToolType=function(t){this.board.setType(t)},e.prototype.getToolType=function(){return this.board.getToolType()},e.prototype.setNextTextInput=function(t,e){void 0===t&&(t=""),void 0===e&&(e=!1),this.board.setNextTextInput(t,e)},e.prototype.setCursorIcon=function(t,e){this.board.setCursorIcon(t,e)},e.prototype.setZoomCursorIcon=function(t,e){this.board.setZoomCursorIcon(t,e)},e.prototype.setRemoteCursorVisible=function(t,e){void 0===e&&(e=1);var r=1===e?"drawing":"moving";this.board.setRemoteCursorVisible(t,r)},e.prototype.setBrushColor=function(t){this.board.setColor(t)},e.prototype.getBrushColor=function(){return this.board.getBrushColor()},e.prototype.setBrushThin=function(t){this.board.setThin(t)},e.prototype.setLineTransparent=function(t){this.board.setLineTransparent(t)},e.prototype.getBrushThin=function(){return this.board.getBrushThin()},e.prototype.setTextColor=function(t){this.board.setTextColor(t)},e.prototype.getTextColor=function(){return this.board.getTextColor()},e.prototype.setTextSize=function(t){this.board.setTextSize(t)},e.prototype.getTextSize=function(){return this.board.getTextSize()},e.prototype.setTextStyle=function(t){this.board.setTextFontStyle(t)},e.prototype.getTextStyle=function(){return this.board.getTextFontStyle()},e.prototype.setTextLineHeight=function(t){this.board.setTextLineHeight(t)},e.prototype.getTextLineHeight=function(){return this.board.getTextLineHeight()},e.prototype.setCursorPosition=function(t){this.board.setCursorPosition(t)},e.prototype.setGraphStyle=function(t){this.board.setGraphStyle(t)},e.prototype.getGraphStyle=function(){return this.board.getGraphStyle()},e.prototype.setOvalDrawMode=function(t){this.board.setOvalDrawMode(t)},e.prototype.getOvalDrawMode=function(){return this.board.getOvalDrawMode()},e.prototype.clear=function(t,e){this._reportCallApi("clear",arguments),this.hasPermission&&this.board.clear(t,e)},e.prototype.setBackgroundImage=function(t,e){this.hasPermission&&this.board._setBackgroundImage(t,e)},e.prototype.setBackgroundImageAngle=function(t){this.hasPermission&&this.board._setBackgroundImageAngle(t)},e.prototype.setBackgroundH5=function(t){this.hasPermission&&this.board.setBackgroundH5(t)},e.prototype.undo=function(){this.hasPermission&&this.board.undo()},e.prototype.redo=function(){this.hasPermission&&this.board.redo()},e.prototype.resize=function(){this.board.resize()},e.prototype.addBoard=function(t){for(var e,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(this._reportCallApi("addBoard",arguments),this.hasPermission)return(e=this.board).addBoard.apply(e,ou([t],iu(r),!1))},e.prototype.deleteBoard=function(t){this._reportCallApi("deleteBoard",arguments),this.hasPermission&&this.board.deleteBoard(t)},e.prototype.prevStep=function(){this._reportCallApi("prevStep"),this.hasPermission&&this.board.prevStep()},e.prototype.nextStep=function(){this._reportCallApi("nextStep"),this.hasPermission&&this.board.nextStep()},e.prototype.prevBoard=function(t){this._reportCallApi("prevBoard",arguments),this.hasPermission&&this.board.prevBoard(t)},e.prototype.nextBoard=function(t){this._reportCallApi("nextBoard",arguments),this.hasPermission&&this.board.nextBoard(t)},e.prototype.setEraseLayerLimit=function(t){void 0===t&&(t=0),this.board.setEraseLayerLimit(t)},e.prototype.setEraseLayerType=function(t){void 0===t&&(t=[]),this.board.setEraseLayerType(t)},e.prototype.gotoBoard=function(t,e){this._reportCallApi("gotoBoard",arguments),this.hasPermission&&this.board.switchBoard(t,e)},e.prototype.getCurrentBoard=function(){return this.board.getCurrentBoard()},e.prototype.setScaleAnchor=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.board.setScaleAnchor(t,e)},e.prototype.getBoardList=function(){return this.board.getBoardList()},e.prototype.setBoardRatio=function(t){this._reportCallApi("setBoardRatio",arguments),this.hasPermission&&this.board.setBoardRatio(t)},e.prototype.getBoardRatio=function(){return this.board.getBoardRatio()},e.prototype.setBoardScale=function(t){this._reportCallApi("setBoardScale",arguments),this.hasPermission&&this.board.setBoardScale(t)},e.prototype.getBoardScale=function(){return this.board.getBoardScale()},e.prototype.setBoardContentFitMode=function(t){this.hasPermission&&this.board.setBoardContentFitMode(t)},e.prototype.getBoardContentFitMode=function(){return this.board.getBoardContentFitMode()},e.prototype.addTranscodeFile=function(t,e){if(void 0===e&&(e=!0),this._reportCallApi("addTranscodeFile",arguments),this.hasPermission)return this.board.addTranscodeFile(t,e)},e.prototype.addImagesFile=function(t,e,r){return void 0===e&&(e=""),void 0===r&&(r=!0),this.hasPermission?this.board.addImagesFile(t,e,r):""},e.prototype.deleteFile=function(t){this._reportCallApi("deleteFile",arguments),this.hasPermission&&this.board.deleteFile(t)},e.prototype.switchFile=function(t,e,r){var i=this;return this._reportCallApi("switchFile",arguments),new Promise((function(o,n){return eu(i,void 0,void 0,(function(){var i,a;return ru(this,(function(s){switch(s.label){case 0:if(!this.hasPermission)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.board.switchFile(t,e,r)];case 2:return i=s.sent(),o(i),[3,4];case 3:return a=s.sent(),n(a),[3,4];case 4:return[2]}}))}))}))},e.prototype.getCurrentFile=function(){return this.board.getCurrentFile()},e.prototype.getFileInfo=function(t){var e=this.board.getFileInfo(t);return e?Object.assign({},e,{boardInfoList:this.board.getBoardInfoList(t)}):e},e.prototype.getFileInfoList=function(){return this.board.getFileInfoList()},e.prototype.getFileBoardList=function(t){return this.board.getBoardByGroup(t)},e.prototype.getThumbnailImages=function(t){return this.board.getThumbnailImages(t)},e.prototype.clearFileDraws=function(t){this.hasPermission&&this.board.clearFileDraws(t)},e.prototype.addVideoFile=function(t,e,r){return void 0===e&&(e=""),void 0===r&&(r=!0),this.hasPermission?this.board.addVideoFile(t,e,r):""},e.prototype.addVODFile=function(t,e,r){return void 0===r&&(r=null),this.hasPermission?"":this.board.addVODFile(t,e,r)},e.prototype.setVODExtParam=function(t,e){this.board.setVODExtParam(t,e)},e.prototype.showVideoControl=function(t){this.board.showVideoControl(t)},e.prototype.playVideo=function(){this._reportCallApi("playVideo",arguments),this.hasPermission&&this.board.playVideo()},e.prototype.pauseVideo=function(){this._reportCallApi("pauseVideo",arguments),this.hasPermission&&this.board.pauseVideo()},e.prototype.seekVideo=function(t){this._reportCallApi("seekVideo",arguments),this.hasPermission&&this.board.seekVideo(t)},e.prototype.muteVideo=function(t){this._reportCallApi("muteVideo",arguments),this.hasPermission&&this.board.muteVideo(t)},e.prototype.resetVideoProgress=function(){this._reportCallApi("resetVideoProgress",arguments),this.hasPermission&&this.board.resetVideoProgress()},e.prototype.playAudio=function(t){this._reportCallApi("playAudio",arguments),!this.__checkElementLocked(t)&&this.hasPermission&&this.board.playAudio(t)},e.prototype.pauseAudio=function(t){this._reportCallApi("pauseAudio",arguments),!this.__checkElementLocked(t)&&this.hasPermission&&this.board.pauseAudio(t)},e.prototype.seekAudio=function(t,e){this._reportCallApi("seekAudio",arguments),!this.__checkElementLocked(t)&&this.hasPermission&&this.board.seekAudio(t,e)},e.prototype.muteAudio=function(t,e){this._reportCallApi("muteAudio",arguments),!this.__checkElementLocked(t)&&this.hasPermission&&this.board.muteAudio(t,e)},e.prototype.setAudioVolume=function(t,e){this._reportCallApi("setAudioVolume",arguments),!this.__checkElementLocked(t)&&this.hasPermission&&this.board.setAudioVolume(t,e)},e.prototype.getAudioVolume=function(t){return this.board.getAudioVolume(t)},e.prototype.setSyncAudioStatusEnable=function(t){this.board.setSyncAudioStatusEnable(t)},e.prototype.setSyncVideoStatusEnable=function(t,e){this.board.setSyncVideoStatusEnable(t,e)},e.prototype.startSyncVideoStatus=function(t){void 0===t&&(t=M.SYNC_VIDEO_STATUS_INTERVAL),this.board.startSyncVideoStatus(t)},e.prototype.stopSyncVideoStatus=function(){this.board.stopSyncVideoStatus()},e.prototype.addH5File=function(t,e,r,i){return void 0===e&&(e=""),void 0===r&&(r=!0),void 0===i&&(i=!1),this.hasPermission?this.board.addH5File(t,e,r,i):""},e.prototype.setHandwritingEnable=function(t){this.board.setHandwritingEnable(t)},e.prototype.removeElement=function(t){if(this._reportCallApi("removeElement",arguments),!this.hasPermission)return!1;var e=this.board.getElementById(t),r=!1;if(e){var i=this.permissionHandler.filter("Element::Delete",[{creator:e.userId}]);!this.__checkElementLocked(t)&&i&&(r=this.board.removeElement(t))}return r},e.prototype.isHandwritingEnable=function(){return this.board.isHandwritingEnable()},e.prototype.addElement=function(t,e,r){return this._reportCallApi("addElement",arguments),this.hasPermission?this.board.addElement(t,e,r):""},e.prototype.refresh=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this.board.refresh(!0,t,!1,e)},e.prototype.addAckData=function(t){this.board&&this.board.addAckData(t)},e.prototype.syncAndReload=function(){this.board.syncAndReload()},e.prototype.snapshot=function(t){this.board.snapshot(t)},e.prototype.setFileScale=function(t,e){this.hasPermission&&this.board.setFileScale(t,e)},e.prototype.getFileScale=function(t){return this.board.getFileScale(t)},e.prototype.webviewMouseExited=function(){var t=this;setTimeout((function(){t.board.webviewMouseExited()}),10)},e.prototype.webviewMouseEntered=function(){this.board.webviewMouseEntered()},e.prototype.setSystemCursorEnable=function(t){this.board.setSystemCursorEnable(t)},e.prototype.setToolTypeTitle=function(t,e,r){this.board.setToolTypeTitle(t,e,r)},e.prototype.enableAudioControl=function(t){this.board.enableAudioControl(t)},e.prototype.getBoardElementList=function(t,e){return this.board.getBoardElementList(t,e)},e.prototype.setScaleToolRatio=function(t){this.board.setScaleToolRatio(t)},e.prototype.setContainerScale=function(t){this.board.setContainerScale(t)},e.prototype.addBackupDomain=function(t,e,r){void 0===e&&(e=""),void 0===r&&(r=0),this.board.addBackupDomain(t,e,r)},e.prototype.removeBackupDomain=function(t,e){void 0===e&&(e=""),this.board.removeBackupDomain(t,e)},e.prototype.setProxyServer=function(t){this.board.setProxyServerMap(t)},e.prototype.setTextValue=function(t,e){!this.__checkElementLocked(t)&&this.hasPermission&&this.board.setTextValue(t,e)},e.prototype.setUserInfo=function(t){this.board.setUserInfo(t)},e.prototype.setPenAutoFittingMode=function(t){this.board.setPenAutoFittingMode(t)},e.prototype.addSnapshotMark=function(){this.board.addSnapshotMark()},e.prototype.setBoardRemark=function(t,e){this.board.setBoardRemark(t,e)},e.prototype.getBoardRemark=function(t){return void 0===t&&(t=""),this.board.getBoardRemark(t)},e.prototype.setMouseToolBehavior=function(t){this.board.setMouseToolBehavior(t)},e.prototype.setMathGraphType=function(t,e){void 0===e&&(e=!0),this.board.setMathGraphType(t),e&&this.setToolType(Xa.TEDU_BOARD_TOOL_TYPE_MOUSE)},e.prototype.setClassGroupEnable=function(t){this.board.setDiscussionGroupEnable(t)},e.prototype.getClassGroupEnable=function(){return this.board.getDiscussionGroupEnable()},e.prototype.setClassGroup=function(t,e,r,i,o){void 0===i&&(i=""),void 0===o&&(o=""),this.board.addDiscussionGroup(t,e,r,i,o)},e.prototype.resetClassGroup=function(){this.board.resetDiscussionGroup()},e.prototype.removeClassGroup=function(t){this.board.removeDiscussionGroup(t)},e.prototype.setClassGroupTitle=function(t,e){this.board.setDiscussionGroupTitle(t,e)},e.prototype.getClassGroupInfoByGroupId=function(t){return this.board.getDiscussionGroupInfoByGroupId(t)},e.prototype.getClassGroupIdByUserId=function(t){return this.board.getDiscussionGroupIdByUserId(t)},e.prototype.addUserToClassGroup=function(t,e){this.board.addUserToDiscussionGroup(t,e)},e.prototype.removeUserInClassGroup=function(t,e){this.board.removeUserInDiscussionGroup(t,e)},e.prototype.addBoardToClassGroup=function(t,e){this.board.addBoardToDiscussionGroup(t,e)},e.prototype.removeBoardInClassGroup=function(t,e){this.board.removeBoardInDiscussionGroup(t,e)},e.prototype.getAllClassGroupIds=function(){return this.board.getAllDiscussionGroupIds()},e.prototype.setLogLevel=function(t){return this.board.setLogLevel(t)},e.prototype.setImageTimeout=function(t){this.board.setImageTimeout(t)},e.prototype.setScrollBarVisible=function(t){this.board.setScrollBarVisible(t)},e.prototype.addTextFontFamily=function(t,e){void 0===e&&(e=""),this.board.addTextFontFamily(t,e)},e.prototype.setTextFontFamily=function(t){this.board.setTextFontFamily(t)},e.prototype.getTextFontFamily=function(){return this.board.getTextFontFamily()},e.prototype.gotoStep=function(t,e){this._reportCallApi("gotoStep",arguments),this.hasPermission&&this.board.switchStep(t,+e||0)},e.prototype.getBoardScroll=function(){return this.board.getBoardScroll()},e.prototype.setPiecewiseErasureEnable=function(t){this.board.setPiecewiseErasureEnable(t)},e.prototype.setEraserMode=function(t){this.board.setEraserMode(t)},e.prototype.isPiecewiseErasureEnable=function(){return this.board.isPiecewiseErasureEnable()},e.prototype.setEraserSize=function(t){this.board.setEraserSize(t)},e.prototype.getEraserSize=function(){return this.board.getEraserSize()},e.prototype.setGlobalBackgroundPic=function(t,e,r){void 0===e&&(e=Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER),void 0===r&&(r=M.BACKGROUND_TYPE.IMAGE),this.hasPermission&&this.board.setGlobalBackgroundPic(t,e,r)},e.prototype.getGlobalBackgroundPic=function(){return this.board.getGlobalBackgroundPic()},e.prototype.soundMuteForPPT=function(t){this._reportCallApi("soundMuteForPPT",arguments),this.board.soundMuteForPPT(t)},e.prototype.setOwnerNickNameVisible=function(t){this.board.setOwnerNickNameVisible(t)},e.prototype.getPPTRemarks=function(t,e){return void 0===e&&(e=-1),this.board.getPPTRemarks(t,e)},e.prototype.useMathTool=function(t){void 0===t&&(t=$a.RULER),this.hasPermission&&this.board.useMathTool(t)},e.prototype.enablePenAutoFit=function(t,e){void 0===e&&(e=2e3),this.board.enablePenAutoFit(t,e)},e.prototype.setHighlighterColor=function(t){this.board.setHighlighterColor(t)},e.prototype.getHighlighterColor=function(){return this.board.getHighlighterColor()},e.prototype.getElementById=function(t){return this.board.getElementById(t)},e.prototype.updateElementById=function(t,e){this._reportCallApi("updateElementById",arguments);var r=this.getElementById(t);if(r){if(this.__checkElementLocked(t))return;var i=!1;e.type===Dl.EL_DELETE?i=this.permissionHandler.filter("Element::Delete::*",[{creator:r.userId}]):e.type===Dl.CHANGE_POSITION?this.permissionHandler.filter("Element::Update::*",[{creator:r.userId}])&&(i=this.permissionHandler.filter("Element::Move::*",[{creator:r.userId}])):i=this.permissionHandler.filter("Element::Update::*",[{creator:r.userId}]),i&&this.board.updateElementById(t,e)}},e.prototype.enableMultiTouch=function(t){this._reportCallApi("enableMultiTouch",arguments),this.board.enableMultiTouch(t)},e.prototype.setSyncFps=function(t){this._reportCallApi("setSyncFps",arguments),this.board.setSyncFps(t)},e.prototype.enableShowGraffiti=function(t){this._reportCallApi("enableShowGraffiti",arguments),this.board.enableShowGraffiti(t)},e.prototype.enableH5PointerEvent=function(){var t=this.board.isH5PPTCosTrans();this.board.enableH5PointerEvent(this.board.getToolType()===Xa.TEDU_BOARD_TOOL_TYPE_MOUSE&&t)},e.prototype.setDisablePointerEvent=function(){this.board.setDisablePointerEvent()},e.prototype.exportInLocalMode=function(t){return this._reportCallApi("exportInLocalMode"),this.board.exportInLocalMode(t)},e.prototype.importInLocalMode=function(t,e){void 0===t&&(t=""),this._reportCallApi("importInLocalMode","data.length:",t.length),this.board.importInLocalMode(t,e)},e.prototype.getBoardClientSize=function(){var t=this.board.getBoardClientSize();return this._reportCallApi("getBoardClientSize",t),t},e.prototype.getBackgroundImage=function(t){return this.board.getBackgroundImage(t,!0)},e.prototype._reportCallApi=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];try{this.logger.reportInfo(this.loggerModuleName,"api",{param:{extraInfo:JSON.stringify({methodName:t,params:e})}},ea.ONLY_ONLINE)}catch(t){}},e.prototype.exportSelectedElementsData=function(){return this.board.exportSelectedElementsData()},e.prototype.importElementsData=function(t,e){this.board.importElementsData(t,e)},e.prototype.setElementsDisplay=function(t,e,r){this._reportCallApi("setElementsDisplay",arguments),this.board.setElementsDisplay(t,e,r)},e.prototype.lockElements=function(t,e){this._reportCallApi("lockElements",arguments),this.board.lockElements(t,e)},e.prototype.__checkElementLocked=function(t){var e=this.board.store.tiwData.getElementByElementId(t);return!!e&&!!e.isLocked()&&(this.event.fireWarningEvent($.TEDU_BOARD_WARNING_ELEMENT_IS_LOCKED,t),!0)},e.prototype.playH5PPTMedia=function(t,e){this.board.setH5PPTMediaPlaybackStatus(t,e,!0)},e.prototype.pauseH5PPTMedia=function(t,e){this.board.setH5PPTMediaPlaybackStatus(t,e,!1)},e.prototype.autoSelectedElement=function(t){this._reportCallApi("autoSelectedElement",arguments),this.board.autoSelectedElement(t)},e.prototype.setDownGradeEnable=function(t,e,r){this._reportCallApi("setDownGradeEnable",arguments),this.board.setDownGradeEnable(t,e,r)},e.prototype.cancelSelect=function(t){this._reportCallApi("cancelSelect",arguments),this.board.cancelSelect(t)},tu([Zh("Instance::Reset::*")],e.prototype,"reset",null),tu([Zh("Background::Update::Color")],e.prototype,"setGlobalBackgroundColor",null),tu([Zh("Background::Update::Color")],e.prototype,"setBackgroundColor",null),tu([Zh("Board::Clear")],e.prototype,"clear",null),tu([Zh("Background::Update::Image")],e.prototype,"setBackgroundImage",null),tu([Zh("Background::Update::Image")],e.prototype,"setBackgroundImageAngle",null),tu([Zh("Background::Update::Frame")],e.prototype,"setBackgroundH5",null),tu([Zh("Board::Undo::*")],e.prototype,"undo",null),tu([Zh("Board::Redo::*")],e.prototype,"redo",null),tu([Zh("Board::Add")],e.prototype,"addBoard",null),tu([Zh("Board::Delete")],e.prototype,"deleteBoard",null),tu([Zh("Board::Switch::Step")],e.prototype,"prevStep",null),tu([Zh("Board::Switch::Step")],e.prototype,"nextStep",null),tu([Zh("Board::Switch::Page")],e.prototype,"prevBoard",null),tu([Zh("Board::Switch::Page")],e.prototype,"nextBoard",null),tu([Zh("Board::Switch::Page")],e.prototype,"gotoBoard",null),tu([Zh("Board::Update::Ratio")],e.prototype,"setBoardRatio",null),tu([Zh("Board::Scale::*")],e.prototype,"setBoardScale",null),tu([Zh("Board::Update::ContentFitMode")],e.prototype,"setBoardContentFitMode",null),tu([Zh("File::Add")],e.prototype,"addTranscodeFile",null),tu([Zh("File::Add")],e.prototype,"addImagesFile",null),tu([Zh("File::Delete")],e.prototype,"deleteFile",null),tu([Zh("File::Switch")],e.prototype,"switchFile",null),tu([Zh("File::Clear")],e.prototype,"clearFileDraws",null),tu([Zh("File::Add")],e.prototype,"addVideoFile",null),tu([Zh("File::Add")],e.prototype,"addVODFile",null),tu([Zh("File::Update::Video")],e.prototype,"playVideo",null),tu([Zh("File::Update::Video")],e.prototype,"pauseVideo",null),tu([Zh("File::Update::Video")],e.prototype,"seekVideo",null),tu([Zh("File::Update::Video")],e.prototype,"muteVideo",null),tu([Zh("File::Update::Video")],e.prototype,"resetVideoProgress",null),tu([Zh("Element::Update::Audio")],e.prototype,"playAudio",null),tu([Zh("Element::Update::Audio")],e.prototype,"pauseAudio",null),tu([Zh("Element::Update::Audio")],e.prototype,"seekAudio",null),tu([Zh("Element::Update::Audio")],e.prototype,"muteAudio",null),tu([Zh("Element::Update::Audio")],e.prototype,"setAudioVolume",null),tu([Zh("File::Add")],e.prototype,"addH5File",null),tu([Zh("Element::Delete")],e.prototype,"removeElement",null),tu([Zh("Element::Add")],e.prototype,"addElement",null),tu([Zh("File::Update::Scale")],e.prototype,"setFileScale",null),tu([Zh("Element::Update")],e.prototype,"setTextValue",null),tu([Zh("Board::Switch::Step")],e.prototype,"gotoStep",null),tu([Zh("Background::Update::Image")],e.prototype,"setGlobalBackgroundPic",null),tu([Zh("Element::Add::MathTool")],e.prototype,"useMathTool",null),e}(X),au={NONE:0,IMAGE_LOAD_FAILED:-1,IMAGE_DIMENSIONS_ABNORMAL:-100},su=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),lu=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},cu=function(t,e,r){if(r||2===arguments.length)for(var i,o=0,n=e.length;o<n;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},hu=function(t){function e(r){var o,n=this,a=Math.ceil(Math.random()*Wt.getTimeStamp())+"";i.setNativeVersion(r.nativeVersion),i.setPlatform(r.platform||i.PLATFORM),X.register(a,r.sdkAppId,r.classId,r.userId+"",r.userSig),(n=t.call(this,a)||this).version=i.VERSION,n.historySyncDone=!1,n.setNativeVersion(r.nativeVersion),n.setProxyServerForCore(null===(o=r.config)||void 0===o?void 0:o.proxyServer),n.loggerModuleName="TEduBoard";var s=new nt(a);n.setEvent(s);var l=new pa(a,(function(t){n.event&&n.event.fireReportLogEvent(t)}));return n.setLogger(l),n.setTEduToolType(new Ka(a)),n.setTEduEventListener(new Fh),n.setSettingConfig(new zh),n.setPermissionHandler(new Wh(a)),n.setSeqUtil(new Xh),n.BoardApiProxy=new nu(a,r),!1===r.syncHistroyEnable?n.historySyncDone=!0:n.historySyncDone=!1,n.event.on(e.EVENT.TEB_HISTROYDATA_SYNCCOMPLETED,(function(){n.historySyncDone=!0})),n.event.on(e.EVENT.TEB_INIT,(function(){!function(t){var e="%c--------------------------------------------------------------------------------------------------------------------------------\n  ┊                                                                                                                              ┊\n  ┊                                                                                                                              ┊\n  ┊         CCCCCCCCCCCCCCCCCCCCCCC,                 8000                 L00001               f000.   tttttttttttttt            ┊\n  ┊        00000000000000000000000:   0000000000G   8000                :00001                f000.  .000000000000000            ┊\n  ┊             f000L                 ;iiiiiiiii;,ii0000iiiii;    000000000000000000000.   tffC000Lft.000G..........             ┊\n  ┊             0000Gfffffffff:                  100000000000G    000000000000000000000.   8000000008.000G                       ┊\n  ┊            i00000000000000:      C00000000000i;;0008;i000G    0000             0000.      0000.  .0000000000000f             ┊\n  ┊            C000i     ,0000       tLL8000GLLLL. .000L .000L    0000             0000.     L00000: .0000CCCCC0000,             ┊\n  ┊           ;0000      i000C         .000C :tC,  i0001 ,000f    000000000000000000000.    i0000000L:000000t ,000L              ┊\n  ┊           C00000000000000t         L000, t000  G000, ;000t    000000000000000000000.   i000000G00f000L00010000.              ┊\n  ┊         ;000088888880000:         ;000Lf80000L:000G  i000i    0000             0000.  1000L000.i C000 t000000:               ┊\n  ┊                     :0000        f0000000000000000,  f000:    0000             0000.   10.f000. i000t  L00001                ┊\n  ┊       8000000000000000000000000   000L;     i0000Lt1f0000     000000000000000000000.      f000.:0008.L00000000C;             ┊\n  ┊       8000000000000000000000000             ,800: 800000;     000000000000000000000.      f000,G000.t000G .8000L             ┊\n  ┊                                                                                                                              ┊\n  ┊                                                                                                                              ┊\n  ┊                                                                                                                              ┊\n  ┊       %c互动白板版本:%c ".concat(i.VERSION,"%c                                                                                   ┊\n  ┊                                                                                                                              ┊\n  ┊      %c互动白板技术支持QQ群:%c 1015970626 %c                                                                                  ┊\n  ┊                                                                                                                              ┊\n  --------------------------------------------------------------------------------------------------------------------------------");t.displayLogLevel===ht.ALL&&window.console.log(e,"color:#d9534f;","color:#000;font-size:14px;font-family: consolas,Arial,x-locale-body,sans-serif;","color:#0072BB;font-size:14px;","color:#d9534f;","color:#000;font-size:14px;font-family: consolas,Arial,x-locale-body,sans-serif;","color:#d9534f;font-size:14px;","color:#d9534f;")}(n.settingConfig)})),new Q,n}return su(e,t),e.prototype.destroy=function(){var t=this.teduEventListener;null==t||t.removeAllEventListener(),this.BoardApiProxy.destroy(),this.off(),this.destroyCore(this.instanceKey),this.historySyncDone=!1},e.prototype.on=function(t,e){this.event.on(t,e)},e.prototype.off=function(t,e){this.event&&this.event.off(t,e)},e.prototype.addSyncData=function(t){this.BoardApiProxy.addSyncData(t)},e.prototype.getVersion=function(){return this.version},e.prototype.setDataSyncEnable=function(t){this.BoardApiProxy.setDataSyncEnable(t)},e.prototype.isDataSyncEnable=function(){return this.BoardApiProxy.isDataSyncEnable()},e.prototype.reset=function(){this.historySyncDone?this.BoardApiProxy.reset():this.event.fireWarningIllegalOperateEvent("reset")},e.prototype.getSyncTime=function(){return this.BoardApiProxy.getSyncTime()},e.prototype.syncRemoteTime=function(t,e){this.BoardApiProxy.syncRemoteTime(t,e)},e.prototype.generateFid=function(){return"#".concat(Wt.getTimeStamp())},e.prototype.setDrawEnable=function(t){this.BoardApiProxy.setDrawEnable(t)},e.prototype.isDrawEnable=function(){return this.BoardApiProxy.isDrawEnable()},e.prototype.setAccessibleUsers=function(t,e,r){void 0===e&&(e=[]),void 0===r&&(r=[]),window.console.error("`setAccessibleUsers` is deprecated since 2.8.0. Please use `enablePermissionChecker` instead.")},e.prototype.setGlobalBackgroundColor=function(t){this.BoardApiProxy.setGlobalBackgroundColor(t)},e.prototype.getGlobalBackgroundColor=function(){return this.BoardApiProxy.getGlobalBackgroundColor()},e.prototype.setBackgroundColor=function(t){this.BoardApiProxy.setBackgroundColor(t)},e.prototype.getBackgroundColor=function(){return this.BoardApiProxy.getBackgroundColor()},e.prototype.setToolType=function(t){this.BoardApiProxy.setToolType(t)},e.prototype.setNextTextInput=function(t,e){void 0===t&&(t=""),void 0===e&&(e=!1),this.BoardApiProxy.setNextTextInput(t,e)},e.prototype.getToolType=function(){return this.BoardApiProxy.getToolType()},e.prototype.setCursorIcon=function(t,e){this.BoardApiProxy.setCursorIcon(t,e)},e.prototype.setZoomCursorIcon=function(t,e){this.BoardApiProxy.setZoomCursorIcon(t,e)},e.prototype.setRemoteCursorVisible=function(t,e){void 0===e&&(e=1),this.BoardApiProxy.setRemoteCursorVisible(t,e)},e.prototype.setBrushColor=function(t){this.BoardApiProxy.setBrushColor(t)},e.prototype.getBrushColor=function(){return this.BoardApiProxy.getBrushColor()},e.prototype.setBrushThin=function(t){this.BoardApiProxy.setBrushThin(t)},e.prototype.setLineTransparent=function(t){this.BoardApiProxy.setLineTransparent(t)},e.prototype.getBrushThin=function(){return this.BoardApiProxy.getBrushThin()},e.prototype.setTextColor=function(t){this.BoardApiProxy.setTextColor(t)},e.prototype.getTextColor=function(){return this.BoardApiProxy.getTextColor()},e.prototype.setTextSize=function(t){this.BoardApiProxy.setTextSize(t)},e.prototype.getTextSize=function(){return this.BoardApiProxy.getTextSize()},e.prototype.setTextStyle=function(t){this.BoardApiProxy.setTextStyle(t)},e.prototype.getTextStyle=function(){return this.BoardApiProxy.getTextStyle()},e.prototype.setTextLineHeight=function(t){this.BoardApiProxy.setTextLineHeight(t)},e.prototype.getTextLineHeight=function(){return this.BoardApiProxy.getTextLineHeight()},e.prototype.setCursorPosition=function(t){this.BoardApiProxy.setCursorPosition(t)},e.prototype.setGraphStyle=function(t){this.BoardApiProxy.setGraphStyle(t)},e.prototype.getGraphStyle=function(){return this.BoardApiProxy.getGraphStyle()},e.prototype.setLineStyle=function(t){},e.prototype.getLineStyle=function(){},e.prototype.setOvalDrawMode=function(t){this.BoardApiProxy.setOvalDrawMode(t)},e.prototype.getOvalDrawMode=function(){return this.BoardApiProxy.getOvalDrawMode()},e.prototype.clear=function(t,e){this.historySyncDone?this.BoardApiProxy.clear(t,e):this.event.fireWarningIllegalOperateEvent("clear")},e.prototype.setBackgroundImage=function(t,e){this.historySyncDone?this.BoardApiProxy.setBackgroundImage(t,e):this.event.fireWarningIllegalOperateEvent("setBackgroundImage")},e.prototype.setBackgroundImageAngle=function(t){this.BoardApiProxy.setBackgroundImageAngle(t)},e.prototype.setBackgroundH5=function(t){this.historySyncDone?this.BoardApiProxy.setBackgroundH5(t):this.event.fireWarningIllegalOperateEvent("setBackgroundH5")},e.prototype.undo=function(){this.historySyncDone?this.BoardApiProxy.undo():this.event.fireWarningIllegalOperateEvent("undo")},e.prototype.redo=function(){this.historySyncDone?this.BoardApiProxy.redo():this.event.fireWarningIllegalOperateEvent("redo")},e.prototype.resize=function(){this.BoardApiProxy.resize()},e.prototype.addBoard=function(t){for(var e,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(this.historySyncDone)return arguments.length>1?(e=this.BoardApiProxy).addBoard.apply(e,cu([t],lu(r),!1)):this.BoardApiProxy.addBoard(t);this.event.fireWarningIllegalOperateEvent("addBoard")},e.prototype.deleteBoard=function(t){this.historySyncDone?this.BoardApiProxy.deleteBoard(t):this.event.fireWarningIllegalOperateEvent("deleteBoard")},e.prototype.prevStep=function(){this.historySyncDone?this.BoardApiProxy.prevStep():this.event.fireWarningIllegalOperateEvent("prevStep")},e.prototype.nextStep=function(){this.historySyncDone?this.BoardApiProxy.nextStep():this.event.fireWarningIllegalOperateEvent("nextStep")},e.prototype.prevBoard=function(t){this.historySyncDone?this.BoardApiProxy.prevBoard(t):this.event.fireWarningIllegalOperateEvent("prevBoard")},e.prototype.setEraseLayerLimit=function(t){void 0===t&&(t=0),this.BoardApiProxy.setEraseLayerLimit(t)},e.prototype.setEraseLayerType=function(t){void 0===t&&(t=[]),this.BoardApiProxy.setEraseLayerType(t)},e.prototype.nextBoard=function(t){this.historySyncDone?this.BoardApiProxy.nextBoard(t):this.event.fireWarningIllegalOperateEvent("nextBoard")},e.prototype.gotoBoard=function(t,e){this.historySyncDone?t&&this.BoardApiProxy.gotoBoard(t,e):this.event.fireWarningIllegalOperateEvent("gotoBoard")},e.prototype.getCurrentBoard=function(){return this.BoardApiProxy.getCurrentBoard()},e.prototype.setScaleAnchor=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.BoardApiProxy.setScaleAnchor(t,e)},e.prototype.getBoardList=function(){return this.BoardApiProxy.getBoardList()},e.prototype.setBoardRatio=function(t){this.historySyncDone?this.BoardApiProxy.setBoardRatio(t):this.event.fireWarningIllegalOperateEvent("setBoardRatio")},e.prototype.getBoardRatio=function(){return this.BoardApiProxy.getBoardRatio()},e.prototype.setBoardScale=function(t){this.historySyncDone?this.BoardApiProxy.setBoardScale(t):this.event.fireWarningIllegalOperateEvent("setBoardScale")},e.prototype.getBoardScale=function(){return this.BoardApiProxy.getBoardScale()},e.prototype.setBoardContentFitMode=function(t){this.BoardApiProxy.setBoardContentFitMode(t)},e.prototype.getBoardContentFitMode=function(){return this.BoardApiProxy.getBoardContentFitMode()},e.prototype.applyFileTranscode=function(t,e){window.console.warn("applyFileTranscode接口自2.6.5起废弃，请使用腾讯云文档转码服务进行文档转码。参考文档：https://doc.qcloudtiw.com/web/TEduBoard.html#applyFileTranscode")},e.prototype.addTranscodeFile=function(t,e){if(void 0===e&&(e=!0),this.historySyncDone)return this.BoardApiProxy.addTranscodeFile(t,e);this.event.fireWarningIllegalOperateEvent("addTranscodeFile")},e.prototype.addImagesFile=function(t,e,r){return void 0===e&&(e=""),void 0===r&&(r=!0),Array.isArray(t)?0===t.length?"":this.historySyncDone?this.BoardApiProxy.addImagesFile(t,e,r):(this.event.fireWarningIllegalOperateEvent("addImagesFile"),""):""},e.prototype.deleteFile=function(t){this.historySyncDone?this.BoardApiProxy.deleteFile(t):this.event.fireWarningIllegalOperateEvent("deleteFile")},e.prototype.switchFile=function(t,e,r){var i=this;return new Promise((function(o,n){return function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function a(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))}(i,void 0,void 0,(function(){var i,a;return function(t,e){var r,i,o,n,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}(this,(function(s){switch(s.label){case 0:return this.historySyncDone?[3,1]:(this.event.fireWarningIllegalOperateEvent("switchFile"),[3,4]);case 1:return s.trys.push([1,3,,4]),[4,this.BoardApiProxy.switchFile(t,e,r)];case 2:return i=s.sent(),o(i),[3,4];case 3:return a=s.sent(),n(a),[3,4];case 4:return[2]}}))}))}))},e.prototype.getCurrentFile=function(){return this.BoardApiProxy.getCurrentFile()},e.prototype.getFileInfo=function(t){return this.BoardApiProxy.getFileInfo(t)},e.prototype.getFileInfoList=function(){return this.BoardApiProxy.getFileInfoList()},e.prototype.getFileBoardList=function(t){return this.BoardApiProxy.getFileBoardList(t)},e.prototype.getThumbnailImages=function(t){return this.BoardApiProxy.getThumbnailImages(t)},e.prototype.clearFileDraws=function(t){this.historySyncDone?this.BoardApiProxy.clearFileDraws(t):this.event.fireWarningIllegalOperateEvent("clearFileDraws")},e.hasVideoPermission=function(){return Rh.hasVideoPermission()},e.applyVideoPermission=function(t){Rh.applyVideoPermission(t)},e.prototype.addVideoFile=function(t,e,r){return void 0===e&&(e=""),void 0===r&&(r=!0),this.historySyncDone?this.BoardApiProxy.addVideoFile(t,e,r):(this.event.fireWarningIllegalOperateEvent("addVideoFile"),"")},e.prototype.addVODFile=function(t,e,r){return void 0===r&&(r=null),this.historySyncDone?this.BoardApiProxy.addVODFile(t,e,r):(this.event.fireWarningIllegalOperateEvent("addVODFile"),"")},e.prototype.setVODExtParam=function(t,e){this.BoardApiProxy.setVODExtParam(t,e)},e.prototype.showVideoControl=function(t){this.BoardApiProxy.showVideoControl(t)},e.prototype.playVideo=function(){this.BoardApiProxy.playVideo()},e.prototype.pauseVideo=function(){this.BoardApiProxy.pauseVideo()},e.prototype.seekVideo=function(t){this.BoardApiProxy.seekVideo(t)},e.prototype.muteVideo=function(t){this.BoardApiProxy.muteVideo(t)},e.prototype.resetVideoProgress=function(){this.BoardApiProxy.resetVideoProgress()},e.prototype.playAudio=function(t){this.BoardApiProxy.playAudio(t)},e.prototype.pauseAudio=function(t){this.BoardApiProxy.pauseAudio(t)},e.prototype.seekAudio=function(t,e){this.BoardApiProxy.seekAudio(t,e)},e.prototype.muteAudio=function(t,e){this.BoardApiProxy.muteAudio(t,e)},e.prototype.setAudioVolume=function(t,e){this.BoardApiProxy.setAudioVolume(t,e)},e.prototype.getAudioVolume=function(t){return this.BoardApiProxy.getAudioVolume(t)},e.prototype.setSyncAudioStatusEnable=function(t){this.BoardApiProxy.setSyncAudioStatusEnable(t)},e.prototype.setSyncVideoStatusEnable=function(t,e){this.BoardApiProxy.setSyncVideoStatusEnable(t,e)},e.prototype.startSyncVideoStatus=function(t){void 0===t&&(t=M.SYNC_VIDEO_STATUS_INTERVAL),this.BoardApiProxy.startSyncVideoStatus(t)},e.prototype.stopSyncVideoStatus=function(){this.BoardApiProxy.stopSyncVideoStatus()},e.prototype.addH5File=function(t,e,r,i){return void 0===e&&(e=""),void 0===r&&(r=!0),void 0===i&&(i=!1),this.historySyncDone?this.BoardApiProxy.addH5File(t,e,r,i):(this.event.fireWarningIllegalOperateEvent("addH5File"),"")},e.prototype.addImageElement=function(t){window.console.warn("自2.6.2版本起此接口已被废弃，请使用addElement接口添加图片元素")},e.prototype.setHandwritingEnable=function(t){if(!this.historySyncDone)return this.event.fireWarningIllegalOperateEvent("setHandwritingEnable"),"";this.BoardApiProxy.setHandwritingEnable(t)},e.prototype.isHandwritingEnable=function(){return this.BoardApiProxy.isHandwritingEnable()},e.prototype.addElement=function(t,e,r){return this.BoardApiProxy.addElement(t,e,r)},e.prototype.generateElementId=function(){return String(this.seqUtil.getSeq())},e.prototype.removeElement=function(t){return this.BoardApiProxy.removeElement(t)},e.prototype.refresh=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this.historySyncDone?this.BoardApiProxy.refresh(t,e):this.event.fireWarningIllegalOperateEvent("refresh")},e.prototype.addAckData=function(t){this.BoardApiProxy.addAckData(t)},e.prototype.syncAndReload=function(){this.historySyncDone?(this.historySyncDone=!1,this.BoardApiProxy.syncAndReload()):this.event.fireWarningIllegalOperateEvent("syncAndReload")},e.prototype.snapshot=function(t){void 0===t&&(t={userData:"",full:!1}),this.historySyncDone?this.BoardApiProxy.snapshot(t):this.event.fireWarningIllegalOperateEvent("snapshot")},e.prototype.setFileScale=function(t,e){this.BoardApiProxy.setFileScale(t,e)},e.prototype.getFileScale=function(t){return this.BoardApiProxy.getFileScale(t)},e.prototype.webviewMouseExited=function(){this.BoardApiProxy.webviewMouseExited()},e.prototype.webviewMouseEntered=function(){this.BoardApiProxy.webviewMouseEntered()},e.prototype.setSystemCursorEnable=function(t){this.historySyncDone?this.BoardApiProxy.setSystemCursorEnable(t):this.event.fireWarningIllegalOperateEvent("setSystemCursorEnable")},e.prototype.setToolTypeTitle=function(t,e,r){this.BoardApiProxy.setToolTypeTitle(t,e,r)},e.prototype.enableAudioControl=function(t){this.historySyncDone?this.BoardApiProxy.enableAudioControl(t):this.event.fireWarningIllegalOperateEvent("enableAudioControl")},e.prototype.getBoardElementList=function(t,e){return this.BoardApiProxy.getBoardElementList(t,e)},e.prototype.setScaleToolRatio=function(t){this.BoardApiProxy.setScaleToolRatio(t)},e.prototype.setContainerScale=function(t){this.BoardApiProxy.setContainerScale(t)},e.prototype.addBackupDomain=function(t,e,r){void 0===e&&(e=""),void 0===r&&(r=0),this.BoardApiProxy.addBackupDomain(t,e,r)},e.prototype.removeBackupDomain=function(t,e){void 0===e&&(e=""),this.BoardApiProxy.removeBackupDomain(t,e)},e.prototype.setProxyServer=function(t){this.BoardApiProxy.setProxyServer(t)},e.prototype.setTextValue=function(t,e){this.BoardApiProxy.setTextValue(t,e)},e.prototype.setUserInfo=function(t){this.historySyncDone?this.BoardApiProxy.setUserInfo(t):this.event.fireWarningIllegalOperateEvent("setUserInfo")},e.prototype.setPenAutoFittingMode=function(t){this.historySyncDone?this.BoardApiProxy.setPenAutoFittingMode(t):this.event.fireWarningIllegalOperateEvent("setPenAutoFittingMode")},e.prototype.addSnapshotMark=function(){this.historySyncDone?this.BoardApiProxy.addSnapshotMark():this.event.fireWarningIllegalOperateEvent("addSnapshotMark")},e.prototype.setBoardRemark=function(t,e){this.BoardApiProxy.setBoardRemark(t,e)},e.prototype.getBoardRemark=function(t){return void 0===t&&(t=""),this.BoardApiProxy.getBoardRemark(t)},e.prototype.setMouseToolBehavior=function(t){this.BoardApiProxy.setMouseToolBehavior(t)},e.prototype.setMathGraphType=function(t,e){void 0===e&&(e=!0),this.BoardApiProxy.setMathGraphType(t,e)},e.prototype.setClassGroupEnable=function(t){this.BoardApiProxy.setClassGroupEnable(t)},e.prototype.getClassGroupEnable=function(){return this.BoardApiProxy.getClassGroupEnable()},e.prototype.setClassGroup=function(t,e,r,i,o){void 0===i&&(i=""),void 0===o&&(o=""),this.BoardApiProxy.setClassGroup(t,e,r,i,o)},e.prototype.resetClassGroup=function(){this.BoardApiProxy.resetClassGroup()},e.prototype.removeClassGroup=function(t){this.BoardApiProxy.removeClassGroup(t)},e.prototype.setClassGroupTitle=function(t,e){this.BoardApiProxy.setClassGroupTitle(t,e)},e.prototype.getClassGroupInfoByGroupId=function(t){return this.BoardApiProxy.getClassGroupInfoByGroupId(t)},e.prototype.getClassGroupIdByUserId=function(t){return this.BoardApiProxy.getClassGroupIdByUserId(t)},e.prototype.addUserToClassGroup=function(t,e){this.BoardApiProxy.addUserToClassGroup(t,e)},e.prototype.removeUserInClassGroup=function(t,e){this.BoardApiProxy.removeUserInClassGroup(t,e)},e.prototype.addBoardToClassGroup=function(t,e){this.BoardApiProxy.addBoardToClassGroup(t,e)},e.prototype.removeBoardInClassGroup=function(t,e){this.BoardApiProxy.removeBoardInClassGroup(t,e)},e.prototype.gotoClassGroupBoard=function(t){this.gotoBoard(t,!0)},e.prototype.getAllClassGroupIds=function(){return this.BoardApiProxy.getAllClassGroupIds()},e.prototype.setLogLevel=function(t){return this.logger.setLogLevel(t)},e.prototype.setImageTimeout=function(t){this.BoardApiProxy.setImageTimeout(t)},e.prototype.setScrollBarVisible=function(t){this.BoardApiProxy.setScrollBarVisible(t)},e.prototype.addTextFontFamily=function(t,e){void 0===e&&(e=""),this.BoardApiProxy.addTextFontFamily(t,e)},e.prototype.setTextFontFamily=function(t){this.BoardApiProxy.setTextFontFamily(t)},e.prototype.getTextFontFamily=function(){return this.BoardApiProxy.getTextFontFamily()},e.prototype.gotoStep=function(t,e){this.BoardApiProxy.gotoStep(t,+e||0)},e.prototype.getBoardScroll=function(){return this.BoardApiProxy.getBoardScroll()},e.prototype.setPiecewiseErasureEnable=function(t){this.BoardApiProxy.setPiecewiseErasureEnable(t)},e.prototype.setEraserMode=function(t){this.BoardApiProxy.setEraserMode(t)},e.prototype.isPiecewiseErasureEnable=function(){return this.BoardApiProxy.isPiecewiseErasureEnable()},e.prototype.setEraserSize=function(t){this.BoardApiProxy.setEraserSize(t)},e.prototype.getEraserSize=function(){return this.BoardApiProxy.getEraserSize()},e.prototype.setGlobalBackgroundPic=function(t,e,r){void 0===e&&(e=Ma.TEDU_BOARD_IMAGE_FIT_MODE_CENTER),void 0===r&&(r=M.BACKGROUND_TYPE.IMAGE),this.BoardApiProxy.setGlobalBackgroundPic(t,e,r)},e.prototype.getGlobalBackgroundPic=function(){return this.BoardApiProxy.getGlobalBackgroundPic()},e.prototype.soundMuteForPPT=function(t){this.BoardApiProxy.soundMuteForPPT(t)},e.prototype.setOwnerNickNameVisible=function(t){this.BoardApiProxy.setOwnerNickNameVisible(t)},e.prototype.getPPTRemarks=function(t,e){return void 0===e&&(e=-1),this.BoardApiProxy.getPPTRemarks(t,e)},e.prototype.useMathTool=function(t){void 0===t&&(t=$a.RULER),this.BoardApiProxy.useMathTool(t)},e.prototype.enablePenAutoFit=function(t,e){void 0===e&&(e=2e3),this.historySyncDone?this.BoardApiProxy.enablePenAutoFit(t,e):this.event.fireWarningIllegalOperateEvent("setPenAutoFittingMode")},e.prototype.setHighlighterColor=function(t){this.BoardApiProxy.setHighlighterColor(t)},e.prototype.getHighlighterColor=function(){return this.BoardApiProxy.getHighlighterColor()},e.prototype.getElementById=function(t){return this.BoardApiProxy.getElementById(t)},e.prototype.updateElementById=function(t,e){this.BoardApiProxy.updateElementById(t,e)},e.prototype.enableMultiTouch=function(t){this.BoardApiProxy.enableMultiTouch(t)},e.prototype.setSyncFps=function(t){this.BoardApiProxy.setSyncFps(t)},e.prototype.enableShowGraffiti=function(t){this.BoardApiProxy.enableShowGraffiti(t)},e.prototype.enablePermissionChecker=function(t,e){void 0===e&&(e=[]);var r=!1;this.permissionHandler.setInterceptor(t,e),this.permissionHandler.getExplictPermissions().find((function(t){return t.indexOf("Board::Switch")}))&&(r=!0),r&&this.BoardApiProxy.enableH5PointerEvent(),this.BoardApiProxy._reportCallApi("enablePermissionChecker",arguments)},e.prototype.disablePermissionChecker=function(t){this.permissionHandler.removeInterceptor(t),this.BoardApiProxy._reportCallApi("disablePermissionChecker",arguments)},e.prototype.resetPermissionChecker=function(){this.permissionHandler.resetInterceptor()},e.prototype.disablePointerEventResponding=function(t){this.setDisablePointerEvent(t),this.BoardApiProxy.setDisablePointerEvent()},e.prototype.exportData=function(){this.logger.warn(this.loggerModuleName,"exportData","please use the exportInLocalMode method.",!0)},e.prototype.importData=function(){this.logger.warn(this.loggerModuleName,"importData","please use the importInLocalMode method.",!0)},e.prototype.exportInLocalMode=function(t){return this.BoardApiProxy.exportInLocalMode(t)},e.prototype.importInLocalMode=function(t,e){this.BoardApiProxy.importInLocalMode(t,e)},e.prototype.getBoardClientSize=function(){return this.BoardApiProxy.getBoardClientSize()},e.prototype.getBackgroundImage=function(t){return this.BoardApiProxy.getBackgroundImage(t)},e.prototype.setElementsDisplay=function(t,e,r){this.BoardApiProxy.setElementsDisplay(t,e,r)},e.prototype.lockElements=function(t,e){this.BoardApiProxy.lockElements(t,e)},e.prototype.playH5PPTVideo=function(t){void 0===t&&(t=[]),this.BoardApiProxy.playH5PPTMedia(t,0)},e.prototype.playH5PPTAudio=function(t){void 0===t&&(t=[]),this.BoardApiProxy.playH5PPTMedia(t,1)},e.prototype.pauseH5PPTVideo=function(t){void 0===t&&(t=[]),this.BoardApiProxy.pauseH5PPTMedia(t,0)},e.prototype.pauseH5PPTAudio=function(t){void 0===t&&(t=[]),this.BoardApiProxy.pauseH5PPTMedia(t,1)},e.prototype.autoSelectedElement=function(t){this.BoardApiProxy.autoSelectedElement(t)},e.prototype.cancelSelect=function(t){this.BoardApiProxy.cancelSelect(t)},e.prototype.setDownGradeEnable=function(t,e,r){this.BoardApiProxy.setDownGradeEnable(t,e,r)},e.getVersion=function(){return i.VERSION},e.EVENT=tt,e.TOOL_TYPE=Xa,e.CONTENT_FIT_MODE=Xn,e.ARROW_TYPE=At,e.LINE_TYPE=mn,e.OVAL_DRAW_MODE=Qn,e.VIDEO_STATUS=Zc,e.MEDIA_STATUS=Fa,e.H5FILE_STATUS=mh,e.TEduBoardErrorCode=Xt,e.TEduBoardWarningCode=$,e.TEduBoardToolType=Xa,e.TEduBoardImageFitMode=Ma,e.TEduBoardTextStyle=Jn,e.TEduBoardUploadStatus=zl,e.TEduBoardBackgroundH5Status=rh,e.TEduBoardContentFitMode=Xn,e.TEduBoardLineType=mn,e.TEduBoardArrowType=At,e.TEduBoardOvalDrawMode=Qn,e.TEduBoardH5FileStatus=mh,e.TEduBoardVideoStatus=Zc,e.TEduBoardAudioStatus=Fa,e.TEduBoardImageStatus=$n,e.TEduBoardElementType=Ta,e.TEduBoardH5PPTStatus=ah,e.TEduBoardH5PPTMediaStatus=sh,e.TEduBoardPosition=Ua,e.TEduBoardServiceType=o,e.TEduBoardErasableElementType=hs,e.TEduBoardAccessibleOperation=Nh,e.TEduBoardTextComponentStatus=Ic,e.TEduBoardMathGraphCode=Bh,e.TEduBoardPenFittingMode=xs,e.TEduBoardBackgroundType=Oh,e.TEduBoardMathGraphType=hl,e.TEduBoardClassGroupOperationType=Al,e.TEduBoardLogLevel=ht,e.TEduBoardFileType=Cl,e.TEduBoardRemoteCursorAction=kh,e.TEduMathToolType=$a,e.TEduElementOperatorType=Dl,e.TEduBoardFillType=Qa,e.TEduWatermarkType=Nl,e.TEduImportInLocalModeStatus=sc,e.TEduBoardPositionChangeStatus=lc,e.TEduSnapshotCode=au,e.TEduDrawStatusCode=bh,e}(X),uu=function(t){function e(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=t.apply(this,Zt([],Kt(e),!1))||this;return Object.getOwnPropertyNames(Qh.prototype).forEach((function(t){if("function"==typeof i[t]){var e=i[t];i[t]=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{return e.apply(this,r)}catch(e){null===(t=this.logger)||void 0===t||t.reportError(this.loggerModuleName,"errorEvent",{code:Xt.TEDU_BOARD_ERROR_RUNTIME,message:"Code: ".concat(Xt.TEDU_BOARD_ERROR_RUNTIME,";Message: ").concat(e.message,"; Stack: ").concat(e.stack.toString()),param:{extraInfo:{code:Xt.TEDU_BOARD_ERROR_RUNTIME,message:e.message,stack:e.stack.toString()}}})}}}})),i}return Jt(e,t),e}(Qh=hu);e.default=uu}]).default}));